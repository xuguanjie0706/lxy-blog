import{c as commonjsGlobal$1,g as getDefaultExportFromCjs$1}from"./chunks/theme.E6NxZvFf.js";import{aw as _export_sfc,p as openBlock,q as createElementBlock,a as ref,e as onMounted,d as getCurrentInstance,ai as resolveComponent,t as createBaseVNode,V as createVNode,P as withCtx,aQ as createStaticVNode,T as createTextVNode}from"./chunks/framework.0Ep84fQ5.js";const _imports_0="/assets/image.ZBvYHFzf.png";function bind(t,r){return function(){return t.apply(r,arguments)}}const{toString:toString$2}=Object.prototype,{getPrototypeOf}=Object,kindOf=(t=>r=>{const e=toString$2.call(r);return t[e]||(t[e]=e.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=t=>(t=t.toLowerCase(),r=>kindOf(r)===t),typeOfTest=t=>r=>typeof r===t,{isArray:isArray$2}=Array,isUndefined$2=typeOfTest("undefined");function isBuffer$2(t){return t!==null&&!isUndefined$2(t)&&t.constructor!==null&&!isUndefined$2(t.constructor)&&isFunction$2(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(t){let r;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?r=ArrayBuffer.isView(t):r=t&&t.buffer&&isArrayBuffer(t.buffer),r}const isString$2=typeOfTest("string"),isFunction$2=typeOfTest("function"),isNumber$2=typeOfTest("number"),isObject$2=t=>t!==null&&typeof t=="object",isBoolean$2=t=>t===!0||t===!1,isPlainObject$1=t=>{if(kindOf(t)!=="object")return!1;const r=getPrototypeOf(t);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=t=>isObject$2(t)&&isFunction$2(t.pipe),isFormData=t=>{let r;return t&&(typeof FormData=="function"&&t instanceof FormData||isFunction$2(t.append)&&((r=kindOf(t))==="formdata"||r==="object"&&isFunction$2(t.toString)&&t.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),trim=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach$1(t,r,{allOwnKeys:e=!1}={}){if(t===null||typeof t>"u")return;let n,a;if(typeof t!="object"&&(t=[t]),isArray$2(t))for(n=0,a=t.length;n<a;n++)r.call(null,t[n],n,t);else{const o=e?Object.getOwnPropertyNames(t):Object.keys(t),s=o.length;let l;for(n=0;n<s;n++)l=o[n],r.call(null,t[l],l,t)}}function findKey(t,r){r=r.toLowerCase();const e=Object.keys(t);let n=e.length,a;for(;n-- >0;)if(a=e[n],r===a.toLowerCase())return a;return null}const _global=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,isContextDefined=t=>!isUndefined$2(t)&&t!==_global;function merge$1(){const{caseless:t}=isContextDefined(this)&&this||{},r={},e=(n,a)=>{const o=t&&findKey(r,a)||a;isPlainObject$1(r[o])&&isPlainObject$1(n)?r[o]=merge$1(r[o],n):isPlainObject$1(n)?r[o]=merge$1({},n):isArray$2(n)?r[o]=n.slice():r[o]=n};for(let n=0,a=arguments.length;n<a;n++)arguments[n]&&forEach$1(arguments[n],e);return r}const extend$1=(t,r,e,{allOwnKeys:n}={})=>(forEach$1(r,(a,o)=>{e&&isFunction$2(a)?t[o]=bind(a,e):t[o]=a},{allOwnKeys:n}),t),stripBOM=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),inherits=(t,r,e,n)=>{t.prototype=Object.create(r.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:r.prototype}),e&&Object.assign(t.prototype,e)},toFlatObject=(t,r,e,n)=>{let a,o,s;const l={};if(r=r||{},t==null)return r;do{for(a=Object.getOwnPropertyNames(t),o=a.length;o-- >0;)s=a[o],(!n||n(s,t,r))&&!l[s]&&(r[s]=t[s],l[s]=!0);t=e!==!1&&getPrototypeOf(t)}while(t&&(!e||e(t,r))&&t!==Object.prototype);return r},endsWith$1=(t,r,e)=>{t=String(t),(e===void 0||e>t.length)&&(e=t.length),e-=r.length;const n=t.indexOf(r,e);return n!==-1&&n===e},toArray=t=>{if(!t)return null;if(isArray$2(t))return t;let r=t.length;if(!isNumber$2(r))return null;const e=new Array(r);for(;r-- >0;)e[r]=t[r];return e},isTypedArray$2=(t=>r=>t&&r instanceof t)(typeof Uint8Array<"u"&&getPrototypeOf(Uint8Array)),forEachEntry=(t,r)=>{const n=(t&&t[Symbol.iterator]).call(t);let a;for(;(a=n.next())&&!a.done;){const o=a.value;r.call(t,o[0],o[1])}},matchAll=(t,r)=>{let e;const n=[];for(;(e=t.exec(r))!==null;)n.push(e);return n},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,n,a){return n.toUpperCase()+a}),hasOwnProperty$h=(({hasOwnProperty:t})=>(r,e)=>t.call(r,e))(Object.prototype),isRegExp$1=kindOfTest("RegExp"),reduceDescriptors=(t,r)=>{const e=Object.getOwnPropertyDescriptors(t),n={};forEach$1(e,(a,o)=>{let s;(s=r(a,o,t))!==!1&&(n[o]=s||a)}),Object.defineProperties(t,n)},freezeMethods=t=>{reduceDescriptors(t,(r,e)=>{if(isFunction$2(t)&&["arguments","caller","callee"].indexOf(e)!==-1)return!1;const n=t[e];if(isFunction$2(n)){if(r.enumerable=!1,"writable"in r){r.writable=!1;return}r.set||(r.set=()=>{throw Error("Can not rewrite read-only method '"+e+"'")})}})},toObjectSet=(t,r)=>{const e={},n=a=>{a.forEach(o=>{e[o]=!0})};return isArray$2(t)?n(t):n(String(t).split(r)),e},noop$1=()=>{},toFiniteNumber=(t,r)=>(t=+t,Number.isFinite(t)?t:r),ALPHA="abcdefghijklmnopqrstuvwxyz",DIGIT="0123456789",ALPHABET={DIGIT,ALPHA,ALPHA_DIGIT:ALPHA+ALPHA.toUpperCase()+DIGIT},generateString=(t=16,r=ALPHABET.ALPHA_DIGIT)=>{let e="";const{length:n}=r;for(;t--;)e+=r[Math.random()*n|0];return e};function isSpecCompliantForm(t){return!!(t&&isFunction$2(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const toJSONObject=t=>{const r=new Array(10),e=(n,a)=>{if(isObject$2(n)){if(r.indexOf(n)>=0)return;if(!("toJSON"in n)){r[a]=n;const o=isArray$2(n)?[]:{};return forEach$1(n,(s,l)=>{const u=e(s,a+1);!isUndefined$2(u)&&(o[l]=u)}),r[a]=void 0,o}}return n};return e(t,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=t=>t&&(isObject$2(t)||isFunction$2(t))&&isFunction$2(t.then)&&isFunction$2(t.catch),utils$1={isArray:isArray$2,isArrayBuffer,isBuffer:isBuffer$2,isFormData,isArrayBufferView,isString:isString$2,isNumber:isNumber$2,isBoolean:isBoolean$2,isObject:isObject$2,isPlainObject:isPlainObject$1,isUndefined:isUndefined$2,isDate,isFile,isBlob,isRegExp:isRegExp$1,isFunction:isFunction$2,isStream,isURLSearchParams,isTypedArray:isTypedArray$2,isFileList,forEach:forEach$1,merge:merge$1,extend:extend$1,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith:endsWith$1,toArray,forEachEntry,matchAll,isHTMLForm,hasOwnProperty:hasOwnProperty$h,hasOwnProp:hasOwnProperty$h,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop:noop$1,toFiniteNumber,findKey,global:_global,isContextDefined,ALPHABET,generateString,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable};function AxiosError(t,r,e,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",r&&(this.code=r),e&&(this.config=e),n&&(this.request=n),a&&(this.response=a)}utils$1.inherits(AxiosError,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$1.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const prototype$1=AxiosError.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{descriptors[t]={value:t}});Object.defineProperties(AxiosError,descriptors);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError.from=(t,r,e,n,a,o)=>{const s=Object.create(prototype$1);return utils$1.toFlatObject(t,s,function(u){return u!==Error.prototype},l=>l!=="isAxiosError"),AxiosError.call(s,t.message,r,e,n,a),s.cause=t,s.name=t.name,o&&Object.assign(s,o),s};const httpAdapter=null;function isVisitable(t){return utils$1.isPlainObject(t)||utils$1.isArray(t)}function removeBrackets(t){return utils$1.endsWith(t,"[]")?t.slice(0,-2):t}function renderKey(t,r,e){return t?t.concat(r).map(function(a,o){return a=removeBrackets(a),!e&&o?"["+a+"]":a}).join(e?".":""):r}function isFlatArray(t){return utils$1.isArray(t)&&!t.some(isVisitable)}const predicates=utils$1.toFlatObject(utils$1,{},null,function(r){return/^is[A-Z]/.test(r)});function toFormData(t,r,e){if(!utils$1.isObject(t))throw new TypeError("target must be an object");r=r||new FormData,e=utils$1.toFlatObject(e,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,y){return!utils$1.isUndefined(y[g])});const n=e.metaTokens,a=e.visitor||d,o=e.dots,s=e.indexes,u=(e.Blob||typeof Blob<"u"&&Blob)&&utils$1.isSpecCompliantForm(r);if(!utils$1.isFunction(a))throw new TypeError("visitor must be a function");function c(v){if(v===null)return"";if(utils$1.isDate(v))return v.toISOString();if(!u&&utils$1.isBlob(v))throw new AxiosError("Blob is not supported. Use a Buffer instead.");return utils$1.isArrayBuffer(v)||utils$1.isTypedArray(v)?u&&typeof Blob=="function"?new Blob([v]):Buffer.from(v):v}function d(v,g,y){let m=v;if(v&&!y&&typeof v=="object"){if(utils$1.endsWith(g,"{}"))g=n?g:g.slice(0,-2),v=JSON.stringify(v);else if(utils$1.isArray(v)&&isFlatArray(v)||(utils$1.isFileList(v)||utils$1.endsWith(g,"[]"))&&(m=utils$1.toArray(v)))return g=removeBrackets(g),m.forEach(function(w,R){!(utils$1.isUndefined(w)||w===null)&&r.append(s===!0?renderKey([g],R,o):s===null?g:g+"[]",c(w))}),!1}return isVisitable(v)?!0:(r.append(renderKey(y,g,o),c(v)),!1)}const f=[],h=Object.assign(predicates,{defaultVisitor:d,convertValue:c,isVisitable});function p(v,g){if(!utils$1.isUndefined(v)){if(f.indexOf(v)!==-1)throw Error("Circular reference detected in "+g.join("."));f.push(v),utils$1.forEach(v,function(m,S){(!(utils$1.isUndefined(m)||m===null)&&a.call(r,m,utils$1.isString(S)?S.trim():S,g,h))===!0&&p(m,g?g.concat(S):[S])}),f.pop()}}if(!utils$1.isObject(t))throw new TypeError("data must be an object");return p(t),r}function encode$1(t){const r={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return r[n]})}function AxiosURLSearchParams(t,r){this._pairs=[],t&&toFormData(t,this,r)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function(r,e){this._pairs.push([r,e])};prototype.toString=function(r){const e=r?function(n){return r.call(this,n,encode$1)}:encode$1;return this._pairs.map(function(a){return e(a[0])+"="+e(a[1])},"").join("&")};function encode(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(t,r,e){if(!r)return t;const n=e&&e.encode||encode,a=e&&e.serialize;let o;if(a?o=a(r,e):o=utils$1.isURLSearchParams(r)?r.toString():new AxiosURLSearchParams(r,e).toString(n),o){const s=t.indexOf("#");s!==-1&&(t=t.slice(0,s)),t+=(t.indexOf("?")===-1?"?":"&")+o}return t}class InterceptorManager{constructor(){this.handlers=[]}use(r,e,n){return this.handlers.push({fulfilled:r,rejected:e,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){utils$1.forEach(this.handlers,function(n){n!==null&&r(n)})}}const transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,platform$1={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window<"u"&&typeof document<"u",hasStandardBrowserEnv=(t=>hasBrowserEnv&&["ReactNative","NativeScript","NS"].indexOf(t)<0)(typeof navigator<"u"&&navigator.product),hasStandardBrowserWebWorkerEnv=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",utils=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv},Symbol.toStringTag,{value:"Module"})),platform={...utils,...platform$1};function toURLEncodedForm(t,r){return toFormData(t,new platform.classes.URLSearchParams,Object.assign({visitor:function(e,n,a,o){return platform.isNode&&utils$1.isBuffer(e)?(this.append(n,e.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},r))}function parsePropPath(t){return utils$1.matchAll(/\w+|\[(\w*)]/g,t).map(r=>r[0]==="[]"?"":r[1]||r[0])}function arrayToObject(t){const r={},e=Object.keys(t);let n;const a=e.length;let o;for(n=0;n<a;n++)o=e[n],r[o]=t[o];return r}function formDataToJSON(t){function r(e,n,a,o){let s=e[o++];if(s==="__proto__")return!0;const l=Number.isFinite(+s),u=o>=e.length;return s=!s&&utils$1.isArray(a)?a.length:s,u?(utils$1.hasOwnProp(a,s)?a[s]=[a[s],n]:a[s]=n,!l):((!a[s]||!utils$1.isObject(a[s]))&&(a[s]=[]),r(e,n,a[s],o)&&utils$1.isArray(a[s])&&(a[s]=arrayToObject(a[s])),!l)}if(utils$1.isFormData(t)&&utils$1.isFunction(t.entries)){const e={};return utils$1.forEachEntry(t,(n,a)=>{r(parsePropPath(n),a,e,0)}),e}return null}function stringifySafely(t,r,e){if(utils$1.isString(t))try{return(r||JSON.parse)(t),utils$1.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(e||JSON.stringify)(t)}const defaults={transitional:transitionalDefaults,adapter:["xhr","http"],transformRequest:[function(r,e){const n=e.getContentType()||"",a=n.indexOf("application/json")>-1,o=utils$1.isObject(r);if(o&&utils$1.isHTMLForm(r)&&(r=new FormData(r)),utils$1.isFormData(r))return a?JSON.stringify(formDataToJSON(r)):r;if(utils$1.isArrayBuffer(r)||utils$1.isBuffer(r)||utils$1.isStream(r)||utils$1.isFile(r)||utils$1.isBlob(r))return r;if(utils$1.isArrayBufferView(r))return r.buffer;if(utils$1.isURLSearchParams(r))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let l;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(r,this.formSerializer).toString();if((l=utils$1.isFileList(r))||n.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return toFormData(l?{"files[]":r}:r,u&&new u,this.formSerializer)}}return o||a?(e.setContentType("application/json",!1),stringifySafely(r)):r}],transformResponse:[function(r){const e=this.transitional||defaults.transitional,n=e&&e.forcedJSONParsing,a=this.responseType==="json";if(r&&utils$1.isString(r)&&(n&&!this.responseType||a)){const s=!(e&&e.silentJSONParsing)&&a;try{return JSON.parse(r)}catch(l){if(s)throw l.name==="SyntaxError"?AxiosError.from(l,AxiosError.ERR_BAD_RESPONSE,this,null,this.response):l}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform.classes.FormData,Blob:platform.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$1.forEach(["delete","get","head","post","put","patch"],t=>{defaults.headers[t]={}});const defaults$1=defaults,ignoreDuplicateOf=utils$1.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=t=>{const r={};let e,n,a;return t&&t.split(`
`).forEach(function(s){a=s.indexOf(":"),e=s.substring(0,a).trim().toLowerCase(),n=s.substring(a+1).trim(),!(!e||r[e]&&ignoreDuplicateOf[e])&&(e==="set-cookie"?r[e]?r[e].push(n):r[e]=[n]:r[e]=r[e]?r[e]+", "+n:n)}),r},$internals=Symbol("internals");function normalizeHeader(t){return t&&String(t).trim().toLowerCase()}function normalizeValue(t){return t===!1||t==null?t:utils$1.isArray(t)?t.map(normalizeValue):String(t)}function parseTokens(t){const r=Object.create(null),e=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=e.exec(t);)r[n[1]]=n[2];return r}const isValidHeaderName=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function matchHeaderValue(t,r,e,n,a){if(utils$1.isFunction(n))return n.call(this,r,e);if(a&&(r=e),!!utils$1.isString(r)){if(utils$1.isString(n))return r.indexOf(n)!==-1;if(utils$1.isRegExp(n))return n.test(r)}}function formatHeader(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(r,e,n)=>e.toUpperCase()+n)}function buildAccessors(t,r){const e=utils$1.toCamelCase(" "+r);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+e,{value:function(a,o,s){return this[n].call(this,r,a,o,s)},configurable:!0})})}class AxiosHeaders{constructor(r){r&&this.set(r)}set(r,e,n){const a=this;function o(l,u,c){const d=normalizeHeader(u);if(!d)throw new Error("header name must be a non-empty string");const f=utils$1.findKey(a,d);(!f||a[f]===void 0||c===!0||c===void 0&&a[f]!==!1)&&(a[f||u]=normalizeValue(l))}const s=(l,u)=>utils$1.forEach(l,(c,d)=>o(c,d,u));return utils$1.isPlainObject(r)||r instanceof this.constructor?s(r,e):utils$1.isString(r)&&(r=r.trim())&&!isValidHeaderName(r)?s(parseHeaders(r),e):r!=null&&o(e,r,n),this}get(r,e){if(r=normalizeHeader(r),r){const n=utils$1.findKey(this,r);if(n){const a=this[n];if(!e)return a;if(e===!0)return parseTokens(a);if(utils$1.isFunction(e))return e.call(this,a,n);if(utils$1.isRegExp(e))return e.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(r,e){if(r=normalizeHeader(r),r){const n=utils$1.findKey(this,r);return!!(n&&this[n]!==void 0&&(!e||matchHeaderValue(this,this[n],n,e)))}return!1}delete(r,e){const n=this;let a=!1;function o(s){if(s=normalizeHeader(s),s){const l=utils$1.findKey(n,s);l&&(!e||matchHeaderValue(n,n[l],l,e))&&(delete n[l],a=!0)}}return utils$1.isArray(r)?r.forEach(o):o(r),a}clear(r){const e=Object.keys(this);let n=e.length,a=!1;for(;n--;){const o=e[n];(!r||matchHeaderValue(this,this[o],o,r,!0))&&(delete this[o],a=!0)}return a}normalize(r){const e=this,n={};return utils$1.forEach(this,(a,o)=>{const s=utils$1.findKey(n,o);if(s){e[s]=normalizeValue(a),delete e[o];return}const l=r?formatHeader(o):String(o).trim();l!==o&&delete e[o],e[l]=normalizeValue(a),n[l]=!0}),this}concat(...r){return this.constructor.concat(this,...r)}toJSON(r){const e=Object.create(null);return utils$1.forEach(this,(n,a)=>{n!=null&&n!==!1&&(e[a]=r&&utils$1.isArray(n)?n.join(", "):n)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([r,e])=>r+": "+e).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(r){return r instanceof this?r:new this(r)}static concat(r,...e){const n=new this(r);return e.forEach(a=>n.set(a)),n}static accessor(r){const n=(this[$internals]=this[$internals]={accessors:{}}).accessors,a=this.prototype;function o(s){const l=normalizeHeader(s);n[l]||(buildAccessors(a,s),n[l]=!0)}return utils$1.isArray(r)?r.forEach(o):o(r),this}}AxiosHeaders.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils$1.reduceDescriptors(AxiosHeaders.prototype,({value:t},r)=>{let e=r[0].toUpperCase()+r.slice(1);return{get:()=>t,set(n){this[e]=n}}});utils$1.freezeMethods(AxiosHeaders);const AxiosHeaders$1=AxiosHeaders;function transformData(t,r){const e=this||defaults$1,n=r||e,a=AxiosHeaders$1.from(n.headers);let o=n.data;return utils$1.forEach(t,function(l){o=l.call(e,o,a.normalize(),r?r.status:void 0)}),a.normalize(),o}function isCancel(t){return!!(t&&t.__CANCEL__)}function CanceledError(t,r,e){AxiosError.call(this,t??"canceled",AxiosError.ERR_CANCELED,r,e),this.name="CanceledError"}utils$1.inherits(CanceledError,AxiosError,{__CANCEL__:!0});function settle(t,r,e){const n=e.config.validateStatus;!e.status||!n||n(e.status)?t(e):r(new AxiosError("Request failed with status code "+e.status,[AxiosError.ERR_BAD_REQUEST,AxiosError.ERR_BAD_RESPONSE][Math.floor(e.status/100)-4],e.config,e.request,e))}const cookies=platform.hasStandardBrowserEnv?{write(t,r,e,n,a,o){const s=[t+"="+encodeURIComponent(r)];utils$1.isNumber(e)&&s.push("expires="+new Date(e).toGMTString()),utils$1.isString(n)&&s.push("path="+n),utils$1.isString(a)&&s.push("domain="+a),o===!0&&s.push("secure"),document.cookie=s.join("; ")},read(t){const r=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function combineURLs(t,r){return r?t.replace(/\/?\/$/,"")+"/"+r.replace(/^\/+/,""):t}function buildFullPath(t,r){return t&&!isAbsoluteURL(r)?combineURLs(t,r):r}const isURLSameOrigin=platform.hasStandardBrowserEnv?function(){const r=/(msie|trident)/i.test(navigator.userAgent),e=document.createElement("a");let n;function a(o){let s=o;return r&&(e.setAttribute("href",s),s=e.href),e.setAttribute("href",s),{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",host:e.host,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):"",hostname:e.hostname,port:e.port,pathname:e.pathname.charAt(0)==="/"?e.pathname:"/"+e.pathname}}return n=a(window.location.href),function(s){const l=utils$1.isString(s)?a(s):s;return l.protocol===n.protocol&&l.host===n.host}}():function(){return function(){return!0}}();function parseProtocol(t){const r=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return r&&r[1]||""}function speedometer(t,r){t=t||10;const e=new Array(t),n=new Array(t);let a=0,o=0,s;return r=r!==void 0?r:1e3,function(u){const c=Date.now(),d=n[o];s||(s=c),e[a]=u,n[a]=c;let f=o,h=0;for(;f!==a;)h+=e[f++],f=f%t;if(a=(a+1)%t,a===o&&(o=(o+1)%t),c-s<r)return;const p=d&&c-d;return p?Math.round(h*1e3/p):void 0}}function progressEventReducer(t,r){let e=0;const n=speedometer(50,250);return a=>{const o=a.loaded,s=a.lengthComputable?a.total:void 0,l=o-e,u=n(l),c=o<=s;e=o;const d={loaded:o,total:s,progress:s?o/s:void 0,bytes:l,rate:u||void 0,estimated:u&&s&&c?(s-o)/u:void 0,event:a};d[r?"download":"upload"]=!0,t(d)}}const isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(t){return new Promise(function(e,n){let a=t.data;const o=AxiosHeaders$1.from(t.headers).normalize();let{responseType:s,withXSRFToken:l}=t,u;function c(){t.cancelToken&&t.cancelToken.unsubscribe(u),t.signal&&t.signal.removeEventListener("abort",u)}let d;if(utils$1.isFormData(a)){if(platform.hasStandardBrowserEnv||platform.hasStandardBrowserWebWorkerEnv)o.setContentType(!1);else if((d=o.getContentType())!==!1){const[g,...y]=d?d.split(";").map(m=>m.trim()).filter(Boolean):[];o.setContentType([g||"multipart/form-data",...y].join("; "))}}let f=new XMLHttpRequest;if(t.auth){const g=t.auth.username||"",y=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";o.set("Authorization","Basic "+btoa(g+":"+y))}const h=buildFullPath(t.baseURL,t.url);f.open(t.method.toUpperCase(),buildURL(h,t.params,t.paramsSerializer),!0),f.timeout=t.timeout;function p(){if(!f)return;const g=AxiosHeaders$1.from("getAllResponseHeaders"in f&&f.getAllResponseHeaders()),m={data:!s||s==="text"||s==="json"?f.responseText:f.response,status:f.status,statusText:f.statusText,headers:g,config:t,request:f};settle(function(w){e(w),c()},function(w){n(w),c()},m),f=null}if("onloadend"in f?f.onloadend=p:f.onreadystatechange=function(){!f||f.readyState!==4||f.status===0&&!(f.responseURL&&f.responseURL.indexOf("file:")===0)||setTimeout(p)},f.onabort=function(){f&&(n(new AxiosError("Request aborted",AxiosError.ECONNABORTED,t,f)),f=null)},f.onerror=function(){n(new AxiosError("Network Error",AxiosError.ERR_NETWORK,t,f)),f=null},f.ontimeout=function(){let y=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const m=t.transitional||transitionalDefaults;t.timeoutErrorMessage&&(y=t.timeoutErrorMessage),n(new AxiosError(y,m.clarifyTimeoutError?AxiosError.ETIMEDOUT:AxiosError.ECONNABORTED,t,f)),f=null},platform.hasStandardBrowserEnv&&(l&&utils$1.isFunction(l)&&(l=l(t)),l||l!==!1&&isURLSameOrigin(h))){const g=t.xsrfHeaderName&&t.xsrfCookieName&&cookies.read(t.xsrfCookieName);g&&o.set(t.xsrfHeaderName,g)}a===void 0&&o.setContentType(null),"setRequestHeader"in f&&utils$1.forEach(o.toJSON(),function(y,m){f.setRequestHeader(m,y)}),utils$1.isUndefined(t.withCredentials)||(f.withCredentials=!!t.withCredentials),s&&s!=="json"&&(f.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&f.addEventListener("progress",progressEventReducer(t.onDownloadProgress,!0)),typeof t.onUploadProgress=="function"&&f.upload&&f.upload.addEventListener("progress",progressEventReducer(t.onUploadProgress)),(t.cancelToken||t.signal)&&(u=g=>{f&&(n(!g||g.type?new CanceledError(null,t,f):g),f.abort(),f=null)},t.cancelToken&&t.cancelToken.subscribe(u),t.signal&&(t.signal.aborted?u():t.signal.addEventListener("abort",u)));const v=parseProtocol(h);if(v&&platform.protocols.indexOf(v)===-1){n(new AxiosError("Unsupported protocol "+v+":",AxiosError.ERR_BAD_REQUEST,t));return}f.send(a||null)})},knownAdapters={http:httpAdapter,xhr:xhrAdapter};utils$1.forEach(knownAdapters,(t,r)=>{if(t){try{Object.defineProperty(t,"name",{value:r})}catch{}Object.defineProperty(t,"adapterName",{value:r})}});const renderReason=t=>`- ${t}`,isResolvedHandle=t=>utils$1.isFunction(t)||t===null||t===!1,adapters={getAdapter:t=>{t=utils$1.isArray(t)?t:[t];const{length:r}=t;let e,n;const a={};for(let o=0;o<r;o++){e=t[o];let s;if(n=e,!isResolvedHandle(e)&&(n=knownAdapters[(s=String(e)).toLowerCase()],n===void 0))throw new AxiosError(`Unknown adapter '${s}'`);if(n)break;a[s||"#"+o]=n}if(!n){const o=Object.entries(a).map(([l,u])=>`adapter ${l} `+(u===!1?"is not supported by the environment":"is not available in the build"));let s=r?o.length>1?`since :
`+o.map(renderReason).join(`
`):" "+renderReason(o[0]):"as no adapter specified";throw new AxiosError("There is no suitable adapter to dispatch the request "+s,"ERR_NOT_SUPPORT")}return n},adapters:knownAdapters};function throwIfCancellationRequested(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new CanceledError(null,t)}function dispatchRequest(t){return throwIfCancellationRequested(t),t.headers=AxiosHeaders$1.from(t.headers),t.data=transformData.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(t.adapter||defaults$1.adapter)(t).then(function(n){return throwIfCancellationRequested(t),n.data=transformData.call(t,t.transformResponse,n),n.headers=AxiosHeaders$1.from(n.headers),n},function(n){return isCancel(n)||(throwIfCancellationRequested(t),n&&n.response&&(n.response.data=transformData.call(t,t.transformResponse,n.response),n.response.headers=AxiosHeaders$1.from(n.response.headers))),Promise.reject(n)})}const headersToObject=t=>t instanceof AxiosHeaders$1?{...t}:t;function mergeConfig(t,r){r=r||{};const e={};function n(c,d,f){return utils$1.isPlainObject(c)&&utils$1.isPlainObject(d)?utils$1.merge.call({caseless:f},c,d):utils$1.isPlainObject(d)?utils$1.merge({},d):utils$1.isArray(d)?d.slice():d}function a(c,d,f){if(utils$1.isUndefined(d)){if(!utils$1.isUndefined(c))return n(void 0,c,f)}else return n(c,d,f)}function o(c,d){if(!utils$1.isUndefined(d))return n(void 0,d)}function s(c,d){if(utils$1.isUndefined(d)){if(!utils$1.isUndefined(c))return n(void 0,c)}else return n(void 0,d)}function l(c,d,f){if(f in r)return n(c,d);if(f in t)return n(void 0,c)}const u={url:o,method:o,data:o,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:l,headers:(c,d)=>a(headersToObject(c),headersToObject(d),!0)};return utils$1.forEach(Object.keys(Object.assign({},t,r)),function(d){const f=u[d]||a,h=f(t[d],r[d],d);utils$1.isUndefined(h)&&f!==l||(e[d]=h)}),e}const VERSION="1.6.8",validators$1={};["object","boolean","number","function","string","symbol"].forEach((t,r)=>{validators$1[t]=function(n){return typeof n===t||"a"+(r<1?"n ":" ")+t}});const deprecatedWarnings={};validators$1.transitional=function(r,e,n){function a(o,s){return"[Axios v"+VERSION+"] Transitional option '"+o+"'"+s+(n?". "+n:"")}return(o,s,l)=>{if(r===!1)throw new AxiosError(a(s," has been removed"+(e?" in "+e:"")),AxiosError.ERR_DEPRECATED);return e&&!deprecatedWarnings[s]&&(deprecatedWarnings[s]=!0,console.warn(a(s," has been deprecated since v"+e+" and will be removed in the near future"))),r?r(o,s,l):!0}};function assertOptions(t,r,e){if(typeof t!="object")throw new AxiosError("options must be an object",AxiosError.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let a=n.length;for(;a-- >0;){const o=n[a],s=r[o];if(s){const l=t[o],u=l===void 0||s(l,o,t);if(u!==!0)throw new AxiosError("option "+o+" must be "+u,AxiosError.ERR_BAD_OPTION_VALUE);continue}if(e!==!0)throw new AxiosError("Unknown option "+o,AxiosError.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$1},validators=validator.validators;class Axios{constructor(r){this.defaults=r,this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}async request(r,e){try{return await this._request(r,e)}catch(n){if(n instanceof Error){let a;Error.captureStackTrace?Error.captureStackTrace(a={}):a=new Error;const o=a.stack?a.stack.replace(/^.+\n/,""):"";n.stack?o&&!String(n.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+o):n.stack=o}throw n}}_request(r,e){typeof r=="string"?(e=e||{},e.url=r):e=r||{},e=mergeConfig(this.defaults,e);const{transitional:n,paramsSerializer:a,headers:o}=e;n!==void 0&&validator.assertOptions(n,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),a!=null&&(utils$1.isFunction(a)?e.paramsSerializer={serialize:a}:validator.assertOptions(a,{encode:validators.function,serialize:validators.function},!0)),e.method=(e.method||this.defaults.method||"get").toLowerCase();let s=o&&utils$1.merge(o.common,o[e.method]);o&&utils$1.forEach(["delete","get","head","post","put","patch","common"],v=>{delete o[v]}),e.headers=AxiosHeaders$1.concat(s,o);const l=[];let u=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(e)===!1||(u=u&&g.synchronous,l.unshift(g.fulfilled,g.rejected))});const c=[];this.interceptors.response.forEach(function(g){c.push(g.fulfilled,g.rejected)});let d,f=0,h;if(!u){const v=[dispatchRequest.bind(this),void 0];for(v.unshift.apply(v,l),v.push.apply(v,c),h=v.length,d=Promise.resolve(e);f<h;)d=d.then(v[f++],v[f++]);return d}h=l.length;let p=e;for(f=0;f<h;){const v=l[f++],g=l[f++];try{p=v(p)}catch(y){g.call(this,y);break}}try{d=dispatchRequest.call(this,p)}catch(v){return Promise.reject(v)}for(f=0,h=c.length;f<h;)d=d.then(c[f++],c[f++]);return d}getUri(r){r=mergeConfig(this.defaults,r);const e=buildFullPath(r.baseURL,r.url);return buildURL(e,r.params,r.paramsSerializer)}}utils$1.forEach(["delete","get","head","options"],function(r){Axios.prototype[r]=function(e,n){return this.request(mergeConfig(n||{},{method:r,url:e,data:(n||{}).data}))}});utils$1.forEach(["post","put","patch"],function(r){function e(n){return function(o,s,l){return this.request(mergeConfig(l||{},{method:r,headers:n?{"Content-Type":"multipart/form-data"}:{},url:o,data:s}))}}Axios.prototype[r]=e(),Axios.prototype[r+"Form"]=e(!0)});const Axios$1=Axios;class CancelToken{constructor(r){if(typeof r!="function")throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(o){e=o});const n=this;this.promise.then(a=>{if(!n._listeners)return;let o=n._listeners.length;for(;o-- >0;)n._listeners[o](a);n._listeners=null}),this.promise.then=a=>{let o;const s=new Promise(l=>{n.subscribe(l),o=l}).then(a);return s.cancel=function(){n.unsubscribe(o)},s},r(function(o,s,l){n.reason||(n.reason=new CanceledError(o,s,l),e(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(r){if(this.reason){r(this.reason);return}this._listeners?this._listeners.push(r):this._listeners=[r]}unsubscribe(r){if(!this._listeners)return;const e=this._listeners.indexOf(r);e!==-1&&this._listeners.splice(e,1)}static source(){let r;return{token:new CancelToken(function(a){r=a}),cancel:r}}}const CancelToken$1=CancelToken;function spread(t){return function(e){return t.apply(null,e)}}function isAxiosError(t){return utils$1.isObject(t)&&t.isAxiosError===!0}const HttpStatusCode={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode).forEach(([t,r])=>{HttpStatusCode[r]=t});const HttpStatusCode$1=HttpStatusCode;function createInstance(t){const r=new Axios$1(t),e=bind(Axios$1.prototype.request,r);return utils$1.extend(e,Axios$1.prototype,r,{allOwnKeys:!0}),utils$1.extend(e,r,null,{allOwnKeys:!0}),e.create=function(a){return createInstance(mergeConfig(t,a))},e}const axios=createInstance(defaults$1);axios.Axios=Axios$1;axios.CanceledError=CanceledError;axios.CancelToken=CancelToken$1;axios.isCancel=isCancel;axios.VERSION=VERSION;axios.toFormData=toFormData;axios.AxiosError=AxiosError;axios.Cancel=axios.CanceledError;axios.all=function(r){return Promise.all(r)};axios.spread=spread;axios.isAxiosError=isAxiosError;axios.mergeConfig=mergeConfig;axios.AxiosHeaders=AxiosHeaders$1;axios.formToJSON=t=>formDataToJSON(utils$1.isHTMLForm(t)?new FormData(t):t);axios.getAdapter=adapters.getAdapter;axios.HttpStatusCode=HttpStatusCode$1;axios.default=axios;var mock={exports:{}};(function(module,exports){(function(r,e){module.exports=e()})(commonjsGlobal$1,function(){return function(t){var r={};function e(n){if(r[n])return r[n].exports;var a=r[n]={exports:{},id:n,loaded:!1};return t[n].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}return e.m=t,e.c=r,e.p="",e(0)}([function(t,r,e){var n=e(1),a=e(3),o=e(5),s=e(20),l=e(23),u=e(25),c;typeof window<"u"&&(c=e(27));/*!
    Mock - 模拟请求 & 模拟数据
    https://github.com/nuysoft/Mock
    墨智 mozhi.gyy@taobao.com nuysoft@gmail.com
*/var d={Handler:n,Random:o,Util:a,XHR:c,RE:s,toJSONSchema:l,valid:u,heredoc:a.heredoc,setup:function(f){return c.setup(f)},_mocked:{}};d.version="1.0.1-beta3",c&&(c.Mock=d),d.mock=function(f,h,p){return arguments.length===1?n.gen(f):(arguments.length===2&&(p=h,h=void 0),c&&(window.XMLHttpRequest=c),d._mocked[f+(h||"")]={rurl:f,rtype:h,template:p},d)},t.exports=d},function(module,exports,__webpack_require__){var Constant=__webpack_require__(2),Util=__webpack_require__(3),Parser=__webpack_require__(4),Random=__webpack_require__(5),RE=__webpack_require__(20),Handler={extend:Util.extend};Handler.gen=function(t,r,e){r=r==null?"":r+"",e=e||{},e={path:e.path||[Constant.GUID],templatePath:e.templatePath||[Constant.GUID++],currentContext:e.currentContext,templateCurrentContext:e.templateCurrentContext||t,root:e.root||e.currentContext,templateRoot:e.templateRoot||e.templateCurrentContext||t};var n=Parser.parse(r),a=Util.type(t),o;return Handler[a]?(o=Handler[a]({type:a,template:t,name:r,parsedName:r&&r.replace(Constant.RE_KEY,"$1"),rule:n,context:e}),e.root||(e.root=o),o):t},Handler.extend({array:function(t){var r=[],e,n;if(t.template.length===0)return r;if(t.rule.parameters)if(t.rule.min===1&&t.rule.max===void 0)t.context.path.push(t.name),t.context.templatePath.push(t.name),r=Random.pick(Handler.gen(t.template,void 0,{path:t.context.path,templatePath:t.context.templatePath,currentContext:r,templateCurrentContext:t.template,root:t.context.root||r,templateRoot:t.context.templateRoot||t.template})),t.context.path.pop(),t.context.templatePath.pop();else if(t.rule.parameters[2])t.template.__order_index=t.template.__order_index||0,t.context.path.push(t.name),t.context.templatePath.push(t.name),r=Handler.gen(t.template,void 0,{path:t.context.path,templatePath:t.context.templatePath,currentContext:r,templateCurrentContext:t.template,root:t.context.root||r,templateRoot:t.context.templateRoot||t.template})[t.template.__order_index%t.template.length],t.template.__order_index+=+t.rule.parameters[2],t.context.path.pop(),t.context.templatePath.pop();else for(e=0;e<t.rule.count;e++)for(n=0;n<t.template.length;n++)t.context.path.push(r.length),t.context.templatePath.push(n),r.push(Handler.gen(t.template[n],r.length,{path:t.context.path,templatePath:t.context.templatePath,currentContext:r,templateCurrentContext:t.template,root:t.context.root||r,templateRoot:t.context.templateRoot||t.template})),t.context.path.pop(),t.context.templatePath.pop();else for(e=0;e<t.template.length;e++)t.context.path.push(e),t.context.templatePath.push(e),r.push(Handler.gen(t.template[e],e,{path:t.context.path,templatePath:t.context.templatePath,currentContext:r,templateCurrentContext:t.template,root:t.context.root||r,templateRoot:t.context.templateRoot||t.template})),t.context.path.pop(),t.context.templatePath.pop();return r},object:function(t){var r={},e,n,a,o,s,l;if(t.rule.min!=null)for(e=Util.keys(t.template),e=Random.shuffle(e),e=e.slice(0,t.rule.count),l=0;l<e.length;l++)a=e[l],o=a.replace(Constant.RE_KEY,"$1"),t.context.path.push(o),t.context.templatePath.push(a),r[o]=Handler.gen(t.template[a],a,{path:t.context.path,templatePath:t.context.templatePath,currentContext:r,templateCurrentContext:t.template,root:t.context.root||r,templateRoot:t.context.templateRoot||t.template}),t.context.path.pop(),t.context.templatePath.pop();else{e=[],n=[];for(a in t.template)(typeof t.template[a]=="function"?n:e).push(a);for(e=e.concat(n),l=0;l<e.length;l++)a=e[l],o=a.replace(Constant.RE_KEY,"$1"),t.context.path.push(o),t.context.templatePath.push(a),r[o]=Handler.gen(t.template[a],a,{path:t.context.path,templatePath:t.context.templatePath,currentContext:r,templateCurrentContext:t.template,root:t.context.root||r,templateRoot:t.context.templateRoot||t.template}),t.context.path.pop(),t.context.templatePath.pop(),s=a.match(Constant.RE_KEY),s&&s[2]&&Util.type(t.template[a])==="number"&&(t.template[a]+=parseInt(s[2],10))}return r},number:function(t){var r,e;if(t.rule.decimal){for(t.template+="",e=t.template.split("."),e[0]=t.rule.range?t.rule.count:e[0],e[1]=(e[1]||"").slice(0,t.rule.dcount);e[1].length<t.rule.dcount;)e[1]+=e[1].length<t.rule.dcount-1?Random.character("number"):Random.character("123456789");r=parseFloat(e.join("."),10)}else r=t.rule.range&&!t.rule.parameters[2]?t.rule.count:t.template;return r},boolean:function(t){var r;return r=t.rule.parameters?Random.bool(t.rule.min,t.rule.max,t.template):t.template,r},string:function(t){var r="",e,n,a,o;if(t.template.length){for(t.rule.count==null&&(r+=t.template),e=0;e<t.rule.count;e++)r+=t.template;for(n=r.match(Constant.RE_PLACEHOLDER)||[],e=0;e<n.length;e++){if(a=n[e],/^\\/.test(a)){n.splice(e--,1);continue}if(o=Handler.placeholder(a,t.context.currentContext,t.context.templateCurrentContext,t),n.length===1&&a===r&&typeof o!=typeof r){r=o;break}r=r.replace(a,o)}}else r=t.rule.range?Random.string(t.rule.count):t.template;return r},function:function(t){return t.template.call(t.context.currentContext,t)},regexp:function(t){var r="";t.rule.count==null&&(r+=t.template.source);for(var e=0;e<t.rule.count;e++)r+=t.template.source;return RE.Handler.gen(RE.Parser.parse(r))}}),Handler.extend({_all:function(){var t={};for(var r in Random)t[r.toLowerCase()]=r;return t},placeholder:function(placeholder,obj,templateContext,options){Constant.RE_PLACEHOLDER.exec("");var parts=Constant.RE_PLACEHOLDER.exec(placeholder),key=parts&&parts[1],lkey=key&&key.toLowerCase(),okey=this._all()[lkey],params=parts&&parts[2]||"",pathParts=this.splitPathToArray(key);try{params=eval("(function(){ return [].splice.call(arguments, 0 ) })("+params+")")}catch(t){params=parts[2].split(/,\s*/)}if(obj&&key in obj)return obj[key];if(key.charAt(0)==="/"||pathParts.length>1)return this.getValueByKeyPath(key,options);if(templateContext&&typeof templateContext=="object"&&key in templateContext&&placeholder!==templateContext[key])return templateContext[key]=Handler.gen(templateContext[key],key,{currentContext:obj,templateCurrentContext:templateContext}),templateContext[key];if(!(key in Random)&&!(lkey in Random)&&!(okey in Random))return placeholder;for(var i=0;i<params.length;i++)Constant.RE_PLACEHOLDER.exec(""),Constant.RE_PLACEHOLDER.test(params[i])&&(params[i]=Handler.placeholder(params[i],obj,templateContext,options));var handle=Random[key]||Random[lkey]||Random[okey];switch(Util.type(handle)){case"array":return Random.pick(handle);case"function":handle.options=options;var re=handle.apply(Random,params);return re===void 0&&(re=""),delete handle.options,re}},getValueByKeyPath:function(t,r){var e=t,n=this.splitPathToArray(t),a=[];t.charAt(0)==="/"?a=[r.context.path[0]].concat(this.normalizePath(n)):n.length>1&&(a=r.context.path.slice(0),a.pop(),a=this.normalizePath(a.concat(n)));try{t=n[n.length-1];for(var o=r.context.root,s=r.context.templateRoot,l=1;l<a.length-1;l++)o=o[a[l]],s=s[a[l]];if(o&&t in o)return o[t];if(s&&typeof s=="object"&&t in s&&e!==s[t])return s[t]=Handler.gen(s[t],t,{currentContext:o,templateCurrentContext:s}),s[t]}catch{}return"@"+n.join("/")},normalizePath:function(t){for(var r=[],e=0;e<t.length;e++)switch(t[e]){case"..":r.pop();break;case".":break;default:r.push(t[e])}return r},splitPathToArray:function(t){var r=t.split(/\/+/);return r[r.length-1]||(r=r.slice(0,-1)),r[0]||(r=r.slice(1)),r}}),module.exports=Handler},function(t,r){t.exports={GUID:1,RE_KEY:/(.+)\|(?:\+(\d+)|([\+\-]?\d+-?[\+\-]?\d*)?(?:\.(\d+-?\d*))?)/,RE_RANGE:/([\+\-]?\d+)-?([\+\-]?\d+)?/,RE_PLACEHOLDER:/\\*@([^@#%&()\?\s]+)(?:\((.*?)\))?/g}},function(t,r){var e={};e.extend=function(){var a=arguments[0]||{},o=1,s=arguments.length,l,u,c,d,f;for(s===1&&(a=this,o=0);o<s;o++)if(l=arguments[o],!!l)for(u in l)c=a[u],d=l[u],a!==d&&d!==void 0&&(e.isArray(d)||e.isObject(d)?(e.isArray(d)&&(f=c&&e.isArray(c)?c:[]),e.isObject(d)&&(f=c&&e.isObject(c)?c:{}),a[u]=e.extend(f,d)):a[u]=d);return a},e.each=function(a,o,s){var l,u;if(this.type(a)==="number")for(l=0;l<a;l++)o(l,l);else if(a.length===+a.length)for(l=0;l<a.length&&o.call(s,a[l],l,a)!==!1;l++);else for(u in a)if(o.call(s,a[u],u,a)===!1)break},e.type=function(a){return a==null?String(a):Object.prototype.toString.call(a).match(/\[object (\w+)\]/)[1].toLowerCase()},e.each("String Object Array RegExp Function".split(" "),function(n){e["is"+n]=function(a){return e.type(a)===n.toLowerCase()}}),e.isObjectOrArray=function(n){return e.isObject(n)||e.isArray(n)},e.isNumeric=function(n){return!isNaN(parseFloat(n))&&isFinite(n)},e.keys=function(n){var a=[];for(var o in n)n.hasOwnProperty(o)&&a.push(o);return a},e.values=function(n){var a=[];for(var o in n)n.hasOwnProperty(o)&&a.push(n[o]);return a},e.heredoc=function(a){return a.toString().replace(/^[^\/]+\/\*!?/,"").replace(/\*\/[^\/]+$/,"").replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,"")},e.noop=function(){},t.exports=e},function(t,r,e){var n=e(2),a=e(5);t.exports={parse:function(o){o=o==null?"":o+"";var s=(o||"").match(n.RE_KEY),l=s&&s[3]&&s[3].match(n.RE_RANGE),u=l&&l[1]&&parseInt(l[1],10),c=l&&l[2]&&parseInt(l[2],10),d=l?l[2]?a.integer(u,c):parseInt(l[1],10):void 0,f=s&&s[4]&&s[4].match(n.RE_RANGE),h=f&&f[1]&&parseInt(f[1],10),p=f&&f[2]&&parseInt(f[2],10),v=f?!f[2]&&parseInt(f[1],10)||a.integer(h,p):void 0,g={parameters:s,range:l,min:u,max:c,count:d,decimal:f,dmin:h,dmax:p,dcount:v};for(var y in g)if(g[y]!=null)return g;return{}}}},function(t,r,e){var n=e(3),a={extend:n.extend};a.extend(e(6)),a.extend(e(7)),a.extend(e(8)),a.extend(e(10)),a.extend(e(13)),a.extend(e(15)),a.extend(e(16)),a.extend(e(17)),a.extend(e(14)),a.extend(e(19)),t.exports=a},function(t,r){t.exports={boolean:function(e,n,a){return a!==void 0?(e=typeof e<"u"&&!isNaN(e)?parseInt(e,10):1,n=typeof n<"u"&&!isNaN(n)?parseInt(n,10):1,Math.random()>1/(e+n)*e?!a:a):Math.random()>=.5},bool:function(e,n,a){return this.boolean(e,n,a)},natural:function(e,n){return e=typeof e<"u"?parseInt(e,10):0,n=typeof n<"u"?parseInt(n,10):9007199254740992,Math.round(Math.random()*(n-e))+e},integer:function(e,n){return e=typeof e<"u"?parseInt(e,10):-9007199254740992,n=typeof n<"u"?parseInt(n,10):9007199254740992,Math.round(Math.random()*(n-e))+e},int:function(e,n){return this.integer(e,n)},float:function(e,n,a,o){a=a===void 0?0:a,a=Math.max(Math.min(a,17),0),o=o===void 0?17:o,o=Math.max(Math.min(o,17),0);for(var s=this.integer(e,n)+".",l=0,u=this.natural(a,o);l<u;l++)s+=l<u-1?this.character("number"):this.character("123456789");return parseFloat(s,10)},character:function(e){var n={lower:"abcdefghijklmnopqrstuvwxyz",upper:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",number:"0123456789",symbol:"!@#$%^&*()[]"};return n.alpha=n.lower+n.upper,n.undefined=n.lower+n.upper+n.number+n.symbol,e=n[(""+e).toLowerCase()]||e,e.charAt(this.natural(0,e.length-1))},char:function(e){return this.character(e)},string:function(e,n,a){var o;switch(arguments.length){case 0:o=this.natural(3,7);break;case 1:o=e,e=void 0;break;case 2:typeof arguments[0]=="string"?o=n:(o=this.natural(e,n),e=void 0);break;case 3:o=this.natural(n,a);break}for(var s="",l=0;l<o;l++)s+=this.character(e);return s},str:function(){return this.string.apply(this,arguments)},range:function(e,n,a){arguments.length<=1&&(n=e||0,e=0),a=arguments[2]||1,e=+e,n=+n,a=+a;for(var o=Math.max(Math.ceil((n-e)/a),0),s=0,l=new Array(o);s<o;)l[s++]=e,e+=a;return l}}},function(t,r){var e={yyyy:"getFullYear",yy:function(n){return(""+n.getFullYear()).slice(2)},y:"yy",MM:function(n){var a=n.getMonth()+1;return a<10?"0"+a:a},M:function(n){return n.getMonth()+1},dd:function(n){var a=n.getDate();return a<10?"0"+a:a},d:"getDate",HH:function(n){var a=n.getHours();return a<10?"0"+a:a},H:"getHours",hh:function(n){var a=n.getHours()%12;return a<10?"0"+a:a},h:function(n){return n.getHours()%12},mm:function(n){var a=n.getMinutes();return a<10?"0"+a:a},m:"getMinutes",ss:function(n){var a=n.getSeconds();return a<10?"0"+a:a},s:"getSeconds",SS:function(n){var a=n.getMilliseconds();return a<10&&"00"+a||a<100&&"0"+a||a},S:"getMilliseconds",A:function(n){return n.getHours()<12?"AM":"PM"},a:function(n){return n.getHours()<12?"am":"pm"},T:"getTime"};t.exports={_patternLetters:e,_rformat:new RegExp(function(){var n=[];for(var a in e)n.push(a);return"("+n.join("|")+")"}(),"g"),_formatDate:function(n,a){return a.replace(this._rformat,function o(s,l){return typeof e[l]=="function"?e[l](n):e[l]in e?o(s,e[l]):n[e[l]]()})},_randomDate:function(n,a){return n=n===void 0?new Date(0):n,a=a===void 0?new Date:a,new Date(Math.random()*(a.getTime()-n.getTime()))},date:function(n){return n=n||"yyyy-MM-dd",this._formatDate(this._randomDate(),n)},time:function(n){return n=n||"HH:mm:ss",this._formatDate(this._randomDate(),n)},datetime:function(n){return n=n||"yyyy-MM-dd HH:mm:ss",this._formatDate(this._randomDate(),n)},now:function(n,a){arguments.length===1&&(/year|month|day|hour|minute|second|week/.test(n)||(a=n,n="")),n=(n||"").toLowerCase(),a=a||"yyyy-MM-dd HH:mm:ss";var o=new Date;switch(n){case"year":o.setMonth(0);case"month":o.setDate(1);case"week":case"day":o.setHours(0);case"hour":o.setMinutes(0);case"minute":o.setSeconds(0);case"second":o.setMilliseconds(0)}switch(n){case"week":o.setDate(o.getDate()-o.getDay())}return this._formatDate(o,a)}}},function(t,r,e){(function(n){n.exports={_adSize:["300x250","250x250","240x400","336x280","180x150","720x300","468x60","234x60","88x31","120x90","120x60","120x240","125x125","728x90","160x600","120x600","300x600"],_screenSize:["320x200","320x240","640x480","800x480","800x480","1024x600","1024x768","1280x800","1440x900","1920x1200","2560x1600"],_videoSize:["720x480","768x576","1280x720","1920x1080"],image:function(a,o,s,l,u){return arguments.length===4&&(u=l,l=void 0),arguments.length===3&&(u=s,s=void 0),a||(a=this.pick(this._adSize)),o&&~o.indexOf("#")&&(o=o.slice(1)),s&&~s.indexOf("#")&&(s=s.slice(1)),"http://dummyimage.com/"+a+(o?"/"+o:"")+(s?"/"+s:"")+(l?"."+l:"")+(u?"&text="+u:"")},img:function(){return this.image.apply(this,arguments)},_brandColors:{"4ormat":"#fb0a2a","500px":"#02adea","About.me (blue)":"#00405d","About.me (yellow)":"#ffcc33",Addvocate:"#ff6138",Adobe:"#ff0000",Aim:"#fcd20b",Amazon:"#e47911",Android:"#a4c639","Angie's List":"#7fbb00",AOL:"#0060a3",Atlassian:"#003366",Behance:"#053eff","Big Cartel":"#97b538",bitly:"#ee6123",Blogger:"#fc4f08",Boeing:"#0039a6","Booking.com":"#003580",Carbonmade:"#613854",Cheddar:"#ff7243","Code School":"#3d4944",Delicious:"#205cc0",Dell:"#3287c1",Designmoo:"#e54a4f",Deviantart:"#4e6252","Designer News":"#2d72da",Devour:"#fd0001",DEWALT:"#febd17","Disqus (blue)":"#59a3fc","Disqus (orange)":"#db7132",Dribbble:"#ea4c89",Dropbox:"#3d9ae8",Drupal:"#0c76ab",Dunked:"#2a323a",eBay:"#89c507",Ember:"#f05e1b",Engadget:"#00bdf6",Envato:"#528036",Etsy:"#eb6d20",Evernote:"#5ba525","Fab.com":"#dd0017",Facebook:"#3b5998",Firefox:"#e66000","Flickr (blue)":"#0063dc","Flickr (pink)":"#ff0084",Forrst:"#5b9a68",Foursquare:"#25a0ca",Garmin:"#007cc3",GetGlue:"#2d75a2",Gimmebar:"#f70078",GitHub:"#171515","Google Blue":"#0140ca","Google Green":"#16a61e","Google Red":"#dd1812","Google Yellow":"#fcca03","Google+":"#dd4b39",Grooveshark:"#f77f00",Groupon:"#82b548","Hacker News":"#ff6600",HelloWallet:"#0085ca","Heroku (light)":"#c7c5e6","Heroku (dark)":"#6567a5",HootSuite:"#003366",Houzz:"#73ba37",HTML5:"#ec6231",IKEA:"#ffcc33",IMDb:"#f3ce13",Instagram:"#3f729b",Intel:"#0071c5",Intuit:"#365ebf",Kickstarter:"#76cc1e",kippt:"#e03500",Kodery:"#00af81",LastFM:"#c3000d",LinkedIn:"#0e76a8",Livestream:"#cf0005",Lumo:"#576396",Mixpanel:"#a086d3",Meetup:"#e51937",Nokia:"#183693",NVIDIA:"#76b900",Opera:"#cc0f16",Path:"#e41f11","PayPal (dark)":"#1e477a","PayPal (light)":"#3b7bbf",Pinboard:"#0000e6",Pinterest:"#c8232c",PlayStation:"#665cbe",Pocket:"#ee4056",Prezi:"#318bff",Pusha:"#0f71b4",Quora:"#a82400","QUOTE.fm":"#66ceff",Rdio:"#008fd5",Readability:"#9c0000","Red Hat":"#cc0000",Resource:"#7eb400",Rockpack:"#0ba6ab",Roon:"#62b0d9",RSS:"#ee802f",Salesforce:"#1798c1",Samsung:"#0c4da2",Shopify:"#96bf48",Skype:"#00aff0",Snagajob:"#f47a20",Softonic:"#008ace",SoundCloud:"#ff7700","Space Box":"#f86960",Spotify:"#81b71a",Sprint:"#fee100",Squarespace:"#121212",StackOverflow:"#ef8236",Staples:"#cc0000","Status Chart":"#d7584f",Stripe:"#008cdd",StudyBlue:"#00afe1",StumbleUpon:"#f74425","T-Mobile":"#ea0a8e",Technorati:"#40a800","The Next Web":"#ef4423",Treehouse:"#5cb868",Trulia:"#5eab1f",Tumblr:"#34526f","Twitch.tv":"#6441a5",Twitter:"#00acee",TYPO3:"#ff8700",Ubuntu:"#dd4814",Ustream:"#3388ff",Verizon:"#ef1d1d",Vimeo:"#86c9ef",Vine:"#00a478",Virb:"#06afd8","Virgin Media":"#cc0000",Wooga:"#5b009c","WordPress (blue)":"#21759b","WordPress (orange)":"#d54e21","WordPress (grey)":"#464646",Wunderlist:"#2b88d9",XBOX:"#9bc848",XING:"#126567","Yahoo!":"#720e9e",Yandex:"#ffcc00",Yelp:"#c41200",YouTube:"#c4302b",Zalongo:"#5498dc",Zendesk:"#78a300",Zerply:"#9dcc7a",Zootool:"#5e8b1d"},_brandNames:function(){var a=[];for(var o in this._brandColors)a.push(o);return a},dataImage:function(a,o){var s;if(typeof document<"u")s=document.createElement("canvas");else{var l=n.require("canvas");s=new l}var u=s&&s.getContext&&s.getContext("2d");if(!s||!u)return"";a||(a=this.pick(this._adSize)),o=o!==void 0?o:a,a=a.split("x");var c=parseInt(a[0],10),d=parseInt(a[1],10),f=this._brandColors[this.pick(this._brandNames())],h="#FFF",p=14,v="sans-serif";return s.width=c,s.height=d,u.textAlign="center",u.textBaseline="middle",u.fillStyle=f,u.fillRect(0,0,c,d),u.fillStyle=h,u.font="bold "+p+"px "+v,u.fillText(o,c/2,d/2,c),s.toDataURL("image/png")}}}).call(r,e(9)(t))},function(t,r){t.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(t,r,e){var n=e(11),a=e(12);t.exports={color:function(o){return o||a[o]?a[o].nicer:this.hex()},hex:function(){var o=this._goldenRatioColor(),s=n.hsv2rgb(o),l=n.rgb2hex(s[0],s[1],s[2]);return l},rgb:function(){var o=this._goldenRatioColor(),s=n.hsv2rgb(o);return"rgb("+parseInt(s[0],10)+", "+parseInt(s[1],10)+", "+parseInt(s[2],10)+")"},rgba:function(){var o=this._goldenRatioColor(),s=n.hsv2rgb(o);return"rgba("+parseInt(s[0],10)+", "+parseInt(s[1],10)+", "+parseInt(s[2],10)+", "+Math.random().toFixed(2)+")"},hsl:function(){var o=this._goldenRatioColor(),s=n.hsv2hsl(o);return"hsl("+parseInt(s[0],10)+", "+parseInt(s[1],10)+", "+parseInt(s[2],10)+")"},_goldenRatioColor:function(o,s){return this._goldenRatio=.618033988749895,this._hue=this._hue||Math.random(),this._hue+=this._goldenRatio,this._hue%=1,typeof o!="number"&&(o=.5),typeof s!="number"&&(s=.95),[this._hue*360,o*100,s*100]}}},function(t,r){t.exports={rgb2hsl:function(n){var a=n[0]/255,o=n[1]/255,s=n[2]/255,l=Math.min(a,o,s),u=Math.max(a,o,s),c=u-l,d,f,h;return u==l?d=0:a==u?d=(o-s)/c:o==u?d=2+(s-a)/c:s==u&&(d=4+(a-o)/c),d=Math.min(d*60,360),d<0&&(d+=360),h=(l+u)/2,u==l?f=0:h<=.5?f=c/(u+l):f=c/(2-u-l),[d,f*100,h*100]},rgb2hsv:function(n){var a=n[0],o=n[1],s=n[2],l=Math.min(a,o,s),u=Math.max(a,o,s),c=u-l,d,f,h;return u===0?f=0:f=c/u*1e3/10,u==l?d=0:a==u?d=(o-s)/c:o==u?d=2+(s-a)/c:s==u&&(d=4+(a-o)/c),d=Math.min(d*60,360),d<0&&(d+=360),h=u/255*1e3/10,[d,f,h]},hsl2rgb:function(n){var a=n[0]/360,o=n[1]/100,s=n[2]/100,l,u,c,d,f;if(o===0)return f=s*255,[f,f,f];s<.5?u=s*(1+o):u=s+o-s*o,l=2*s-u,d=[0,0,0];for(var h=0;h<3;h++)c=a+1/3*-(h-1),c<0&&c++,c>1&&c--,6*c<1?f=l+(u-l)*6*c:2*c<1?f=u:3*c<2?f=l+(u-l)*(2/3-c)*6:f=l,d[h]=f*255;return d},hsl2hsv:function(n){var a=n[0],o=n[1]/100,s=n[2]/100,l,u;return s*=2,o*=s<=1?s:2-s,u=(s+o)/2,l=2*o/(s+o),[a,l*100,u*100]},hsv2rgb:function(n){var a=n[0]/60,o=n[1]/100,s=n[2]/100,l=Math.floor(a)%6,u=a-Math.floor(a),c=255*s*(1-o),d=255*s*(1-o*u),f=255*s*(1-o*(1-u));switch(s=255*s,l){case 0:return[s,f,c];case 1:return[d,s,c];case 2:return[c,s,f];case 3:return[c,d,s];case 4:return[f,c,s];case 5:return[s,c,d]}},hsv2hsl:function(n){var a=n[0],o=n[1]/100,s=n[2]/100,l,u;return u=(2-o)*s,l=o*s,l/=u<=1?u:2-u,u/=2,[a,l*100,u*100]},rgb2hex:function(e,n,a){return"#"+((256+e<<8|n)<<8|a).toString(16).slice(1)},hex2rgb:function(e){return e="0x"+e.slice(1).replace(e.length>4?e:/./g,"$&$&")|0,[e>>16,e>>8&255,e&255]}}},function(t,r){t.exports={navy:{value:"#000080",nicer:"#001F3F"},blue:{value:"#0000ff",nicer:"#0074D9"},aqua:{value:"#00ffff",nicer:"#7FDBFF"},teal:{value:"#008080",nicer:"#39CCCC"},olive:{value:"#008000",nicer:"#3D9970"},green:{value:"#008000",nicer:"#2ECC40"},lime:{value:"#00ff00",nicer:"#01FF70"},yellow:{value:"#ffff00",nicer:"#FFDC00"},orange:{value:"#ffa500",nicer:"#FF851B"},red:{value:"#ff0000",nicer:"#FF4136"},maroon:{value:"#800000",nicer:"#85144B"},fuchsia:{value:"#ff00ff",nicer:"#F012BE"},purple:{value:"#800080",nicer:"#B10DC9"},silver:{value:"#c0c0c0",nicer:"#DDDDDD"},gray:{value:"#808080",nicer:"#AAAAAA"},black:{value:"#000000",nicer:"#111111"},white:{value:"#FFFFFF",nicer:"#FFFFFF"}}},function(t,r,e){var n=e(6),a=e(14);function o(s,l,u,c){return u===void 0?n.natural(s,l):c===void 0?u:n.natural(parseInt(u,10),parseInt(c,10))}t.exports={paragraph:function(s,l){for(var u=o(3,7,s,l),c=[],d=0;d<u;d++)c.push(this.sentence());return c.join(" ")},cparagraph:function(s,l){for(var u=o(3,7,s,l),c=[],d=0;d<u;d++)c.push(this.csentence());return c.join("")},sentence:function(s,l){for(var u=o(12,18,s,l),c=[],d=0;d<u;d++)c.push(this.word());return a.capitalize(c.join(" "))+"."},csentence:function(s,l){for(var u=o(12,18,s,l),c=[],d=0;d<u;d++)c.push(this.cword());return c.join("")+"。"},word:function(s,l){for(var u=o(3,10,s,l),c="",d=0;d<u;d++)c+=n.character("lower");return c},cword:function(s,l,u){var c="的一是在不了有和人这中大为上个国我以要他时来用们生到作地于出就分对成会可主发年动同工也能下过子说产种面而方后多定行学法所民得经十三之进着等部度家电力里如水化高自二理起小物现实加量都两体制机当使点从业本去把性好应开它合还因由其些然前外天政四日那社义事平形相全表间样与关各重新线内数正心反你明看原又么利比或但质气第向道命此变条只没结解问意建月公无系军很情者最立代想已通并提直题党程展五果料象员革位入常文总次品式活设及管特件长求老头基资边流路级少图山统接知较将组见计别她手角期根论运农指几九区强放决西被干做必战先回则任取据处队南给色光门即保治北造百规热领七海口东导器压志世金增争济阶油思术极交受联什认六共权收证改清己美再采转更单风切打白教速花带安场身车例真务具万每目至达走积示议声报斗完类八离华名确才科张信马节话米整空元况今集温传土许步群广石记需段研界拉林律叫且究观越织装影算低持音众书布复容儿须际商非验连断深难近矿千周委素技备半办青省列习响约支般史感劳便团往酸历市克何除消构府称太准精值号率族维划选标写存候毛亲快效斯院查江型眼王按格养易置派层片始却专状育厂京识适属圆包火住调满县局照参红细引听该铁价严龙飞",d;switch(arguments.length){case 0:s=c,d=1;break;case 1:typeof arguments[0]=="string"?d=1:(d=s,s=c);break;case 2:typeof arguments[0]=="string"?d=l:(d=this.natural(s,l),s=c);break;case 3:d=this.natural(l,u);break}for(var f="",h=0;h<d;h++)f+=s.charAt(this.natural(0,s.length-1));return f},title:function(s,l){for(var u=o(3,7,s,l),c=[],d=0;d<u;d++)c.push(this.capitalize(this.word()));return c.join(" ")},ctitle:function(s,l){for(var u=o(3,7,s,l),c=[],d=0;d<u;d++)c.push(this.cword());return c.join("")}}},function(t,r,e){var n=e(3);t.exports={capitalize:function(a){return(a+"").charAt(0).toUpperCase()+(a+"").substr(1)},upper:function(a){return(a+"").toUpperCase()},lower:function(a){return(a+"").toLowerCase()},pick:function(o,s,l){return n.isArray(o)?(s===void 0&&(s=1),l===void 0&&(l=s)):(o=[].slice.call(arguments),s=1,l=1),s===1&&l===1?o[this.natural(0,o.length-1)]:this.shuffle(o,s,l)},shuffle:function(o,s,l){o=o||[];for(var u=o.slice(0),c=[],d=0,f=u.length,h=0;h<f;h++)d=this.natural(0,u.length-1),c.push(u[d]),u.splice(d,1);switch(arguments.length){case 0:case 1:return c;case 2:l=s;case 3:return s=parseInt(s,10),l=parseInt(l,10),c.slice(0,this.natural(s,l))}},order:function a(o){a.cache=a.cache||{},arguments.length>1&&(o=[].slice.call(arguments,0));var s=a.options,l=s.context.templatePath.join("."),u=a.cache[l]=a.cache[l]||{index:0,array:o};return u.array[u.index++%u.array.length]}}},function(t,r){t.exports={first:function(){var e=["James","John","Robert","Michael","William","David","Richard","Charles","Joseph","Thomas","Christopher","Daniel","Paul","Mark","Donald","George","Kenneth","Steven","Edward","Brian","Ronald","Anthony","Kevin","Jason","Matthew","Gary","Timothy","Jose","Larry","Jeffrey","Frank","Scott","Eric"].concat(["Mary","Patricia","Linda","Barbara","Elizabeth","Jennifer","Maria","Susan","Margaret","Dorothy","Lisa","Nancy","Karen","Betty","Helen","Sandra","Donna","Carol","Ruth","Sharon","Michelle","Laura","Sarah","Kimberly","Deborah","Jessica","Shirley","Cynthia","Angela","Melissa","Brenda","Amy","Anna"]);return this.pick(e)},last:function(){var e=["Smith","Johnson","Williams","Brown","Jones","Miller","Davis","Garcia","Rodriguez","Wilson","Martinez","Anderson","Taylor","Thomas","Hernandez","Moore","Martin","Jackson","Thompson","White","Lopez","Lee","Gonzalez","Harris","Clark","Lewis","Robinson","Walker","Perez","Hall","Young","Allen"];return this.pick(e)},name:function(e){return this.first()+" "+(e?this.first()+" ":"")+this.last()},cfirst:function(){var e="王 李 张 刘 陈 杨 赵 黄 周 吴 徐 孙 胡 朱 高 林 何 郭 马 罗 梁 宋 郑 谢 韩 唐 冯 于 董 萧 程 曹 袁 邓 许 傅 沈 曾 彭 吕 苏 卢 蒋 蔡 贾 丁 魏 薛 叶 阎 余 潘 杜 戴 夏 锺 汪 田 任 姜 范 方 石 姚 谭 廖 邹 熊 金 陆 郝 孔 白 崔 康 毛 邱 秦 江 史 顾 侯 邵 孟 龙 万 段 雷 钱 汤 尹 黎 易 常 武 乔 贺 赖 龚 文".split(" ");return this.pick(e)},clast:function(){var e="伟 芳 娜 秀英 敏 静 丽 强 磊 军 洋 勇 艳 杰 娟 涛 明 超 秀兰 霞 平 刚 桂英".split(" ");return this.pick(e)},cname:function(){return this.cfirst()+this.clast()}}},function(t,r){t.exports={url:function(e,n){return(e||this.protocol())+"://"+(n||this.domain())+"/"+this.word()},protocol:function(){return this.pick("http ftp gopher mailto mid cid news nntp prospero telnet rlogin tn3270 wais".split(" "))},domain:function(e){return this.word()+"."+(e||this.tld())},tld:function(){return this.pick("com net org edu gov int mil cn com.cn net.cn gov.cn org.cn 中国 中国互联.公司 中国互联.网络 tel biz cc tv info name hk mobi asia cd travel pro museum coop aero ad ae af ag ai al am an ao aq ar as at au aw az ba bb bd be bf bg bh bi bj bm bn bo br bs bt bv bw by bz ca cc cf cg ch ci ck cl cm cn co cq cr cu cv cx cy cz de dj dk dm do dz ec ee eg eh es et ev fi fj fk fm fo fr ga gb gd ge gf gh gi gl gm gn gp gr gt gu gw gy hk hm hn hr ht hu id ie il in io iq ir is it jm jo jp ke kg kh ki km kn kp kr kw ky kz la lb lc li lk lr ls lt lu lv ly ma mc md mg mh ml mm mn mo mp mq mr ms mt mv mw mx my mz na nc ne nf ng ni nl no np nr nt nu nz om qa pa pe pf pg ph pk pl pm pn pr pt pw py re ro ru rw sa sb sc sd se sg sh si sj sk sl sm sn so sr st su sy sz tc td tf tg th tj tk tm tn to tp tr tt tv tw tz ua ug uk us uy va vc ve vg vn vu wf ws ye yu za zm zr zw".split(" "))},email:function(e){return this.character("lower")+"."+this.word()+"@"+(e||this.word()+"."+this.tld())},ip:function(){return this.natural(0,255)+"."+this.natural(0,255)+"."+this.natural(0,255)+"."+this.natural(0,255)}}},function(t,r,e){var n=e(18),a=["东北","华北","华东","华中","华南","西南","西北"];t.exports={region:function(){return this.pick(a)},province:function(){return this.pick(n).name},city:function(o){var s=this.pick(n),l=this.pick(s.children);return o?[s.name,l.name].join(" "):l.name},county:function(o){var s=this.pick(n),l=this.pick(s.children),u=this.pick(l.children)||{name:"-"};return o?[s.name,l.name,u.name].join(" "):u.name},zip:function(o){for(var s="",l=0;l<(o||6);l++)s+=this.natural(0,9);return s}}},function(t,r){var e={11e4:"北京",110100:"北京市",110101:"东城区",110102:"西城区",110105:"朝阳区",110106:"丰台区",110107:"石景山区",110108:"海淀区",110109:"门头沟区",110111:"房山区",110112:"通州区",110113:"顺义区",110114:"昌平区",110115:"大兴区",110116:"怀柔区",110117:"平谷区",110228:"密云县",110229:"延庆县",110230:"其它区",12e4:"天津",120100:"天津市",120101:"和平区",120102:"河东区",120103:"河西区",120104:"南开区",120105:"河北区",120106:"红桥区",120110:"东丽区",120111:"西青区",120112:"津南区",120113:"北辰区",120114:"武清区",120115:"宝坻区",120116:"滨海新区",120221:"宁河县",120223:"静海县",120225:"蓟县",120226:"其它区",13e4:"河北省",130100:"石家庄市",130102:"长安区",130103:"桥东区",130104:"桥西区",130105:"新华区",130107:"井陉矿区",130108:"裕华区",130121:"井陉县",130123:"正定县",130124:"栾城县",130125:"行唐县",130126:"灵寿县",130127:"高邑县",130128:"深泽县",130129:"赞皇县",130130:"无极县",130131:"平山县",130132:"元氏县",130133:"赵县",130181:"辛集市",130182:"藁城市",130183:"晋州市",130184:"新乐市",130185:"鹿泉市",130186:"其它区",130200:"唐山市",130202:"路南区",130203:"路北区",130204:"古冶区",130205:"开平区",130207:"丰南区",130208:"丰润区",130223:"滦县",130224:"滦南县",130225:"乐亭县",130227:"迁西县",130229:"玉田县",130230:"曹妃甸区",130281:"遵化市",130283:"迁安市",130284:"其它区",130300:"秦皇岛市",130302:"海港区",130303:"山海关区",130304:"北戴河区",130321:"青龙满族自治县",130322:"昌黎县",130323:"抚宁县",130324:"卢龙县",130398:"其它区",130400:"邯郸市",130402:"邯山区",130403:"丛台区",130404:"复兴区",130406:"峰峰矿区",130421:"邯郸县",130423:"临漳县",130424:"成安县",130425:"大名县",130426:"涉县",130427:"磁县",130428:"肥乡县",130429:"永年县",130430:"邱县",130431:"鸡泽县",130432:"广平县",130433:"馆陶县",130434:"魏县",130435:"曲周县",130481:"武安市",130482:"其它区",130500:"邢台市",130502:"桥东区",130503:"桥西区",130521:"邢台县",130522:"临城县",130523:"内丘县",130524:"柏乡县",130525:"隆尧县",130526:"任县",130527:"南和县",130528:"宁晋县",130529:"巨鹿县",130530:"新河县",130531:"广宗县",130532:"平乡县",130533:"威县",130534:"清河县",130535:"临西县",130581:"南宫市",130582:"沙河市",130583:"其它区",130600:"保定市",130602:"新市区",130603:"北市区",130604:"南市区",130621:"满城县",130622:"清苑县",130623:"涞水县",130624:"阜平县",130625:"徐水县",130626:"定兴县",130627:"唐县",130628:"高阳县",130629:"容城县",130630:"涞源县",130631:"望都县",130632:"安新县",130633:"易县",130634:"曲阳县",130635:"蠡县",130636:"顺平县",130637:"博野县",130638:"雄县",130681:"涿州市",130682:"定州市",130683:"安国市",130684:"高碑店市",130699:"其它区",130700:"张家口市",130702:"桥东区",130703:"桥西区",130705:"宣化区",130706:"下花园区",130721:"宣化县",130722:"张北县",130723:"康保县",130724:"沽源县",130725:"尚义县",130726:"蔚县",130727:"阳原县",130728:"怀安县",130729:"万全县",130730:"怀来县",130731:"涿鹿县",130732:"赤城县",130733:"崇礼县",130734:"其它区",130800:"承德市",130802:"双桥区",130803:"双滦区",130804:"鹰手营子矿区",130821:"承德县",130822:"兴隆县",130823:"平泉县",130824:"滦平县",130825:"隆化县",130826:"丰宁满族自治县",130827:"宽城满族自治县",130828:"围场满族蒙古族自治县",130829:"其它区",130900:"沧州市",130902:"新华区",130903:"运河区",130921:"沧县",130922:"青县",130923:"东光县",130924:"海兴县",130925:"盐山县",130926:"肃宁县",130927:"南皮县",130928:"吴桥县",130929:"献县",130930:"孟村回族自治县",130981:"泊头市",130982:"任丘市",130983:"黄骅市",130984:"河间市",130985:"其它区",131e3:"廊坊市",131002:"安次区",131003:"广阳区",131022:"固安县",131023:"永清县",131024:"香河县",131025:"大城县",131026:"文安县",131028:"大厂回族自治县",131081:"霸州市",131082:"三河市",131083:"其它区",131100:"衡水市",131102:"桃城区",131121:"枣强县",131122:"武邑县",131123:"武强县",131124:"饶阳县",131125:"安平县",131126:"故城县",131127:"景县",131128:"阜城县",131181:"冀州市",131182:"深州市",131183:"其它区",14e4:"山西省",140100:"太原市",140105:"小店区",140106:"迎泽区",140107:"杏花岭区",140108:"尖草坪区",140109:"万柏林区",140110:"晋源区",140121:"清徐县",140122:"阳曲县",140123:"娄烦县",140181:"古交市",140182:"其它区",140200:"大同市",140202:"城区",140203:"矿区",140211:"南郊区",140212:"新荣区",140221:"阳高县",140222:"天镇县",140223:"广灵县",140224:"灵丘县",140225:"浑源县",140226:"左云县",140227:"大同县",140228:"其它区",140300:"阳泉市",140302:"城区",140303:"矿区",140311:"郊区",140321:"平定县",140322:"盂县",140323:"其它区",140400:"长治市",140421:"长治县",140423:"襄垣县",140424:"屯留县",140425:"平顺县",140426:"黎城县",140427:"壶关县",140428:"长子县",140429:"武乡县",140430:"沁县",140431:"沁源县",140481:"潞城市",140482:"城区",140483:"郊区",140485:"其它区",140500:"晋城市",140502:"城区",140521:"沁水县",140522:"阳城县",140524:"陵川县",140525:"泽州县",140581:"高平市",140582:"其它区",140600:"朔州市",140602:"朔城区",140603:"平鲁区",140621:"山阴县",140622:"应县",140623:"右玉县",140624:"怀仁县",140625:"其它区",140700:"晋中市",140702:"榆次区",140721:"榆社县",140722:"左权县",140723:"和顺县",140724:"昔阳县",140725:"寿阳县",140726:"太谷县",140727:"祁县",140728:"平遥县",140729:"灵石县",140781:"介休市",140782:"其它区",140800:"运城市",140802:"盐湖区",140821:"临猗县",140822:"万荣县",140823:"闻喜县",140824:"稷山县",140825:"新绛县",140826:"绛县",140827:"垣曲县",140828:"夏县",140829:"平陆县",140830:"芮城县",140881:"永济市",140882:"河津市",140883:"其它区",140900:"忻州市",140902:"忻府区",140921:"定襄县",140922:"五台县",140923:"代县",140924:"繁峙县",140925:"宁武县",140926:"静乐县",140927:"神池县",140928:"五寨县",140929:"岢岚县",140930:"河曲县",140931:"保德县",140932:"偏关县",140981:"原平市",140982:"其它区",141e3:"临汾市",141002:"尧都区",141021:"曲沃县",141022:"翼城县",141023:"襄汾县",141024:"洪洞县",141025:"古县",141026:"安泽县",141027:"浮山县",141028:"吉县",141029:"乡宁县",141030:"大宁县",141031:"隰县",141032:"永和县",141033:"蒲县",141034:"汾西县",141081:"侯马市",141082:"霍州市",141083:"其它区",141100:"吕梁市",141102:"离石区",141121:"文水县",141122:"交城县",141123:"兴县",141124:"临县",141125:"柳林县",141126:"石楼县",141127:"岚县",141128:"方山县",141129:"中阳县",141130:"交口县",141181:"孝义市",141182:"汾阳市",141183:"其它区",15e4:"内蒙古自治区",150100:"呼和浩特市",150102:"新城区",150103:"回民区",150104:"玉泉区",150105:"赛罕区",150121:"土默特左旗",150122:"托克托县",150123:"和林格尔县",150124:"清水河县",150125:"武川县",150126:"其它区",150200:"包头市",150202:"东河区",150203:"昆都仑区",150204:"青山区",150205:"石拐区",150206:"白云鄂博矿区",150207:"九原区",150221:"土默特右旗",150222:"固阳县",150223:"达尔罕茂明安联合旗",150224:"其它区",150300:"乌海市",150302:"海勃湾区",150303:"海南区",150304:"乌达区",150305:"其它区",150400:"赤峰市",150402:"红山区",150403:"元宝山区",150404:"松山区",150421:"阿鲁科尔沁旗",150422:"巴林左旗",150423:"巴林右旗",150424:"林西县",150425:"克什克腾旗",150426:"翁牛特旗",150428:"喀喇沁旗",150429:"宁城县",150430:"敖汉旗",150431:"其它区",150500:"通辽市",150502:"科尔沁区",150521:"科尔沁左翼中旗",150522:"科尔沁左翼后旗",150523:"开鲁县",150524:"库伦旗",150525:"奈曼旗",150526:"扎鲁特旗",150581:"霍林郭勒市",150582:"其它区",150600:"鄂尔多斯市",150602:"东胜区",150621:"达拉特旗",150622:"准格尔旗",150623:"鄂托克前旗",150624:"鄂托克旗",150625:"杭锦旗",150626:"乌审旗",150627:"伊金霍洛旗",150628:"其它区",150700:"呼伦贝尔市",150702:"海拉尔区",150703:"扎赉诺尔区",150721:"阿荣旗",150722:"莫力达瓦达斡尔族自治旗",150723:"鄂伦春自治旗",150724:"鄂温克族自治旗",150725:"陈巴尔虎旗",150726:"新巴尔虎左旗",150727:"新巴尔虎右旗",150781:"满洲里市",150782:"牙克石市",150783:"扎兰屯市",150784:"额尔古纳市",150785:"根河市",150786:"其它区",150800:"巴彦淖尔市",150802:"临河区",150821:"五原县",150822:"磴口县",150823:"乌拉特前旗",150824:"乌拉特中旗",150825:"乌拉特后旗",150826:"杭锦后旗",150827:"其它区",150900:"乌兰察布市",150902:"集宁区",150921:"卓资县",150922:"化德县",150923:"商都县",150924:"兴和县",150925:"凉城县",150926:"察哈尔右翼前旗",150927:"察哈尔右翼中旗",150928:"察哈尔右翼后旗",150929:"四子王旗",150981:"丰镇市",150982:"其它区",152200:"兴安盟",152201:"乌兰浩特市",152202:"阿尔山市",152221:"科尔沁右翼前旗",152222:"科尔沁右翼中旗",152223:"扎赉特旗",152224:"突泉县",152225:"其它区",152500:"锡林郭勒盟",152501:"二连浩特市",152502:"锡林浩特市",152522:"阿巴嘎旗",152523:"苏尼特左旗",152524:"苏尼特右旗",152525:"东乌珠穆沁旗",152526:"西乌珠穆沁旗",152527:"太仆寺旗",152528:"镶黄旗",152529:"正镶白旗",152530:"正蓝旗",152531:"多伦县",152532:"其它区",152900:"阿拉善盟",152921:"阿拉善左旗",152922:"阿拉善右旗",152923:"额济纳旗",152924:"其它区",21e4:"辽宁省",210100:"沈阳市",210102:"和平区",210103:"沈河区",210104:"大东区",210105:"皇姑区",210106:"铁西区",210111:"苏家屯区",210112:"东陵区",210113:"新城子区",210114:"于洪区",210122:"辽中县",210123:"康平县",210124:"法库县",210181:"新民市",210184:"沈北新区",210185:"其它区",210200:"大连市",210202:"中山区",210203:"西岗区",210204:"沙河口区",210211:"甘井子区",210212:"旅顺口区",210213:"金州区",210224:"长海县",210281:"瓦房店市",210282:"普兰店市",210283:"庄河市",210298:"其它区",210300:"鞍山市",210302:"铁东区",210303:"铁西区",210304:"立山区",210311:"千山区",210321:"台安县",210323:"岫岩满族自治县",210381:"海城市",210382:"其它区",210400:"抚顺市",210402:"新抚区",210403:"东洲区",210404:"望花区",210411:"顺城区",210421:"抚顺县",210422:"新宾满族自治县",210423:"清原满族自治县",210424:"其它区",210500:"本溪市",210502:"平山区",210503:"溪湖区",210504:"明山区",210505:"南芬区",210521:"本溪满族自治县",210522:"桓仁满族自治县",210523:"其它区",210600:"丹东市",210602:"元宝区",210603:"振兴区",210604:"振安区",210624:"宽甸满族自治县",210681:"东港市",210682:"凤城市",210683:"其它区",210700:"锦州市",210702:"古塔区",210703:"凌河区",210711:"太和区",210726:"黑山县",210727:"义县",210781:"凌海市",210782:"北镇市",210783:"其它区",210800:"营口市",210802:"站前区",210803:"西市区",210804:"鲅鱼圈区",210811:"老边区",210881:"盖州市",210882:"大石桥市",210883:"其它区",210900:"阜新市",210902:"海州区",210903:"新邱区",210904:"太平区",210905:"清河门区",210911:"细河区",210921:"阜新蒙古族自治县",210922:"彰武县",210923:"其它区",211e3:"辽阳市",211002:"白塔区",211003:"文圣区",211004:"宏伟区",211005:"弓长岭区",211011:"太子河区",211021:"辽阳县",211081:"灯塔市",211082:"其它区",211100:"盘锦市",211102:"双台子区",211103:"兴隆台区",211121:"大洼县",211122:"盘山县",211123:"其它区",211200:"铁岭市",211202:"银州区",211204:"清河区",211221:"铁岭县",211223:"西丰县",211224:"昌图县",211281:"调兵山市",211282:"开原市",211283:"其它区",211300:"朝阳市",211302:"双塔区",211303:"龙城区",211321:"朝阳县",211322:"建平县",211324:"喀喇沁左翼蒙古族自治县",211381:"北票市",211382:"凌源市",211383:"其它区",211400:"葫芦岛市",211402:"连山区",211403:"龙港区",211404:"南票区",211421:"绥中县",211422:"建昌县",211481:"兴城市",211482:"其它区",22e4:"吉林省",220100:"长春市",220102:"南关区",220103:"宽城区",220104:"朝阳区",220105:"二道区",220106:"绿园区",220112:"双阳区",220122:"农安县",220181:"九台市",220182:"榆树市",220183:"德惠市",220188:"其它区",220200:"吉林市",220202:"昌邑区",220203:"龙潭区",220204:"船营区",220211:"丰满区",220221:"永吉县",220281:"蛟河市",220282:"桦甸市",220283:"舒兰市",220284:"磐石市",220285:"其它区",220300:"四平市",220302:"铁西区",220303:"铁东区",220322:"梨树县",220323:"伊通满族自治县",220381:"公主岭市",220382:"双辽市",220383:"其它区",220400:"辽源市",220402:"龙山区",220403:"西安区",220421:"东丰县",220422:"东辽县",220423:"其它区",220500:"通化市",220502:"东昌区",220503:"二道江区",220521:"通化县",220523:"辉南县",220524:"柳河县",220581:"梅河口市",220582:"集安市",220583:"其它区",220600:"白山市",220602:"浑江区",220621:"抚松县",220622:"靖宇县",220623:"长白朝鲜族自治县",220625:"江源区",220681:"临江市",220682:"其它区",220700:"松原市",220702:"宁江区",220721:"前郭尔罗斯蒙古族自治县",220722:"长岭县",220723:"乾安县",220724:"扶余市",220725:"其它区",220800:"白城市",220802:"洮北区",220821:"镇赉县",220822:"通榆县",220881:"洮南市",220882:"大安市",220883:"其它区",222400:"延边朝鲜族自治州",222401:"延吉市",222402:"图们市",222403:"敦化市",222404:"珲春市",222405:"龙井市",222406:"和龙市",222424:"汪清县",222426:"安图县",222427:"其它区",23e4:"黑龙江省",230100:"哈尔滨市",230102:"道里区",230103:"南岗区",230104:"道外区",230106:"香坊区",230108:"平房区",230109:"松北区",230111:"呼兰区",230123:"依兰县",230124:"方正县",230125:"宾县",230126:"巴彦县",230127:"木兰县",230128:"通河县",230129:"延寿县",230181:"阿城区",230182:"双城市",230183:"尚志市",230184:"五常市",230186:"其它区",230200:"齐齐哈尔市",230202:"龙沙区",230203:"建华区",230204:"铁锋区",230205:"昂昂溪区",230206:"富拉尔基区",230207:"碾子山区",230208:"梅里斯达斡尔族区",230221:"龙江县",230223:"依安县",230224:"泰来县",230225:"甘南县",230227:"富裕县",230229:"克山县",230230:"克东县",230231:"拜泉县",230281:"讷河市",230282:"其它区",230300:"鸡西市",230302:"鸡冠区",230303:"恒山区",230304:"滴道区",230305:"梨树区",230306:"城子河区",230307:"麻山区",230321:"鸡东县",230381:"虎林市",230382:"密山市",230383:"其它区",230400:"鹤岗市",230402:"向阳区",230403:"工农区",230404:"南山区",230405:"兴安区",230406:"东山区",230407:"兴山区",230421:"萝北县",230422:"绥滨县",230423:"其它区",230500:"双鸭山市",230502:"尖山区",230503:"岭东区",230505:"四方台区",230506:"宝山区",230521:"集贤县",230522:"友谊县",230523:"宝清县",230524:"饶河县",230525:"其它区",230600:"大庆市",230602:"萨尔图区",230603:"龙凤区",230604:"让胡路区",230605:"红岗区",230606:"大同区",230621:"肇州县",230622:"肇源县",230623:"林甸县",230624:"杜尔伯特蒙古族自治县",230625:"其它区",230700:"伊春市",230702:"伊春区",230703:"南岔区",230704:"友好区",230705:"西林区",230706:"翠峦区",230707:"新青区",230708:"美溪区",230709:"金山屯区",230710:"五营区",230711:"乌马河区",230712:"汤旺河区",230713:"带岭区",230714:"乌伊岭区",230715:"红星区",230716:"上甘岭区",230722:"嘉荫县",230781:"铁力市",230782:"其它区",230800:"佳木斯市",230803:"向阳区",230804:"前进区",230805:"东风区",230811:"郊区",230822:"桦南县",230826:"桦川县",230828:"汤原县",230833:"抚远县",230881:"同江市",230882:"富锦市",230883:"其它区",230900:"七台河市",230902:"新兴区",230903:"桃山区",230904:"茄子河区",230921:"勃利县",230922:"其它区",231e3:"牡丹江市",231002:"东安区",231003:"阳明区",231004:"爱民区",231005:"西安区",231024:"东宁县",231025:"林口县",231081:"绥芬河市",231083:"海林市",231084:"宁安市",231085:"穆棱市",231086:"其它区",231100:"黑河市",231102:"爱辉区",231121:"嫩江县",231123:"逊克县",231124:"孙吴县",231181:"北安市",231182:"五大连池市",231183:"其它区",231200:"绥化市",231202:"北林区",231221:"望奎县",231222:"兰西县",231223:"青冈县",231224:"庆安县",231225:"明水县",231226:"绥棱县",231281:"安达市",231282:"肇东市",231283:"海伦市",231284:"其它区",232700:"大兴安岭地区",232702:"松岭区",232703:"新林区",232704:"呼中区",232721:"呼玛县",232722:"塔河县",232723:"漠河县",232724:"加格达奇区",232725:"其它区",31e4:"上海",310100:"上海市",310101:"黄浦区",310104:"徐汇区",310105:"长宁区",310106:"静安区",310107:"普陀区",310108:"闸北区",310109:"虹口区",310110:"杨浦区",310112:"闵行区",310113:"宝山区",310114:"嘉定区",310115:"浦东新区",310116:"金山区",310117:"松江区",310118:"青浦区",310120:"奉贤区",310230:"崇明县",310231:"其它区",32e4:"江苏省",320100:"南京市",320102:"玄武区",320104:"秦淮区",320105:"建邺区",320106:"鼓楼区",320111:"浦口区",320113:"栖霞区",320114:"雨花台区",320115:"江宁区",320116:"六合区",320124:"溧水区",320125:"高淳区",320126:"其它区",320200:"无锡市",320202:"崇安区",320203:"南长区",320204:"北塘区",320205:"锡山区",320206:"惠山区",320211:"滨湖区",320281:"江阴市",320282:"宜兴市",320297:"其它区",320300:"徐州市",320302:"鼓楼区",320303:"云龙区",320305:"贾汪区",320311:"泉山区",320321:"丰县",320322:"沛县",320323:"铜山区",320324:"睢宁县",320381:"新沂市",320382:"邳州市",320383:"其它区",320400:"常州市",320402:"天宁区",320404:"钟楼区",320405:"戚墅堰区",320411:"新北区",320412:"武进区",320481:"溧阳市",320482:"金坛市",320483:"其它区",320500:"苏州市",320505:"虎丘区",320506:"吴中区",320507:"相城区",320508:"姑苏区",320581:"常熟市",320582:"张家港市",320583:"昆山市",320584:"吴江区",320585:"太仓市",320596:"其它区",320600:"南通市",320602:"崇川区",320611:"港闸区",320612:"通州区",320621:"海安县",320623:"如东县",320681:"启东市",320682:"如皋市",320684:"海门市",320694:"其它区",320700:"连云港市",320703:"连云区",320705:"新浦区",320706:"海州区",320721:"赣榆县",320722:"东海县",320723:"灌云县",320724:"灌南县",320725:"其它区",320800:"淮安市",320802:"清河区",320803:"淮安区",320804:"淮阴区",320811:"清浦区",320826:"涟水县",320829:"洪泽县",320830:"盱眙县",320831:"金湖县",320832:"其它区",320900:"盐城市",320902:"亭湖区",320903:"盐都区",320921:"响水县",320922:"滨海县",320923:"阜宁县",320924:"射阳县",320925:"建湖县",320981:"东台市",320982:"大丰市",320983:"其它区",321e3:"扬州市",321002:"广陵区",321003:"邗江区",321023:"宝应县",321081:"仪征市",321084:"高邮市",321088:"江都区",321093:"其它区",321100:"镇江市",321102:"京口区",321111:"润州区",321112:"丹徒区",321181:"丹阳市",321182:"扬中市",321183:"句容市",321184:"其它区",321200:"泰州市",321202:"海陵区",321203:"高港区",321281:"兴化市",321282:"靖江市",321283:"泰兴市",321284:"姜堰区",321285:"其它区",321300:"宿迁市",321302:"宿城区",321311:"宿豫区",321322:"沭阳县",321323:"泗阳县",321324:"泗洪县",321325:"其它区",33e4:"浙江省",330100:"杭州市",330102:"上城区",330103:"下城区",330104:"江干区",330105:"拱墅区",330106:"西湖区",330108:"滨江区",330109:"萧山区",330110:"余杭区",330122:"桐庐县",330127:"淳安县",330182:"建德市",330183:"富阳市",330185:"临安市",330186:"其它区",330200:"宁波市",330203:"海曙区",330204:"江东区",330205:"江北区",330206:"北仑区",330211:"镇海区",330212:"鄞州区",330225:"象山县",330226:"宁海县",330281:"余姚市",330282:"慈溪市",330283:"奉化市",330284:"其它区",330300:"温州市",330302:"鹿城区",330303:"龙湾区",330304:"瓯海区",330322:"洞头县",330324:"永嘉县",330326:"平阳县",330327:"苍南县",330328:"文成县",330329:"泰顺县",330381:"瑞安市",330382:"乐清市",330383:"其它区",330400:"嘉兴市",330402:"南湖区",330411:"秀洲区",330421:"嘉善县",330424:"海盐县",330481:"海宁市",330482:"平湖市",330483:"桐乡市",330484:"其它区",330500:"湖州市",330502:"吴兴区",330503:"南浔区",330521:"德清县",330522:"长兴县",330523:"安吉县",330524:"其它区",330600:"绍兴市",330602:"越城区",330621:"绍兴县",330624:"新昌县",330681:"诸暨市",330682:"上虞市",330683:"嵊州市",330684:"其它区",330700:"金华市",330702:"婺城区",330703:"金东区",330723:"武义县",330726:"浦江县",330727:"磐安县",330781:"兰溪市",330782:"义乌市",330783:"东阳市",330784:"永康市",330785:"其它区",330800:"衢州市",330802:"柯城区",330803:"衢江区",330822:"常山县",330824:"开化县",330825:"龙游县",330881:"江山市",330882:"其它区",330900:"舟山市",330902:"定海区",330903:"普陀区",330921:"岱山县",330922:"嵊泗县",330923:"其它区",331e3:"台州市",331002:"椒江区",331003:"黄岩区",331004:"路桥区",331021:"玉环县",331022:"三门县",331023:"天台县",331024:"仙居县",331081:"温岭市",331082:"临海市",331083:"其它区",331100:"丽水市",331102:"莲都区",331121:"青田县",331122:"缙云县",331123:"遂昌县",331124:"松阳县",331125:"云和县",331126:"庆元县",331127:"景宁畲族自治县",331181:"龙泉市",331182:"其它区",34e4:"安徽省",340100:"合肥市",340102:"瑶海区",340103:"庐阳区",340104:"蜀山区",340111:"包河区",340121:"长丰县",340122:"肥东县",340123:"肥西县",340192:"其它区",340200:"芜湖市",340202:"镜湖区",340203:"弋江区",340207:"鸠江区",340208:"三山区",340221:"芜湖县",340222:"繁昌县",340223:"南陵县",340224:"其它区",340300:"蚌埠市",340302:"龙子湖区",340303:"蚌山区",340304:"禹会区",340311:"淮上区",340321:"怀远县",340322:"五河县",340323:"固镇县",340324:"其它区",340400:"淮南市",340402:"大通区",340403:"田家庵区",340404:"谢家集区",340405:"八公山区",340406:"潘集区",340421:"凤台县",340422:"其它区",340500:"马鞍山市",340503:"花山区",340504:"雨山区",340506:"博望区",340521:"当涂县",340522:"其它区",340600:"淮北市",340602:"杜集区",340603:"相山区",340604:"烈山区",340621:"濉溪县",340622:"其它区",340700:"铜陵市",340702:"铜官山区",340703:"狮子山区",340711:"郊区",340721:"铜陵县",340722:"其它区",340800:"安庆市",340802:"迎江区",340803:"大观区",340811:"宜秀区",340822:"怀宁县",340823:"枞阳县",340824:"潜山县",340825:"太湖县",340826:"宿松县",340827:"望江县",340828:"岳西县",340881:"桐城市",340882:"其它区",341e3:"黄山市",341002:"屯溪区",341003:"黄山区",341004:"徽州区",341021:"歙县",341022:"休宁县",341023:"黟县",341024:"祁门县",341025:"其它区",341100:"滁州市",341102:"琅琊区",341103:"南谯区",341122:"来安县",341124:"全椒县",341125:"定远县",341126:"凤阳县",341181:"天长市",341182:"明光市",341183:"其它区",341200:"阜阳市",341202:"颍州区",341203:"颍东区",341204:"颍泉区",341221:"临泉县",341222:"太和县",341225:"阜南县",341226:"颍上县",341282:"界首市",341283:"其它区",341300:"宿州市",341302:"埇桥区",341321:"砀山县",341322:"萧县",341323:"灵璧县",341324:"泗县",341325:"其它区",341400:"巢湖市",341421:"庐江县",341422:"无为县",341423:"含山县",341424:"和县",341500:"六安市",341502:"金安区",341503:"裕安区",341521:"寿县",341522:"霍邱县",341523:"舒城县",341524:"金寨县",341525:"霍山县",341526:"其它区",341600:"亳州市",341602:"谯城区",341621:"涡阳县",341622:"蒙城县",341623:"利辛县",341624:"其它区",341700:"池州市",341702:"贵池区",341721:"东至县",341722:"石台县",341723:"青阳县",341724:"其它区",341800:"宣城市",341802:"宣州区",341821:"郎溪县",341822:"广德县",341823:"泾县",341824:"绩溪县",341825:"旌德县",341881:"宁国市",341882:"其它区",35e4:"福建省",350100:"福州市",350102:"鼓楼区",350103:"台江区",350104:"仓山区",350105:"马尾区",350111:"晋安区",350121:"闽侯县",350122:"连江县",350123:"罗源县",350124:"闽清县",350125:"永泰县",350128:"平潭县",350181:"福清市",350182:"长乐市",350183:"其它区",350200:"厦门市",350203:"思明区",350205:"海沧区",350206:"湖里区",350211:"集美区",350212:"同安区",350213:"翔安区",350214:"其它区",350300:"莆田市",350302:"城厢区",350303:"涵江区",350304:"荔城区",350305:"秀屿区",350322:"仙游县",350323:"其它区",350400:"三明市",350402:"梅列区",350403:"三元区",350421:"明溪县",350423:"清流县",350424:"宁化县",350425:"大田县",350426:"尤溪县",350427:"沙县",350428:"将乐县",350429:"泰宁县",350430:"建宁县",350481:"永安市",350482:"其它区",350500:"泉州市",350502:"鲤城区",350503:"丰泽区",350504:"洛江区",350505:"泉港区",350521:"惠安县",350524:"安溪县",350525:"永春县",350526:"德化县",350527:"金门县",350581:"石狮市",350582:"晋江市",350583:"南安市",350584:"其它区",350600:"漳州市",350602:"芗城区",350603:"龙文区",350622:"云霄县",350623:"漳浦县",350624:"诏安县",350625:"长泰县",350626:"东山县",350627:"南靖县",350628:"平和县",350629:"华安县",350681:"龙海市",350682:"其它区",350700:"南平市",350702:"延平区",350721:"顺昌县",350722:"浦城县",350723:"光泽县",350724:"松溪县",350725:"政和县",350781:"邵武市",350782:"武夷山市",350783:"建瓯市",350784:"建阳市",350785:"其它区",350800:"龙岩市",350802:"新罗区",350821:"长汀县",350822:"永定县",350823:"上杭县",350824:"武平县",350825:"连城县",350881:"漳平市",350882:"其它区",350900:"宁德市",350902:"蕉城区",350921:"霞浦县",350922:"古田县",350923:"屏南县",350924:"寿宁县",350925:"周宁县",350926:"柘荣县",350981:"福安市",350982:"福鼎市",350983:"其它区",36e4:"江西省",360100:"南昌市",360102:"东湖区",360103:"西湖区",360104:"青云谱区",360105:"湾里区",360111:"青山湖区",360121:"南昌县",360122:"新建县",360123:"安义县",360124:"进贤县",360128:"其它区",360200:"景德镇市",360202:"昌江区",360203:"珠山区",360222:"浮梁县",360281:"乐平市",360282:"其它区",360300:"萍乡市",360302:"安源区",360313:"湘东区",360321:"莲花县",360322:"上栗县",360323:"芦溪县",360324:"其它区",360400:"九江市",360402:"庐山区",360403:"浔阳区",360421:"九江县",360423:"武宁县",360424:"修水县",360425:"永修县",360426:"德安县",360427:"星子县",360428:"都昌县",360429:"湖口县",360430:"彭泽县",360481:"瑞昌市",360482:"其它区",360483:"共青城市",360500:"新余市",360502:"渝水区",360521:"分宜县",360522:"其它区",360600:"鹰潭市",360602:"月湖区",360622:"余江县",360681:"贵溪市",360682:"其它区",360700:"赣州市",360702:"章贡区",360721:"赣县",360722:"信丰县",360723:"大余县",360724:"上犹县",360725:"崇义县",360726:"安远县",360727:"龙南县",360728:"定南县",360729:"全南县",360730:"宁都县",360731:"于都县",360732:"兴国县",360733:"会昌县",360734:"寻乌县",360735:"石城县",360781:"瑞金市",360782:"南康市",360783:"其它区",360800:"吉安市",360802:"吉州区",360803:"青原区",360821:"吉安县",360822:"吉水县",360823:"峡江县",360824:"新干县",360825:"永丰县",360826:"泰和县",360827:"遂川县",360828:"万安县",360829:"安福县",360830:"永新县",360881:"井冈山市",360882:"其它区",360900:"宜春市",360902:"袁州区",360921:"奉新县",360922:"万载县",360923:"上高县",360924:"宜丰县",360925:"靖安县",360926:"铜鼓县",360981:"丰城市",360982:"樟树市",360983:"高安市",360984:"其它区",361e3:"抚州市",361002:"临川区",361021:"南城县",361022:"黎川县",361023:"南丰县",361024:"崇仁县",361025:"乐安县",361026:"宜黄县",361027:"金溪县",361028:"资溪县",361029:"东乡县",361030:"广昌县",361031:"其它区",361100:"上饶市",361102:"信州区",361121:"上饶县",361122:"广丰县",361123:"玉山县",361124:"铅山县",361125:"横峰县",361126:"弋阳县",361127:"余干县",361128:"鄱阳县",361129:"万年县",361130:"婺源县",361181:"德兴市",361182:"其它区",37e4:"山东省",370100:"济南市",370102:"历下区",370103:"市中区",370104:"槐荫区",370105:"天桥区",370112:"历城区",370113:"长清区",370124:"平阴县",370125:"济阳县",370126:"商河县",370181:"章丘市",370182:"其它区",370200:"青岛市",370202:"市南区",370203:"市北区",370211:"黄岛区",370212:"崂山区",370213:"李沧区",370214:"城阳区",370281:"胶州市",370282:"即墨市",370283:"平度市",370285:"莱西市",370286:"其它区",370300:"淄博市",370302:"淄川区",370303:"张店区",370304:"博山区",370305:"临淄区",370306:"周村区",370321:"桓台县",370322:"高青县",370323:"沂源县",370324:"其它区",370400:"枣庄市",370402:"市中区",370403:"薛城区",370404:"峄城区",370405:"台儿庄区",370406:"山亭区",370481:"滕州市",370482:"其它区",370500:"东营市",370502:"东营区",370503:"河口区",370521:"垦利县",370522:"利津县",370523:"广饶县",370591:"其它区",370600:"烟台市",370602:"芝罘区",370611:"福山区",370612:"牟平区",370613:"莱山区",370634:"长岛县",370681:"龙口市",370682:"莱阳市",370683:"莱州市",370684:"蓬莱市",370685:"招远市",370686:"栖霞市",370687:"海阳市",370688:"其它区",370700:"潍坊市",370702:"潍城区",370703:"寒亭区",370704:"坊子区",370705:"奎文区",370724:"临朐县",370725:"昌乐县",370781:"青州市",370782:"诸城市",370783:"寿光市",370784:"安丘市",370785:"高密市",370786:"昌邑市",370787:"其它区",370800:"济宁市",370802:"市中区",370811:"任城区",370826:"微山县",370827:"鱼台县",370828:"金乡县",370829:"嘉祥县",370830:"汶上县",370831:"泗水县",370832:"梁山县",370881:"曲阜市",370882:"兖州市",370883:"邹城市",370884:"其它区",370900:"泰安市",370902:"泰山区",370903:"岱岳区",370921:"宁阳县",370923:"东平县",370982:"新泰市",370983:"肥城市",370984:"其它区",371e3:"威海市",371002:"环翠区",371081:"文登市",371082:"荣成市",371083:"乳山市",371084:"其它区",371100:"日照市",371102:"东港区",371103:"岚山区",371121:"五莲县",371122:"莒县",371123:"其它区",371200:"莱芜市",371202:"莱城区",371203:"钢城区",371204:"其它区",371300:"临沂市",371302:"兰山区",371311:"罗庄区",371312:"河东区",371321:"沂南县",371322:"郯城县",371323:"沂水县",371324:"苍山县",371325:"费县",371326:"平邑县",371327:"莒南县",371328:"蒙阴县",371329:"临沭县",371330:"其它区",371400:"德州市",371402:"德城区",371421:"陵县",371422:"宁津县",371423:"庆云县",371424:"临邑县",371425:"齐河县",371426:"平原县",371427:"夏津县",371428:"武城县",371481:"乐陵市",371482:"禹城市",371483:"其它区",371500:"聊城市",371502:"东昌府区",371521:"阳谷县",371522:"莘县",371523:"茌平县",371524:"东阿县",371525:"冠县",371526:"高唐县",371581:"临清市",371582:"其它区",371600:"滨州市",371602:"滨城区",371621:"惠民县",371622:"阳信县",371623:"无棣县",371624:"沾化县",371625:"博兴县",371626:"邹平县",371627:"其它区",371700:"菏泽市",371702:"牡丹区",371721:"曹县",371722:"单县",371723:"成武县",371724:"巨野县",371725:"郓城县",371726:"鄄城县",371727:"定陶县",371728:"东明县",371729:"其它区",41e4:"河南省",410100:"郑州市",410102:"中原区",410103:"二七区",410104:"管城回族区",410105:"金水区",410106:"上街区",410108:"惠济区",410122:"中牟县",410181:"巩义市",410182:"荥阳市",410183:"新密市",410184:"新郑市",410185:"登封市",410188:"其它区",410200:"开封市",410202:"龙亭区",410203:"顺河回族区",410204:"鼓楼区",410205:"禹王台区",410211:"金明区",410221:"杞县",410222:"通许县",410223:"尉氏县",410224:"开封县",410225:"兰考县",410226:"其它区",410300:"洛阳市",410302:"老城区",410303:"西工区",410304:"瀍河回族区",410305:"涧西区",410306:"吉利区",410307:"洛龙区",410322:"孟津县",410323:"新安县",410324:"栾川县",410325:"嵩县",410326:"汝阳县",410327:"宜阳县",410328:"洛宁县",410329:"伊川县",410381:"偃师市",410400:"平顶山市",410402:"新华区",410403:"卫东区",410404:"石龙区",410411:"湛河区",410421:"宝丰县",410422:"叶县",410423:"鲁山县",410425:"郏县",410481:"舞钢市",410482:"汝州市",410483:"其它区",410500:"安阳市",410502:"文峰区",410503:"北关区",410505:"殷都区",410506:"龙安区",410522:"安阳县",410523:"汤阴县",410526:"滑县",410527:"内黄县",410581:"林州市",410582:"其它区",410600:"鹤壁市",410602:"鹤山区",410603:"山城区",410611:"淇滨区",410621:"浚县",410622:"淇县",410623:"其它区",410700:"新乡市",410702:"红旗区",410703:"卫滨区",410704:"凤泉区",410711:"牧野区",410721:"新乡县",410724:"获嘉县",410725:"原阳县",410726:"延津县",410727:"封丘县",410728:"长垣县",410781:"卫辉市",410782:"辉县市",410783:"其它区",410800:"焦作市",410802:"解放区",410803:"中站区",410804:"马村区",410811:"山阳区",410821:"修武县",410822:"博爱县",410823:"武陟县",410825:"温县",410881:"济源市",410882:"沁阳市",410883:"孟州市",410884:"其它区",410900:"濮阳市",410902:"华龙区",410922:"清丰县",410923:"南乐县",410926:"范县",410927:"台前县",410928:"濮阳县",410929:"其它区",411e3:"许昌市",411002:"魏都区",411023:"许昌县",411024:"鄢陵县",411025:"襄城县",411081:"禹州市",411082:"长葛市",411083:"其它区",411100:"漯河市",411102:"源汇区",411103:"郾城区",411104:"召陵区",411121:"舞阳县",411122:"临颍县",411123:"其它区",411200:"三门峡市",411202:"湖滨区",411221:"渑池县",411222:"陕县",411224:"卢氏县",411281:"义马市",411282:"灵宝市",411283:"其它区",411300:"南阳市",411302:"宛城区",411303:"卧龙区",411321:"南召县",411322:"方城县",411323:"西峡县",411324:"镇平县",411325:"内乡县",411326:"淅川县",411327:"社旗县",411328:"唐河县",411329:"新野县",411330:"桐柏县",411381:"邓州市",411382:"其它区",411400:"商丘市",411402:"梁园区",411403:"睢阳区",411421:"民权县",411422:"睢县",411423:"宁陵县",411424:"柘城县",411425:"虞城县",411426:"夏邑县",411481:"永城市",411482:"其它区",411500:"信阳市",411502:"浉河区",411503:"平桥区",411521:"罗山县",411522:"光山县",411523:"新县",411524:"商城县",411525:"固始县",411526:"潢川县",411527:"淮滨县",411528:"息县",411529:"其它区",411600:"周口市",411602:"川汇区",411621:"扶沟县",411622:"西华县",411623:"商水县",411624:"沈丘县",411625:"郸城县",411626:"淮阳县",411627:"太康县",411628:"鹿邑县",411681:"项城市",411682:"其它区",411700:"驻马店市",411702:"驿城区",411721:"西平县",411722:"上蔡县",411723:"平舆县",411724:"正阳县",411725:"确山县",411726:"泌阳县",411727:"汝南县",411728:"遂平县",411729:"新蔡县",411730:"其它区",42e4:"湖北省",420100:"武汉市",420102:"江岸区",420103:"江汉区",420104:"硚口区",420105:"汉阳区",420106:"武昌区",420107:"青山区",420111:"洪山区",420112:"东西湖区",420113:"汉南区",420114:"蔡甸区",420115:"江夏区",420116:"黄陂区",420117:"新洲区",420118:"其它区",420200:"黄石市",420202:"黄石港区",420203:"西塞山区",420204:"下陆区",420205:"铁山区",420222:"阳新县",420281:"大冶市",420282:"其它区",420300:"十堰市",420302:"茅箭区",420303:"张湾区",420321:"郧县",420322:"郧西县",420323:"竹山县",420324:"竹溪县",420325:"房县",420381:"丹江口市",420383:"其它区",420500:"宜昌市",420502:"西陵区",420503:"伍家岗区",420504:"点军区",420505:"猇亭区",420506:"夷陵区",420525:"远安县",420526:"兴山县",420527:"秭归县",420528:"长阳土家族自治县",420529:"五峰土家族自治县",420581:"宜都市",420582:"当阳市",420583:"枝江市",420584:"其它区",420600:"襄阳市",420602:"襄城区",420606:"樊城区",420607:"襄州区",420624:"南漳县",420625:"谷城县",420626:"保康县",420682:"老河口市",420683:"枣阳市",420684:"宜城市",420685:"其它区",420700:"鄂州市",420702:"梁子湖区",420703:"华容区",420704:"鄂城区",420705:"其它区",420800:"荆门市",420802:"东宝区",420804:"掇刀区",420821:"京山县",420822:"沙洋县",420881:"钟祥市",420882:"其它区",420900:"孝感市",420902:"孝南区",420921:"孝昌县",420922:"大悟县",420923:"云梦县",420981:"应城市",420982:"安陆市",420984:"汉川市",420985:"其它区",421e3:"荆州市",421002:"沙市区",421003:"荆州区",421022:"公安县",421023:"监利县",421024:"江陵县",421081:"石首市",421083:"洪湖市",421087:"松滋市",421088:"其它区",421100:"黄冈市",421102:"黄州区",421121:"团风县",421122:"红安县",421123:"罗田县",421124:"英山县",421125:"浠水县",421126:"蕲春县",421127:"黄梅县",421181:"麻城市",421182:"武穴市",421183:"其它区",421200:"咸宁市",421202:"咸安区",421221:"嘉鱼县",421222:"通城县",421223:"崇阳县",421224:"通山县",421281:"赤壁市",421283:"其它区",421300:"随州市",421302:"曾都区",421321:"随县",421381:"广水市",421382:"其它区",422800:"恩施土家族苗族自治州",422801:"恩施市",422802:"利川市",422822:"建始县",422823:"巴东县",422825:"宣恩县",422826:"咸丰县",422827:"来凤县",422828:"鹤峰县",422829:"其它区",429004:"仙桃市",429005:"潜江市",429006:"天门市",429021:"神农架林区",43e4:"湖南省",430100:"长沙市",430102:"芙蓉区",430103:"天心区",430104:"岳麓区",430105:"开福区",430111:"雨花区",430121:"长沙县",430122:"望城区",430124:"宁乡县",430181:"浏阳市",430182:"其它区",430200:"株洲市",430202:"荷塘区",430203:"芦淞区",430204:"石峰区",430211:"天元区",430221:"株洲县",430223:"攸县",430224:"茶陵县",430225:"炎陵县",430281:"醴陵市",430282:"其它区",430300:"湘潭市",430302:"雨湖区",430304:"岳塘区",430321:"湘潭县",430381:"湘乡市",430382:"韶山市",430383:"其它区",430400:"衡阳市",430405:"珠晖区",430406:"雁峰区",430407:"石鼓区",430408:"蒸湘区",430412:"南岳区",430421:"衡阳县",430422:"衡南县",430423:"衡山县",430424:"衡东县",430426:"祁东县",430481:"耒阳市",430482:"常宁市",430483:"其它区",430500:"邵阳市",430502:"双清区",430503:"大祥区",430511:"北塔区",430521:"邵东县",430522:"新邵县",430523:"邵阳县",430524:"隆回县",430525:"洞口县",430527:"绥宁县",430528:"新宁县",430529:"城步苗族自治县",430581:"武冈市",430582:"其它区",430600:"岳阳市",430602:"岳阳楼区",430603:"云溪区",430611:"君山区",430621:"岳阳县",430623:"华容县",430624:"湘阴县",430626:"平江县",430681:"汨罗市",430682:"临湘市",430683:"其它区",430700:"常德市",430702:"武陵区",430703:"鼎城区",430721:"安乡县",430722:"汉寿县",430723:"澧县",430724:"临澧县",430725:"桃源县",430726:"石门县",430781:"津市市",430782:"其它区",430800:"张家界市",430802:"永定区",430811:"武陵源区",430821:"慈利县",430822:"桑植县",430823:"其它区",430900:"益阳市",430902:"资阳区",430903:"赫山区",430921:"南县",430922:"桃江县",430923:"安化县",430981:"沅江市",430982:"其它区",431e3:"郴州市",431002:"北湖区",431003:"苏仙区",431021:"桂阳县",431022:"宜章县",431023:"永兴县",431024:"嘉禾县",431025:"临武县",431026:"汝城县",431027:"桂东县",431028:"安仁县",431081:"资兴市",431082:"其它区",431100:"永州市",431102:"零陵区",431103:"冷水滩区",431121:"祁阳县",431122:"东安县",431123:"双牌县",431124:"道县",431125:"江永县",431126:"宁远县",431127:"蓝山县",431128:"新田县",431129:"江华瑶族自治县",431130:"其它区",431200:"怀化市",431202:"鹤城区",431221:"中方县",431222:"沅陵县",431223:"辰溪县",431224:"溆浦县",431225:"会同县",431226:"麻阳苗族自治县",431227:"新晃侗族自治县",431228:"芷江侗族自治县",431229:"靖州苗族侗族自治县",431230:"通道侗族自治县",431281:"洪江市",431282:"其它区",431300:"娄底市",431302:"娄星区",431321:"双峰县",431322:"新化县",431381:"冷水江市",431382:"涟源市",431383:"其它区",433100:"湘西土家族苗族自治州",433101:"吉首市",433122:"泸溪县",433123:"凤凰县",433124:"花垣县",433125:"保靖县",433126:"古丈县",433127:"永顺县",433130:"龙山县",433131:"其它区",44e4:"广东省",440100:"广州市",440103:"荔湾区",440104:"越秀区",440105:"海珠区",440106:"天河区",440111:"白云区",440112:"黄埔区",440113:"番禺区",440114:"花都区",440115:"南沙区",440116:"萝岗区",440183:"增城市",440184:"从化市",440189:"其它区",440200:"韶关市",440203:"武江区",440204:"浈江区",440205:"曲江区",440222:"始兴县",440224:"仁化县",440229:"翁源县",440232:"乳源瑶族自治县",440233:"新丰县",440281:"乐昌市",440282:"南雄市",440283:"其它区",440300:"深圳市",440303:"罗湖区",440304:"福田区",440305:"南山区",440306:"宝安区",440307:"龙岗区",440308:"盐田区",440309:"其它区",440320:"光明新区",440321:"坪山新区",440322:"大鹏新区",440323:"龙华新区",440400:"珠海市",440402:"香洲区",440403:"斗门区",440404:"金湾区",440488:"其它区",440500:"汕头市",440507:"龙湖区",440511:"金平区",440512:"濠江区",440513:"潮阳区",440514:"潮南区",440515:"澄海区",440523:"南澳县",440524:"其它区",440600:"佛山市",440604:"禅城区",440605:"南海区",440606:"顺德区",440607:"三水区",440608:"高明区",440609:"其它区",440700:"江门市",440703:"蓬江区",440704:"江海区",440705:"新会区",440781:"台山市",440783:"开平市",440784:"鹤山市",440785:"恩平市",440786:"其它区",440800:"湛江市",440802:"赤坎区",440803:"霞山区",440804:"坡头区",440811:"麻章区",440823:"遂溪县",440825:"徐闻县",440881:"廉江市",440882:"雷州市",440883:"吴川市",440884:"其它区",440900:"茂名市",440902:"茂南区",440903:"茂港区",440923:"电白县",440981:"高州市",440982:"化州市",440983:"信宜市",440984:"其它区",441200:"肇庆市",441202:"端州区",441203:"鼎湖区",441223:"广宁县",441224:"怀集县",441225:"封开县",441226:"德庆县",441283:"高要市",441284:"四会市",441285:"其它区",441300:"惠州市",441302:"惠城区",441303:"惠阳区",441322:"博罗县",441323:"惠东县",441324:"龙门县",441325:"其它区",441400:"梅州市",441402:"梅江区",441421:"梅县",441422:"大埔县",441423:"丰顺县",441424:"五华县",441426:"平远县",441427:"蕉岭县",441481:"兴宁市",441482:"其它区",441500:"汕尾市",441502:"城区",441521:"海丰县",441523:"陆河县",441581:"陆丰市",441582:"其它区",441600:"河源市",441602:"源城区",441621:"紫金县",441622:"龙川县",441623:"连平县",441624:"和平县",441625:"东源县",441626:"其它区",441700:"阳江市",441702:"江城区",441721:"阳西县",441723:"阳东县",441781:"阳春市",441782:"其它区",441800:"清远市",441802:"清城区",441821:"佛冈县",441823:"阳山县",441825:"连山壮族瑶族自治县",441826:"连南瑶族自治县",441827:"清新区",441881:"英德市",441882:"连州市",441883:"其它区",441900:"东莞市",442e3:"中山市",442101:"东沙群岛",445100:"潮州市",445102:"湘桥区",445121:"潮安区",445122:"饶平县",445186:"其它区",445200:"揭阳市",445202:"榕城区",445221:"揭东区",445222:"揭西县",445224:"惠来县",445281:"普宁市",445285:"其它区",445300:"云浮市",445302:"云城区",445321:"新兴县",445322:"郁南县",445323:"云安县",445381:"罗定市",445382:"其它区",45e4:"广西壮族自治区",450100:"南宁市",450102:"兴宁区",450103:"青秀区",450105:"江南区",450107:"西乡塘区",450108:"良庆区",450109:"邕宁区",450122:"武鸣县",450123:"隆安县",450124:"马山县",450125:"上林县",450126:"宾阳县",450127:"横县",450128:"其它区",450200:"柳州市",450202:"城中区",450203:"鱼峰区",450204:"柳南区",450205:"柳北区",450221:"柳江县",450222:"柳城县",450223:"鹿寨县",450224:"融安县",450225:"融水苗族自治县",450226:"三江侗族自治县",450227:"其它区",450300:"桂林市",450302:"秀峰区",450303:"叠彩区",450304:"象山区",450305:"七星区",450311:"雁山区",450321:"阳朔县",450322:"临桂区",450323:"灵川县",450324:"全州县",450325:"兴安县",450326:"永福县",450327:"灌阳县",450328:"龙胜各族自治县",450329:"资源县",450330:"平乐县",450331:"荔浦县",450332:"恭城瑶族自治县",450333:"其它区",450400:"梧州市",450403:"万秀区",450405:"长洲区",450406:"龙圩区",450421:"苍梧县",450422:"藤县",450423:"蒙山县",450481:"岑溪市",450482:"其它区",450500:"北海市",450502:"海城区",450503:"银海区",450512:"铁山港区",450521:"合浦县",450522:"其它区",450600:"防城港市",450602:"港口区",450603:"防城区",450621:"上思县",450681:"东兴市",450682:"其它区",450700:"钦州市",450702:"钦南区",450703:"钦北区",450721:"灵山县",450722:"浦北县",450723:"其它区",450800:"贵港市",450802:"港北区",450803:"港南区",450804:"覃塘区",450821:"平南县",450881:"桂平市",450882:"其它区",450900:"玉林市",450902:"玉州区",450903:"福绵区",450921:"容县",450922:"陆川县",450923:"博白县",450924:"兴业县",450981:"北流市",450982:"其它区",451e3:"百色市",451002:"右江区",451021:"田阳县",451022:"田东县",451023:"平果县",451024:"德保县",451025:"靖西县",451026:"那坡县",451027:"凌云县",451028:"乐业县",451029:"田林县",451030:"西林县",451031:"隆林各族自治县",451032:"其它区",451100:"贺州市",451102:"八步区",451119:"平桂管理区",451121:"昭平县",451122:"钟山县",451123:"富川瑶族自治县",451124:"其它区",451200:"河池市",451202:"金城江区",451221:"南丹县",451222:"天峨县",451223:"凤山县",451224:"东兰县",451225:"罗城仫佬族自治县",451226:"环江毛南族自治县",451227:"巴马瑶族自治县",451228:"都安瑶族自治县",451229:"大化瑶族自治县",451281:"宜州市",451282:"其它区",451300:"来宾市",451302:"兴宾区",451321:"忻城县",451322:"象州县",451323:"武宣县",451324:"金秀瑶族自治县",451381:"合山市",451382:"其它区",451400:"崇左市",451402:"江州区",451421:"扶绥县",451422:"宁明县",451423:"龙州县",451424:"大新县",451425:"天等县",451481:"凭祥市",451482:"其它区",46e4:"海南省",460100:"海口市",460105:"秀英区",460106:"龙华区",460107:"琼山区",460108:"美兰区",460109:"其它区",460200:"三亚市",460300:"三沙市",460321:"西沙群岛",460322:"南沙群岛",460323:"中沙群岛的岛礁及其海域",469001:"五指山市",469002:"琼海市",469003:"儋州市",469005:"文昌市",469006:"万宁市",469007:"东方市",469025:"定安县",469026:"屯昌县",469027:"澄迈县",469028:"临高县",469030:"白沙黎族自治县",469031:"昌江黎族自治县",469033:"乐东黎族自治县",469034:"陵水黎族自治县",469035:"保亭黎族苗族自治县",469036:"琼中黎族苗族自治县",471005:"其它区",5e5:"重庆",500100:"重庆市",500101:"万州区",500102:"涪陵区",500103:"渝中区",500104:"大渡口区",500105:"江北区",500106:"沙坪坝区",500107:"九龙坡区",500108:"南岸区",500109:"北碚区",500110:"万盛区",500111:"双桥区",500112:"渝北区",500113:"巴南区",500114:"黔江区",500115:"长寿区",500222:"綦江区",500223:"潼南县",500224:"铜梁县",500225:"大足区",500226:"荣昌县",500227:"璧山县",500228:"梁平县",500229:"城口县",500230:"丰都县",500231:"垫江县",500232:"武隆县",500233:"忠县",500234:"开县",500235:"云阳县",500236:"奉节县",500237:"巫山县",500238:"巫溪县",500240:"石柱土家族自治县",500241:"秀山土家族苗族自治县",500242:"酉阳土家族苗族自治县",500243:"彭水苗族土家族自治县",500381:"江津区",500382:"合川区",500383:"永川区",500384:"南川区",500385:"其它区",51e4:"四川省",510100:"成都市",510104:"锦江区",510105:"青羊区",510106:"金牛区",510107:"武侯区",510108:"成华区",510112:"龙泉驿区",510113:"青白江区",510114:"新都区",510115:"温江区",510121:"金堂县",510122:"双流县",510124:"郫县",510129:"大邑县",510131:"蒲江县",510132:"新津县",510181:"都江堰市",510182:"彭州市",510183:"邛崃市",510184:"崇州市",510185:"其它区",510300:"自贡市",510302:"自流井区",510303:"贡井区",510304:"大安区",510311:"沿滩区",510321:"荣县",510322:"富顺县",510323:"其它区",510400:"攀枝花市",510402:"东区",510403:"西区",510411:"仁和区",510421:"米易县",510422:"盐边县",510423:"其它区",510500:"泸州市",510502:"江阳区",510503:"纳溪区",510504:"龙马潭区",510521:"泸县",510522:"合江县",510524:"叙永县",510525:"古蔺县",510526:"其它区",510600:"德阳市",510603:"旌阳区",510623:"中江县",510626:"罗江县",510681:"广汉市",510682:"什邡市",510683:"绵竹市",510684:"其它区",510700:"绵阳市",510703:"涪城区",510704:"游仙区",510722:"三台县",510723:"盐亭县",510724:"安县",510725:"梓潼县",510726:"北川羌族自治县",510727:"平武县",510781:"江油市",510782:"其它区",510800:"广元市",510802:"利州区",510811:"昭化区",510812:"朝天区",510821:"旺苍县",510822:"青川县",510823:"剑阁县",510824:"苍溪县",510825:"其它区",510900:"遂宁市",510903:"船山区",510904:"安居区",510921:"蓬溪县",510922:"射洪县",510923:"大英县",510924:"其它区",511e3:"内江市",511002:"市中区",511011:"东兴区",511024:"威远县",511025:"资中县",511028:"隆昌县",511029:"其它区",511100:"乐山市",511102:"市中区",511111:"沙湾区",511112:"五通桥区",511113:"金口河区",511123:"犍为县",511124:"井研县",511126:"夹江县",511129:"沐川县",511132:"峨边彝族自治县",511133:"马边彝族自治县",511181:"峨眉山市",511182:"其它区",511300:"南充市",511302:"顺庆区",511303:"高坪区",511304:"嘉陵区",511321:"南部县",511322:"营山县",511323:"蓬安县",511324:"仪陇县",511325:"西充县",511381:"阆中市",511382:"其它区",511400:"眉山市",511402:"东坡区",511421:"仁寿县",511422:"彭山县",511423:"洪雅县",511424:"丹棱县",511425:"青神县",511426:"其它区",511500:"宜宾市",511502:"翠屏区",511521:"宜宾县",511522:"南溪区",511523:"江安县",511524:"长宁县",511525:"高县",511526:"珙县",511527:"筠连县",511528:"兴文县",511529:"屏山县",511530:"其它区",511600:"广安市",511602:"广安区",511603:"前锋区",511621:"岳池县",511622:"武胜县",511623:"邻水县",511681:"华蓥市",511683:"其它区",511700:"达州市",511702:"通川区",511721:"达川区",511722:"宣汉县",511723:"开江县",511724:"大竹县",511725:"渠县",511781:"万源市",511782:"其它区",511800:"雅安市",511802:"雨城区",511821:"名山区",511822:"荥经县",511823:"汉源县",511824:"石棉县",511825:"天全县",511826:"芦山县",511827:"宝兴县",511828:"其它区",511900:"巴中市",511902:"巴州区",511903:"恩阳区",511921:"通江县",511922:"南江县",511923:"平昌县",511924:"其它区",512e3:"资阳市",512002:"雁江区",512021:"安岳县",512022:"乐至县",512081:"简阳市",512082:"其它区",513200:"阿坝藏族羌族自治州",513221:"汶川县",513222:"理县",513223:"茂县",513224:"松潘县",513225:"九寨沟县",513226:"金川县",513227:"小金县",513228:"黑水县",513229:"马尔康县",513230:"壤塘县",513231:"阿坝县",513232:"若尔盖县",513233:"红原县",513234:"其它区",513300:"甘孜藏族自治州",513321:"康定县",513322:"泸定县",513323:"丹巴县",513324:"九龙县",513325:"雅江县",513326:"道孚县",513327:"炉霍县",513328:"甘孜县",513329:"新龙县",513330:"德格县",513331:"白玉县",513332:"石渠县",513333:"色达县",513334:"理塘县",513335:"巴塘县",513336:"乡城县",513337:"稻城县",513338:"得荣县",513339:"其它区",513400:"凉山彝族自治州",513401:"西昌市",513422:"木里藏族自治县",513423:"盐源县",513424:"德昌县",513425:"会理县",513426:"会东县",513427:"宁南县",513428:"普格县",513429:"布拖县",513430:"金阳县",513431:"昭觉县",513432:"喜德县",513433:"冕宁县",513434:"越西县",513435:"甘洛县",513436:"美姑县",513437:"雷波县",513438:"其它区",52e4:"贵州省",520100:"贵阳市",520102:"南明区",520103:"云岩区",520111:"花溪区",520112:"乌当区",520113:"白云区",520121:"开阳县",520122:"息烽县",520123:"修文县",520151:"观山湖区",520181:"清镇市",520182:"其它区",520200:"六盘水市",520201:"钟山区",520203:"六枝特区",520221:"水城县",520222:"盘县",520223:"其它区",520300:"遵义市",520302:"红花岗区",520303:"汇川区",520321:"遵义县",520322:"桐梓县",520323:"绥阳县",520324:"正安县",520325:"道真仡佬族苗族自治县",520326:"务川仡佬族苗族自治县",520327:"凤冈县",520328:"湄潭县",520329:"余庆县",520330:"习水县",520381:"赤水市",520382:"仁怀市",520383:"其它区",520400:"安顺市",520402:"西秀区",520421:"平坝县",520422:"普定县",520423:"镇宁布依族苗族自治县",520424:"关岭布依族苗族自治县",520425:"紫云苗族布依族自治县",520426:"其它区",522200:"铜仁市",522201:"碧江区",522222:"江口县",522223:"玉屏侗族自治县",522224:"石阡县",522225:"思南县",522226:"印江土家族苗族自治县",522227:"德江县",522228:"沿河土家族自治县",522229:"松桃苗族自治县",522230:"万山区",522231:"其它区",522300:"黔西南布依族苗族自治州",522301:"兴义市",522322:"兴仁县",522323:"普安县",522324:"晴隆县",522325:"贞丰县",522326:"望谟县",522327:"册亨县",522328:"安龙县",522329:"其它区",522400:"毕节市",522401:"七星关区",522422:"大方县",522423:"黔西县",522424:"金沙县",522425:"织金县",522426:"纳雍县",522427:"威宁彝族回族苗族自治县",522428:"赫章县",522429:"其它区",522600:"黔东南苗族侗族自治州",522601:"凯里市",522622:"黄平县",522623:"施秉县",522624:"三穗县",522625:"镇远县",522626:"岑巩县",522627:"天柱县",522628:"锦屏县",522629:"剑河县",522630:"台江县",522631:"黎平县",522632:"榕江县",522633:"从江县",522634:"雷山县",522635:"麻江县",522636:"丹寨县",522637:"其它区",522700:"黔南布依族苗族自治州",522701:"都匀市",522702:"福泉市",522722:"荔波县",522723:"贵定县",522725:"瓮安县",522726:"独山县",522727:"平塘县",522728:"罗甸县",522729:"长顺县",522730:"龙里县",522731:"惠水县",522732:"三都水族自治县",522733:"其它区",53e4:"云南省",530100:"昆明市",530102:"五华区",530103:"盘龙区",530111:"官渡区",530112:"西山区",530113:"东川区",530121:"呈贡区",530122:"晋宁县",530124:"富民县",530125:"宜良县",530126:"石林彝族自治县",530127:"嵩明县",530128:"禄劝彝族苗族自治县",530129:"寻甸回族彝族自治县",530181:"安宁市",530182:"其它区",530300:"曲靖市",530302:"麒麟区",530321:"马龙县",530322:"陆良县",530323:"师宗县",530324:"罗平县",530325:"富源县",530326:"会泽县",530328:"沾益县",530381:"宣威市",530382:"其它区",530400:"玉溪市",530402:"红塔区",530421:"江川县",530422:"澄江县",530423:"通海县",530424:"华宁县",530425:"易门县",530426:"峨山彝族自治县",530427:"新平彝族傣族自治县",530428:"元江哈尼族彝族傣族自治县",530429:"其它区",530500:"保山市",530502:"隆阳区",530521:"施甸县",530522:"腾冲县",530523:"龙陵县",530524:"昌宁县",530525:"其它区",530600:"昭通市",530602:"昭阳区",530621:"鲁甸县",530622:"巧家县",530623:"盐津县",530624:"大关县",530625:"永善县",530626:"绥江县",530627:"镇雄县",530628:"彝良县",530629:"威信县",530630:"水富县",530631:"其它区",530700:"丽江市",530702:"古城区",530721:"玉龙纳西族自治县",530722:"永胜县",530723:"华坪县",530724:"宁蒗彝族自治县",530725:"其它区",530800:"普洱市",530802:"思茅区",530821:"宁洱哈尼族彝族自治县",530822:"墨江哈尼族自治县",530823:"景东彝族自治县",530824:"景谷傣族彝族自治县",530825:"镇沅彝族哈尼族拉祜族自治县",530826:"江城哈尼族彝族自治县",530827:"孟连傣族拉祜族佤族自治县",530828:"澜沧拉祜族自治县",530829:"西盟佤族自治县",530830:"其它区",530900:"临沧市",530902:"临翔区",530921:"凤庆县",530922:"云县",530923:"永德县",530924:"镇康县",530925:"双江拉祜族佤族布朗族傣族自治县",530926:"耿马傣族佤族自治县",530927:"沧源佤族自治县",530928:"其它区",532300:"楚雄彝族自治州",532301:"楚雄市",532322:"双柏县",532323:"牟定县",532324:"南华县",532325:"姚安县",532326:"大姚县",532327:"永仁县",532328:"元谋县",532329:"武定县",532331:"禄丰县",532332:"其它区",532500:"红河哈尼族彝族自治州",532501:"个旧市",532502:"开远市",532522:"蒙自市",532523:"屏边苗族自治县",532524:"建水县",532525:"石屏县",532526:"弥勒市",532527:"泸西县",532528:"元阳县",532529:"红河县",532530:"金平苗族瑶族傣族自治县",532531:"绿春县",532532:"河口瑶族自治县",532533:"其它区",532600:"文山壮族苗族自治州",532621:"文山市",532622:"砚山县",532623:"西畴县",532624:"麻栗坡县",532625:"马关县",532626:"丘北县",532627:"广南县",532628:"富宁县",532629:"其它区",532800:"西双版纳傣族自治州",532801:"景洪市",532822:"勐海县",532823:"勐腊县",532824:"其它区",532900:"大理白族自治州",532901:"大理市",532922:"漾濞彝族自治县",532923:"祥云县",532924:"宾川县",532925:"弥渡县",532926:"南涧彝族自治县",532927:"巍山彝族回族自治县",532928:"永平县",532929:"云龙县",532930:"洱源县",532931:"剑川县",532932:"鹤庆县",532933:"其它区",533100:"德宏傣族景颇族自治州",533102:"瑞丽市",533103:"芒市",533122:"梁河县",533123:"盈江县",533124:"陇川县",533125:"其它区",533300:"怒江傈僳族自治州",533321:"泸水县",533323:"福贡县",533324:"贡山独龙族怒族自治县",533325:"兰坪白族普米族自治县",533326:"其它区",533400:"迪庆藏族自治州",533421:"香格里拉县",533422:"德钦县",533423:"维西傈僳族自治县",533424:"其它区",54e4:"西藏自治区",540100:"拉萨市",540102:"城关区",540121:"林周县",540122:"当雄县",540123:"尼木县",540124:"曲水县",540125:"堆龙德庆县",540126:"达孜县",540127:"墨竹工卡县",540128:"其它区",542100:"昌都地区",542121:"昌都县",542122:"江达县",542123:"贡觉县",542124:"类乌齐县",542125:"丁青县",542126:"察雅县",542127:"八宿县",542128:"左贡县",542129:"芒康县",542132:"洛隆县",542133:"边坝县",542134:"其它区",542200:"山南地区",542221:"乃东县",542222:"扎囊县",542223:"贡嘎县",542224:"桑日县",542225:"琼结县",542226:"曲松县",542227:"措美县",542228:"洛扎县",542229:"加查县",542231:"隆子县",542232:"错那县",542233:"浪卡子县",542234:"其它区",542300:"日喀则地区",542301:"日喀则市",542322:"南木林县",542323:"江孜县",542324:"定日县",542325:"萨迦县",542326:"拉孜县",542327:"昂仁县",542328:"谢通门县",542329:"白朗县",542330:"仁布县",542331:"康马县",542332:"定结县",542333:"仲巴县",542334:"亚东县",542335:"吉隆县",542336:"聂拉木县",542337:"萨嘎县",542338:"岗巴县",542339:"其它区",542400:"那曲地区",542421:"那曲县",542422:"嘉黎县",542423:"比如县",542424:"聂荣县",542425:"安多县",542426:"申扎县",542427:"索县",542428:"班戈县",542429:"巴青县",542430:"尼玛县",542431:"其它区",542432:"双湖县",542500:"阿里地区",542521:"普兰县",542522:"札达县",542523:"噶尔县",542524:"日土县",542525:"革吉县",542526:"改则县",542527:"措勤县",542528:"其它区",542600:"林芝地区",542621:"林芝县",542622:"工布江达县",542623:"米林县",542624:"墨脱县",542625:"波密县",542626:"察隅县",542627:"朗县",542628:"其它区",61e4:"陕西省",610100:"西安市",610102:"新城区",610103:"碑林区",610104:"莲湖区",610111:"灞桥区",610112:"未央区",610113:"雁塔区",610114:"阎良区",610115:"临潼区",610116:"长安区",610122:"蓝田县",610124:"周至县",610125:"户县",610126:"高陵县",610127:"其它区",610200:"铜川市",610202:"王益区",610203:"印台区",610204:"耀州区",610222:"宜君县",610223:"其它区",610300:"宝鸡市",610302:"渭滨区",610303:"金台区",610304:"陈仓区",610322:"凤翔县",610323:"岐山县",610324:"扶风县",610326:"眉县",610327:"陇县",610328:"千阳县",610329:"麟游县",610330:"凤县",610331:"太白县",610332:"其它区",610400:"咸阳市",610402:"秦都区",610403:"杨陵区",610404:"渭城区",610422:"三原县",610423:"泾阳县",610424:"乾县",610425:"礼泉县",610426:"永寿县",610427:"彬县",610428:"长武县",610429:"旬邑县",610430:"淳化县",610431:"武功县",610481:"兴平市",610482:"其它区",610500:"渭南市",610502:"临渭区",610521:"华县",610522:"潼关县",610523:"大荔县",610524:"合阳县",610525:"澄城县",610526:"蒲城县",610527:"白水县",610528:"富平县",610581:"韩城市",610582:"华阴市",610583:"其它区",610600:"延安市",610602:"宝塔区",610621:"延长县",610622:"延川县",610623:"子长县",610624:"安塞县",610625:"志丹县",610626:"吴起县",610627:"甘泉县",610628:"富县",610629:"洛川县",610630:"宜川县",610631:"黄龙县",610632:"黄陵县",610633:"其它区",610700:"汉中市",610702:"汉台区",610721:"南郑县",610722:"城固县",610723:"洋县",610724:"西乡县",610725:"勉县",610726:"宁强县",610727:"略阳县",610728:"镇巴县",610729:"留坝县",610730:"佛坪县",610731:"其它区",610800:"榆林市",610802:"榆阳区",610821:"神木县",610822:"府谷县",610823:"横山县",610824:"靖边县",610825:"定边县",610826:"绥德县",610827:"米脂县",610828:"佳县",610829:"吴堡县",610830:"清涧县",610831:"子洲县",610832:"其它区",610900:"安康市",610902:"汉滨区",610921:"汉阴县",610922:"石泉县",610923:"宁陕县",610924:"紫阳县",610925:"岚皋县",610926:"平利县",610927:"镇坪县",610928:"旬阳县",610929:"白河县",610930:"其它区",611e3:"商洛市",611002:"商州区",611021:"洛南县",611022:"丹凤县",611023:"商南县",611024:"山阳县",611025:"镇安县",611026:"柞水县",611027:"其它区",62e4:"甘肃省",620100:"兰州市",620102:"城关区",620103:"七里河区",620104:"西固区",620105:"安宁区",620111:"红古区",620121:"永登县",620122:"皋兰县",620123:"榆中县",620124:"其它区",620200:"嘉峪关市",620300:"金昌市",620302:"金川区",620321:"永昌县",620322:"其它区",620400:"白银市",620402:"白银区",620403:"平川区",620421:"靖远县",620422:"会宁县",620423:"景泰县",620424:"其它区",620500:"天水市",620502:"秦州区",620503:"麦积区",620521:"清水县",620522:"秦安县",620523:"甘谷县",620524:"武山县",620525:"张家川回族自治县",620526:"其它区",620600:"武威市",620602:"凉州区",620621:"民勤县",620622:"古浪县",620623:"天祝藏族自治县",620624:"其它区",620700:"张掖市",620702:"甘州区",620721:"肃南裕固族自治县",620722:"民乐县",620723:"临泽县",620724:"高台县",620725:"山丹县",620726:"其它区",620800:"平凉市",620802:"崆峒区",620821:"泾川县",620822:"灵台县",620823:"崇信县",620824:"华亭县",620825:"庄浪县",620826:"静宁县",620827:"其它区",620900:"酒泉市",620902:"肃州区",620921:"金塔县",620922:"瓜州县",620923:"肃北蒙古族自治县",620924:"阿克塞哈萨克族自治县",620981:"玉门市",620982:"敦煌市",620983:"其它区",621e3:"庆阳市",621002:"西峰区",621021:"庆城县",621022:"环县",621023:"华池县",621024:"合水县",621025:"正宁县",621026:"宁县",621027:"镇原县",621028:"其它区",621100:"定西市",621102:"安定区",621121:"通渭县",621122:"陇西县",621123:"渭源县",621124:"临洮县",621125:"漳县",621126:"岷县",621127:"其它区",621200:"陇南市",621202:"武都区",621221:"成县",621222:"文县",621223:"宕昌县",621224:"康县",621225:"西和县",621226:"礼县",621227:"徽县",621228:"两当县",621229:"其它区",622900:"临夏回族自治州",622901:"临夏市",622921:"临夏县",622922:"康乐县",622923:"永靖县",622924:"广河县",622925:"和政县",622926:"东乡族自治县",622927:"积石山保安族东乡族撒拉族自治县",622928:"其它区",623e3:"甘南藏族自治州",623001:"合作市",623021:"临潭县",623022:"卓尼县",623023:"舟曲县",623024:"迭部县",623025:"玛曲县",623026:"碌曲县",623027:"夏河县",623028:"其它区",63e4:"青海省",630100:"西宁市",630102:"城东区",630103:"城中区",630104:"城西区",630105:"城北区",630121:"大通回族土族自治县",630122:"湟中县",630123:"湟源县",630124:"其它区",632100:"海东市",632121:"平安县",632122:"民和回族土族自治县",632123:"乐都区",632126:"互助土族自治县",632127:"化隆回族自治县",632128:"循化撒拉族自治县",632129:"其它区",632200:"海北藏族自治州",632221:"门源回族自治县",632222:"祁连县",632223:"海晏县",632224:"刚察县",632225:"其它区",632300:"黄南藏族自治州",632321:"同仁县",632322:"尖扎县",632323:"泽库县",632324:"河南蒙古族自治县",632325:"其它区",632500:"海南藏族自治州",632521:"共和县",632522:"同德县",632523:"贵德县",632524:"兴海县",632525:"贵南县",632526:"其它区",632600:"果洛藏族自治州",632621:"玛沁县",632622:"班玛县",632623:"甘德县",632624:"达日县",632625:"久治县",632626:"玛多县",632627:"其它区",632700:"玉树藏族自治州",632721:"玉树市",632722:"杂多县",632723:"称多县",632724:"治多县",632725:"囊谦县",632726:"曲麻莱县",632727:"其它区",632800:"海西蒙古族藏族自治州",632801:"格尔木市",632802:"德令哈市",632821:"乌兰县",632822:"都兰县",632823:"天峻县",632824:"其它区",64e4:"宁夏回族自治区",640100:"银川市",640104:"兴庆区",640105:"西夏区",640106:"金凤区",640121:"永宁县",640122:"贺兰县",640181:"灵武市",640182:"其它区",640200:"石嘴山市",640202:"大武口区",640205:"惠农区",640221:"平罗县",640222:"其它区",640300:"吴忠市",640302:"利通区",640303:"红寺堡区",640323:"盐池县",640324:"同心县",640381:"青铜峡市",640382:"其它区",640400:"固原市",640402:"原州区",640422:"西吉县",640423:"隆德县",640424:"泾源县",640425:"彭阳县",640426:"其它区",640500:"中卫市",640502:"沙坡头区",640521:"中宁县",640522:"海原县",640523:"其它区",65e4:"新疆维吾尔自治区",650100:"乌鲁木齐市",650102:"天山区",650103:"沙依巴克区",650104:"新市区",650105:"水磨沟区",650106:"头屯河区",650107:"达坂城区",650109:"米东区",650121:"乌鲁木齐县",650122:"其它区",650200:"克拉玛依市",650202:"独山子区",650203:"克拉玛依区",650204:"白碱滩区",650205:"乌尔禾区",650206:"其它区",652100:"吐鲁番地区",652101:"吐鲁番市",652122:"鄯善县",652123:"托克逊县",652124:"其它区",652200:"哈密地区",652201:"哈密市",652222:"巴里坤哈萨克自治县",652223:"伊吾县",652224:"其它区",652300:"昌吉回族自治州",652301:"昌吉市",652302:"阜康市",652323:"呼图壁县",652324:"玛纳斯县",652325:"奇台县",652327:"吉木萨尔县",652328:"木垒哈萨克自治县",652329:"其它区",652700:"博尔塔拉蒙古自治州",652701:"博乐市",652702:"阿拉山口市",652722:"精河县",652723:"温泉县",652724:"其它区",652800:"巴音郭楞蒙古自治州",652801:"库尔勒市",652822:"轮台县",652823:"尉犁县",652824:"若羌县",652825:"且末县",652826:"焉耆回族自治县",652827:"和静县",652828:"和硕县",652829:"博湖县",652830:"其它区",652900:"阿克苏地区",652901:"阿克苏市",652922:"温宿县",652923:"库车县",652924:"沙雅县",652925:"新和县",652926:"拜城县",652927:"乌什县",652928:"阿瓦提县",652929:"柯坪县",652930:"其它区",653e3:"克孜勒苏柯尔克孜自治州",653001:"阿图什市",653022:"阿克陶县",653023:"阿合奇县",653024:"乌恰县",653025:"其它区",653100:"喀什地区",653101:"喀什市",653121:"疏附县",653122:"疏勒县",653123:"英吉沙县",653124:"泽普县",653125:"莎车县",653126:"叶城县",653127:"麦盖提县",653128:"岳普湖县",653129:"伽师县",653130:"巴楚县",653131:"塔什库尔干塔吉克自治县",653132:"其它区",653200:"和田地区",653201:"和田市",653221:"和田县",653222:"墨玉县",653223:"皮山县",653224:"洛浦县",653225:"策勒县",653226:"于田县",653227:"民丰县",653228:"其它区",654e3:"伊犁哈萨克自治州",654002:"伊宁市",654003:"奎屯市",654021:"伊宁县",654022:"察布查尔锡伯自治县",654023:"霍城县",654024:"巩留县",654025:"新源县",654026:"昭苏县",654027:"特克斯县",654028:"尼勒克县",654029:"其它区",654200:"塔城地区",654201:"塔城市",654202:"乌苏市",654221:"额敏县",654223:"沙湾县",654224:"托里县",654225:"裕民县",654226:"和布克赛尔蒙古自治县",654227:"其它区",654300:"阿勒泰地区",654301:"阿勒泰市",654321:"布尔津县",654322:"富蕴县",654323:"福海县",654324:"哈巴河县",654325:"青河县",654326:"吉木乃县",654327:"其它区",659001:"石河子市",659002:"阿拉尔市",659003:"图木舒克市",659004:"五家渠市",71e4:"台湾",710100:"台北市",710101:"中正区",710102:"大同区",710103:"中山区",710104:"松山区",710105:"大安区",710106:"万华区",710107:"信义区",710108:"士林区",710109:"北投区",710110:"内湖区",710111:"南港区",710112:"文山区",710113:"其它区",710200:"高雄市",710201:"新兴区",710202:"前金区",710203:"芩雅区",710204:"盐埕区",710205:"鼓山区",710206:"旗津区",710207:"前镇区",710208:"三民区",710209:"左营区",710210:"楠梓区",710211:"小港区",710212:"其它区",710241:"苓雅区",710242:"仁武区",710243:"大社区",710244:"冈山区",710245:"路竹区",710246:"阿莲区",710247:"田寮区",710248:"燕巢区",710249:"桥头区",710250:"梓官区",710251:"弥陀区",710252:"永安区",710253:"湖内区",710254:"凤山区",710255:"大寮区",710256:"林园区",710257:"鸟松区",710258:"大树区",710259:"旗山区",710260:"美浓区",710261:"六龟区",710262:"内门区",710263:"杉林区",710264:"甲仙区",710265:"桃源区",710266:"那玛夏区",710267:"茂林区",710268:"茄萣区",710300:"台南市",710301:"中西区",710302:"东区",710303:"南区",710304:"北区",710305:"安平区",710306:"安南区",710307:"其它区",710339:"永康区",710340:"归仁区",710341:"新化区",710342:"左镇区",710343:"玉井区",710344:"楠西区",710345:"南化区",710346:"仁德区",710347:"关庙区",710348:"龙崎区",710349:"官田区",710350:"麻豆区",710351:"佳里区",710352:"西港区",710353:"七股区",710354:"将军区",710355:"学甲区",710356:"北门区",710357:"新营区",710358:"后壁区",710359:"白河区",710360:"东山区",710361:"六甲区",710362:"下营区",710363:"柳营区",710364:"盐水区",710365:"善化区",710366:"大内区",710367:"山上区",710368:"新市区",710369:"安定区",710400:"台中市",710401:"中区",710402:"东区",710403:"南区",710404:"西区",710405:"北区",710406:"北屯区",710407:"西屯区",710408:"南屯区",710409:"其它区",710431:"太平区",710432:"大里区",710433:"雾峰区",710434:"乌日区",710435:"丰原区",710436:"后里区",710437:"石冈区",710438:"东势区",710439:"和平区",710440:"新社区",710441:"潭子区",710442:"大雅区",710443:"神冈区",710444:"大肚区",710445:"沙鹿区",710446:"龙井区",710447:"梧栖区",710448:"清水区",710449:"大甲区",710450:"外埔区",710451:"大安区",710500:"金门县",710507:"金沙镇",710508:"金湖镇",710509:"金宁乡",710510:"金城镇",710511:"烈屿乡",710512:"乌坵乡",710600:"南投县",710614:"南投市",710615:"中寮乡",710616:"草屯镇",710617:"国姓乡",710618:"埔里镇",710619:"仁爱乡",710620:"名间乡",710621:"集集镇",710622:"水里乡",710623:"鱼池乡",710624:"信义乡",710625:"竹山镇",710626:"鹿谷乡",710700:"基隆市",710701:"仁爱区",710702:"信义区",710703:"中正区",710704:"中山区",710705:"安乐区",710706:"暖暖区",710707:"七堵区",710708:"其它区",710800:"新竹市",710801:"东区",710802:"北区",710803:"香山区",710804:"其它区",710900:"嘉义市",710901:"东区",710902:"西区",710903:"其它区",711100:"新北市",711130:"万里区",711131:"金山区",711132:"板桥区",711133:"汐止区",711134:"深坑区",711135:"石碇区",711136:"瑞芳区",711137:"平溪区",711138:"双溪区",711139:"贡寮区",711140:"新店区",711141:"坪林区",711142:"乌来区",711143:"永和区",711144:"中和区",711145:"土城区",711146:"三峡区",711147:"树林区",711148:"莺歌区",711149:"三重区",711150:"新庄区",711151:"泰山区",711152:"林口区",711153:"芦洲区",711154:"五股区",711155:"八里区",711156:"淡水区",711157:"三芝区",711158:"石门区",711200:"宜兰县",711214:"宜兰市",711215:"头城镇",711216:"礁溪乡",711217:"壮围乡",711218:"员山乡",711219:"罗东镇",711220:"三星乡",711221:"大同乡",711222:"五结乡",711223:"冬山乡",711224:"苏澳镇",711225:"南澳乡",711226:"钓鱼台",711300:"新竹县",711314:"竹北市",711315:"湖口乡",711316:"新丰乡",711317:"新埔镇",711318:"关西镇",711319:"芎林乡",711320:"宝山乡",711321:"竹东镇",711322:"五峰乡",711323:"横山乡",711324:"尖石乡",711325:"北埔乡",711326:"峨眉乡",711400:"桃园县",711414:"中坜市",711415:"平镇市",711416:"龙潭乡",711417:"杨梅市",711418:"新屋乡",711419:"观音乡",711420:"桃园市",711421:"龟山乡",711422:"八德市",711423:"大溪镇",711424:"复兴乡",711425:"大园乡",711426:"芦竹乡",711500:"苗栗县",711519:"竹南镇",711520:"头份镇",711521:"三湾乡",711522:"南庄乡",711523:"狮潭乡",711524:"后龙镇",711525:"通霄镇",711526:"苑里镇",711527:"苗栗市",711528:"造桥乡",711529:"头屋乡",711530:"公馆乡",711531:"大湖乡",711532:"泰安乡",711533:"铜锣乡",711534:"三义乡",711535:"西湖乡",711536:"卓兰镇",711700:"彰化县",711727:"彰化市",711728:"芬园乡",711729:"花坛乡",711730:"秀水乡",711731:"鹿港镇",711732:"福兴乡",711733:"线西乡",711734:"和美镇",711735:"伸港乡",711736:"员林镇",711737:"社头乡",711738:"永靖乡",711739:"埔心乡",711740:"溪湖镇",711741:"大村乡",711742:"埔盐乡",711743:"田中镇",711744:"北斗镇",711745:"田尾乡",711746:"埤头乡",711747:"溪州乡",711748:"竹塘乡",711749:"二林镇",711750:"大城乡",711751:"芳苑乡",711752:"二水乡",711900:"嘉义县",711919:"番路乡",711920:"梅山乡",711921:"竹崎乡",711922:"阿里山乡",711923:"中埔乡",711924:"大埔乡",711925:"水上乡",711926:"鹿草乡",711927:"太保市",711928:"朴子市",711929:"东石乡",711930:"六脚乡",711931:"新港乡",711932:"民雄乡",711933:"大林镇",711934:"溪口乡",711935:"义竹乡",711936:"布袋镇",712100:"云林县",712121:"斗南镇",712122:"大埤乡",712123:"虎尾镇",712124:"土库镇",712125:"褒忠乡",712126:"东势乡",712127:"台西乡",712128:"仑背乡",712129:"麦寮乡",712130:"斗六市",712131:"林内乡",712132:"古坑乡",712133:"莿桐乡",712134:"西螺镇",712135:"二仑乡",712136:"北港镇",712137:"水林乡",712138:"口湖乡",712139:"四湖乡",712140:"元长乡",712400:"屏东县",712434:"屏东市",712435:"三地门乡",712436:"雾台乡",712437:"玛家乡",712438:"九如乡",712439:"里港乡",712440:"高树乡",712441:"盐埔乡",712442:"长治乡",712443:"麟洛乡",712444:"竹田乡",712445:"内埔乡",712446:"万丹乡",712447:"潮州镇",712448:"泰武乡",712449:"来义乡",712450:"万峦乡",712451:"崁顶乡",712452:"新埤乡",712453:"南州乡",712454:"林边乡",712455:"东港镇",712456:"琉球乡",712457:"佳冬乡",712458:"新园乡",712459:"枋寮乡",712460:"枋山乡",712461:"春日乡",712462:"狮子乡",712463:"车城乡",712464:"牡丹乡",712465:"恒春镇",712466:"满州乡",712500:"台东县",712517:"台东市",712518:"绿岛乡",712519:"兰屿乡",712520:"延平乡",712521:"卑南乡",712522:"鹿野乡",712523:"关山镇",712524:"海端乡",712525:"池上乡",712526:"东河乡",712527:"成功镇",712528:"长滨乡",712529:"金峰乡",712530:"大武乡",712531:"达仁乡",712532:"太麻里乡",712600:"花莲县",712615:"花莲市",712616:"新城乡",712617:"太鲁阁",712618:"秀林乡",712619:"吉安乡",712620:"寿丰乡",712621:"凤林镇",712622:"光复乡",712623:"丰滨乡",712624:"瑞穗乡",712625:"万荣乡",712626:"玉里镇",712627:"卓溪乡",712628:"富里乡",712700:"澎湖县",712707:"马公市",712708:"西屿乡",712709:"望安乡",712710:"七美乡",712711:"白沙乡",712712:"湖西乡",712800:"连江县",712805:"南竿乡",712806:"北竿乡",712807:"莒光乡",712808:"东引乡",81e4:"香港特别行政区",810100:"香港岛",810101:"中西区",810102:"湾仔",810103:"东区",810104:"南区",810200:"九龙",810201:"九龙城区",810202:"油尖旺区",810203:"深水埗区",810204:"黄大仙区",810205:"观塘区",810300:"新界",810301:"北区",810302:"大埔区",810303:"沙田区",810304:"西贡区",810305:"元朗区",810306:"屯门区",810307:"荃湾区",810308:"葵青区",810309:"离岛区",82e4:"澳门特别行政区",820100:"澳门半岛",820200:"离岛",99e4:"海外",990100:"海外"};function n(o){for(var s={},l=0,u;l<o.length;l++)u=o[l],!(!u||!u.id)&&(s[u.id]=u);for(var c=[],d=0;d<o.length;d++)if(u=o[d],!!u){if(u.pid==null&&u.parentId==null){c.push(u);continue}var f=s[u.pid]||s[u.parentId];f&&(f.children||(f.children=[]),f.children.push(u))}return c}var a=function(){var o=[];for(var s in e){var l=s.slice(2,6)==="0000"?void 0:s.slice(4,6)=="00"?s.slice(0,2)+"0000":s.slice(0,4)+"00";o.push({id:s,pid:l,name:e[s]})}return n(o)}();t.exports=a},function(t,r,e){var n=e(18);t.exports={d4:function(){return this.natural(1,4)},d6:function(){return this.natural(1,6)},d8:function(){return this.natural(1,8)},d12:function(){return this.natural(1,12)},d20:function(){return this.natural(1,20)},d100:function(){return this.natural(1,100)},guid:function(){var a="abcdefABCDEF1234567890",o=this.string(a,8)+"-"+this.string(a,4)+"-"+this.string(a,4)+"-"+this.string(a,4)+"-"+this.string(a,12);return o},uuid:function(){return this.guid()},id:function(){var a,o=0,s=["7","9","10","5","8","4","2","1","6","3","7","9","10","5","8","4","2"],l=["1","0","X","9","8","7","6","5","4","3","2"];a=this.pick(n).id+this.date("yyyyMMdd")+this.string("number",3);for(var u=0;u<a.length;u++)o+=a[u]*s[u];return a+=l[o%11],a},increment:function(){var a=0;return function(o){return a+=+o||1}}(),inc:function(a){return this.increment(a)}}},function(t,r,e){var n=e(21),a=e(22);t.exports={Parser:n,Handler:a}},function(t,r){function e(R){this.type=R,this.offset=e.offset(),this.text=e.text()}function n(R,T){e.call(this,"alternate"),this.left=R,this.right=T}function a(R){e.call(this,"match"),this.body=R.filter(Boolean)}function o(R,T){e.call(this,R),this.body=T}function s(R){o.call(this,"capture-group"),this.index=w[this.offset]||(w[this.offset]=S++),this.body=R}function l(R,T){e.call(this,"quantified"),this.body=R,this.quantifier=T}function u(R,T){e.call(this,"quantifier"),this.min=R,this.max=T,this.greedy=!0}function c(R,T){e.call(this,"charset"),this.invert=R,this.body=T}function d(R,T){e.call(this,"range"),this.start=R,this.end=T}function f(R){e.call(this,"literal"),this.body=R,this.escaped=this.body!=this.text}function h(R){e.call(this,"unicode"),this.code=R.toUpperCase()}function p(R){e.call(this,"hex"),this.code=R.toUpperCase()}function v(R){e.call(this,"octal"),this.code=R.toUpperCase()}function g(R){e.call(this,"back-reference"),this.code=R.toUpperCase()}function y(R){e.call(this,"control-character"),this.code=R.toUpperCase()}var m=function(){function R(b,L){function M(){this.constructor=b}M.prototype=L.prototype,b.prototype=new M}function T(b,L,M,D,N){function F(k,H){function G(W){function V(X){return X.charCodeAt(0).toString(16).toUpperCase()}return W.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(X){return"\\x0"+V(X)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(X){return"\\x"+V(X)}).replace(/[\u0180-\u0FFF]/g,function(X){return"\\u0"+V(X)}).replace(/[\u1080-\uFFFF]/g,function(X){return"\\u"+V(X)})}var z,$;switch(k.length){case 0:z="end of input";break;case 1:z=k[0];break;default:z=k.slice(0,-1).join(", ")+" or "+k[k.length-1]}return $=H?'"'+G(H)+'"':"end of input","Expected "+z+" but "+$+" found."}this.expected=b,this.found=L,this.offset=M,this.line=D,this.column=N,this.name="SyntaxError",this.message=F(b,L)}function x(b){function L(){return b.substring(Z,I)}function M(){return Z}function D(E){function O(U,K,ee){var he,_e;for(he=K;ee>he;he++)_e=b.charAt(he),_e===`
`?(U.seenCR||U.line++,U.column=1,U.seenCR=!1):_e==="\r"||_e==="\u2028"||_e==="\u2029"?(U.line++,U.column=1,U.seenCR=!0):(U.column++,U.seenCR=!1)}return Ce!==E&&(Ce>E&&(Ce=0,Ge={line:1,column:1,seenCR:!1}),O(Ge,Ce,E),Ce=E),Ge}function N(E){Pe>I||(I>Pe&&(Pe=I,Ne=[]),Ne.push(E))}function F(E){var O=0;for(E.sort();O<E.length;)E[O-1]===E[O]?E.splice(O,1):O++}function k(){var E,O,U,K,ee;return E=I,O=H(),O!==null?(U=I,b.charCodeAt(I)===124?(K=$t,I++):(K=null,Y===0&&N(Gt)),K!==null?(ee=k(),ee!==null?(K=[K,ee],U=K):(I=U,U=q)):(I=U,U=q),U===null&&(U=ge),U!==null?(Z=E,O=zt(O,U),O===null&&(I=E),E=O):(I=E,E=q)):(I=E,E=q),E}function H(){var E,O,U,K,ee;if(E=I,O=z(),O===null&&(O=ge),O!==null)if(U=I,Y++,K=V(),Y--,K===null?U=ge:(I=U,U=q),U!==null){for(K=[],ee=W(),ee===null&&(ee=G());ee!==null;)K.push(ee),ee=W(),ee===null&&(ee=G());K!==null?(ee=$(),ee===null&&(ee=ge),ee!==null?(Z=E,O=Ut(O,K,ee),O===null&&(I=E),E=O):(I=E,E=q)):(I=E,E=q)}else I=E,E=q;else I=E,E=q;return E}function G(){var E;return E=le(),E===null&&(E=Ee(),E===null&&(E=Te())),E}function z(){var E,O;return E=I,b.charCodeAt(I)===94?(O=at,I++):(O=null,Y===0&&N(ot)),O!==null&&(Z=E,O=Wt()),O===null&&(I=E),E=O,E}function $(){var E,O;return E=I,b.charCodeAt(I)===36?(O=Vt,I++):(O=null,Y===0&&N(Yt)),O!==null&&(Z=E,O=Xt()),O===null&&(I=E),E=O,E}function W(){var E,O,U;return E=I,O=G(),O!==null?(U=V(),U!==null?(Z=E,O=Kt(O,U),O===null&&(I=E),E=O):(I=E,E=q)):(I=E,E=q),E}function V(){var E,O,U;return Y++,E=I,O=X(),O!==null?(U=oe(),U===null&&(U=ge),U!==null?(Z=E,O=jt(O,U),O===null&&(I=E),E=O):(I=E,E=q)):(I=E,E=q),Y--,E===null&&(O=null,Y===0&&N(qt)),E}function X(){var E;return E=J(),E===null&&(E=j(),E===null&&(E=ne(),E===null&&(E=Q(),E===null&&(E=ie(),E===null&&(E=te()))))),E}function J(){var E,O,U,K,ee,he;return E=I,b.charCodeAt(I)===123?(O=ke,I++):(O=null,Y===0&&N(He)),O!==null?(U=ae(),U!==null?(b.charCodeAt(I)===44?(K=Zt,I++):(K=null,Y===0&&N(Jt)),K!==null?(ee=ae(),ee!==null?(b.charCodeAt(I)===125?(he=st,I++):(he=null,Y===0&&N(lt)),he!==null?(Z=E,O=Qt(U,ee),O===null&&(I=E),E=O):(I=E,E=q)):(I=E,E=q)):(I=E,E=q)):(I=E,E=q)):(I=E,E=q),E}function j(){var E,O,U,K;return E=I,b.charCodeAt(I)===123?(O=ke,I++):(O=null,Y===0&&N(He)),O!==null?(U=ae(),U!==null?(b.substr(I,2)===ut?(K=ut,I+=2):(K=null,Y===0&&N(er)),K!==null?(Z=E,O=tr(U),O===null&&(I=E),E=O):(I=E,E=q)):(I=E,E=q)):(I=E,E=q),E}function ne(){var E,O,U,K;return E=I,b.charCodeAt(I)===123?(O=ke,I++):(O=null,Y===0&&N(He)),O!==null?(U=ae(),U!==null?(b.charCodeAt(I)===125?(K=st,I++):(K=null,Y===0&&N(lt)),K!==null?(Z=E,O=rr(U),O===null&&(I=E),E=O):(I=E,E=q)):(I=E,E=q)):(I=E,E=q),E}function Q(){var E,O;return E=I,b.charCodeAt(I)===43?(O=nr,I++):(O=null,Y===0&&N(ir)),O!==null&&(Z=E,O=ar()),O===null&&(I=E),E=O,E}function ie(){var E,O;return E=I,b.charCodeAt(I)===42?(O=or,I++):(O=null,Y===0&&N(sr)),O!==null&&(Z=E,O=lr()),O===null&&(I=E),E=O,E}function te(){var E,O;return E=I,b.charCodeAt(I)===63?(O=ct,I++):(O=null,Y===0&&N(dt)),O!==null&&(Z=E,O=ur()),O===null&&(I=E),E=O,E}function oe(){var E;return b.charCodeAt(I)===63?(E=ct,I++):(E=null,Y===0&&N(dt)),E}function ae(){var E,O,U;if(E=I,O=[],ft.test(b.charAt(I))?(U=b.charAt(I),I++):(U=null,Y===0&&N(ht)),U!==null)for(;U!==null;)O.push(U),ft.test(b.charAt(I))?(U=b.charAt(I),I++):(U=null,Y===0&&N(ht));else O=q;return O!==null&&(Z=E,O=cr(O)),O===null&&(I=E),E=O,E}function le(){var E,O,U,K;return E=I,b.charCodeAt(I)===40?(O=dr,I++):(O=null,Y===0&&N(fr)),O!==null?(U=pe(),U===null&&(U=ye(),U===null&&(U=fe(),U===null&&(U=se()))),U!==null?(b.charCodeAt(I)===41?(K=hr,I++):(K=null,Y===0&&N(pr)),K!==null?(Z=E,O=vr(U),O===null&&(I=E),E=O):(I=E,E=q)):(I=E,E=q)):(I=E,E=q),E}function se(){var E,O;return E=I,O=k(),O!==null&&(Z=E,O=gr(O)),O===null&&(I=E),E=O,E}function fe(){var E,O,U;return E=I,b.substr(I,2)===pt?(O=pt,I+=2):(O=null,Y===0&&N(yr)),O!==null?(U=k(),U!==null?(Z=E,O=mr(U),O===null&&(I=E),E=O):(I=E,E=q)):(I=E,E=q),E}function pe(){var E,O,U;return E=I,b.substr(I,2)===vt?(O=vt,I+=2):(O=null,Y===0&&N(Cr)),O!==null?(U=k(),U!==null?(Z=E,O=_r(U),O===null&&(I=E),E=O):(I=E,E=q)):(I=E,E=q),E}function ye(){var E,O,U;return E=I,b.substr(I,2)===gt?(O=gt,I+=2):(O=null,Y===0&&N(Er)),O!==null?(U=k(),U!==null?(Z=E,O=Sr(U),O===null&&(I=E),E=O):(I=E,E=q)):(I=E,E=q),E}function Ee(){var E,O,U,K,ee;if(Y++,E=I,b.charCodeAt(I)===91?(O=Tr,I++):(O=null,Y===0&&N(wr)),O!==null)if(b.charCodeAt(I)===94?(U=at,I++):(U=null,Y===0&&N(ot)),U===null&&(U=ge),U!==null){for(K=[],ee=me(),ee===null&&(ee=ue());ee!==null;)K.push(ee),ee=me(),ee===null&&(ee=ue());K!==null?(b.charCodeAt(I)===93?(ee=br,I++):(ee=null,Y===0&&N(Rr)),ee!==null?(Z=E,O=Ar(U,K),O===null&&(I=E),E=O):(I=E,E=q)):(I=E,E=q)}else I=E,E=q;else I=E,E=q;return Y--,E===null&&(O=null,Y===0&&N(xr)),E}function me(){var E,O,U,K;return Y++,E=I,O=ue(),O!==null?(b.charCodeAt(I)===45?(U=Lr,I++):(U=null,Y===0&&N(Mr)),U!==null?(K=ue(),K!==null?(Z=E,O=Ir(O,K),O===null&&(I=E),E=O):(I=E,E=q)):(I=E,E=q)):(I=E,E=q),Y--,E===null&&(O=null,Y===0&&N(Or)),E}function ue(){var E;return Y++,E=xe(),E===null&&(E=Se()),Y--,E===null&&Y===0&&N(Pr),E}function Se(){var E,O;return E=I,Nr.test(b.charAt(I))?(O=b.charAt(I),I++):(O=null,Y===0&&N(Dr)),O!==null&&(Z=E,O=$e(O)),O===null&&(I=E),E=O,E}function xe(){var E;return E=de(),E===null&&(E=Ze(),E===null&&(E=be(),E===null&&(E=Re(),E===null&&(E=ze(),E===null&&(E=Ue(),E===null&&(E=We(),E===null&&(E=Ve(),E===null&&(E=Ye(),E===null&&(E=Xe(),E===null&&(E=Ke(),E===null&&(E=qe(),E===null&&(E=je(),E===null&&(E=Je(),E===null&&(E=Qe(),E===null&&(E=et(),E===null&&(E=tt(),E===null&&(E=rt()))))))))))))))))),E}function Te(){var E;return E=ve(),E===null&&(E=ce(),E===null&&(E=we())),E}function ve(){var E,O;return E=I,b.charCodeAt(I)===46?(O=Br,I++):(O=null,Y===0&&N(Fr)),O!==null&&(Z=E,O=kr()),O===null&&(I=E),E=O,E}function we(){var E,O;return Y++,E=I,$r.test(b.charAt(I))?(O=b.charAt(I),I++):(O=null,Y===0&&N(Gr)),O!==null&&(Z=E,O=$e(O)),O===null&&(I=E),E=O,Y--,E===null&&(O=null,Y===0&&N(Hr)),E}function ce(){var E;return E=De(),E===null&&(E=Be(),E===null&&(E=Ze(),E===null&&(E=be(),E===null&&(E=Re(),E===null&&(E=ze(),E===null&&(E=Ue(),E===null&&(E=We(),E===null&&(E=Ve(),E===null&&(E=Ye(),E===null&&(E=Xe(),E===null&&(E=Ke(),E===null&&(E=qe(),E===null&&(E=je(),E===null&&(E=Ht(),E===null&&(E=Je(),E===null&&(E=Qe(),E===null&&(E=et(),E===null&&(E=tt(),E===null&&(E=rt()))))))))))))))))))),E}function de(){var E,O;return E=I,b.substr(I,2)===Oe?(O=Oe,I+=2):(O=null,Y===0&&N(yt)),O!==null&&(Z=E,O=zr()),O===null&&(I=E),E=O,E}function De(){var E,O;return E=I,b.substr(I,2)===Oe?(O=Oe,I+=2):(O=null,Y===0&&N(yt)),O!==null&&(Z=E,O=Ur()),O===null&&(I=E),E=O,E}function Be(){var E,O;return E=I,b.substr(I,2)===mt?(O=mt,I+=2):(O=null,Y===0&&N(Wr)),O!==null&&(Z=E,O=Vr()),O===null&&(I=E),E=O,E}function be(){var E,O;return E=I,b.substr(I,2)===Ct?(O=Ct,I+=2):(O=null,Y===0&&N(Yr)),O!==null&&(Z=E,O=Xr()),O===null&&(I=E),E=O,E}function Re(){var E,O;return E=I,b.substr(I,2)===_t?(O=_t,I+=2):(O=null,Y===0&&N(Kr)),O!==null&&(Z=E,O=qr()),O===null&&(I=E),E=O,E}function ze(){var E,O;return E=I,b.substr(I,2)===Et?(O=Et,I+=2):(O=null,Y===0&&N(jr)),O!==null&&(Z=E,O=Zr()),O===null&&(I=E),E=O,E}function Ue(){var E,O;return E=I,b.substr(I,2)===St?(O=St,I+=2):(O=null,Y===0&&N(Jr)),O!==null&&(Z=E,O=Qr()),O===null&&(I=E),E=O,E}function We(){var E,O;return E=I,b.substr(I,2)===xt?(O=xt,I+=2):(O=null,Y===0&&N(en)),O!==null&&(Z=E,O=tn()),O===null&&(I=E),E=O,E}function Ve(){var E,O;return E=I,b.substr(I,2)===Tt?(O=Tt,I+=2):(O=null,Y===0&&N(rn)),O!==null&&(Z=E,O=nn()),O===null&&(I=E),E=O,E}function Ye(){var E,O;return E=I,b.substr(I,2)===wt?(O=wt,I+=2):(O=null,Y===0&&N(an)),O!==null&&(Z=E,O=on()),O===null&&(I=E),E=O,E}function Xe(){var E,O;return E=I,b.substr(I,2)===bt?(O=bt,I+=2):(O=null,Y===0&&N(sn)),O!==null&&(Z=E,O=un()),O===null&&(I=E),E=O,E}function Ke(){var E,O;return E=I,b.substr(I,2)===Rt?(O=Rt,I+=2):(O=null,Y===0&&N(cn)),O!==null&&(Z=E,O=dn()),O===null&&(I=E),E=O,E}function qe(){var E,O;return E=I,b.substr(I,2)===At?(O=At,I+=2):(O=null,Y===0&&N(fn)),O!==null&&(Z=E,O=hn()),O===null&&(I=E),E=O,E}function je(){var E,O;return E=I,b.substr(I,2)===Ot?(O=Ot,I+=2):(O=null,Y===0&&N(pn)),O!==null&&(Z=E,O=vn()),O===null&&(I=E),E=O,E}function Ze(){var E,O,U;return E=I,b.substr(I,2)===Lt?(O=Lt,I+=2):(O=null,Y===0&&N(gn)),O!==null?(b.length>I?(U=b.charAt(I),I++):(U=null,Y===0&&N(Mt)),U!==null?(Z=E,O=yn(U),O===null&&(I=E),E=O):(I=E,E=q)):(I=E,E=q),E}function Ht(){var E,O,U;return E=I,b.charCodeAt(I)===92?(O=It,I++):(O=null,Y===0&&N(Pt)),O!==null?(mn.test(b.charAt(I))?(U=b.charAt(I),I++):(U=null,Y===0&&N(Cn)),U!==null?(Z=E,O=_n(U),O===null&&(I=E),E=O):(I=E,E=q)):(I=E,E=q),E}function Je(){var E,O,U,K;if(E=I,b.substr(I,2)===Le?(O=Le,I+=2):(O=null,Y===0&&N(Nt)),O!==null){if(U=[],Dt.test(b.charAt(I))?(K=b.charAt(I),I++):(K=null,Y===0&&N(Bt)),K!==null)for(;K!==null;)U.push(K),Dt.test(b.charAt(I))?(K=b.charAt(I),I++):(K=null,Y===0&&N(Bt));else U=q;U!==null?(Z=E,O=En(U),O===null&&(I=E),E=O):(I=E,E=q)}else I=E,E=q;return E}function Qe(){var E,O,U,K;if(E=I,b.substr(I,2)===Ft?(O=Ft,I+=2):(O=null,Y===0&&N(Sn)),O!==null){if(U=[],Me.test(b.charAt(I))?(K=b.charAt(I),I++):(K=null,Y===0&&N(Ie)),K!==null)for(;K!==null;)U.push(K),Me.test(b.charAt(I))?(K=b.charAt(I),I++):(K=null,Y===0&&N(Ie));else U=q;U!==null?(Z=E,O=xn(U),O===null&&(I=E),E=O):(I=E,E=q)}else I=E,E=q;return E}function et(){var E,O,U,K;if(E=I,b.substr(I,2)===kt?(O=kt,I+=2):(O=null,Y===0&&N(Tn)),O!==null){if(U=[],Me.test(b.charAt(I))?(K=b.charAt(I),I++):(K=null,Y===0&&N(Ie)),K!==null)for(;K!==null;)U.push(K),Me.test(b.charAt(I))?(K=b.charAt(I),I++):(K=null,Y===0&&N(Ie));else U=q;U!==null?(Z=E,O=wn(U),O===null&&(I=E),E=O):(I=E,E=q)}else I=E,E=q;return E}function tt(){var E,O;return E=I,b.substr(I,2)===Le?(O=Le,I+=2):(O=null,Y===0&&N(Nt)),O!==null&&(Z=E,O=bn()),O===null&&(I=E),E=O,E}function rt(){var E,O,U;return E=I,b.charCodeAt(I)===92?(O=It,I++):(O=null,Y===0&&N(Pt)),O!==null?(b.length>I?(U=b.charAt(I),I++):(U=null,Y===0&&N(Mt)),U!==null?(Z=E,O=$e(U),O===null&&(I=E),E=O):(I=E,E=q)):(I=E,E=q),E}var Fe,Ae=arguments.length>1?arguments[1]:{},nt={regexp:k},it=k,q=null,ge="",$t="|",Gt='"|"',zt=function(E,O){return O?new n(E,O[1]):E},Ut=function(E,O,U){return new a([E].concat(O).concat([U]))},at="^",ot='"^"',Wt=function(){return new e("start")},Vt="$",Yt='"$"',Xt=function(){return new e("end")},Kt=function(E,O){return new l(E,O)},qt="Quantifier",jt=function(E,O){return O&&(E.greedy=!1),E},ke="{",He='"{"',Zt=",",Jt='","',st="}",lt='"}"',Qt=function(E,O){return new u(E,O)},ut=",}",er='",}"',tr=function(E){return new u(E,1/0)},rr=function(E){return new u(E,E)},nr="+",ir='"+"',ar=function(){return new u(1,1/0)},or="*",sr='"*"',lr=function(){return new u(0,1/0)},ct="?",dt='"?"',ur=function(){return new u(0,1)},ft=/^[0-9]/,ht="[0-9]",cr=function(E){return+E.join("")},dr="(",fr='"("',hr=")",pr='")"',vr=function(E){return E},gr=function(E){return new s(E)},pt="?:",yr='"?:"',mr=function(E){return new o("non-capture-group",E)},vt="?=",Cr='"?="',_r=function(E){return new o("positive-lookahead",E)},gt="?!",Er='"?!"',Sr=function(E){return new o("negative-lookahead",E)},xr="CharacterSet",Tr="[",wr='"["',br="]",Rr='"]"',Ar=function(E,O){return new c(!!E,O)},Or="CharacterRange",Lr="-",Mr='"-"',Ir=function(E,O){return new d(E,O)},Pr="Character",Nr=/^[^\\\]]/,Dr="[^\\\\\\]]",$e=function(E){return new f(E)},Br=".",Fr='"."',kr=function(){return new e("any-character")},Hr="Literal",$r=/^[^|\\\/.[()?+*$\^]/,Gr="[^|\\\\\\/.[()?+*$\\^]",Oe="\\b",yt='"\\\\b"',zr=function(){return new e("backspace")},Ur=function(){return new e("word-boundary")},mt="\\B",Wr='"\\\\B"',Vr=function(){return new e("non-word-boundary")},Ct="\\d",Yr='"\\\\d"',Xr=function(){return new e("digit")},_t="\\D",Kr='"\\\\D"',qr=function(){return new e("non-digit")},Et="\\f",jr='"\\\\f"',Zr=function(){return new e("form-feed")},St="\\n",Jr='"\\\\n"',Qr=function(){return new e("line-feed")},xt="\\r",en='"\\\\r"',tn=function(){return new e("carriage-return")},Tt="\\s",rn='"\\\\s"',nn=function(){return new e("white-space")},wt="\\S",an='"\\\\S"',on=function(){return new e("non-white-space")},bt="\\t",sn='"\\\\t"',un=function(){return new e("tab")},Rt="\\v",cn='"\\\\v"',dn=function(){return new e("vertical-tab")},At="\\w",fn='"\\\\w"',hn=function(){return new e("word")},Ot="\\W",pn='"\\\\W"',vn=function(){return new e("non-word")},Lt="\\c",gn='"\\\\c"',Mt="any character",yn=function(E){return new y(E)},It="\\",Pt='"\\\\"',mn=/^[1-9]/,Cn="[1-9]",_n=function(E){return new g(E)},Le="\\0",Nt='"\\\\0"',Dt=/^[0-7]/,Bt="[0-7]",En=function(E){return new v(E.join(""))},Ft="\\x",Sn='"\\\\x"',Me=/^[0-9a-fA-F]/,Ie="[0-9a-fA-F]",xn=function(E){return new p(E.join(""))},kt="\\u",Tn='"\\\\u"',wn=function(E){return new h(E.join(""))},bn=function(){return new e("null-character")},I=0,Z=0,Ce=0,Ge={line:1,column:1,seenCR:!1},Pe=0,Ne=[],Y=0;if("startRule"in Ae){if(!(Ae.startRule in nt))throw new Error(`Can't start parsing from rule "`+Ae.startRule+'".');it=nt[Ae.startRule]}if(e.offset=M,e.text=L,Fe=it(),Fe!==null&&I===b.length)return Fe;throw F(Ne),Z=Math.max(I,Pe),new T(Ne,Z<b.length?b.charAt(Z):null,Z,D(Z).line,D(Z).column)}return R(T,Error),{SyntaxError:T,parse:x}}(),S=1,w={};t.exports=m},function(t,r,e){var n=e(3),a=e(5),o={extend:n.extend},s=p(97,122),l=p(65,90),u=p(48,57),c=p(32,47)+p(58,64)+p(91,96)+p(123,126),d=p(32,126),f=` \f
\r	\v \u2028\u2029`,h={"\\w":s+l+u+"_","\\W":c.replace("_",""),"\\s":f,"\\S":function(){for(var v=d,g=0;g<f.length;g++)v=v.replace(f[g],"");return v}(),"\\d":u,"\\D":s+l+c};function p(v,g){for(var y="",m=v;m<=g;m++)y+=String.fromCharCode(m);return y}o.gen=function(v,g,y){return y=y||{guid:1},o[v.type]?o[v.type](v,g,y):o.token(v,g,y)},o.extend({token:function(v,g,y){switch(v.type){case"start":case"end":return"";case"any-character":return a.character();case"backspace":return"";case"word-boundary":return"";case"non-word-boundary":break;case"digit":return a.pick(u.split(""));case"non-digit":return a.pick((s+l+c).split(""));case"form-feed":break;case"line-feed":return v.body||v.text;case"carriage-return":break;case"white-space":return a.pick(f.split(""));case"non-white-space":return a.pick((s+l+u).split(""));case"tab":break;case"vertical-tab":break;case"word":return a.pick((s+l+u).split(""));case"non-word":return a.pick(c.replace("_","").split(""))}return v.body||v.text},alternate:function(v,g,y){return this.gen(a.boolean()?v.left:v.right,g,y)},match:function(v,g,y){g="";for(var m=0;m<v.body.length;m++)g+=this.gen(v.body[m],g,y);return g},"capture-group":function(v,g,y){return g=this.gen(v.body,g,y),y[y.guid++]=g,g},"non-capture-group":function(v,g,y){return this.gen(v.body,g,y)},"positive-lookahead":function(v,g,y){return this.gen(v.body,g,y)},"negative-lookahead":function(v,g,y){return""},quantified:function(v,g,y){g="";for(var m=this.quantifier(v.quantifier),S=0;S<m;S++)g+=this.gen(v.body,g,y);return g},quantifier:function(v,g,y){var m=Math.max(v.min,0),S=isFinite(v.max)?v.max:m+a.integer(3,7);return a.integer(m,S)},charset:function(v,g,y){if(v.invert)return this["invert-charset"](v,g,y);var m=a.pick(v.body);return this.gen(m,g,y)},"invert-charset":function(v,g,y){for(var m=d,S=0,w;S<v.body.length;S++)switch(w=v.body[S],w.type){case"literal":m=m.replace(w.body,"");break;case"range":for(var R=this.gen(w.start,g,y).charCodeAt(),T=this.gen(w.end,g,y).charCodeAt(),x=R;x<=T;x++)m=m.replace(String.fromCharCode(x),"");default:var b=h[w.text];if(b)for(var L=0;L<=b.length;L++)m=m.replace(b[L],"")}return a.pick(m.split(""))},range:function(v,g,y){var m=this.gen(v.start,g,y).charCodeAt(),S=this.gen(v.end,g,y).charCodeAt();return String.fromCharCode(a.integer(m,S))},literal:function(v,g,y){return v.escaped?v.body:v.text},unicode:function(v,g,y){return String.fromCharCode(parseInt(v.code,16))},hex:function(v,g,y){return String.fromCharCode(parseInt(v.code,16))},octal:function(v,g,y){return String.fromCharCode(parseInt(v.code,8))},"back-reference":function(v,g,y){return y[v.code]||""},CONTROL_CHARACTER_MAP:function(){for(var v="@ A B C D E F G H I J K L M N O P Q R S T U V W X Y Z [ \\ ] ^ _".split(" "),g=`\0       \x07 \b 	 
 \v \f \r              \x1B    `.split(" "),y={},m=0;m<v.length;m++)y[v[m]]=g[m];return y}(),"control-character":function(v,g,y){return this.CONTROL_CHARACTER_MAP[v.code]}}),t.exports=o},function(t,r,e){t.exports=e(24)},function(t,r,e){var n=e(2),a=e(3),o=e(4);function s(l,u,c){c=c||[];var d={name:typeof u=="string"?u.replace(n.RE_KEY,"$1"):u,template:l,type:a.type(l),rule:o.parse(u)};switch(d.path=c.slice(0),d.path.push(u===void 0?"ROOT":d.name),d.type){case"array":d.items=[],a.each(l,function(f,h){d.items.push(s(f,h,d.path))});break;case"object":d.properties=[],a.each(l,function(f,h){d.properties.push(s(f,h,d.path))});break}return d}t.exports=s},function(t,r,e){t.exports=e(26)},function(t,r,e){var n=e(2),a=e(3),o=e(23);function s(c,d){for(var f=o(c),h=l.diff(f,d),p=0;p<h.length;p++);return h}var l={diff:function(d,f,h){var p=[];return this.name(d,f,h,p)&&this.type(d,f,h,p)&&(this.value(d,f,h,p),this.properties(d,f,h,p),this.items(d,f,h,p)),p},name:function(c,d,f,h){var p=h.length;return u.equal("name",c.path,f+"",c.name+"",h),h.length===p},type:function(c,d,f,h){var p=h.length;switch(c.type){case"string":if(c.template.match(n.RE_PLACEHOLDER))return!0;break;case"array":if(c.rule.parameters&&(c.rule.min!==void 0&&c.rule.max===void 0&&c.rule.count===1||c.rule.parameters[2]))return!0;break;case"function":return!0}return u.equal("type",c.path,a.type(d),c.type,h),h.length===p},value:function(c,d,f,h){var p=h.length,v=c.rule,g=c.type;if(g==="object"||g==="array"||g==="function")return!0;if(!v.parameters){switch(g){case"regexp":return u.match("value",c.path,d,c.template,h),h.length===p;case"string":if(c.template.match(n.RE_PLACEHOLDER))return h.length===p;break}return u.equal("value",c.path,d,c.template,h),h.length===p}var y;switch(g){case"number":var m=(d+"").split(".");m[0]=+m[0],v.min!==void 0&&v.max!==void 0&&(u.greaterThanOrEqualTo("value",c.path,m[0],Math.min(v.min,v.max),h),u.lessThanOrEqualTo("value",c.path,m[0],Math.max(v.min,v.max),h)),v.min!==void 0&&v.max===void 0&&u.equal("value",c.path,m[0],v.min,h,"[value] "+f),v.decimal&&(v.dmin!==void 0&&v.dmax!==void 0&&(u.greaterThanOrEqualTo("value",c.path,m[1].length,v.dmin,h),u.lessThanOrEqualTo("value",c.path,m[1].length,v.dmax,h)),v.dmin!==void 0&&v.dmax===void 0&&u.equal("value",c.path,m[1].length,v.dmin,h));break;case"boolean":break;case"string":y=d.match(new RegExp(c.template,"g")),y=y?y.length:0,v.min!==void 0&&v.max!==void 0&&(u.greaterThanOrEqualTo("repeat count",c.path,y,v.min,h),u.lessThanOrEqualTo("repeat count",c.path,y,v.max,h)),v.min!==void 0&&v.max===void 0&&u.equal("repeat count",c.path,y,v.min,h);break;case"regexp":y=d.match(new RegExp(c.template.source.replace(/^\^|\$$/g,""),"g")),y=y?y.length:0,v.min!==void 0&&v.max!==void 0&&(u.greaterThanOrEqualTo("repeat count",c.path,y,v.min,h),u.lessThanOrEqualTo("repeat count",c.path,y,v.max,h)),v.min!==void 0&&v.max===void 0&&u.equal("repeat count",c.path,y,v.min,h);break}return h.length===p},properties:function(c,d,f,h){var p=h.length,v=c.rule,g=a.keys(d);if(c.properties){if(c.rule.parameters?(v.min!==void 0&&v.max!==void 0&&(u.greaterThanOrEqualTo("properties length",c.path,g.length,Math.min(v.min,v.max),h),u.lessThanOrEqualTo("properties length",c.path,g.length,Math.max(v.min,v.max),h)),v.min!==void 0&&v.max===void 0&&v.count!==1&&u.equal("properties length",c.path,g.length,v.min,h)):u.equal("properties length",c.path,g.length,c.properties.length,h),h.length!==p)return!1;for(var y=0;y<g.length;y++)h.push.apply(h,this.diff(function(){var m;return a.each(c.properties,function(S){S.name===g[y]&&(m=S)}),m||c.properties[y]}(),d[g[y]],g[y]));return h.length===p}},items:function(c,d,f,h){var p=h.length;if(c.items){var v=c.rule;if(!c.rule.parameters)u.equal("items length",c.path,d.length,c.items.length,h);else{if(v.min!==void 0&&v.max!==void 0&&(u.greaterThanOrEqualTo("items",c.path,d.length,Math.min(v.min,v.max)*c.items.length,h,"[{utype}] array is too short: {path} must have at least {expected} elements but instance has {actual} elements"),u.lessThanOrEqualTo("items",c.path,d.length,Math.max(v.min,v.max)*c.items.length,h,"[{utype}] array is too long: {path} must have at most {expected} elements but instance has {actual} elements")),v.min!==void 0&&v.max===void 0){if(v.count===1)return h.length===p;u.equal("items length",c.path,d.length,v.min*c.items.length,h)}if(v.parameters[2])return h.length===p}if(h.length!==p)return!1;for(var g=0;g<d.length;g++)h.push.apply(h,this.diff(c.items[g%c.items.length],d[g],g%c.items.length));return h.length===p}}},u={message:function(c){return(c.message||"[{utype}] Expect {path}'{ltype} {action} {expected}, but is {actual}").replace("{utype}",c.type.toUpperCase()).replace("{ltype}",c.type.toLowerCase()).replace("{path}",a.isArray(c.path)&&c.path.join(".")||c.path).replace("{action}",c.action).replace("{expected}",c.expected).replace("{actual}",c.actual)},equal:function(c,d,f,h,p,v){if(f===h)return!0;switch(c){case"type":if(h==="regexp"&&f==="string")return!0;break}var g={path:d,type:c,actual:f,expected:h,action:"is equal to",message:v};return g.message=u.message(g),p.push(g),!1},match:function(c,d,f,h,p,v){if(h.test(f))return!0;var g={path:d,type:c,actual:f,expected:h,action:"matches",message:v};return g.message=u.message(g),p.push(g),!1},notEqual:function(c,d,f,h,p,v){if(f!==h)return!0;var g={path:d,type:c,actual:f,expected:h,action:"is not equal to",message:v};return g.message=u.message(g),p.push(g),!1},greaterThan:function(c,d,f,h,p,v){if(f>h)return!0;var g={path:d,type:c,actual:f,expected:h,action:"is greater than",message:v};return g.message=u.message(g),p.push(g),!1},lessThan:function(c,d,f,h,p,v){if(f<h)return!0;var g={path:d,type:c,actual:f,expected:h,action:"is less to",message:v};return g.message=u.message(g),p.push(g),!1},greaterThanOrEqualTo:function(c,d,f,h,p,v){if(f>=h)return!0;var g={path:d,type:c,actual:f,expected:h,action:"is greater than or equal to",message:v};return g.message=u.message(g),p.push(g),!1},lessThanOrEqualTo:function(c,d,f,h,p,v){if(f<=h)return!0;var g={path:d,type:c,actual:f,expected:h,action:"is less than or equal to",message:v};return g.message=u.message(g),p.push(g),!1}};s.Diff=l,s.Assert=u,t.exports=s},function(t,r,e){t.exports=e(28)},function(t,r,e){var n=e(3);window._XMLHttpRequest=window.XMLHttpRequest,window._ActiveXObject=window.ActiveXObject;try{new window.Event("custom")}catch{window.Event=function(v,g,y,m){var S=document.createEvent("CustomEvent");return S.initCustomEvent(v,g,y,m),S}}var a={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},o="readystatechange loadstart progress abort error load timeout loadend".split(" "),s="timeout withCredentials".split(" "),l="readyState responseURL status statusText responseType response responseText responseXML".split(" "),u={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choice",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"};function c(){this.custom={events:{},requestHeaders:{},responseHeaders:{}}}c._settings={timeout:"10-100"},c.setup=function(p){return n.extend(c._settings,p),c._settings},n.extend(c,a),n.extend(c.prototype,a),c.prototype.mock=!0,c.prototype.match=!1,n.extend(c.prototype,{open:function(p,v,g,y,m){var S=this;n.extend(this.custom,{method:p,url:v,async:typeof g=="boolean"?g:!0,username:y,password:m,options:{url:v,type:p}}),this.custom.timeout=function(L){if(typeof L=="number")return L;if(typeof L=="string"&&!~L.indexOf("-"))return parseInt(L,10);if(typeof L=="string"&&~L.indexOf("-")){var M=L.split("-"),D=parseInt(M[0],10),N=parseInt(M[1],10);return Math.round(Math.random()*(N-D))+D}}(c._settings.timeout);var w=f(this.custom.options);function R(L){for(var M=0;M<l.length;M++)try{S[l[M]]=T[l[M]]}catch{}S.dispatchEvent(new Event(L.type))}if(!w){var T=d();this.custom.xhr=T;for(var x=0;x<o.length;x++)T.addEventListener(o[x],R);y?T.open(p,v,g,y,m):T.open(p,v,g);for(var b=0;b<s.length;b++)try{T[s[b]]=S[s[b]]}catch{}return}this.match=!0,this.custom.template=w,this.readyState=c.OPENED,this.dispatchEvent(new Event("readystatechange"))},setRequestHeader:function(p,v){if(!this.match){this.custom.xhr.setRequestHeader(p,v);return}var g=this.custom.requestHeaders;g[p]?g[p]+=","+v:g[p]=v},timeout:0,withCredentials:!1,upload:{},send:function(v){var g=this;if(this.custom.options.body=v,!this.match){this.custom.xhr.send(v);return}this.setRequestHeader("X-Requested-With","MockXMLHttpRequest"),this.dispatchEvent(new Event("loadstart")),this.custom.async?setTimeout(y,this.custom.timeout):y();function y(){g.readyState=c.HEADERS_RECEIVED,g.dispatchEvent(new Event("readystatechange")),g.readyState=c.LOADING,g.dispatchEvent(new Event("readystatechange")),g.status=200,g.statusText=u[200],g.response=g.responseText=JSON.stringify(h(g.custom.template,g.custom.options),null,4),g.readyState=c.DONE,g.dispatchEvent(new Event("readystatechange")),g.dispatchEvent(new Event("load")),g.dispatchEvent(new Event("loadend"))}},abort:function(){if(!this.match){this.custom.xhr.abort();return}this.readyState=c.UNSENT,this.dispatchEvent(new Event("abort",!1,!1,this)),this.dispatchEvent(new Event("error",!1,!1,this))}}),n.extend(c.prototype,{responseURL:"",status:c.UNSENT,statusText:"",getResponseHeader:function(p){return this.match?this.custom.responseHeaders[p.toLowerCase()]:this.custom.xhr.getResponseHeader(p)},getAllResponseHeaders:function(){if(!this.match)return this.custom.xhr.getAllResponseHeaders();var p=this.custom.responseHeaders,v="";for(var g in p)p.hasOwnProperty(g)&&(v+=g+": "+p[g]+`\r
`);return v},overrideMimeType:function(){},responseType:"",response:null,responseText:"",responseXML:null}),n.extend(c.prototype,{addEventListener:function(v,g){var y=this.custom.events;y[v]||(y[v]=[]),y[v].push(g)},removeEventListener:function(v,g){for(var y=this.custom.events[v]||[],m=0;m<y.length;m++)y[m]===g&&y.splice(m--,1)},dispatchEvent:function(v){for(var g=this.custom.events[v.type]||[],y=0;y<g.length;y++)g[y].call(this,v);var m="on"+v.type;this[m]&&this[m](v)}});function d(){var p=function(){var y=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,m=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,S=location.href,w=m.exec(S.toLowerCase())||[];return y.test(w[1])}();return window.ActiveXObject?!p&&v()||g():v();function v(){try{return new window._XMLHttpRequest}catch{}}function g(){try{return new window._ActiveXObject("Microsoft.XMLHTTP")}catch{}}}function f(p){for(var v in c.Mock._mocked){var g=c.Mock._mocked[v];if((!g.rurl||y(g.rurl,p.url))&&(!g.rtype||y(g.rtype,p.type.toLowerCase())))return g}function y(m,S){if(n.type(m)==="string")return m===S;if(n.type(m)==="regexp")return m.test(S)}}function h(p,v){return n.isFunction(p.template)?p.template(v):c.Mock.mock(p.template)}t.exports=c}])})})(mock);var mockExports=mock.exports;const Mock=getDefaultExportFromCjs$1(mockExports);Mock.mock({"list|1-10":[{"id|+1":1}]});const template={describe:"标准交叉表数据。",fields:{rows:["province","city"],columns:["type","sub_type"],values:["number"],valueInCols:!0},data:[{number:7789,province:"浙江省",city:"杭州市",type:"家具",sub_type:"桌子"},{number:2367,province:"浙江省",city:"绍兴市",type:"家具",sub_type:"桌子"},{number:3877,province:"浙江省",city:"宁波市",type:"家具",sub_type:"桌子"},{number:4342,province:"浙江省",city:"舟山市",type:"家具",sub_type:"桌子"},{number:5343,province:"浙江省",city:"杭州市",type:"家具",sub_type:"沙发"},{number:632,province:"浙江省",city:"绍兴市",type:"家具",sub_type:"沙发"},{number:7234,province:"浙江省",city:"宁波市",type:"家具",sub_type:"沙发"},{number:834,province:"浙江省",city:"舟山市",type:"家具",sub_type:"沙发"},{number:945,province:"浙江省",city:"杭州市",type:"办公用品",sub_type:"笔"},{number:1304,province:"浙江省",city:"绍兴市",type:"办公用品",sub_type:"笔"},{number:1145,province:"浙江省",city:"宁波市",type:"办公用品",sub_type:"笔"},{number:1432,province:"浙江省",city:"舟山市",type:"办公用品",sub_type:"笔"},{number:1343,province:"浙江省",city:"杭州市",type:"办公用品",sub_type:"纸张"},{number:1354,province:"浙江省",city:"绍兴市",type:"办公用品",sub_type:"纸张"},{number:1523,province:"浙江省",city:"宁波市",type:"办公用品",sub_type:"纸张"},{number:1634,province:"浙江省",city:"舟山市",type:"办公用品",sub_type:"纸张"},{number:1723,province:"四川省",city:"成都市",type:"家具",sub_type:"桌子"},{number:1822,province:"四川省",city:"绵阳市",type:"家具",sub_type:"桌子"},{number:1943,province:"四川省",city:"南充市",type:"家具",sub_type:"桌子"},{number:2330,province:"四川省",city:"乐山市",type:"家具",sub_type:"桌子"},{number:2451,province:"四川省",city:"成都市",type:"家具",sub_type:"沙发"},{number:2244,province:"四川省",city:"绵阳市",type:"家具",sub_type:"沙发"},{number:2333,province:"四川省",city:"南充市",type:"家具",sub_type:"沙发"},{number:2445,province:"四川省",city:"乐山市",type:"家具",sub_type:"沙发"},{number:2335,province:"四川省",city:"成都市",type:"办公用品",sub_type:"笔"},{number:245,province:"四川省",city:"绵阳市",type:"办公用品",sub_type:"笔"},{number:2457,province:"四川省",city:"南充市",type:"办公用品",sub_type:"笔"},{number:2458,province:"四川省",city:"乐山市",type:"办公用品",sub_type:"笔"},{number:4004,province:"四川省",city:"成都市",type:"办公用品",sub_type:"纸张"},{number:3077,province:"四川省",city:"绵阳市",type:"办公用品",sub_type:"纸张"},{number:3551,province:"四川省",city:"南充市",type:"办公用品",sub_type:"纸张"},{number:352,province:"四川省",city:"乐山市",type:"办公用品",sub_type:"纸张"}],totalData:[{number:26193,type:"家具",sub_type:"桌子"},{number:49709,type:"家具"},{number:23516,type:"家具",sub_type:"沙发"},{number:29159,type:"办公用品"},{number:12321,type:"办公用品",sub_type:"笔"},{number:16838,type:"办公用品",sub_type:"纸张"},{number:18375,province:"浙江省",type:"家具",sub_type:"桌子"},{number:14043,province:"浙江省",type:"家具",sub_type:"沙发"},{number:4826,province:"浙江省",type:"办公用品",sub_type:"笔"},{number:5854,province:"浙江省",type:"办公用品",sub_type:"纸张"},{number:7818,province:"四川省",type:"家具",sub_type:"桌子"},{number:9473,province:"四川省",type:"家具",sub_type:"沙发"},{number:7495,province:"四川省",type:"办公用品",sub_type:"笔"},{number:10984,province:"四川省",type:"办公用品",sub_type:"纸张"},{number:13132,province:"浙江省",city:"杭州市",type:"家具"},{number:2288,province:"浙江省",city:"杭州市",type:"办公用品"},{number:15420,province:"浙江省",city:"杭州市"},{number:2999,province:"浙江省",city:"绍兴市",type:"家具"},{number:2658,province:"浙江省",city:"绍兴市",type:"办公用品"},{number:5657,province:"浙江省",city:"绍兴市"},{number:11111,province:"浙江省",city:"宁波市",type:"家具"},{number:2668,province:"浙江省",city:"宁波市",type:"办公用品"},{number:13779,province:"浙江省",city:"宁波市"},{number:5176,province:"浙江省",city:"舟山市",type:"家具"},{number:3066,province:"浙江省",city:"舟山市",type:"办公用品"},{number:8242,province:"浙江省",city:"舟山市"},{number:4174,province:"四川省",city:"成都市",type:"家具"},{number:6339,province:"四川省",city:"成都市",type:"办公用品"},{number:10513,province:"四川省",city:"成都市"},{number:4066,province:"四川省",city:"绵阳市",type:"家具"},{number:3322,province:"四川省",city:"绵阳市",type:"办公用品"},{number:7388,province:"四川省",city:"绵阳市"},{number:4276,province:"四川省",city:"南充市",type:"家具"},{number:6008,province:"四川省",city:"南充市",type:"办公用品"},{number:10284,province:"四川省",city:"南充市"},{number:4775,province:"四川省",city:"乐山市",type:"家具"},{number:2810,province:"四川省",city:"乐山市",type:"办公用品"},{number:7585,province:"四川省",city:"乐山市"},{number:32418,province:"浙江省",type:"家具"},{number:10680,province:"浙江省",type:"办公用品"},{number:43098,province:"浙江省"},{number:17291,province:"四川省",type:"家具"},{number:18479,province:"四川省",type:"办公用品"},{number:35770,province:"四川省"},{number:78868}]},data1=Mock.mock(template),provinceCityData={北京:["北京市"],上海:["上海市"],广东:["广州市","深圳市","佛山市","佛门市"],河北:["石家庄市","邯郸市","保定市"],浙江:["宁波","杭州","台州","温州","绍兴","湖州"]},useType={家具:["桌子","沙发","椅子","床"],办公用品:["笔","纸张","橡皮"]};Mock.mock("/data/list","get",{describe:"标准交叉表数据。",fields:{rows:["province","city"],columns:["type","sub_type"],values:["number"],valueInCols:!0},"data|1000":[{number:"@integer(200,3000)","province|1":Object.keys(provinceCityData),img:"@image()","city|1":function(){const t=Math.floor(provinceCityData[this.province].length*Math.random());return provinceCityData[this.province][t]},"type|1":Object.keys(useType),sub_type:function(){const t=Math.floor(useType[this.type].length*Math.random());return useType[this.type][t]}}]});var extendStatics=function(t,r){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])},extendStatics(t,r)};function __extends(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");extendStatics(t,r);function e(){this.constructor=t}t.prototype=r===null?Object.create(r):(e.prototype=r.prototype,new e)}var __assign=function(){return __assign=Object.assign||function(r){for(var e,n=1,a=arguments.length;n<a;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o])}return r},__assign.apply(this,arguments)};function __rest(t,r){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(e[n[a]]=t[n[a]]);return e}function __awaiter(t,r,e,n){function a(o){return o instanceof e?o:new e(function(s){s(o)})}return new(e||(e=Promise))(function(o,s){function l(d){try{c(n.next(d))}catch(f){s(f)}}function u(d){try{c(n.throw(d))}catch(f){s(f)}}function c(d){d.done?o(d.value):a(d.value).then(l,u)}c((n=n.apply(t,r||[])).next())})}function __generator(t,r){var e={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,a,o,s;return s={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function l(c){return function(d){return u([c,d])}}function u(c){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,c[0]&&(e=0)),e;)try{if(n=1,a&&(o=c[0]&2?a.return:c[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,c[1])).done)return o;switch(a=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return e.label++,{value:c[1],done:!1};case 5:e.label++,a=c[1],c=[0];continue;case 7:c=e.ops.pop(),e.trys.pop();continue;default:if(o=e.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){e=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){e.label=c[1];break}if(c[0]===6&&e.label<o[1]){e.label=o[1],o=c;break}if(o&&e.label<o[2]){e.label=o[2],e.ops.push(c);break}o[2]&&e.ops.pop(),e.trys.pop();continue}c=r.call(t,e)}catch(d){c=[6,d],a=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function __values(t){var r=typeof Symbol=="function"&&Symbol.iterator,e=r&&t[r],n=0;if(e)return e.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),a,o=[],s;try{for(;(r===void 0||r-- >0)&&!(a=n.next()).done;)o.push(a.value)}catch(l){s={error:l}}finally{try{a&&!a.done&&(e=n.return)&&e.call(n)}finally{if(s)throw s.error}}return o}function __spreadArray(t,r,e){if(e||arguments.length===2)for(var n=0,a=r.length,o;n<a;n++)(o||!(n in r))&&(o||(o=Array.prototype.slice.call(r,0,n)),o[n]=r[n]);return t.concat(o||Array.prototype.slice.call(r))}typeof SuppressedError=="function"&&SuppressedError;function getDefaultExportFromCjs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var eventemitter3={exports:{}};(function(t){var r=Object.prototype.hasOwnProperty,e="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(e=!1));function a(u,c,d){this.fn=u,this.context=c,this.once=d||!1}function o(u,c,d,f,h){if(typeof d!="function")throw new TypeError("The listener must be a function");var p=new a(d,f||u,h),v=e?e+c:c;return u._events[v]?u._events[v].fn?u._events[v]=[u._events[v],p]:u._events[v].push(p):(u._events[v]=p,u._eventsCount++),u}function s(u,c){--u._eventsCount===0?u._events=new n:delete u._events[c]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var c=[],d,f;if(this._eventsCount===0)return c;for(f in d=this._events)r.call(d,f)&&c.push(e?f.slice(1):f);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(d)):c},l.prototype.listeners=function(c){var d=e?e+c:c,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,p=f.length,v=new Array(p);h<p;h++)v[h]=f[h].fn;return v},l.prototype.listenerCount=function(c){var d=e?e+c:c,f=this._events[d];return f?f.fn?1:f.length:0},l.prototype.emit=function(c,d,f,h,p,v){var g=e?e+c:c;if(!this._events[g])return!1;var y=this._events[g],m=arguments.length,S,w;if(y.fn){switch(y.once&&this.removeListener(c,y.fn,void 0,!0),m){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,d),!0;case 3:return y.fn.call(y.context,d,f),!0;case 4:return y.fn.call(y.context,d,f,h),!0;case 5:return y.fn.call(y.context,d,f,h,p),!0;case 6:return y.fn.call(y.context,d,f,h,p,v),!0}for(w=1,S=new Array(m-1);w<m;w++)S[w-1]=arguments[w];y.fn.apply(y.context,S)}else{var R=y.length,T;for(w=0;w<R;w++)switch(y[w].once&&this.removeListener(c,y[w].fn,void 0,!0),m){case 1:y[w].fn.call(y[w].context);break;case 2:y[w].fn.call(y[w].context,d);break;case 3:y[w].fn.call(y[w].context,d,f);break;case 4:y[w].fn.call(y[w].context,d,f,h);break;default:if(!S)for(T=1,S=new Array(m-1);T<m;T++)S[T-1]=arguments[T];y[w].fn.apply(y[w].context,S)}}return!0},l.prototype.on=function(c,d,f){return o(this,c,d,f,!1)},l.prototype.once=function(c,d,f){return o(this,c,d,f,!0)},l.prototype.removeListener=function(c,d,f,h){var p=e?e+c:c;if(!this._events[p])return this;if(!d)return s(this,p),this;var v=this._events[p];if(v.fn)v.fn===d&&(!h||v.once)&&(!f||v.context===f)&&s(this,p);else{for(var g=0,y=[],m=v.length;g<m;g++)(v[g].fn!==d||h&&!v[g].once||f&&v[g].context!==f)&&y.push(v[g]);y.length?this._events[p]=y.length===1?y[0]:y:s(this,p)}return this},l.prototype.removeAllListeners=function(c){var d;return c?(d=e?e+c:c,this._events[d]&&s(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=e,l.EventEmitter=l,t.exports=l})(eventemitter3);var eventemitter3Exports=eventemitter3.exports,EventEmitter$1=getDefaultExportFromCjs(eventemitter3Exports),EPSILON$1=1e-6,ARRAY_TYPE=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,r=arguments.length;r--;)t+=arguments[r]*arguments[r];return Math.sqrt(t)});function create$5(){var t=new ARRAY_TYPE(9);return ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function fromMat4(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[4],t[4]=r[5],t[5]=r[6],t[6]=r[8],t[7]=r[9],t[8]=r[10],t}function fromValues$5(t,r,e,n,a,o,s,l,u){var c=new ARRAY_TYPE(9);return c[0]=t,c[1]=r,c[2]=e,c[3]=n,c[4]=a,c[5]=o,c[6]=s,c[7]=l,c[8]=u,c}function create$4(){var t=new ARRAY_TYPE(16);return ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function clone$3(t){var r=new ARRAY_TYPE(16);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r}function copy$4(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t}function fromValues$4(t,r,e,n,a,o,s,l,u,c,d,f,h,p,v,g){var y=new ARRAY_TYPE(16);return y[0]=t,y[1]=r,y[2]=e,y[3]=n,y[4]=a,y[5]=o,y[6]=s,y[7]=l,y[8]=u,y[9]=c,y[10]=d,y[11]=f,y[12]=h,y[13]=p,y[14]=v,y[15]=g,y}function set$2(t,r,e,n,a,o,s,l,u,c,d,f,h,p,v,g,y){return t[0]=r,t[1]=e,t[2]=n,t[3]=a,t[4]=o,t[5]=s,t[6]=l,t[7]=u,t[8]=c,t[9]=d,t[10]=f,t[11]=h,t[12]=p,t[13]=v,t[14]=g,t[15]=y,t}function identity$1(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function transpose(t,r){if(t===r){var e=r[1],n=r[2],a=r[3],o=r[6],s=r[7],l=r[11];t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=e,t[6]=r[9],t[7]=r[13],t[8]=n,t[9]=o,t[11]=r[14],t[12]=a,t[13]=s,t[14]=l}else t[0]=r[0],t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=r[1],t[5]=r[5],t[6]=r[9],t[7]=r[13],t[8]=r[2],t[9]=r[6],t[10]=r[10],t[11]=r[14],t[12]=r[3],t[13]=r[7],t[14]=r[11],t[15]=r[15];return t}function invert$1(t,r){var e=r[0],n=r[1],a=r[2],o=r[3],s=r[4],l=r[5],u=r[6],c=r[7],d=r[8],f=r[9],h=r[10],p=r[11],v=r[12],g=r[13],y=r[14],m=r[15],S=e*l-n*s,w=e*u-a*s,R=e*c-o*s,T=n*u-a*l,x=n*c-o*l,b=a*c-o*u,L=d*g-f*v,M=d*y-h*v,D=d*m-p*v,N=f*y-h*g,F=f*m-p*g,k=h*m-p*y,H=S*k-w*F+R*N+T*D-x*M+b*L;return H?(H=1/H,t[0]=(l*k-u*F+c*N)*H,t[1]=(a*F-n*k-o*N)*H,t[2]=(g*b-y*x+m*T)*H,t[3]=(h*x-f*b-p*T)*H,t[4]=(u*D-s*k-c*M)*H,t[5]=(e*k-a*D+o*M)*H,t[6]=(y*R-v*b-m*w)*H,t[7]=(d*b-h*R+p*w)*H,t[8]=(s*F-l*D+c*L)*H,t[9]=(n*D-e*F-o*L)*H,t[10]=(v*x-g*R+m*S)*H,t[11]=(f*R-d*x-p*S)*H,t[12]=(l*M-s*N-u*L)*H,t[13]=(e*N-n*M+a*L)*H,t[14]=(g*w-v*T-y*S)*H,t[15]=(d*T-f*w+h*S)*H,t):null}function adjoint(t,r){var e=r[0],n=r[1],a=r[2],o=r[3],s=r[4],l=r[5],u=r[6],c=r[7],d=r[8],f=r[9],h=r[10],p=r[11],v=r[12],g=r[13],y=r[14],m=r[15];return t[0]=l*(h*m-p*y)-f*(u*m-c*y)+g*(u*p-c*h),t[1]=-(n*(h*m-p*y)-f*(a*m-o*y)+g*(a*p-o*h)),t[2]=n*(u*m-c*y)-l*(a*m-o*y)+g*(a*c-o*u),t[3]=-(n*(u*p-c*h)-l*(a*p-o*h)+f*(a*c-o*u)),t[4]=-(s*(h*m-p*y)-d*(u*m-c*y)+v*(u*p-c*h)),t[5]=e*(h*m-p*y)-d*(a*m-o*y)+v*(a*p-o*h),t[6]=-(e*(u*m-c*y)-s*(a*m-o*y)+v*(a*c-o*u)),t[7]=e*(u*p-c*h)-s*(a*p-o*h)+d*(a*c-o*u),t[8]=s*(f*m-p*g)-d*(l*m-c*g)+v*(l*p-c*f),t[9]=-(e*(f*m-p*g)-d*(n*m-o*g)+v*(n*p-o*f)),t[10]=e*(l*m-c*g)-s*(n*m-o*g)+v*(n*c-o*l),t[11]=-(e*(l*p-c*f)-s*(n*p-o*f)+d*(n*c-o*l)),t[12]=-(s*(f*y-h*g)-d*(l*y-u*g)+v*(l*h-u*f)),t[13]=e*(f*y-h*g)-d*(n*y-a*g)+v*(n*h-a*f),t[14]=-(e*(l*y-u*g)-s*(n*y-a*g)+v*(n*u-a*l)),t[15]=e*(l*h-u*f)-s*(n*h-a*f)+d*(n*u-a*l),t}function determinant(t){var r=t[0],e=t[1],n=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],d=t[9],f=t[10],h=t[11],p=t[12],v=t[13],g=t[14],y=t[15],m=r*s-e*o,S=r*l-n*o,w=r*u-a*o,R=e*l-n*s,T=e*u-a*s,x=n*u-a*l,b=c*v-d*p,L=c*g-f*p,M=c*y-h*p,D=d*g-f*v,N=d*y-h*v,F=f*y-h*g;return m*F-S*N+w*D+R*M-T*L+x*b}function multiply$2(t,r,e){var n=r[0],a=r[1],o=r[2],s=r[3],l=r[4],u=r[5],c=r[6],d=r[7],f=r[8],h=r[9],p=r[10],v=r[11],g=r[12],y=r[13],m=r[14],S=r[15],w=e[0],R=e[1],T=e[2],x=e[3];return t[0]=w*n+R*l+T*f+x*g,t[1]=w*a+R*u+T*h+x*y,t[2]=w*o+R*c+T*p+x*m,t[3]=w*s+R*d+T*v+x*S,w=e[4],R=e[5],T=e[6],x=e[7],t[4]=w*n+R*l+T*f+x*g,t[5]=w*a+R*u+T*h+x*y,t[6]=w*o+R*c+T*p+x*m,t[7]=w*s+R*d+T*v+x*S,w=e[8],R=e[9],T=e[10],x=e[11],t[8]=w*n+R*l+T*f+x*g,t[9]=w*a+R*u+T*h+x*y,t[10]=w*o+R*c+T*p+x*m,t[11]=w*s+R*d+T*v+x*S,w=e[12],R=e[13],T=e[14],x=e[15],t[12]=w*n+R*l+T*f+x*g,t[13]=w*a+R*u+T*h+x*y,t[14]=w*o+R*c+T*p+x*m,t[15]=w*s+R*d+T*v+x*S,t}function translate(t,r,e){var n=e[0],a=e[1],o=e[2],s,l,u,c,d,f,h,p,v,g,y,m;return r===t?(t[12]=r[0]*n+r[4]*a+r[8]*o+r[12],t[13]=r[1]*n+r[5]*a+r[9]*o+r[13],t[14]=r[2]*n+r[6]*a+r[10]*o+r[14],t[15]=r[3]*n+r[7]*a+r[11]*o+r[15]):(s=r[0],l=r[1],u=r[2],c=r[3],d=r[4],f=r[5],h=r[6],p=r[7],v=r[8],g=r[9],y=r[10],m=r[11],t[0]=s,t[1]=l,t[2]=u,t[3]=c,t[4]=d,t[5]=f,t[6]=h,t[7]=p,t[8]=v,t[9]=g,t[10]=y,t[11]=m,t[12]=s*n+d*a+v*o+r[12],t[13]=l*n+f*a+g*o+r[13],t[14]=u*n+h*a+y*o+r[14],t[15]=c*n+p*a+m*o+r[15]),t}function scale$2(t,r,e){var n=e[0],a=e[1],o=e[2];return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=r[3]*n,t[4]=r[4]*a,t[5]=r[5]*a,t[6]=r[6]*a,t[7]=r[7]*a,t[8]=r[8]*o,t[9]=r[9]*o,t[10]=r[10]*o,t[11]=r[11]*o,t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t}function rotate(t,r,e,n){var a=n[0],o=n[1],s=n[2],l=Math.hypot(a,o,s),u,c,d,f,h,p,v,g,y,m,S,w,R,T,x,b,L,M,D,N,F,k,H,G;return l<EPSILON$1?null:(l=1/l,a*=l,o*=l,s*=l,u=Math.sin(e),c=Math.cos(e),d=1-c,f=r[0],h=r[1],p=r[2],v=r[3],g=r[4],y=r[5],m=r[6],S=r[7],w=r[8],R=r[9],T=r[10],x=r[11],b=a*a*d+c,L=o*a*d+s*u,M=s*a*d-o*u,D=a*o*d-s*u,N=o*o*d+c,F=s*o*d+a*u,k=a*s*d+o*u,H=o*s*d-a*u,G=s*s*d+c,t[0]=f*b+g*L+w*M,t[1]=h*b+y*L+R*M,t[2]=p*b+m*L+T*M,t[3]=v*b+S*L+x*M,t[4]=f*D+g*N+w*F,t[5]=h*D+y*N+R*F,t[6]=p*D+m*N+T*F,t[7]=v*D+S*N+x*F,t[8]=f*k+g*H+w*G,t[9]=h*k+y*H+R*G,t[10]=p*k+m*H+T*G,t[11]=v*k+S*H+x*G,r!==t&&(t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t)}function rotateX(t,r,e){var n=Math.sin(e),a=Math.cos(e),o=r[4],s=r[5],l=r[6],u=r[7],c=r[8],d=r[9],f=r[10],h=r[11];return r!==t&&(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[4]=o*a+c*n,t[5]=s*a+d*n,t[6]=l*a+f*n,t[7]=u*a+h*n,t[8]=c*a-o*n,t[9]=d*a-s*n,t[10]=f*a-l*n,t[11]=h*a-u*n,t}function rotateY(t,r,e){var n=Math.sin(e),a=Math.cos(e),o=r[0],s=r[1],l=r[2],u=r[3],c=r[8],d=r[9],f=r[10],h=r[11];return r!==t&&(t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=o*a-c*n,t[1]=s*a-d*n,t[2]=l*a-f*n,t[3]=u*a-h*n,t[8]=o*n+c*a,t[9]=s*n+d*a,t[10]=l*n+f*a,t[11]=u*n+h*a,t}function rotateZ(t,r,e){var n=Math.sin(e),a=Math.cos(e),o=r[0],s=r[1],l=r[2],u=r[3],c=r[4],d=r[5],f=r[6],h=r[7];return r!==t&&(t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=o*a+c*n,t[1]=s*a+d*n,t[2]=l*a+f*n,t[3]=u*a+h*n,t[4]=c*a-o*n,t[5]=d*a-s*n,t[6]=f*a-l*n,t[7]=h*a-u*n,t}function fromTranslation(t,r){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function fromScaling(t,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=r[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function fromRotation(t,r,e){var n=e[0],a=e[1],o=e[2],s=Math.hypot(n,a,o),l,u,c;return s<EPSILON$1?null:(s=1/s,n*=s,a*=s,o*=s,l=Math.sin(r),u=Math.cos(r),c=1-u,t[0]=n*n*c+u,t[1]=a*n*c+o*l,t[2]=o*n*c-a*l,t[3]=0,t[4]=n*a*c-o*l,t[5]=a*a*c+u,t[6]=o*a*c+n*l,t[7]=0,t[8]=n*o*c+a*l,t[9]=a*o*c-n*l,t[10]=o*o*c+u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function fromXRotation(t,r){var e=Math.sin(r),n=Math.cos(r);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=e,t[7]=0,t[8]=0,t[9]=-e,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function fromYRotation(t,r){var e=Math.sin(r),n=Math.cos(r);return t[0]=n,t[1]=0,t[2]=-e,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=e,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function fromZRotation(t,r){var e=Math.sin(r),n=Math.cos(r);return t[0]=n,t[1]=e,t[2]=0,t[3]=0,t[4]=-e,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function fromRotationTranslation(t,r,e){var n=r[0],a=r[1],o=r[2],s=r[3],l=n+n,u=a+a,c=o+o,d=n*l,f=n*u,h=n*c,p=a*u,v=a*c,g=o*c,y=s*l,m=s*u,S=s*c;return t[0]=1-(p+g),t[1]=f+S,t[2]=h-m,t[3]=0,t[4]=f-S,t[5]=1-(d+g),t[6]=v+y,t[7]=0,t[8]=h+m,t[9]=v-y,t[10]=1-(d+p),t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function fromQuat2(t,r){var e=new ARRAY_TYPE(3),n=-r[0],a=-r[1],o=-r[2],s=r[3],l=r[4],u=r[5],c=r[6],d=r[7],f=n*n+a*a+o*o+s*s;return f>0?(e[0]=(l*s+d*n+u*o-c*a)*2/f,e[1]=(u*s+d*a+c*n-l*o)*2/f,e[2]=(c*s+d*o+l*a-u*n)*2/f):(e[0]=(l*s+d*n+u*o-c*a)*2,e[1]=(u*s+d*a+c*n-l*o)*2,e[2]=(c*s+d*o+l*a-u*n)*2),fromRotationTranslation(t,r,e),t}function getTranslation(t,r){return t[0]=r[12],t[1]=r[13],t[2]=r[14],t}function getScaling(t,r){var e=r[0],n=r[1],a=r[2],o=r[4],s=r[5],l=r[6],u=r[8],c=r[9],d=r[10];return t[0]=Math.hypot(e,n,a),t[1]=Math.hypot(o,s,l),t[2]=Math.hypot(u,c,d),t}function getRotation(t,r){var e=new ARRAY_TYPE(3);getScaling(e,r);var n=1/e[0],a=1/e[1],o=1/e[2],s=r[0]*n,l=r[1]*a,u=r[2]*o,c=r[4]*n,d=r[5]*a,f=r[6]*o,h=r[8]*n,p=r[9]*a,v=r[10]*o,g=s+d+v,y=0;return g>0?(y=Math.sqrt(g+1)*2,t[3]=.25*y,t[0]=(f-p)/y,t[1]=(h-u)/y,t[2]=(l-c)/y):s>d&&s>v?(y=Math.sqrt(1+s-d-v)*2,t[3]=(f-p)/y,t[0]=.25*y,t[1]=(l+c)/y,t[2]=(h+u)/y):d>v?(y=Math.sqrt(1+d-s-v)*2,t[3]=(h-u)/y,t[0]=(l+c)/y,t[1]=.25*y,t[2]=(f+p)/y):(y=Math.sqrt(1+v-s-d)*2,t[3]=(l-c)/y,t[0]=(h+u)/y,t[1]=(f+p)/y,t[2]=.25*y),t}function fromRotationTranslationScale$1(t,r,e,n){var a=r[0],o=r[1],s=r[2],l=r[3],u=a+a,c=o+o,d=s+s,f=a*u,h=a*c,p=a*d,v=o*c,g=o*d,y=s*d,m=l*u,S=l*c,w=l*d,R=n[0],T=n[1],x=n[2];return t[0]=(1-(v+y))*R,t[1]=(h+w)*R,t[2]=(p-S)*R,t[3]=0,t[4]=(h-w)*T,t[5]=(1-(f+y))*T,t[6]=(g+m)*T,t[7]=0,t[8]=(p+S)*x,t[9]=(g-m)*x,t[10]=(1-(f+v))*x,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function fromRotationTranslationScaleOrigin(t,r,e,n,a){var o=r[0],s=r[1],l=r[2],u=r[3],c=o+o,d=s+s,f=l+l,h=o*c,p=o*d,v=o*f,g=s*d,y=s*f,m=l*f,S=u*c,w=u*d,R=u*f,T=n[0],x=n[1],b=n[2],L=a[0],M=a[1],D=a[2],N=(1-(g+m))*T,F=(p+R)*T,k=(v-w)*T,H=(p-R)*x,G=(1-(h+m))*x,z=(y+S)*x,$=(v+w)*b,W=(y-S)*b,V=(1-(h+g))*b;return t[0]=N,t[1]=F,t[2]=k,t[3]=0,t[4]=H,t[5]=G,t[6]=z,t[7]=0,t[8]=$,t[9]=W,t[10]=V,t[11]=0,t[12]=e[0]+L-(N*L+H*M+$*D),t[13]=e[1]+M-(F*L+G*M+W*D),t[14]=e[2]+D-(k*L+z*M+V*D),t[15]=1,t}function fromQuat(t,r){var e=r[0],n=r[1],a=r[2],o=r[3],s=e+e,l=n+n,u=a+a,c=e*s,d=n*s,f=n*l,h=a*s,p=a*l,v=a*u,g=o*s,y=o*l,m=o*u;return t[0]=1-f-v,t[1]=d+m,t[2]=h-y,t[3]=0,t[4]=d-m,t[5]=1-c-v,t[6]=p+g,t[7]=0,t[8]=h+y,t[9]=p-g,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function frustum(t,r,e,n,a,o,s){var l=1/(e-r),u=1/(a-n),c=1/(o-s);return t[0]=o*2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o*2*u,t[6]=0,t[7]=0,t[8]=(e+r)*l,t[9]=(a+n)*u,t[10]=(s+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*c,t[15]=0,t}function perspectiveNO(t,r,e,n,a){var o=1/Math.tan(r/2),s;return t[0]=o/e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,a!=null&&a!==1/0?(s=1/(n-a),t[10]=(a+n)*s,t[14]=2*a*n*s):(t[10]=-1,t[14]=-2*n),t}var perspective=perspectiveNO;function perspectiveZO(t,r,e,n,a){var o=1/Math.tan(r/2),s;return t[0]=o/e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,a!=null&&a!==1/0?(s=1/(n-a),t[10]=a*s,t[14]=a*n*s):(t[10]=-1,t[14]=-n),t}function perspectiveFromFieldOfView(t,r,e,n){var a=Math.tan(r.upDegrees*Math.PI/180),o=Math.tan(r.downDegrees*Math.PI/180),s=Math.tan(r.leftDegrees*Math.PI/180),l=Math.tan(r.rightDegrees*Math.PI/180),u=2/(s+l),c=2/(a+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-((s-l)*u*.5),t[9]=(a-o)*c*.5,t[10]=n/(e-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*e/(e-n),t[15]=0,t}function orthoNO(t,r,e,n,a,o,s){var l=1/(r-e),u=1/(n-a),c=1/(o-s);return t[0]=-2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(r+e)*l,t[13]=(a+n)*u,t[14]=(s+o)*c,t[15]=1,t}var ortho=orthoNO;function orthoZO(t,r,e,n,a,o,s){var l=1/(r-e),u=1/(n-a),c=1/(o-s);return t[0]=-2*l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=c,t[11]=0,t[12]=(r+e)*l,t[13]=(a+n)*u,t[14]=o*c,t[15]=1,t}function lookAt(t,r,e,n){var a,o,s,l,u,c,d,f,h,p,v=r[0],g=r[1],y=r[2],m=n[0],S=n[1],w=n[2],R=e[0],T=e[1],x=e[2];return Math.abs(v-R)<EPSILON$1&&Math.abs(g-T)<EPSILON$1&&Math.abs(y-x)<EPSILON$1?identity$1(t):(d=v-R,f=g-T,h=y-x,p=1/Math.hypot(d,f,h),d*=p,f*=p,h*=p,a=S*h-w*f,o=w*d-m*h,s=m*f-S*d,p=Math.hypot(a,o,s),p?(p=1/p,a*=p,o*=p,s*=p):(a=0,o=0,s=0),l=f*s-h*o,u=h*a-d*s,c=d*o-f*a,p=Math.hypot(l,u,c),p?(p=1/p,l*=p,u*=p,c*=p):(l=0,u=0,c=0),t[0]=a,t[1]=l,t[2]=d,t[3]=0,t[4]=o,t[5]=u,t[6]=f,t[7]=0,t[8]=s,t[9]=c,t[10]=h,t[11]=0,t[12]=-(a*v+o*g+s*y),t[13]=-(l*v+u*g+c*y),t[14]=-(d*v+f*g+h*y),t[15]=1,t)}function targetTo(t,r,e,n){var a=r[0],o=r[1],s=r[2],l=n[0],u=n[1],c=n[2],d=a-e[0],f=o-e[1],h=s-e[2],p=d*d+f*f+h*h;p>0&&(p=1/Math.sqrt(p),d*=p,f*=p,h*=p);var v=u*h-c*f,g=c*d-l*h,y=l*f-u*d;return p=v*v+g*g+y*y,p>0&&(p=1/Math.sqrt(p),v*=p,g*=p,y*=p),t[0]=v,t[1]=g,t[2]=y,t[3]=0,t[4]=f*y-h*g,t[5]=h*v-d*y,t[6]=d*g-f*v,t[7]=0,t[8]=d,t[9]=f,t[10]=h,t[11]=0,t[12]=a,t[13]=o,t[14]=s,t[15]=1,t}function str(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function frob(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function add$2(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t[3]=r[3]+e[3],t[4]=r[4]+e[4],t[5]=r[5]+e[5],t[6]=r[6]+e[6],t[7]=r[7]+e[7],t[8]=r[8]+e[8],t[9]=r[9]+e[9],t[10]=r[10]+e[10],t[11]=r[11]+e[11],t[12]=r[12]+e[12],t[13]=r[13]+e[13],t[14]=r[14]+e[14],t[15]=r[15]+e[15],t}function subtract$1(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t[3]=r[3]-e[3],t[4]=r[4]-e[4],t[5]=r[5]-e[5],t[6]=r[6]-e[6],t[7]=r[7]-e[7],t[8]=r[8]-e[8],t[9]=r[9]-e[9],t[10]=r[10]-e[10],t[11]=r[11]-e[11],t[12]=r[12]-e[12],t[13]=r[13]-e[13],t[14]=r[14]-e[14],t[15]=r[15]-e[15],t}function multiplyScalar(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t[3]=r[3]*e,t[4]=r[4]*e,t[5]=r[5]*e,t[6]=r[6]*e,t[7]=r[7]*e,t[8]=r[8]*e,t[9]=r[9]*e,t[10]=r[10]*e,t[11]=r[11]*e,t[12]=r[12]*e,t[13]=r[13]*e,t[14]=r[14]*e,t[15]=r[15]*e,t}function multiplyScalarAndAdd(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t[2]=r[2]+e[2]*n,t[3]=r[3]+e[3]*n,t[4]=r[4]+e[4]*n,t[5]=r[5]+e[5]*n,t[6]=r[6]+e[6]*n,t[7]=r[7]+e[7]*n,t[8]=r[8]+e[8]*n,t[9]=r[9]+e[9]*n,t[10]=r[10]+e[10]*n,t[11]=r[11]+e[11]*n,t[12]=r[12]+e[12]*n,t[13]=r[13]+e[13]*n,t[14]=r[14]+e[14]*n,t[15]=r[15]+e[15]*n,t}function exactEquals$1(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]&&t[4]===r[4]&&t[5]===r[5]&&t[6]===r[6]&&t[7]===r[7]&&t[8]===r[8]&&t[9]===r[9]&&t[10]===r[10]&&t[11]===r[11]&&t[12]===r[12]&&t[13]===r[13]&&t[14]===r[14]&&t[15]===r[15]}function equals$1(t,r){var e=t[0],n=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],d=t[8],f=t[9],h=t[10],p=t[11],v=t[12],g=t[13],y=t[14],m=t[15],S=r[0],w=r[1],R=r[2],T=r[3],x=r[4],b=r[5],L=r[6],M=r[7],D=r[8],N=r[9],F=r[10],k=r[11],H=r[12],G=r[13],z=r[14],$=r[15];return Math.abs(e-S)<=EPSILON$1*Math.max(1,Math.abs(e),Math.abs(S))&&Math.abs(n-w)<=EPSILON$1*Math.max(1,Math.abs(n),Math.abs(w))&&Math.abs(a-R)<=EPSILON$1*Math.max(1,Math.abs(a),Math.abs(R))&&Math.abs(o-T)<=EPSILON$1*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(s-x)<=EPSILON$1*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(l-b)<=EPSILON$1*Math.max(1,Math.abs(l),Math.abs(b))&&Math.abs(u-L)<=EPSILON$1*Math.max(1,Math.abs(u),Math.abs(L))&&Math.abs(c-M)<=EPSILON$1*Math.max(1,Math.abs(c),Math.abs(M))&&Math.abs(d-D)<=EPSILON$1*Math.max(1,Math.abs(d),Math.abs(D))&&Math.abs(f-N)<=EPSILON$1*Math.max(1,Math.abs(f),Math.abs(N))&&Math.abs(h-F)<=EPSILON$1*Math.max(1,Math.abs(h),Math.abs(F))&&Math.abs(p-k)<=EPSILON$1*Math.max(1,Math.abs(p),Math.abs(k))&&Math.abs(v-H)<=EPSILON$1*Math.max(1,Math.abs(v),Math.abs(H))&&Math.abs(g-G)<=EPSILON$1*Math.max(1,Math.abs(g),Math.abs(G))&&Math.abs(y-z)<=EPSILON$1*Math.max(1,Math.abs(y),Math.abs(z))&&Math.abs(m-$)<=EPSILON$1*Math.max(1,Math.abs(m),Math.abs($))}var mul$2=multiply$2,sub$1=subtract$1,mat4=Object.freeze({__proto__:null,add:add$2,adjoint,clone:clone$3,copy:copy$4,create:create$4,determinant,equals:equals$1,exactEquals:exactEquals$1,frob,fromQuat,fromQuat2,fromRotation,fromRotationTranslation,fromRotationTranslationScale:fromRotationTranslationScale$1,fromRotationTranslationScaleOrigin,fromScaling,fromTranslation,fromValues:fromValues$4,fromXRotation,fromYRotation,fromZRotation,frustum,getRotation,getScaling,getTranslation,identity:identity$1,invert:invert$1,lookAt,mul:mul$2,multiply:multiply$2,multiplyScalar,multiplyScalarAndAdd,ortho,orthoNO,orthoZO,perspective,perspectiveFromFieldOfView,perspectiveNO,perspectiveZO,rotate,rotateX,rotateY,rotateZ,scale:scale$2,set:set$2,str,sub:sub$1,subtract:subtract$1,targetTo,translate,transpose});function create$3(){var t=new ARRAY_TYPE(3);return ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function clone$2(t){var r=new ARRAY_TYPE(3);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r}function length(t){var r=t[0],e=t[1],n=t[2];return Math.hypot(r,e,n)}function fromValues$3(t,r,e){var n=new ARRAY_TYPE(3);return n[0]=t,n[1]=r,n[2]=e,n}function copy$3(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t}function set$1(t,r,e,n){return t[0]=r,t[1]=e,t[2]=n,t}function add$1(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t}function subtract(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t}function multiply$1(t,r,e){return t[0]=r[0]*e[0],t[1]=r[1]*e[1],t[2]=r[2]*e[2],t}function scale$1(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t}function distance$1(t,r){var e=r[0]-t[0],n=r[1]-t[1],a=r[2]-t[2];return Math.hypot(e,n,a)}function normalize$4(t,r){var e=r[0],n=r[1],a=r[2],o=e*e+n*n+a*a;return o>0&&(o=1/Math.sqrt(o)),t[0]=r[0]*o,t[1]=r[1]*o,t[2]=r[2]*o,t}function dot$2(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]}function cross(t,r,e){var n=r[0],a=r[1],o=r[2],s=e[0],l=e[1],u=e[2];return t[0]=a*u-o*l,t[1]=o*s-n*u,t[2]=n*l-a*s,t}function lerp(t,r,e,n){var a=r[0],o=r[1],s=r[2];return t[0]=a+n*(e[0]-a),t[1]=o+n*(e[1]-o),t[2]=s+n*(e[2]-s),t}function transformMat4$1(t,r,e){var n=r[0],a=r[1],o=r[2],s=e[3]*n+e[7]*a+e[11]*o+e[15];return s=s||1,t[0]=(e[0]*n+e[4]*a+e[8]*o+e[12])/s,t[1]=(e[1]*n+e[5]*a+e[9]*o+e[13])/s,t[2]=(e[2]*n+e[6]*a+e[10]*o+e[14])/s,t}function transformMat3(t,r,e){var n=r[0],a=r[1],o=r[2];return t[0]=n*e[0]+a*e[3]+o*e[6],t[1]=n*e[1]+a*e[4]+o*e[7],t[2]=n*e[2]+a*e[5]+o*e[8],t}function transformQuat(t,r,e){var n=e[0],a=e[1],o=e[2],s=e[3],l=r[0],u=r[1],c=r[2],d=a*c-o*u,f=o*l-n*c,h=n*u-a*l,p=a*h-o*f,v=o*d-n*h,g=n*f-a*d,y=s*2;return d*=y,f*=y,h*=y,p*=2,v*=2,g*=2,t[0]=l+d+p,t[1]=u+f+v,t[2]=c+h+g,t}function equals(t,r){var e=t[0],n=t[1],a=t[2],o=r[0],s=r[1],l=r[2];return Math.abs(e-o)<=EPSILON$1*Math.max(1,Math.abs(e),Math.abs(o))&&Math.abs(n-s)<=EPSILON$1*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-l)<=EPSILON$1*Math.max(1,Math.abs(a),Math.abs(l))}var dist=distance$1,len=length;(function(){var t=create$3();return function(r,e,n,a,o,s){var l,u;for(e||(e=3),n||(n=0),a?u=Math.min(a*e+n,r.length):u=r.length,l=n;l<u;l+=e)t[0]=r[l],t[1]=r[l+1],t[2]=r[l+2],o(t,t,s),r[l]=t[0],r[l+1]=t[1],r[l+2]=t[2];return r}})();function create$2(){var t=new ARRAY_TYPE(4);return ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function fromValues$2(t,r,e,n){var a=new ARRAY_TYPE(4);return a[0]=t,a[1]=r,a[2]=e,a[3]=n,a}function copy$2(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t}function normalize$3(t,r){var e=r[0],n=r[1],a=r[2],o=r[3],s=e*e+n*n+a*a+o*o;return s>0&&(s=1/Math.sqrt(s)),t[0]=e*s,t[1]=n*s,t[2]=a*s,t[3]=o*s,t}function transformMat4(t,r,e){var n=r[0],a=r[1],o=r[2],s=r[3];return t[0]=e[0]*n+e[4]*a+e[8]*o+e[12]*s,t[1]=e[1]*n+e[5]*a+e[9]*o+e[13]*s,t[2]=e[2]*n+e[6]*a+e[10]*o+e[14]*s,t[3]=e[3]*n+e[7]*a+e[11]*o+e[15]*s,t}(function(){var t=create$2();return function(r,e,n,a,o,s){var l,u;for(e||(e=4),n||(n=0),a?u=Math.min(a*e+n,r.length):u=r.length,l=n;l<u;l+=e)t[0]=r[l],t[1]=r[l+1],t[2]=r[l+2],t[3]=r[l+3],o(t,t,s),r[l]=t[0],r[l+1]=t[1],r[l+2]=t[2],r[l+3]=t[3];return r}})();function create$1(){var t=new ARRAY_TYPE(4);return ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function setAxisAngle(t,r,e){e=e*.5;var n=Math.sin(e);return t[0]=n*r[0],t[1]=n*r[1],t[2]=n*r[2],t[3]=Math.cos(e),t}function multiply(t,r,e){var n=r[0],a=r[1],o=r[2],s=r[3],l=e[0],u=e[1],c=e[2],d=e[3];return t[0]=n*d+s*l+a*c-o*u,t[1]=a*d+s*u+o*l-n*c,t[2]=o*d+s*c+n*u-a*l,t[3]=s*d-n*l-a*u-o*c,t}function slerp(t,r,e,n){var a=r[0],o=r[1],s=r[2],l=r[3],u=e[0],c=e[1],d=e[2],f=e[3],h,p,v,g,y;return p=a*u+o*c+s*d+l*f,p<0&&(p=-p,u=-u,c=-c,d=-d,f=-f),1-p>EPSILON$1?(h=Math.acos(p),v=Math.sin(h),g=Math.sin((1-n)*h)/v,y=Math.sin(n*h)/v):(g=1-n,y=n),t[0]=g*a+y*u,t[1]=g*o+y*c,t[2]=g*s+y*d,t[3]=g*l+y*f,t}function invert(t,r){var e=r[0],n=r[1],a=r[2],o=r[3],s=e*e+n*n+a*a+o*o,l=s?1/s:0;return t[0]=-e*l,t[1]=-n*l,t[2]=-a*l,t[3]=o*l,t}function fromMat3(t,r){var e=r[0]+r[4]+r[8],n;if(e>0)n=Math.sqrt(e+1),t[3]=.5*n,n=.5/n,t[0]=(r[5]-r[7])*n,t[1]=(r[6]-r[2])*n,t[2]=(r[1]-r[3])*n;else{var a=0;r[4]>r[0]&&(a=1),r[8]>r[a*3+a]&&(a=2);var o=(a+1)%3,s=(a+2)%3;n=Math.sqrt(r[a*3+a]-r[o*3+o]-r[s*3+s]+1),t[a]=.5*n,n=.5/n,t[3]=(r[o*3+s]-r[s*3+o])*n,t[o]=(r[o*3+a]+r[a*3+o])*n,t[s]=(r[s*3+a]+r[a*3+s])*n}return t}function fromEuler(t,r,e,n){var a=.5*Math.PI/180;r*=a,e*=a,n*=a;var o=Math.sin(r),s=Math.cos(r),l=Math.sin(e),u=Math.cos(e),c=Math.sin(n),d=Math.cos(n);return t[0]=o*u*d-s*l*c,t[1]=s*l*d+o*u*c,t[2]=s*u*c-o*l*d,t[3]=s*u*d+o*l*c,t}var fromValues$1=fromValues$2,copy$1=copy$2,mul$1=multiply,normalize$2=normalize$3;(function(){var t=create$3(),r=fromValues$3(1,0,0),e=fromValues$3(0,1,0);return function(n,a,o){var s=dot$2(a,o);return s<-.999999?(cross(t,r,a),len(t)<1e-6&&cross(t,e,a),normalize$4(t,t),setAxisAngle(n,t,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(cross(t,a,o),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+s,normalize$2(n,n))}})();(function(){var t=create$1(),r=create$1();return function(e,n,a,o,s,l){return slerp(t,n,s,l),slerp(r,a,o,l),slerp(e,t,r,2*l*(1-l)),e}})();(function(){var t=create$5();return function(r,e,n,a){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=a[0],t[4]=a[1],t[7]=a[2],t[2]=-e[0],t[5]=-e[1],t[8]=-e[2],normalize$2(r,fromMat3(r,t))}})();function create(){var t=new ARRAY_TYPE(2);return ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0),t}function fromValues(t,r){var e=new ARRAY_TYPE(2);return e[0]=t,e[1]=r,e}function copy(t,r){return t[0]=r[0],t[1]=r[1],t}function normalize$1(t,r){var e=r[0],n=r[1],a=e*e+n*n;return a>0&&(a=1/Math.sqrt(a)),t[0]=r[0]*a,t[1]=r[1]*a,t}function dot$1(t,r){return t[0]*r[0]+t[1]*r[1]}function exactEquals(t,r){return t[0]===r[0]&&t[1]===r[1]}(function(){var t=create();return function(r,e,n,a,o,s){var l,u;for(e||(e=2),n||(n=0),a?u=Math.min(a*e+n,r.length):u=r.length,l=n;l<u;l+=e)t[0]=r[l],t[1]=r[l+1],o(t,t,s),r[l]=t[0],r[l+1]=t[1];return r}})();var isNil$1=function(t){return t==null},toString$1={}.toString,isType=function(t,r){return toString$1.call(t)==="[object "+r+"]"},isArray$1=function(t){return Array.isArray?Array.isArray(t):isType(t,"Array")},isObject$1=function(t){var r=typeof t;return t!==null&&r==="object"||r==="function"},max$2=function(t){if(isArray$1(t))return t.reduce(function(r,e){return Math.max(r,e)},t[0])},min$2=function(t){if(isArray$1(t))return t.reduce(function(r,e){return Math.min(r,e)},t[0])},isString$1=function(t){return isType(t,"String")},clamp$2=function(t,r,e){return t<r?r:t>e?e:t},isNumber$1=function(t){return isType(t,"Number")},PRECISION$1=1e-5;function isNumberEqual(t,r,e){return e===void 0&&(e=PRECISION$1),Math.abs(t-r)<e}var mod$1=function(t,r){return(t%r+r)%r},isBoolean$1=function(t){return isType(t,"Boolean")},isUndefined$1=function(t){return t===void 0},paramsParser={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function fixArc(t,r,e){if(t[e].length>7){t[e].shift();for(var n=t[e],a=e;n.length;)r[e]="A",t.splice(a+=1,0,["C"].concat(n.splice(0,6)));t.splice(e,1)}}var paramsCount={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function isPathArray(t){return Array.isArray(t)&&t.every(function(r){var e=r[0].toLowerCase();return paramsCount[e]===r.length-1&&"achlmqstvz".includes(e)})}function isAbsoluteArray(t){return isPathArray(t)&&t.every(function(r){var e=r[0];return e===e.toUpperCase()})}function isNormalizedArray(t){return isAbsoluteArray(t)&&t.every(function(r){var e=r[0];return"ACLMQZ".includes(e)})}function finalizeSegment(t){for(var r=t.pathValue[t.segmentStart],e=r.toLowerCase(),n=t.data;n.length>=paramsCount[e]&&(e==="m"&&n.length>2?(t.segments.push([r].concat(n.splice(0,2))),e="l",r=r==="m"?"l":"L"):t.segments.push([r].concat(n.splice(0,paramsCount[e]))),!!paramsCount[e]););}function scanFlag(t){var r=t.index,e=t.pathValue,n=e.charCodeAt(r);if(n===48){t.param=0,t.index+=1;return}if(n===49){t.param=1,t.index+=1;return}t.err='[path-util]: invalid Arc flag "'+e[r]+'", expecting 0 or 1 at index '+r}function isDigitStart(t){return t>=48&&t<=57||t===43||t===45||t===46}function isDigit(t){return t>=48&&t<=57}function scanParam(t){var r=t.max,e=t.pathValue,n=t.index,a=n,o=!1,s=!1,l=!1,u=!1,c;if(a>=r){t.err="[path-util]: Invalid path value at index "+a+', "pathValue" is missing param';return}if(c=e.charCodeAt(a),(c===43||c===45)&&(a+=1,c=e.charCodeAt(a)),!isDigit(c)&&c!==46){t.err="[path-util]: Invalid path value at index "+a+', "'+e[a]+'" is not a number';return}if(c!==46){if(o=c===48,a+=1,c=e.charCodeAt(a),o&&a<r&&c&&isDigit(c)){t.err="[path-util]: Invalid path value at index "+n+', "'+e[n]+'" illegal number';return}for(;a<r&&isDigit(e.charCodeAt(a));)a+=1,s=!0;c=e.charCodeAt(a)}if(c===46){for(u=!0,a+=1;isDigit(e.charCodeAt(a));)a+=1,l=!0;c=e.charCodeAt(a)}if(c===101||c===69){if(u&&!s&&!l){t.err="[path-util]: Invalid path value at index "+a+', "'+e[a]+'" invalid float exponent';return}if(a+=1,c=e.charCodeAt(a),(c===43||c===45)&&(a+=1),a<r&&isDigit(e.charCodeAt(a)))for(;a<r&&isDigit(e.charCodeAt(a));)a+=1;else{t.err="[path-util]: Invalid path value at index "+a+', "'+e[a]+'" invalid integer exponent';return}}t.index=a,t.param=+t.pathValue.slice(n,a)}function isSpace(t){var r=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];return t===10||t===13||t===8232||t===8233||t===32||t===9||t===11||t===12||t===160||t>=5760&&r.includes(t)}function skipSpaces(t){for(var r=t.pathValue,e=t.max;t.index<e&&isSpace(r.charCodeAt(t.index));)t.index+=1}function isPathCommand(t){switch(t|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}function isArcCommand(t){return(t|32)===97}function scanSegment(t){var r=t.max,e=t.pathValue,n=t.index,a=e.charCodeAt(n),o=paramsCount[e[n].toLowerCase()];if(t.segmentStart=n,!isPathCommand(a)){t.err='[path-util]: Invalid path value "'+e[n]+'" is not a path command';return}if(t.index+=1,skipSpaces(t),t.data=[],!o){finalizeSegment(t);return}for(;;){for(var s=o;s>0;s-=1){if(isArcCommand(a)&&(s===3||s===4)?scanFlag(t):scanParam(t),t.err.length)return;t.data.push(t.param),skipSpaces(t),t.index<r&&e.charCodeAt(t.index)===44&&(t.index+=1,skipSpaces(t))}if(t.index>=t.max||!isDigitStart(e.charCodeAt(t.index)))break}finalizeSegment(t)}var PathParser=function(){function t(r){this.pathValue=r,this.segments=[],this.max=r.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}return t}();function parsePathString(t){if(isPathArray(t))return[].concat(t);var r=new PathParser(t);for(skipSpaces(r);r.index<r.max&&!r.err.length;)scanSegment(r);return r.err?r.err:r.segments}function path2Absolute(t){if(isAbsoluteArray(t))return[].concat(t);var r=parsePathString(t),e=0,n=0,a=0,o=0;return r.map(function(s){var l=s.slice(1).map(Number),u=s[0],c=u.toUpperCase();if(u==="M")return e=l[0],n=l[1],a=e,o=n,["M",e,n];var d;if(u!==c)switch(c){case"A":d=[c,l[0],l[1],l[2],l[3],l[4],l[5]+e,l[6]+n];break;case"V":d=[c,l[0]+n];break;case"H":d=[c,l[0]+e];break;default:{var f=l.map(function(p,v){return p+(v%2?n:e)});d=[c].concat(f)}}else d=[c].concat(l);var h=d.length;switch(c){case"Z":e=a,n=o;break;case"H":e=d[1];break;case"V":n=d[1];break;default:e=d[h-2],n=d[h-1],c==="M"&&(a=e,o=n)}return d})}function normalizeSegment(t,r){var e=t[0],n=r.x1,a=r.y1,o=r.x2,s=r.y2,l=t.slice(1).map(Number),u=t;if("TQ".includes(e)||(r.qx=null,r.qy=null),e==="H")u=["L",t[1],a];else if(e==="V")u=["L",n,t[1]];else if(e==="S"){var c=n*2-o,d=a*2-s;r.x1=c,r.y1=d,u=["C",c,d].concat(l)}else if(e==="T"){var f=n*2-r.qx,h=a*2-r.qy;r.qx=f,r.qy=h,u=["Q",f,h].concat(l)}else if(e==="Q"){var p=l[0],v=l[1];r.qx=p,r.qy=v}return u}function normalizePath(t){if(isNormalizedArray(t))return[].concat(t);for(var r=path2Absolute(t),e=__assign({},paramsParser),n=0;n<r.length;n+=1){r[n]=normalizeSegment(r[n],e);var a=r[n],o=a.length;e.x1=+a[o-2],e.y1=+a[o-1],e.x2=+a[o-4]||e.x1,e.y2=+a[o-3]||e.y1}return r}function isCurveArray(t){return isNormalizedArray(t)&&t.every(function(r){var e=r[0];return"MC".includes(e)})}function rotateVector(t,r,e){var n=t*Math.cos(e)-r*Math.sin(e),a=t*Math.sin(e)+r*Math.cos(e);return{x:n,y:a}}function arcToCubic(t,r,e,n,a,o,s,l,u,c){var d=t,f=r,h=e,p=n,v=l,g=u,y=Math.PI*120/180,m=Math.PI/180*(+a||0),S=[],w,R,T,x,b;if(c)R=c[0],T=c[1],x=c[2],b=c[3];else{w=rotateVector(d,f,-m),d=w.x,f=w.y,w=rotateVector(v,g,-m),v=w.x,g=w.y;var L=(d-v)/2,M=(f-g)/2,D=L*L/(h*h)+M*M/(p*p);D>1&&(D=Math.sqrt(D),h*=D,p*=D);var N=h*h,F=p*p,k=(o===s?-1:1)*Math.sqrt(Math.abs((N*F-N*M*M-F*L*L)/(N*M*M+F*L*L)));x=k*h*M/p+(d+v)/2,b=k*-p*L/h+(f+g)/2,R=Math.asin(((f-b)/p*Math.pow(10,9)>>0)/Math.pow(10,9)),T=Math.asin(((g-b)/p*Math.pow(10,9)>>0)/Math.pow(10,9)),R=d<x?Math.PI-R:R,T=v<x?Math.PI-T:T,R<0&&(R=Math.PI*2+R),T<0&&(T=Math.PI*2+T),s&&R>T&&(R-=Math.PI*2),!s&&T>R&&(T-=Math.PI*2)}var H=T-R;if(Math.abs(H)>y){var G=T,z=v,$=g;T=R+y*(s&&T>R?1:-1),v=x+h*Math.cos(T),g=b+p*Math.sin(T),S=arcToCubic(v,g,h,p,a,0,s,z,$,[T,G,x,b])}H=T-R;var W=Math.cos(R),V=Math.sin(R),X=Math.cos(T),J=Math.sin(T),j=Math.tan(H/4),ne=4/3*h*j,Q=4/3*p*j,ie=[d,f],te=[d+ne*V,f-Q*W],oe=[v+ne*J,g-Q*X],ae=[v,g];if(te[0]=2*ie[0]-te[0],te[1]=2*ie[1]-te[1],c)return te.concat(oe,ae,S);S=te.concat(oe,ae,S);for(var le=[],se=0,fe=S.length;se<fe;se+=1)le[se]=se%2?rotateVector(S[se-1],S[se],m).y:rotateVector(S[se],S[se+1],m).x;return le}function quadToCubic(t,r,e,n,a,o){var s=.3333333333333333,l=2/3;return[s*t+l*e,s*r+l*n,s*a+l*e,s*o+l*n,a,o]}function midPoint(t,r,e){var n=t[0],a=t[1],o=r[0],s=r[1];return[n+(o-n)*e,a+(s-a)*e]}var lineToCubic=function(t,r,e,n){var a=.5,o=midPoint([t,r],[e,n],a);return __spreadArray(__spreadArray([],o,!0),[e,n,e,n],!1)};function segmentToCubic(t,r){var e=t[0],n=t.slice(1).map(Number),a=n[0],o=n[1],s,l=r.x1,u=r.y1,c=r.x,d=r.y;switch("TQ".includes(e)||(r.qx=null,r.qy=null),e){case"M":return r.x=a,r.y=o,t;case"A":return s=[l,u].concat(n),["C"].concat(arcToCubic(s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],s[8],s[9]));case"Q":return r.qx=a,r.qy=o,s=[l,u].concat(n),["C"].concat(quadToCubic(s[0],s[1],s[2],s[3],s[4],s[5]));case"L":return["C"].concat(lineToCubic(l,u,a,o));case"Z":return l===c&&u===d?["C",l,u,c,d,c,d]:["C"].concat(lineToCubic(l,u,c,d))}return t}function path2Curve(t,r){if(r===void 0&&(r=!1),isCurveArray(t)){var e=[].concat(t);return r?[e,[]]:e}for(var n=normalizePath(t),a=__assign({},paramsParser),o=[],s="",l=n.length,u,c,d=[],f=0;f<l;f+=1){n[f]&&(s=n[f][0]),o[f]=s;var h=segmentToCubic(n[f],a);n[f]=h,fixArc(n,o,f),l=n.length,s==="Z"&&d.push(f),u=n[f],c=u.length,a.x1=+u[c-2],a.y1=+u[c-1],a.x2=+u[c-4]||a.x1,a.y2=+u[c-3]||a.y1}return r?[n,d]:n}function clonePath(t){return t.map(function(r){return Array.isArray(r)?[].concat(r):r})}function reverseCurve(t){var r=t.slice(1).map(function(e,n,a){return n?a[n-1].slice(-2).concat(e.slice(1)):t[0].slice(1).concat(e.slice(1))}).map(function(e){return e.map(function(n,a){return e[e.length-a-2*(1-a%2)]})}).reverse();return[["M"].concat(r[0].slice(0,2))].concat(r.map(function(e){return["C"].concat(e.slice(2))}))}function distanceSquareRoot(t,r){return Math.sqrt((t[0]-r[0])*(t[0]-r[0])+(t[1]-r[1])*(t[1]-r[1]))}function segmentLineFactory(t,r,e,n,a){var o=distanceSquareRoot([t,r],[e,n]),s={x:0,y:0};if(typeof a=="number")if(a<=0)s={x:t,y:r};else if(a>=o)s={x:e,y:n};else{var l=midPoint([t,r],[e,n],a/o),u=l[0],c=l[1];s={x:u,y:c}}return{length:o,point:s,min:{x:Math.min(t,e),y:Math.min(r,n)},max:{x:Math.max(t,e),y:Math.max(r,n)}}}function angleBetween$1(t,r){var e=t.x,n=t.y,a=r.x,o=r.y,s=e*a+n*o,l=Math.sqrt((Math.pow(e,2)+Math.pow(n,2))*(Math.pow(a,2)+Math.pow(o,2))),u=e*o-n*a<0?-1:1,c=u*Math.acos(s/l);return c}function getPointAtArcSegmentLength(t,r,e,n,a,o,s,l,u,c){var d=Math.abs,f=Math.sin,h=Math.cos,p=Math.sqrt,v=Math.PI,g=d(e),y=d(n),m=(a%360+360)%360,S=m*(v/180);if(t===l&&r===u)return{x:t,y:r};if(g===0||y===0)return segmentLineFactory(t,r,l,u,c).point;var w=(t-l)/2,R=(r-u)/2,T={x:h(S)*w+f(S)*R,y:-f(S)*w+h(S)*R},x=Math.pow(T.x,2)/Math.pow(g,2)+Math.pow(T.y,2)/Math.pow(y,2);x>1&&(g*=p(x),y*=p(x));var b=Math.pow(g,2)*Math.pow(y,2)-Math.pow(g,2)*Math.pow(T.y,2)-Math.pow(y,2)*Math.pow(T.x,2),L=Math.pow(g,2)*Math.pow(T.y,2)+Math.pow(y,2)*Math.pow(T.x,2),M=b/L;M=M<0?0:M;var D=(o!==s?1:-1)*p(M),N={x:D*(g*T.y/y),y:D*(-(y*T.x)/g)},F={x:h(S)*N.x-f(S)*N.y+(t+l)/2,y:f(S)*N.x+h(S)*N.y+(r+u)/2},k={x:(T.x-N.x)/g,y:(T.y-N.y)/y},H=angleBetween$1({x:1,y:0},k),G={x:(-T.x-N.x)/g,y:(-T.y-N.y)/y},z=angleBetween$1(k,G);!s&&z>0?z-=2*v:s&&z<0&&(z+=2*v),z%=2*v;var $=H+z*c,W=g*h($),V=y*f($),X={x:h(S)*W-f(S)*V+F.x,y:f(S)*W+h(S)*V+F.y};return X}function segmentArcFactory(t,r,e,n,a,o,s,l,u,c,d){var f,h=d.bbox,p=h===void 0?!0:h,v=d.length,g=v===void 0?!0:v,y=d.sampleSize,m=y===void 0?30:y,S=typeof c=="number",w=t,R=r,T=0,x=[w,R,T],b=[w,R],L=0,M={x:0,y:0},D=[{x:w,y:R}];S&&c<=0&&(M={x:w,y:R});for(var N=0;N<=m;N+=1){if(L=N/m,f=getPointAtArcSegmentLength(t,r,e,n,a,o,s,l,u,L),w=f.x,R=f.y,p&&D.push({x:w,y:R}),g&&(T+=distanceSquareRoot(b,[w,R])),b=[w,R],S&&T>=c&&c>x[2]){var F=(T-c)/(T-x[2]);M={x:b[0]*(1-F)+x[0]*F,y:b[1]*(1-F)+x[1]*F}}x=[w,R,T]}return S&&c>=T&&(M={x:l,y:u}),{length:T,point:M,min:{x:Math.min.apply(null,D.map(function(k){return k.x})),y:Math.min.apply(null,D.map(function(k){return k.y}))},max:{x:Math.max.apply(null,D.map(function(k){return k.x})),y:Math.max.apply(null,D.map(function(k){return k.y}))}}}function getPointAtCubicSegmentLength(t,r,e,n,a,o,s,l,u){var c=1-u;return{x:Math.pow(c,3)*t+3*Math.pow(c,2)*u*e+3*c*Math.pow(u,2)*a+Math.pow(u,3)*s,y:Math.pow(c,3)*r+3*Math.pow(c,2)*u*n+3*c*Math.pow(u,2)*o+Math.pow(u,3)*l}}function segmentCubicFactory(t,r,e,n,a,o,s,l,u,c){var d,f=c.bbox,h=f===void 0?!0:f,p=c.length,v=p===void 0?!0:p,g=c.sampleSize,y=g===void 0?10:g,m=typeof u=="number",S=t,w=r,R=0,T=[S,w,R],x=[S,w],b=0,L={x:0,y:0},M=[{x:S,y:w}];m&&u<=0&&(L={x:S,y:w});for(var D=0;D<=y;D+=1){if(b=D/y,d=getPointAtCubicSegmentLength(t,r,e,n,a,o,s,l,b),S=d.x,w=d.y,h&&M.push({x:S,y:w}),v&&(R+=distanceSquareRoot(x,[S,w])),x=[S,w],m&&R>=u&&u>T[2]){var N=(R-u)/(R-T[2]);L={x:x[0]*(1-N)+T[0]*N,y:x[1]*(1-N)+T[1]*N}}T=[S,w,R]}return m&&u>=R&&(L={x:s,y:l}),{length:R,point:L,min:{x:Math.min.apply(null,M.map(function(F){return F.x})),y:Math.min.apply(null,M.map(function(F){return F.y}))},max:{x:Math.max.apply(null,M.map(function(F){return F.x})),y:Math.max.apply(null,M.map(function(F){return F.y}))}}}function getPointAtQuadSegmentLength(t,r,e,n,a,o,s){var l=1-s;return{x:Math.pow(l,2)*t+2*l*s*e+Math.pow(s,2)*a,y:Math.pow(l,2)*r+2*l*s*n+Math.pow(s,2)*o}}function segmentQuadFactory(t,r,e,n,a,o,s,l){var u,c=l.bbox,d=c===void 0?!0:c,f=l.length,h=f===void 0?!0:f,p=l.sampleSize,v=p===void 0?10:p,g=typeof s=="number",y=t,m=r,S=0,w=[y,m,S],R=[y,m],T=0,x={x:0,y:0},b=[{x:y,y:m}];g&&s<=0&&(x={x:y,y:m});for(var L=0;L<=v;L+=1){if(T=L/v,u=getPointAtQuadSegmentLength(t,r,e,n,a,o,T),y=u.x,m=u.y,d&&b.push({x:y,y:m}),h&&(S+=distanceSquareRoot(R,[y,m])),R=[y,m],g&&S>=s&&s>w[2]){var M=(S-s)/(S-w[2]);x={x:R[0]*(1-M)+w[0]*M,y:R[1]*(1-M)+w[1]*M}}w=[y,m,S]}return g&&s>=S&&(x={x:a,y:o}),{length:S,point:x,min:{x:Math.min.apply(null,b.map(function(D){return D.x})),y:Math.min.apply(null,b.map(function(D){return D.y}))},max:{x:Math.max.apply(null,b.map(function(D){return D.x})),y:Math.max.apply(null,b.map(function(D){return D.y}))}}}function pathLengthFactory(t,r,e){for(var n,a,o,s,l,u,c=normalizePath(t),d=typeof r=="number",f,h=[],p,v=0,g=0,y=0,m=0,S,w=[],R=[],T=0,x={x:0,y:0},b=x,L=x,M=x,D=0,N=0,F=c.length;N<F;N+=1)S=c[N],p=S[0],f=p==="M",h=f?h:[v,g].concat(S.slice(1)),f?(y=S[1],m=S[2],x={x:y,y:m},b=x,T=0,d&&r<.001&&(M=x)):p==="L"?(n=segmentLineFactory(h[0],h[1],h[2],h[3],(r||0)-D),T=n.length,x=n.min,b=n.max,L=n.point):p==="A"?(a=segmentArcFactory(h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],h[8],(r||0)-D,e||{}),T=a.length,x=a.min,b=a.max,L=a.point):p==="C"?(o=segmentCubicFactory(h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],(r||0)-D,e||{}),T=o.length,x=o.min,b=o.max,L=o.point):p==="Q"?(s=segmentQuadFactory(h[0],h[1],h[2],h[3],h[4],h[5],(r||0)-D,e||{}),T=s.length,x=s.min,b=s.max,L=s.point):p==="Z"&&(h=[v,g,y,m],l=segmentLineFactory(h[0],h[1],h[2],h[3],(r||0)-D),T=l.length,x=l.min,b=l.max,L=l.point),d&&D<r&&D+T>=r&&(M=L),R.push(b),w.push(x),D+=T,u=p!=="Z"?S.slice(-2):[y,m],v=u[0],g=u[1];return d&&r>=D&&(M={x:v,y:g}),{length:D,point:M,min:{x:Math.min.apply(null,w.map(function(k){return k.x})),y:Math.min.apply(null,w.map(function(k){return k.y}))},max:{x:Math.max.apply(null,R.map(function(k){return k.x})),y:Math.max.apply(null,R.map(function(k){return k.y}))}}}function getTotalLength(t,r){return pathLengthFactory(t,void 0,__assign(__assign({},r),{bbox:!1,length:!0})).length}function getRotations(t){var r=t.length,e=r-1;return t.map(function(n,a){return t.map(function(o,s){var l=a+s,u;return s===0||t[l]&&t[l][0]==="M"?(u=t[l],["M"].concat(u.slice(-2))):(l>=r&&(l-=e),t[l])})})}function getRotatedCurve(t,r){var e=t.length-1,n=[],a=0,o=0,s=getRotations(t);return s.forEach(function(l,u){t.slice(1).forEach(function(c,d){o+=distanceSquareRoot(t[(u+d)%e].slice(-2),r[d%e].slice(-2))}),n[u]=o,o=0}),a=n.indexOf(Math.min.apply(null,n)),s[a]}function getCubicSegArea(t,r,e,n,a,o,s,l){return 3*((l-r)*(e+a)-(s-t)*(n+o)+n*(t-a)-e*(r-o)+l*(a+t/3)-s*(o+r/3))/20}function getPathArea(t){var r=0,e=0,n=0;return path2Curve(t).map(function(a){var o;switch(a[0]){case"M":return r=a[1],e=a[2],0;default:var s=a.slice(1),l=s[0],u=s[1],c=s[2],d=s[3],f=s[4],h=s[5];return n=getCubicSegArea(r,e,l,u,c,d,f,h),o=a.slice(-2),r=o[0],e=o[1],n}}).reduce(function(a,o){return a+o},0)}function getDrawDirection(t){return getPathArea(t)>=0}function getPointAtLength(t,r,e){return pathLengthFactory(t,r,__assign(__assign({},e),{bbox:!1,length:!0})).point}function splitCubic(t,r){r===void 0&&(r=.5);var e=t.slice(0,2),n=t.slice(2,4),a=t.slice(4,6),o=t.slice(6,8),s=midPoint(e,n,r),l=midPoint(n,a,r),u=midPoint(a,o,r),c=midPoint(s,l,r),d=midPoint(l,u,r),f=midPoint(c,d,r);return[["C"].concat(s,c,f),["C"].concat(d,u,o)]}function getCurveArray(t){return t.map(function(r,e,n){var a=e&&n[e-1].slice(-2).concat(r.slice(1)),o=e?segmentCubicFactory(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],{bbox:!1}).length:0,s;return e?s=o?splitCubic(a):[r,r]:s=[r],{s:r,ss:s,l:o}})}function equalizeSegments(t,r,e){var n=getCurveArray(t),a=getCurveArray(r),o=n.length,s=a.length,l=n.filter(function(y){return y.l}).length,u=a.filter(function(y){return y.l}).length,c=n.filter(function(y){return y.l}).reduce(function(y,m){var S=m.l;return y+S},0)/l||0,d=a.filter(function(y){return y.l}).reduce(function(y,m){var S=m.l;return y+S},0)/u||0,f=e||Math.max(o,s),h=[c,d],p=[f-o,f-s],v=0,g=[n,a].map(function(y,m){return y.l===f?y.map(function(S){return S.s}):y.map(function(S,w){return v=w&&p[m]&&S.l>=h[m],p[m]-=v?1:0,v?S.ss:[S.s]}).flat()});return g[0].length===g[1].length?g:equalizeSegments(g[0],g[1],f)}function define(t,r,e){t.prototype=r.prototype=e,e.constructor=t}function extend(t,r){var e=Object.create(t.prototype);for(var n in r)e[n]=r[n];return e}function Color(){}var darker=.7,brighter=1/darker,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp("^rgb\\("+[reI,reI,reI]+"\\)$"),reRgbPercent=new RegExp("^rgb\\("+[reP,reP,reP]+"\\)$"),reRgbaInteger=new RegExp("^rgba\\("+[reI,reI,reI,reN]+"\\)$"),reRgbaPercent=new RegExp("^rgba\\("+[reP,reP,reP,reN]+"\\)$"),reHslPercent=new RegExp("^hsl\\("+[reN,reP,reP]+"\\)$"),reHslaPercent=new RegExp("^hsla\\("+[reN,reP,reP,reN]+"\\)$"),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};define(Color,color,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHsl:color_formatHsl,formatRgb:color_formatRgb,toString:color_formatRgb});function color_formatHex(){return this.rgb().formatHex()}function color_formatHsl(){return hslConvert(this).formatHsl()}function color_formatRgb(){return this.rgb().formatRgb()}function color(t){var r,e;return t=(t+"").trim().toLowerCase(),(r=reHex.exec(t))?(e=r[1].length,r=parseInt(r[1],16),e===6?rgbn(r):e===3?new Rgb(r>>8&15|r>>4&240,r>>4&15|r&240,(r&15)<<4|r&15,1):e===8?rgba(r>>24&255,r>>16&255,r>>8&255,(r&255)/255):e===4?rgba(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|r&240,((r&15)<<4|r&15)/255):null):(r=reRgbInteger.exec(t))?new Rgb(r[1],r[2],r[3],1):(r=reRgbPercent.exec(t))?new Rgb(r[1]*255/100,r[2]*255/100,r[3]*255/100,1):(r=reRgbaInteger.exec(t))?rgba(r[1],r[2],r[3],r[4]):(r=reRgbaPercent.exec(t))?rgba(r[1]*255/100,r[2]*255/100,r[3]*255/100,r[4]):(r=reHslPercent.exec(t))?hsla(r[1],r[2]/100,r[3]/100,1):(r=reHslaPercent.exec(t))?hsla(r[1],r[2]/100,r[3]/100,r[4]):named.hasOwnProperty(t)?rgbn(named[t]):t==="transparent"?new Rgb(NaN,NaN,NaN,0):null}function rgbn(t){return new Rgb(t>>16&255,t>>8&255,t&255,1)}function rgba(t,r,e,n){return n<=0&&(t=r=e=NaN),new Rgb(t,r,e,n)}function rgbConvert(t){return t instanceof Color||(t=color(t)),t?(t=t.rgb(),new Rgb(t.r,t.g,t.b,t.opacity)):new Rgb}function rgb$1(t,r,e,n){return arguments.length===1?rgbConvert(t):new Rgb(t,r,e,n??1)}function Rgb(t,r,e,n){this.r=+t,this.g=+r,this.b=+e,this.opacity=+n}define(Rgb,rgb$1,extend(Color,{brighter:function(t){return t=t==null?brighter:Math.pow(brighter,t),new Rgb(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?darker:Math.pow(darker,t),new Rgb(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatRgb:rgb_formatRgb,toString:rgb_formatRgb}));function rgb_formatHex(){return"#"+hex(this.r)+hex(this.g)+hex(this.b)}function rgb_formatRgb(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function hex(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function hsla(t,r,e,n){return n<=0?t=r=e=NaN:e<=0||e>=1?t=r=NaN:r<=0&&(t=NaN),new Hsl(t,r,e,n)}function hslConvert(t){if(t instanceof Hsl)return new Hsl(t.h,t.s,t.l,t.opacity);if(t instanceof Color||(t=color(t)),!t)return new Hsl;if(t instanceof Hsl)return t;t=t.rgb();var r=t.r/255,e=t.g/255,n=t.b/255,a=Math.min(r,e,n),o=Math.max(r,e,n),s=NaN,l=o-a,u=(o+a)/2;return l?(r===o?s=(e-n)/l+(e<n)*6:e===o?s=(n-r)/l+2:s=(r-e)/l+4,l/=u<.5?o+a:2-o-a,s*=60):l=u>0&&u<1?0:s,new Hsl(s,l,u,t.opacity)}function hsl(t,r,e,n){return arguments.length===1?hslConvert(t):new Hsl(t,r,e,n??1)}function Hsl(t,r,e,n){this.h=+t,this.s=+r,this.l=+e,this.opacity=+n}define(Hsl,hsl,extend(Color,{brighter:function(t){return t=t==null?brighter:Math.pow(brighter,t),new Hsl(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?darker:Math.pow(darker,t),new Hsl(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,r=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,n=e+(e<.5?e:1-e)*r,a=2*e-n;return new Rgb(hsl2rgb(t>=240?t-240:t+120,a,n),hsl2rgb(t,a,n),hsl2rgb(t<120?t+240:t-120,a,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function hsl2rgb(t,r,e){return(t<60?r+(e-r)*t/60:t<180?e:t<240?r+(e-r)*(240-t)/60:r)*255}function distance(t,r,e,n){var a=t-e,o=r-n;return Math.sqrt(a*a+o*o)}function getBBoxByArray(t,r){var e=Math.min.apply(Math,__spreadArray([],__read(t),!1)),n=Math.min.apply(Math,__spreadArray([],__read(r),!1)),a=Math.max.apply(Math,__spreadArray([],__read(t),!1)),o=Math.max.apply(Math,__spreadArray([],__read(r),!1));return{x:e,y:n,width:a-e,height:o-n}}function xExtrema(t,r,e){return Math.atan(-r/t*Math.tan(e))}function yExtrema(t,r,e){return Math.atan(r/(t*Math.tan(e)))}function xAt(t,r,e,n,a,o){return e*Math.cos(a)*Math.cos(o)-n*Math.sin(a)*Math.sin(o)+t}function yAt(t,r,e,n,a,o){return e*Math.sin(a)*Math.cos(o)+n*Math.cos(a)*Math.sin(o)+r}function box$5(t,r,e,n,a,o,s){for(var l=xExtrema(e,n,a),u=1/0,c=-1/0,d=[o,s],f=-Math.PI*2;f<=Math.PI*2;f+=Math.PI){var h=l+f;o<s?o<h&&h<s&&d.push(h):s<h&&h<o&&d.push(h)}for(var f=0;f<d.length;f++){var p=xAt(t,r,e,n,a,d[f]);p<u&&(u=p),p>c&&(c=p)}for(var v=yExtrema(e,n,a),g=1/0,y=-1/0,m=[o,s],f=-Math.PI*2;f<=Math.PI*2;f+=Math.PI){var S=v+f;o<s?o<S&&S<s&&m.push(S):s<S&&S<o&&m.push(S)}for(var f=0;f<m.length;f++){var w=yAt(t,r,e,n,a,m[f]);w<g&&(g=w),w>y&&(y=w)}return{x:u,y:g,width:c-u,height:y-g}}var EPSILON=1e-4;function nearestPoint$2(t,r,e,n,a,o){var s=-1,l=1/0,u=[e,n],c=20;o&&o>200&&(c=o/10);for(var d=1/c,f=d/10,h=0;h<=c;h++){var p=h*d,v=[a.apply(void 0,__spreadArray([],__read(t.concat([p])),!1)),a.apply(void 0,__spreadArray([],__read(r.concat([p])),!1))],g=distance(u[0],u[1],v[0],v[1]);g<l&&(s=p,l=g)}if(s===0)return{x:t[0],y:r[0]};if(s===1){var y=t.length;return{x:t[y-1],y:r[y-1]}}l=1/0;for(var h=0;h<32&&!(f<EPSILON);h++){var m=s-f,S=s+f,v=[a.apply(void 0,__spreadArray([],__read(t.concat([m])),!1)),a.apply(void 0,__spreadArray([],__read(r.concat([m])),!1))],g=distance(u[0],u[1],v[0],v[1]);if(m>=0&&g<l)s=m,l=g;else{var w=[a.apply(void 0,__spreadArray([],__read(t.concat([S])),!1)),a.apply(void 0,__spreadArray([],__read(r.concat([S])),!1))],R=distance(u[0],u[1],w[0],w[1]);S<=1&&R<l?(s=S,l=R):f*=.5}}return{x:a.apply(void 0,__spreadArray([],__read(t.concat([s])),!1)),y:a.apply(void 0,__spreadArray([],__read(r.concat([s])),!1))}}function length$4(t,r,e,n){return distance(t,r,e,n)}function pointAt$3(t,r,e,n,a){return{x:(1-a)*t+a*e,y:(1-a)*r+a*n}}function pointToLine(t,r,e,n,a,o){var s=[e-t,n-r];if(exactEquals(s,[0,0]))return Math.sqrt((a-t)*(a-t)+(o-r)*(o-r));var l=[-s[1],s[0]];normalize$1(l,l);var u=[a-t,o-r];return Math.abs(dot$1(u,l))}function cubicAt(t,r,e,n,a){var o=1-a;return o*o*o*t+3*r*a*o*o+3*e*a*a*o+n*a*a*a}function extrema$1(t,r,e,n){var a=-3*t+9*r-9*e+3*n,o=6*t-12*r+6*e,s=3*r-3*t,l=[],u,c,d;if(isNumberEqual(a,0))isNumberEqual(o,0)||(u=-s/o,u>=0&&u<=1&&l.push(u));else{var f=o*o-4*a*s;isNumberEqual(f,0)?l.push(-o/(2*a)):f>0&&(d=Math.sqrt(f),u=(-o+d)/(2*a),c=(-o-d)/(2*a),u>=0&&u<=1&&l.push(u),c>=0&&c<=1&&l.push(c))}return l}function box$3(t,r,e,n,a,o,s,l){for(var u=[t,s],c=[r,l],d=extrema$1(t,e,a,s),f=extrema$1(r,n,o,l),h=0;h<d.length;h++)u.push(cubicAt(t,e,a,s,d[h]));for(var h=0;h<f.length;h++)c.push(cubicAt(r,n,o,l,f[h]));return getBBoxByArray(u,c)}function nearestPoint$1(t,r,e,n,a,o,s,l,u,c,d){return nearestPoint$2([t,e,a,s],[r,n,o,l],u,c,cubicAt,d)}function pointDistance$3(t,r,e,n,a,o,s,l,u,c,d){var f=nearestPoint$1(t,r,e,n,a,o,s,l,u,c,d);return distance(f.x,f.y,u,c)}function lengthOfSegment(t){if(t.length<2)return 0;for(var r=0,e=0;e<t.length-1;e++){var n=t[e],a=t[e+1];r+=distance(n[0],n[1],a[0],a[1])}return r}function length$2(t){return lengthOfSegment(t)}function quadraticAt(t,r,e,n){var a=1-n;return a*a*t+2*n*a*r+n*n*e}function extrema(t,r,e){var n=t+e-2*r;if(isNumberEqual(n,0))return[.5];var a=(t-r)/n;return a<=1&&a>=0?[a]:[]}function box(t,r,e,n,a,o){var s=extrema(t,e,a)[0],l=extrema(r,n,o)[0],u=[t,a],c=[r,o];return s!==void 0&&u.push(quadraticAt(t,e,a,s)),l!==void 0&&c.push(quadraticAt(r,n,o,l)),getBBoxByArray(u,c)}function nearestPoint(t,r,e,n,a,o,s,l){return nearestPoint$2([t,e,a],[r,n,o],s,l,quadraticAt)}function pointDistance(t,r,e,n,a,o,s,l){var u=nearestPoint(t,r,e,n,a,o,s,l);return distance(u.x,u.y,s,l)}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},rbush={exports:{}};(function(t,r){(function(e,n){t.exports=n()})(commonjsGlobal,function(){function e(T,x,b,L,M){n(T,x,b||0,L||T.length-1,M||o)}function n(T,x,b,L,M){for(;L>b;){if(L-b>600){var D=L-b+1,N=x-b+1,F=Math.log(D),k=.5*Math.exp(2*F/3),H=.5*Math.sqrt(F*k*(D-k)/D)*(N-D/2<0?-1:1),G=Math.max(b,Math.floor(x-N*k/D+H)),z=Math.min(L,Math.floor(x+(D-N)*k/D+H));n(T,x,G,z,M)}var $=T[x],W=b,V=L;for(a(T,b,x),M(T[L],$)>0&&a(T,b,L);W<V;){for(a(T,W,V),W++,V--;M(T[W],$)<0;)W++;for(;M(T[V],$)>0;)V--}M(T[b],$)===0?a(T,b,V):(V++,a(T,V,L)),V<=x&&(b=V+1),x<=V&&(L=V-1)}}function a(T,x,b){var L=T[x];T[x]=T[b],T[b]=L}function o(T,x){return T<x?-1:T>x?1:0}var s=function(x){x===void 0&&(x=9),this._maxEntries=Math.max(4,x),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()};s.prototype.all=function(){return this._all(this.data,[])},s.prototype.search=function(x){var b=this.data,L=[];if(!S(x,b))return L;for(var M=this.toBBox,D=[];b;){for(var N=0;N<b.children.length;N++){var F=b.children[N],k=b.leaf?M(F):F;S(x,k)&&(b.leaf?L.push(F):m(x,k)?this._all(F,L):D.push(F))}b=D.pop()}return L},s.prototype.collides=function(x){var b=this.data;if(!S(x,b))return!1;for(var L=[];b;){for(var M=0;M<b.children.length;M++){var D=b.children[M],N=b.leaf?this.toBBox(D):D;if(S(x,N)){if(b.leaf||m(x,N))return!0;L.push(D)}}b=L.pop()}return!1},s.prototype.load=function(x){if(!(x&&x.length))return this;if(x.length<this._minEntries){for(var b=0;b<x.length;b++)this.insert(x[b]);return this}var L=this._build(x.slice(),0,x.length-1,0);if(!this.data.children.length)this.data=L;else if(this.data.height===L.height)this._splitRoot(this.data,L);else{if(this.data.height<L.height){var M=this.data;this.data=L,L=M}this._insert(L,this.data.height-L.height-1,!0)}return this},s.prototype.insert=function(x){return x&&this._insert(x,this.data.height-1),this},s.prototype.clear=function(){return this.data=w([]),this},s.prototype.remove=function(x,b){if(!x)return this;for(var L=this.data,M=this.toBBox(x),D=[],N=[],F,k,H;L||D.length;){if(L||(L=D.pop(),k=D[D.length-1],F=N.pop(),H=!0),L.leaf){var G=l(x,L.children,b);if(G!==-1)return L.children.splice(G,1),D.push(L),this._condense(D),this}!H&&!L.leaf&&m(L,M)?(D.push(L),N.push(F),F=0,k=L,L=L.children[0]):k?(F++,L=k.children[F],H=!1):L=null}return this},s.prototype.toBBox=function(x){return x},s.prototype.compareMinX=function(x,b){return x.minX-b.minX},s.prototype.compareMinY=function(x,b){return x.minY-b.minY},s.prototype.toJSON=function(){return this.data},s.prototype.fromJSON=function(x){return this.data=x,this},s.prototype._all=function(x,b){for(var L=[];x;)x.leaf?b.push.apply(b,x.children):L.push.apply(L,x.children),x=L.pop();return b},s.prototype._build=function(x,b,L,M){var D=L-b+1,N=this._maxEntries,F;if(D<=N)return F=w(x.slice(b,L+1)),u(F,this.toBBox),F;M||(M=Math.ceil(Math.log(D)/Math.log(N)),N=Math.ceil(D/Math.pow(N,M-1))),F=w([]),F.leaf=!1,F.height=M;var k=Math.ceil(D/N),H=k*Math.ceil(Math.sqrt(N));R(x,b,L,H,this.compareMinX);for(var G=b;G<=L;G+=H){var z=Math.min(G+H-1,L);R(x,G,z,k,this.compareMinY);for(var $=G;$<=z;$+=k){var W=Math.min($+k-1,z);F.children.push(this._build(x,$,W,M-1))}}return u(F,this.toBBox),F},s.prototype._chooseSubtree=function(x,b,L,M){for(;M.push(b),!(b.leaf||M.length-1===L);){for(var D=1/0,N=1/0,F=void 0,k=0;k<b.children.length;k++){var H=b.children[k],G=p(H),z=g(x,H)-G;z<N?(N=z,D=G<D?G:D,F=H):z===N&&G<D&&(D=G,F=H)}b=F||b.children[0]}return b},s.prototype._insert=function(x,b,L){var M=L?x:this.toBBox(x),D=[],N=this._chooseSubtree(M,this.data,b,D);for(N.children.push(x),d(N,M);b>=0&&D[b].children.length>this._maxEntries;)this._split(D,b),b--;this._adjustParentBBoxes(M,D,b)},s.prototype._split=function(x,b){var L=x[b],M=L.children.length,D=this._minEntries;this._chooseSplitAxis(L,D,M);var N=this._chooseSplitIndex(L,D,M),F=w(L.children.splice(N,L.children.length-N));F.height=L.height,F.leaf=L.leaf,u(L,this.toBBox),u(F,this.toBBox),b?x[b-1].children.push(F):this._splitRoot(L,F)},s.prototype._splitRoot=function(x,b){this.data=w([x,b]),this.data.height=x.height+1,this.data.leaf=!1,u(this.data,this.toBBox)},s.prototype._chooseSplitIndex=function(x,b,L){for(var M,D=1/0,N=1/0,F=b;F<=L-b;F++){var k=c(x,0,F,this.toBBox),H=c(x,F,L,this.toBBox),G=y(k,H),z=p(k)+p(H);G<D?(D=G,M=F,N=z<N?z:N):G===D&&z<N&&(N=z,M=F)}return M||L-b},s.prototype._chooseSplitAxis=function(x,b,L){var M=x.leaf?this.compareMinX:f,D=x.leaf?this.compareMinY:h,N=this._allDistMargin(x,b,L,M),F=this._allDistMargin(x,b,L,D);N<F&&x.children.sort(M)},s.prototype._allDistMargin=function(x,b,L,M){x.children.sort(M);for(var D=this.toBBox,N=c(x,0,b,D),F=c(x,L-b,L,D),k=v(N)+v(F),H=b;H<L-b;H++){var G=x.children[H];d(N,x.leaf?D(G):G),k+=v(N)}for(var z=L-b-1;z>=b;z--){var $=x.children[z];d(F,x.leaf?D($):$),k+=v(F)}return k},s.prototype._adjustParentBBoxes=function(x,b,L){for(var M=L;M>=0;M--)d(b[M],x)},s.prototype._condense=function(x){for(var b=x.length-1,L=void 0;b>=0;b--)x[b].children.length===0?b>0?(L=x[b-1].children,L.splice(L.indexOf(x[b]),1)):this.clear():u(x[b],this.toBBox)};function l(T,x,b){if(!b)return x.indexOf(T);for(var L=0;L<x.length;L++)if(b(T,x[L]))return L;return-1}function u(T,x){c(T,0,T.children.length,x,T)}function c(T,x,b,L,M){M||(M=w(null)),M.minX=1/0,M.minY=1/0,M.maxX=-1/0,M.maxY=-1/0;for(var D=x;D<b;D++){var N=T.children[D];d(M,T.leaf?L(N):N)}return M}function d(T,x){return T.minX=Math.min(T.minX,x.minX),T.minY=Math.min(T.minY,x.minY),T.maxX=Math.max(T.maxX,x.maxX),T.maxY=Math.max(T.maxY,x.maxY),T}function f(T,x){return T.minX-x.minX}function h(T,x){return T.minY-x.minY}function p(T){return(T.maxX-T.minX)*(T.maxY-T.minY)}function v(T){return T.maxX-T.minX+(T.maxY-T.minY)}function g(T,x){return(Math.max(x.maxX,T.maxX)-Math.min(x.minX,T.minX))*(Math.max(x.maxY,T.maxY)-Math.min(x.minY,T.minY))}function y(T,x){var b=Math.max(T.minX,x.minX),L=Math.max(T.minY,x.minY),M=Math.min(T.maxX,x.maxX),D=Math.min(T.maxY,x.maxY);return Math.max(0,M-b)*Math.max(0,D-L)}function m(T,x){return T.minX<=x.minX&&T.minY<=x.minY&&x.maxX<=T.maxX&&x.maxY<=T.maxY}function S(T,x){return x.minX<=T.maxX&&x.minY<=T.maxY&&x.maxX>=T.minX&&x.maxY>=T.minY}function w(T){return{children:T,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function R(T,x,b,L,M){for(var D=[x,b];D.length;)if(b=D.pop(),x=D.pop(),!(b-x<=L)){var N=x+Math.ceil((b-x)/L/2)*L;e(T,N,x,b,M),D.push(x,N,N,b)}}return s})})(rbush);var RBush=rbush.exports,Shape;(function(t){t.GROUP="g",t.CIRCLE="circle",t.ELLIPSE="ellipse",t.IMAGE="image",t.RECT="rect",t.LINE="line",t.POLYLINE="polyline",t.POLYGON="polygon",t.TEXT="text",t.PATH="path",t.HTML="html",t.MESH="mesh"})(Shape||(Shape={}));var ClipSpaceNearZ;(function(t){t[t.ZERO=0]="ZERO",t[t.NEGATIVE_ONE=1]="NEGATIVE_ONE"})(ClipSpaceNearZ||(ClipSpaceNearZ={}));var AbstractRendererPlugin=function(){function t(){this.plugins=[]}return t.prototype.addRenderingPlugin=function(r){this.plugins.push(r),this.context.renderingPlugins.push(r)},t.prototype.removeAllRenderingPlugins=function(){var r=this;this.plugins.forEach(function(e){var n=r.context.renderingPlugins.indexOf(e);n>=0&&r.context.renderingPlugins.splice(n,1)})},t}(),AbstractRenderer=function(){function t(r){this.clipSpaceNearZ=ClipSpaceNearZ.NEGATIVE_ONE,this.plugins=[],this.config=__assign({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0},r)}return t.prototype.registerPlugin=function(r){var e=this.plugins.findIndex(function(n){return n===r});e===-1&&this.plugins.push(r)},t.prototype.unregisterPlugin=function(r){var e=this.plugins.findIndex(function(n){return n===r});e>-1&&this.plugins.splice(e,1)},t.prototype.getPlugins=function(){return this.plugins},t.prototype.getPlugin=function(r){return this.plugins.find(function(e){return e.name===r})},t.prototype.getConfig=function(){return this.config},t.prototype.setConfig=function(r){Object.assign(this.config,r)},t}();function copyVec3(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t}function subVec3(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t}function addVec3(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t}function scaleVec3(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t}function maxVec3(t,r,e){return t[0]=Math.max(r[0],e[0]),t[1]=Math.max(r[1],e[1]),t[2]=Math.max(r[2],e[2]),t}function minVec3(t,r,e){return t[0]=Math.min(r[0],e[0]),t[1]=Math.min(r[1],e[1]),t[2]=Math.min(r[2],e[2]),t}function getAngle(t){return t===void 0?0:t>360||t<-360?t%360:t}function createVec3(t,r,e){return r===void 0&&(r=0),e===void 0&&(e=0),Array.isArray(t)&&t.length===3?clone$2(t):isNumber$1(t)?fromValues$3(t,r,e):fromValues$3(t[0],t[1]||r,t[2]||e)}function deg2rad(t){return t*(Math.PI/180)}function rad2deg(t){return t*(180/Math.PI)}function turn2deg(t){return 360*t}function getEulerFromQuat(t,r){var e=r[0],n=r[1],a=r[2],o=r[3],s=e*e,l=n*n,u=a*a,c=o*o,d=s+l+u+c,f=e*o-n*a;return f>.499995*d?(t[0]=Math.PI/2,t[1]=2*Math.atan2(n,e),t[2]=0):f<-.499995*d?(t[0]=-Math.PI/2,t[1]=2*Math.atan2(n,e),t[2]=0):(t[0]=Math.asin(2*(e*a-o*n)),t[1]=Math.atan2(2*(e*o+n*a),1-2*(u+c)),t[2]=Math.atan2(2*(e*n+a*o),1-2*(l+u))),t}function getEulerFromMat4(t,r){var e,n,a=Math.PI*.5,o=__read(getScaling(create$3(),r),3),s=o[0],l=o[1],u=o[2],c=Math.asin(-r[2]/s);return c<a?c>-a?(e=Math.atan2(r[6]/l,r[10]/u),n=Math.atan2(r[1]/s,r[0]/s)):(n=0,e=-Math.atan2(r[4]/l,r[5]/l)):(n=0,e=Math.atan2(r[4]/l,r[5]/l)),t[0]=e,t[1]=c,t[2]=n,t}function getEuler(t,r){return r.length===16?getEulerFromMat4(t,r):getEulerFromQuat(t,r)}function fromRotationTranslationScale(t,r,e,n,a){var o=Math.cos(t),s=Math.sin(t);return fromValues$5(n*o,a*s,0,-n*s,a*o,0,r,e,1)}function makePerspective(t,r,e,n,a,o,s,l){l===void 0&&(l=!1);var u=2*o/(e-r),c=2*o/(n-a),d=(e+r)/(e-r),f=(n+a)/(n-a),h,p;return l?(h=-s/(s-o),p=-s*o/(s-o)):(h=-(s+o)/(s-o),p=-2*s*o/(s-o)),t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=d,t[9]=f,t[10]=h,t[11]=-1,t[12]=0,t[13]=0,t[14]=p,t[15]=0,t}function decompose(t){var r=t[0],e=t[1],n=t[3],a=t[4],o=Math.sqrt(r*r+e*e),s=Math.sqrt(n*n+a*a),l=r*a-e*n;l<0&&(r<a?o=-o:s=-s),o&&(r*=1/o,e*=1/o),s&&(n*=1/s,a*=1/s);var u=Math.atan2(e,r),c=rad2deg(u);return[t[6],t[7],o,s,c]}var tmp=create$4(),perspectiveMatrix=create$4(),tmpVec4=create$2(),row=[create$3(),create$3(),create$3()],pdum3=create$3();function decomposeMat4(t,r,e,n,a,o){if(!normalize(tmp,t)||(copy$4(perspectiveMatrix,tmp),perspectiveMatrix[3]=0,perspectiveMatrix[7]=0,perspectiveMatrix[11]=0,perspectiveMatrix[15]=1,Math.abs(determinant(perspectiveMatrix))<1e-8))return!1;var s=tmp[3],l=tmp[7],u=tmp[11],c=tmp[12],d=tmp[13],f=tmp[14],h=tmp[15];if(s!==0||l!==0||u!==0){tmpVec4[0]=s,tmpVec4[1]=l,tmpVec4[2]=u,tmpVec4[3]=h;var p=invert$1(perspectiveMatrix,perspectiveMatrix);if(!p)return!1;transpose(perspectiveMatrix,perspectiveMatrix),transformMat4(a,tmpVec4,perspectiveMatrix)}else a[0]=a[1]=a[2]=0,a[3]=1;if(r[0]=c,r[1]=d,r[2]=f,mat3from4(row,tmp),e[0]=length(row[0]),normalize$4(row[0],row[0]),n[0]=dot$2(row[0],row[1]),combine(row[1],row[1],row[0],1,-n[0]),e[1]=length(row[1]),normalize$4(row[1],row[1]),n[0]/=e[1],n[1]=dot$2(row[0],row[2]),combine(row[2],row[2],row[0],1,-n[1]),n[2]=dot$2(row[1],row[2]),combine(row[2],row[2],row[1],1,-n[2]),e[2]=length(row[2]),normalize$4(row[2],row[2]),n[1]/=e[2],n[2]/=e[2],cross(pdum3,row[1],row[2]),dot$2(row[0],pdum3)<0)for(var v=0;v<3;v++)e[v]*=-1,row[v][0]*=-1,row[v][1]*=-1,row[v][2]*=-1;return o[0]=.5*Math.sqrt(Math.max(1+row[0][0]-row[1][1]-row[2][2],0)),o[1]=.5*Math.sqrt(Math.max(1-row[0][0]+row[1][1]-row[2][2],0)),o[2]=.5*Math.sqrt(Math.max(1-row[0][0]-row[1][1]+row[2][2],0)),o[3]=.5*Math.sqrt(Math.max(1+row[0][0]+row[1][1]+row[2][2],0)),row[2][1]>row[1][2]&&(o[0]=-o[0]),row[0][2]>row[2][0]&&(o[1]=-o[1]),row[1][0]>row[0][1]&&(o[2]=-o[2]),!0}function normalize(t,r){var e=r[15];if(e===0)return!1;for(var n=1/e,a=0;a<16;a++)t[a]=r[a]*n;return!0}function mat3from4(t,r){t[0][0]=r[0],t[0][1]=r[1],t[0][2]=r[2],t[1][0]=r[4],t[1][1]=r[5],t[1][2]=r[6],t[2][0]=r[8],t[2][1]=r[9],t[2][2]=r[10]}function combine(t,r,e,n,a){t[0]=r[0]*n+e[0]*a,t[1]=r[1]*n+e[1]*a,t[2]=r[2]*n+e[2]*a}var AABB=function(){function t(){this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return t.isEmpty=function(r){return!r||r.halfExtents[0]===0&&r.halfExtents[1]===0&&r.halfExtents[2]===0},t.prototype.update=function(r,e){copyVec3(this.center,r),copyVec3(this.halfExtents,e),subVec3(this.min,this.center,this.halfExtents),addVec3(this.max,this.center,this.halfExtents)},t.prototype.setMinMax=function(r,e){addVec3(this.center,e,r),scaleVec3(this.center,this.center,.5),subVec3(this.halfExtents,e,r),scaleVec3(this.halfExtents,this.halfExtents,.5),copyVec3(this.min,r),copyVec3(this.max,e)},t.prototype.getMin=function(){return this.min},t.prototype.getMax=function(){return this.max},t.prototype.add=function(r){if(!t.isEmpty(r)){if(t.isEmpty(this)){this.setMinMax(r.getMin(),r.getMax());return}var e=this.center,n=e[0],a=e[1],o=e[2],s=this.halfExtents,l=s[0],u=s[1],c=s[2],d=n-l,f=n+l,h=a-u,p=a+u,v=o-c,g=o+c,y=r.center,m=y[0],S=y[1],w=y[2],R=r.halfExtents,T=R[0],x=R[1],b=R[2],L=m-T,M=m+T,D=S-x,N=S+x,F=w-b,k=w+b;L<d&&(d=L),M>f&&(f=M),D<h&&(h=D),N>p&&(p=N),F<v&&(v=F),k>g&&(g=k),e[0]=(d+f)*.5,e[1]=(h+p)*.5,e[2]=(v+g)*.5,s[0]=(f-d)*.5,s[1]=(p-h)*.5,s[2]=(g-v)*.5,this.min[0]=d,this.min[1]=h,this.min[2]=v,this.max[0]=f,this.max[1]=p,this.max[2]=g}},t.prototype.setFromTransformedAABB=function(r,e){var n=this.center,a=this.halfExtents,o=r.center,s=r.halfExtents,l=e[0],u=e[4],c=e[8],d=e[1],f=e[5],h=e[9],p=e[2],v=e[6],g=e[10],y=Math.abs(l),m=Math.abs(u),S=Math.abs(c),w=Math.abs(d),R=Math.abs(f),T=Math.abs(h),x=Math.abs(p),b=Math.abs(v),L=Math.abs(g);n[0]=e[12]+l*o[0]+u*o[1]+c*o[2],n[1]=e[13]+d*o[0]+f*o[1]+h*o[2],n[2]=e[14]+p*o[0]+v*o[1]+g*o[2],a[0]=y*s[0]+m*s[1]+S*s[2],a[1]=w*s[0]+R*s[1]+T*s[2],a[2]=x*s[0]+b*s[1]+L*s[2],subVec3(this.min,n,a),addVec3(this.max,n,a)},t.prototype.intersects=function(r){var e=this.getMax(),n=this.getMin(),a=r.getMax(),o=r.getMin();return n[0]<=a[0]&&e[0]>=o[0]&&n[1]<=a[1]&&e[1]>=o[1]&&n[2]<=a[2]&&e[2]>=o[2]},t.prototype.intersection=function(r){if(!this.intersects(r))return null;var e=new t,n=maxVec3([0,0,0],this.getMin(),r.getMin()),a=minVec3([0,0,0],this.getMax(),r.getMax());return e.setMinMax(n,a),e},t.prototype.getNegativeFarPoint=function(r){return r.pnVertexFlag===273?copyVec3([0,0,0],this.min):r.pnVertexFlag===272?[this.min[0],this.min[1],this.max[2]]:r.pnVertexFlag===257?[this.min[0],this.max[1],this.min[2]]:r.pnVertexFlag===256?[this.min[0],this.max[1],this.max[2]]:r.pnVertexFlag===17?[this.max[0],this.min[1],this.min[2]]:r.pnVertexFlag===16?[this.max[0],this.min[1],this.max[2]]:r.pnVertexFlag===1?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]},t.prototype.getPositiveFarPoint=function(r){return r.pnVertexFlag===273?copyVec3([0,0,0],this.max):r.pnVertexFlag===272?[this.max[0],this.max[1],this.min[2]]:r.pnVertexFlag===257?[this.max[0],this.min[1],this.max[2]]:r.pnVertexFlag===256?[this.max[0],this.min[1],this.min[2]]:r.pnVertexFlag===17?[this.min[0],this.max[1],this.max[2]]:r.pnVertexFlag===16?[this.min[0],this.max[1],this.min[2]]:r.pnVertexFlag===1?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]},t}(),Plane=function(){function t(r,e){this.distance=r||0,this.normal=e||fromValues$3(0,1,0),this.updatePNVertexFlag()}return t.prototype.updatePNVertexFlag=function(){this.pnVertexFlag=(+(this.normal[0]>=0)<<8)+(+(this.normal[1]>=0)<<4)+ +(this.normal[2]>=0)},t.prototype.distanceToPoint=function(r){return dot$2(r,this.normal)-this.distance},t.prototype.normalize=function(){var r=1/len(this.normal);scale$1(this.normal,this.normal,r),this.distance*=r},t.prototype.intersectsLine=function(r,e,n){var a=this.distanceToPoint(r),o=this.distanceToPoint(e),s=a/(a-o),l=s>=0&&s<=1;return l&&n&&lerp(n,r,e,s),l},t}(),Mask;(function(t){t[t.OUTSIDE=4294967295]="OUTSIDE",t[t.INSIDE=0]="INSIDE",t[t.INDETERMINATE=2147483647]="INDETERMINATE"})(Mask||(Mask={}));var Frustum=function(){function t(r){if(this.planes=[],r)this.planes=r;else for(var e=0;e<6;e++)this.planes.push(new Plane)}return t.prototype.extractFromVPMatrix=function(r){var e=__read(r,16),n=e[0],a=e[1],o=e[2],s=e[3],l=e[4],u=e[5],c=e[6],d=e[7],f=e[8],h=e[9],p=e[10],v=e[11],g=e[12],y=e[13],m=e[14],S=e[15];set$1(this.planes[0].normal,s-n,d-l,v-f),this.planes[0].distance=S-g,set$1(this.planes[1].normal,s+n,d+l,v+f),this.planes[1].distance=S+g,set$1(this.planes[2].normal,s+a,d+u,v+h),this.planes[2].distance=S+y,set$1(this.planes[3].normal,s-a,d-u,v-h),this.planes[3].distance=S-y,set$1(this.planes[4].normal,s-o,d-c,v-p),this.planes[4].distance=S-m,set$1(this.planes[5].normal,s+o,d+c,v+p),this.planes[5].distance=S+m,this.planes.forEach(function(w){w.normalize(),w.updatePNVertexFlag()})},t}(),Point=function(){function t(r,e){r===void 0&&(r=0),e===void 0&&(e=0),this.x=0,this.y=0,this.x=r,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(r){this.x=r.x,this.y=r.y},t}(),Rectangle=function(){function t(r,e,n,a){this.x=r,this.y=e,this.width=n,this.height=a,this.left=r,this.right=r+n,this.top=e,this.bottom=e+a}return t.prototype.toJSON=function(){},t}(),ERROR_MSG_METHOD_NOT_IMPLEMENTED="Method not implemented.",ERROR_MSG_USE_DOCUMENT_ELEMENT="Use document.documentElement instead.",ERROR_MSG_APPEND_DESTROYED_ELEMENT="Cannot append a destroyed element.",CameraType;(function(t){t[t.ORBITING=0]="ORBITING",t[t.EXPLORING=1]="EXPLORING",t[t.TRACKING=2]="TRACKING"})(CameraType||(CameraType={}));var CameraTrackingMode;(function(t){t[t.DEFAULT=0]="DEFAULT",t[t.ROTATIONAL=1]="ROTATIONAL",t[t.TRANSLATIONAL=2]="TRANSLATIONAL",t[t.CINEMATIC=3]="CINEMATIC"})(CameraTrackingMode||(CameraTrackingMode={}));var CameraProjectionMode;(function(t){t[t.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",t[t.PERSPECTIVE=1]="PERSPECTIVE"})(CameraProjectionMode||(CameraProjectionMode={}));var CameraEvent={UPDATED:"updated"},MIN_DISTANCE=2e-4,Camera=function(){function t(){this.clipSpaceNearZ=ClipSpaceNearZ.NEGATIVE_ONE,this.eventEmitter=new EventEmitter$1,this.matrix=create$4(),this.right=fromValues$3(1,0,0),this.up=fromValues$3(0,1,0),this.forward=fromValues$3(0,0,1),this.position=fromValues$3(0,0,1),this.focalPoint=fromValues$3(0,0,0),this.distanceVector=fromValues$3(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=create$4(),this.projectionMatrixInverse=create$4(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=CameraType.EXPLORING,this.trackingMode=CameraTrackingMode.DEFAULT,this.projectionMode=CameraProjectionMode.PERSPECTIVE,this.frustum=new Frustum,this.orthoMatrix=create$4()}return t.prototype.isOrtho=function(){return this.projectionMode===CameraProjectionMode.ORTHOGRAPHIC},t.prototype.getProjectionMode=function(){return this.projectionMode},t.prototype.getPerspective=function(){return this.jitteredProjectionMatrix||this.projectionMatrix},t.prototype.getPerspectiveInverse=function(){return this.projectionMatrixInverse},t.prototype.getFrustum=function(){return this.frustum},t.prototype.getPosition=function(){return this.position},t.prototype.getFocalPoint=function(){return this.focalPoint},t.prototype.getDollyingStep=function(){return this.dollyingStep},t.prototype.getNear=function(){return this.near},t.prototype.getFar=function(){return this.far},t.prototype.getZoom=function(){return this.zoom},t.prototype.getOrthoMatrix=function(){return this.orthoMatrix},t.prototype.getView=function(){return this.view},t.prototype.setEnableUpdate=function(r){this.enableUpdate=r},t.prototype.setType=function(r,e){return this.type=r,this.type===CameraType.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===CameraType.TRACKING&&e!==void 0&&this.setTrackingMode(e),this},t.prototype.setProjectionMode=function(r){return this.projectionMode=r,this},t.prototype.setTrackingMode=function(r){if(this.type!==CameraType.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=r,this},t.prototype.setWorldRotation=function(r){return this.rotateWorld=r,this._getAngles(),this},t.prototype.getViewTransform=function(){return invert$1(create$4(),this.matrix)},t.prototype.getWorldTransform=function(){return this.matrix},t.prototype.jitterProjectionMatrix=function(r,e){var n=fromTranslation(create$4(),[r,e,0]);this.jitteredProjectionMatrix=multiply$2(create$4(),n,this.projectionMatrix)},t.prototype.clearJitterProjectionMatrix=function(){this.jitteredProjectionMatrix=void 0},t.prototype.setMatrix=function(r){return this.matrix=r,this._update(),this},t.prototype.setFov=function(r){return this.setPerspective(this.near,this.far,r,this.aspect),this},t.prototype.setAspect=function(r){return this.setPerspective(this.near,this.far,this.fov,r),this},t.prototype.setNear=function(r){return this.projectionMode===CameraProjectionMode.PERSPECTIVE?this.setPerspective(r,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,r,this.far),this},t.prototype.setFar=function(r){return this.projectionMode===CameraProjectionMode.PERSPECTIVE?this.setPerspective(this.near,r,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,r),this},t.prototype.setViewOffset=function(r,e,n,a,o,s){return this.aspect=r/e,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=r,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=a,this.view.width=o,this.view.height=s,this.projectionMode===CameraProjectionMode.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},t.prototype.clearViewOffset=function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===CameraProjectionMode.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},t.prototype.setZoom=function(r){return this.zoom=r,this.projectionMode===CameraProjectionMode.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===CameraProjectionMode.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this},t.prototype.setZoomByViewportPoint=function(r,e){var n=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),a=n.x,o=n.y,s=this.roll;this.rotate(0,0,-s),this.setPosition(a,o),this.setFocalPoint(a,o),this.setZoom(r),this.rotate(0,0,s);var l=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),u=l.x,c=l.y,d=fromValues$3(u-a,c-o,0),f=dot$2(d,this.right)/length(this.right),h=dot$2(d,this.up)/length(this.up);return this.pan(-f,-h),this},t.prototype.setPerspective=function(r,e,n,a){var o;this.projectionMode=CameraProjectionMode.PERSPECTIVE,this.fov=n,this.near=r,this.far=e,this.aspect=a;var s=this.near*Math.tan(deg2rad(.5*this.fov))/this.zoom,l=2*s,u=this.aspect*l,c=-.5*u;if(!((o=this.view)===null||o===void 0)&&o.enabled){var d=this.view.fullWidth,f=this.view.fullHeight;c+=this.view.offsetX*u/d,s-=this.view.offsetY*l/f,u*=this.view.width/d,l*=this.view.height/f}return makePerspective(this.projectionMatrix,c,c+u,s,s-l,r,this.far,this.clipSpaceNearZ===ClipSpaceNearZ.ZERO),scale$2(this.projectionMatrix,this.projectionMatrix,fromValues$3(1,-1,1)),invert$1(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this},t.prototype.setOrthographic=function(r,e,n,a,o,s){var l;this.projectionMode=CameraProjectionMode.ORTHOGRAPHIC,this.rright=e,this.left=r,this.top=n,this.bottom=a,this.near=o,this.far=s;var u=(this.rright-this.left)/(2*this.zoom),c=(this.top-this.bottom)/(2*this.zoom),d=(this.rright+this.left)/2,f=(this.top+this.bottom)/2,h=d-u,p=d+u,v=f+c,g=f-c;if(!((l=this.view)===null||l===void 0)&&l.enabled){var y=(this.rright-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;h+=y*this.view.offsetX,p=h+y*this.view.width,v-=m*this.view.offsetY,g=v-m*this.view.height}return this.clipSpaceNearZ===ClipSpaceNearZ.NEGATIVE_ONE?ortho(this.projectionMatrix,h,p,g,v,o,s):orthoZO(this.projectionMatrix,h,p,g,v,o,s),scale$2(this.projectionMatrix,this.projectionMatrix,fromValues$3(1,-1,1)),invert$1(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this},t.prototype.setPosition=function(r,e,n){e===void 0&&(e=this.position[1]),n===void 0&&(n=this.position[2]);var a=createVec3(r,e,n);return this._setPosition(a),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this},t.prototype.setFocalPoint=function(r,e,n){e===void 0&&(e=this.focalPoint[1]),n===void 0&&(n=this.focalPoint[2]);var a=fromValues$3(0,1,0);if(this.focalPoint=createVec3(r,e,n),this.trackingMode===CameraTrackingMode.CINEMATIC){var o=subtract(create$3(),this.focalPoint,this.position);r=o[0],e=o[1],n=o[2];var s=length(o),l=rad2deg(Math.asin(e/s)),u=90+rad2deg(Math.atan2(n,r)),c=create$4();rotateY(c,c,deg2rad(u)),rotateX(c,c,deg2rad(l)),a=transformMat4$1(create$3(),[0,1,0],c)}return invert$1(this.matrix,lookAt(create$4(),this.position,this.focalPoint,a)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this},t.prototype.getDistance=function(){return this.distance},t.prototype.getDistanceVector=function(){return this.distanceVector},t.prototype.setDistance=function(r){if(this.distance===r||r<0)return this;this.distance=r,this.distance<MIN_DISTANCE&&(this.distance=MIN_DISTANCE),this.dollyingStep=this.distance/100;var e=create$3();r=this.distance;var n=this.forward,a=this.focalPoint;return e[0]=r*n[0]+a[0],e[1]=r*n[1]+a[1],e[2]=r*n[2]+a[2],this._setPosition(e),this.triggerUpdate(),this},t.prototype.setMaxDistance=function(r){return this.maxDistance=r,this},t.prototype.setMinDistance=function(r){return this.minDistance=r,this},t.prototype.setAzimuth=function(r){return this.azimuth=getAngle(r),this.computeMatrix(),this._getAxes(),this.type===CameraType.ORBITING||this.type===CameraType.EXPLORING?this._getPosition():this.type===CameraType.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},t.prototype.getAzimuth=function(){return this.azimuth},t.prototype.setElevation=function(r){return this.elevation=getAngle(r),this.computeMatrix(),this._getAxes(),this.type===CameraType.ORBITING||this.type===CameraType.EXPLORING?this._getPosition():this.type===CameraType.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},t.prototype.getElevation=function(){return this.elevation},t.prototype.setRoll=function(r){return this.roll=getAngle(r),this.computeMatrix(),this._getAxes(),this.type===CameraType.ORBITING||this.type===CameraType.EXPLORING?this._getPosition():this.type===CameraType.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},t.prototype.getRoll=function(){return this.roll},t.prototype._update=function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()},t.prototype.computeMatrix=function(){var r=setAxisAngle(create$1(),[0,0,1],deg2rad(this.roll));identity$1(this.matrix);var e=setAxisAngle(create$1(),[1,0,0],deg2rad((this.rotateWorld&&this.type!==CameraType.TRACKING||this.type===CameraType.TRACKING?1:-1)*this.elevation)),n=setAxisAngle(create$1(),[0,1,0],deg2rad((this.rotateWorld&&this.type!==CameraType.TRACKING||this.type===CameraType.TRACKING?1:-1)*this.azimuth)),a=multiply(create$1(),n,e);a=multiply(create$1(),a,r);var o=fromQuat(create$4(),a);this.type===CameraType.ORBITING||this.type===CameraType.EXPLORING?(translate(this.matrix,this.matrix,this.focalPoint),multiply$2(this.matrix,this.matrix,o),translate(this.matrix,this.matrix,[0,0,this.distance])):this.type===CameraType.TRACKING&&(translate(this.matrix,this.matrix,this.position),multiply$2(this.matrix,this.matrix,o))},t.prototype._setPosition=function(r,e,n){this.position=createVec3(r,e,n);var a=this.matrix;a[12]=this.position[0],a[13]=this.position[1],a[14]=this.position[2],a[15]=1,this._getOrthoMatrix()},t.prototype._getAxes=function(){copy$3(this.right,createVec3(transformMat4(create$2(),[1,0,0,0],this.matrix))),copy$3(this.up,createVec3(transformMat4(create$2(),[0,1,0,0],this.matrix))),copy$3(this.forward,createVec3(transformMat4(create$2(),[0,0,1,0],this.matrix))),normalize$4(this.right,this.right),normalize$4(this.up,this.up),normalize$4(this.forward,this.forward)},t.prototype._getAngles=function(){var r=this.distanceVector[0],e=this.distanceVector[1],n=this.distanceVector[2],a=length(this.distanceVector);if(a===0){this.elevation=0,this.azimuth=0;return}this.type===CameraType.TRACKING?(this.elevation=rad2deg(Math.asin(e/a)),this.azimuth=rad2deg(Math.atan2(-r,-n))):this.rotateWorld?(this.elevation=rad2deg(Math.asin(e/a)),this.azimuth=rad2deg(Math.atan2(-r,-n))):(this.elevation=-rad2deg(Math.asin(e/a)),this.azimuth=-rad2deg(Math.atan2(-r,-n)))},t.prototype._getPosition=function(){copy$3(this.position,createVec3(transformMat4(create$2(),[0,0,0,1],this.matrix))),this._getDistance()},t.prototype._getFocalPoint=function(){transformMat3(this.distanceVector,[0,0,-this.distance],fromMat4(create$5(),this.matrix)),add$1(this.focalPoint,this.position,this.distanceVector),this._getDistance()},t.prototype._getDistance=function(){this.distanceVector=subtract(create$3(),this.focalPoint,this.position),this.distance=length(this.distanceVector),this.dollyingStep=this.distance/100},t.prototype._getOrthoMatrix=function(){if(this.projectionMode===CameraProjectionMode.ORTHOGRAPHIC){var r=this.position,e=setAxisAngle(create$1(),[0,0,1],-this.roll*Math.PI/180);fromRotationTranslationScaleOrigin(this.orthoMatrix,e,fromValues$3((this.rright-this.left)/2-r[0],(this.top-this.bottom)/2-r[1],0),fromValues$3(this.zoom,this.zoom,1),r)}},t.prototype.triggerUpdate=function(){if(this.enableUpdate){var r=this.getViewTransform(),e=multiply$2(create$4(),this.getPerspective(),r);this.getFrustum().extractFromVPMatrix(e),this.eventEmitter.emit(CameraEvent.UPDATED)}},t.prototype.rotate=function(r,e,n){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},t.prototype.pan=function(r,e){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},t.prototype.dolly=function(r){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},t.prototype.createLandmark=function(r,e){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},t.prototype.gotoLandmark=function(r,e){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},t.prototype.cancelLandmarkAnimation=function(){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},t}();function memoize$1(t,r){if(typeof t!="function"||r!=null&&typeof r!="function")throw new TypeError("Expected a function");var e=function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];var o=r?r.apply(this,n):n[0],s=e.cache;if(s.has(o))return s.get(o);var l=t.apply(this,n);return e.cache=s.set(o,l)||s,l};return e.cache=new(memoize$1.Cache||Map),e}memoize$1.Cache=Map;var UnitType;(function(t){t[t.kUnknown=0]="kUnknown",t[t.kNumber=1]="kNumber",t[t.kPercentage=2]="kPercentage",t[t.kEms=3]="kEms",t[t.kPixels=4]="kPixels",t[t.kRems=5]="kRems",t[t.kDegrees=6]="kDegrees",t[t.kRadians=7]="kRadians",t[t.kGradians=8]="kGradians",t[t.kTurns=9]="kTurns",t[t.kMilliseconds=10]="kMilliseconds",t[t.kSeconds=11]="kSeconds",t[t.kInteger=12]="kInteger"})(UnitType||(UnitType={}));var UnitCategory;(function(t){t[t.kUNumber=0]="kUNumber",t[t.kUPercent=1]="kUPercent",t[t.kULength=2]="kULength",t[t.kUAngle=3]="kUAngle",t[t.kUTime=4]="kUTime",t[t.kUOther=5]="kUOther"})(UnitCategory||(UnitCategory={}));var ValueRange;(function(t){t[t.kAll=0]="kAll",t[t.kNonNegative=1]="kNonNegative",t[t.kInteger=2]="kInteger",t[t.kNonNegativeInteger=3]="kNonNegativeInteger",t[t.kPositiveInteger=4]="kPositiveInteger"})(ValueRange||(ValueRange={}));var Nested;(function(t){t[t.kYes=0]="kYes",t[t.kNo=1]="kNo"})(Nested||(Nested={}));var ParenLess;(function(t){t[t.kYes=0]="kYes",t[t.kNo=1]="kNo"})(ParenLess||(ParenLess={}));var data=[{name:"em",unit_type:UnitType.kEms},{name:"px",unit_type:UnitType.kPixels},{name:"deg",unit_type:UnitType.kDegrees},{name:"rad",unit_type:UnitType.kRadians},{name:"grad",unit_type:UnitType.kGradians},{name:"ms",unit_type:UnitType.kMilliseconds},{name:"s",unit_type:UnitType.kSeconds},{name:"rem",unit_type:UnitType.kRems},{name:"turn",unit_type:UnitType.kTurns}],CSSStyleValueType;(function(t){t[t.kUnknownType=0]="kUnknownType",t[t.kUnparsedType=1]="kUnparsedType",t[t.kKeywordType=2]="kKeywordType",t[t.kUnitType=3]="kUnitType",t[t.kSumType=4]="kSumType",t[t.kProductType=5]="kProductType",t[t.kNegateType=6]="kNegateType",t[t.kInvertType=7]="kInvertType",t[t.kMinType=8]="kMinType",t[t.kMaxType=9]="kMaxType",t[t.kClampType=10]="kClampType",t[t.kTransformType=11]="kTransformType",t[t.kPositionType=12]="kPositionType",t[t.kURLImageType=13]="kURLImageType",t[t.kColorType=14]="kColorType",t[t.kUnsupportedColorType=15]="kUnsupportedColorType"})(CSSStyleValueType||(CSSStyleValueType={}));var stringToUnitType=function(t){return data.find(function(r){return r.name===t}).unit_type},unitFromName=function(t){return t?t==="number"?UnitType.kNumber:t==="percent"||t==="%"?UnitType.kPercentage:stringToUnitType(t):UnitType.kUnknown},unitTypeToUnitCategory=function(t){switch(t){case UnitType.kNumber:case UnitType.kInteger:return UnitCategory.kUNumber;case UnitType.kPercentage:return UnitCategory.kUPercent;case UnitType.kPixels:return UnitCategory.kULength;case UnitType.kMilliseconds:case UnitType.kSeconds:return UnitCategory.kUTime;case UnitType.kDegrees:case UnitType.kRadians:case UnitType.kGradians:case UnitType.kTurns:return UnitCategory.kUAngle;default:return UnitCategory.kUOther}},canonicalUnitTypeForCategory=function(t){switch(t){case UnitCategory.kUNumber:return UnitType.kNumber;case UnitCategory.kULength:return UnitType.kPixels;case UnitCategory.kUPercent:return UnitType.kPercentage;case UnitCategory.kUTime:return UnitType.kSeconds;case UnitCategory.kUAngle:return UnitType.kDegrees;default:return UnitType.kUnknown}},conversionToCanonicalUnitsScaleFactor=function(t){var r=1;switch(t){case UnitType.kPixels:case UnitType.kDegrees:case UnitType.kSeconds:break;case UnitType.kMilliseconds:r=.001;break;case UnitType.kRadians:r=180/Math.PI;break;case UnitType.kGradians:r=.9;break;case UnitType.kTurns:r=360;break}return r},unitTypeToString=function(t){switch(t){case UnitType.kNumber:case UnitType.kInteger:return"";case UnitType.kPercentage:return"%";case UnitType.kEms:return"em";case UnitType.kRems:return"rem";case UnitType.kPixels:return"px";case UnitType.kDegrees:return"deg";case UnitType.kRadians:return"rad";case UnitType.kGradians:return"grad";case UnitType.kMilliseconds:return"ms";case UnitType.kSeconds:return"s";case UnitType.kTurns:return"turn"}return""},CSSStyleValue=function(){function t(){}return t.isAngle=function(r){return r===UnitType.kDegrees||r===UnitType.kRadians||r===UnitType.kGradians||r===UnitType.kTurns},t.isLength=function(r){return r>=UnitType.kEms&&r<UnitType.kDegrees},t.isRelativeUnit=function(r){return r===UnitType.kPercentage||r===UnitType.kEms||r===UnitType.kRems},t.isTime=function(r){return r===UnitType.kSeconds||r===UnitType.kMilliseconds},t.prototype.toString=function(){return this.buildCSSText(Nested.kNo,ParenLess.kNo,"")},t.prototype.isNumericValue=function(){return this.getType()>=CSSStyleValueType.kUnitType&&this.getType()<=CSSStyleValueType.kClampType},t}(),CSSColorValue=function(t){__extends(r,t);function r(e){var n=t.call(this)||this;return n.colorSpace=e,n}return r.prototype.getType=function(){return CSSStyleValueType.kColorType},r.prototype.to=function(e){return this},r}(CSSStyleValue),GradientType;(function(t){t[t.Constant=0]="Constant",t[t.LinearGradient=1]="LinearGradient",t[t.RadialGradient=2]="RadialGradient"})(GradientType||(GradientType={}));var CSSGradientValue=function(t){__extends(r,t);function r(e,n){var a=t.call(this)||this;return a.type=e,a.value=n,a}return r.prototype.clone=function(){return new r(this.type,this.value)},r.prototype.buildCSSText=function(e,n,a){return a},r.prototype.getType=function(){return CSSStyleValueType.kColorType},r}(CSSStyleValue),CSSKeywordValue=function(t){__extends(r,t);function r(e){var n=t.call(this)||this;return n.value=e,n}return r.prototype.clone=function(){return new r(this.value)},r.prototype.getType=function(){return CSSStyleValueType.kKeywordType},r.prototype.buildCSSText=function(e,n,a){return a+this.value},r}(CSSStyleValue),camelCase=memoize$1(function(t){return t===void 0&&(t=""),t.replace(/-([a-z])/g,function(r){return r[1].toUpperCase()})}),kebabize=function(t){return t.split("").map(function(r,e){return r.toUpperCase()===r?"".concat(e!==0?"-":"").concat(r.toLowerCase()):r}).join("")};function DCHECK(t){if(!t)throw new Error}function isFunction$1(t){return typeof t=="function"}function isSymbol$1(t){return typeof t=="symbol"}var FORMAT_ATTR_MAP={d:{alias:"path"},strokeDasharray:{alias:"lineDash"},strokeWidth:{alias:"lineWidth"},textAnchor:{alias:"textAlign"},src:{alias:"img"}},formatAttributeName=memoize$1(function(t){var r=camelCase(t),e=FORMAT_ATTR_MAP[r];return r=(e==null?void 0:e.alias)||r,r}),formatInfinityOrNaN=function(t,r){r===void 0&&(r="");var e="";return Number.isFinite(t)?(DCHECK(Number.isNaN(t)),e="NaN"):t>0?e="infinity":e="-infinity",e+=r},toCanonicalUnit=function(t){return canonicalUnitTypeForCategory(unitTypeToUnitCategory(t))},CSSUnitValue=function(t){__extends(r,t);function r(e,n){n===void 0&&(n=UnitType.kNumber);var a=t.call(this)||this,o;return typeof n=="string"?o=unitFromName(n):o=n,a.unit=o,a.value=e,a}return r.prototype.clone=function(){return new r(this.value,this.unit)},r.prototype.equals=function(e){var n=e;return this.value===n.value&&this.unit===n.unit},r.prototype.getType=function(){return CSSStyleValueType.kUnitType},r.prototype.convertTo=function(e){if(this.unit===e)return new r(this.value,this.unit);var n=toCanonicalUnit(this.unit);if(n!==toCanonicalUnit(e)||n===UnitType.kUnknown)return null;var a=conversionToCanonicalUnitsScaleFactor(this.unit)/conversionToCanonicalUnitsScaleFactor(e);return new r(this.value*a,e)},r.prototype.buildCSSText=function(e,n,a){var o;switch(this.unit){case UnitType.kUnknown:break;case UnitType.kInteger:o=Number(this.value).toFixed(0);break;case UnitType.kNumber:case UnitType.kPercentage:case UnitType.kEms:case UnitType.kRems:case UnitType.kPixels:case UnitType.kDegrees:case UnitType.kRadians:case UnitType.kGradians:case UnitType.kMilliseconds:case UnitType.kSeconds:case UnitType.kTurns:{var s=-999999,l=999999,u=this.value,c=unitTypeToString(this.unit);if(u<s||u>l){var d=unitTypeToString(this.unit);!Number.isFinite(u)||Number.isNaN(u)?o=formatInfinityOrNaN(u,d):o=u+(d||"")}else o="".concat(u).concat(c)}}return a+=o,a},r}(CSSStyleValue),Opx=new CSSUnitValue(0,"px");new CSSUnitValue(1,"px");var Odeg=new CSSUnitValue(0,"deg"),CSSRGB=function(t){__extends(r,t);function r(e,n,a,o,s){o===void 0&&(o=1),s===void 0&&(s=!1);var l=t.call(this,"rgb")||this;return l.r=e,l.g=n,l.b=a,l.alpha=o,l.isNone=s,l}return r.prototype.clone=function(){return new r(this.r,this.g,this.b,this.alpha)},r.prototype.buildCSSText=function(e,n,a){return a+"rgba(".concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")},r}(CSSColorValue),unsetKeywordValue=new CSSKeywordValue("unset"),initialKeywordValue=new CSSKeywordValue("initial"),inheritKeywordValue=new CSSKeywordValue("inherit"),keywordCache={"":unsetKeywordValue,unset:unsetKeywordValue,initial:initialKeywordValue,inherit:inheritKeywordValue},getOrCreateKeyword=function(t){return keywordCache[t]||(keywordCache[t]=new CSSKeywordValue(t)),keywordCache[t]},noneColor=new CSSRGB(0,0,0,0,!0),transparentColor=new CSSRGB(0,0,0,0),getOrCreateRGBA=memoize$1(function(t,r,e,n){return new CSSRGB(t,r,e,n)},function(t,r,e,n){return"rgba(".concat(t,",").concat(r,",").concat(e,",").concat(n,")")}),getOrCreateUnitValue=function(t,r){return r===void 0&&(r=UnitType.kNumber),new CSSUnitValue(t,r)},PECENTAGE_50=new CSSUnitValue(50,"%"),Strategy;(function(t){t[t.Standard=0]="Standard"})(Strategy||(Strategy={}));var SortReason;(function(t){t[t.ADDED=0]="ADDED",t[t.REMOVED=1]="REMOVED",t[t.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED"})(SortReason||(SortReason={}));var EMPTY_PARSED_PATH={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Rectangle(0,0,0,0)},PropertySyntax;(function(t){t.COORDINATE="<coordinate>",t.COLOR="<color>",t.PAINT="<paint>",t.NUMBER="<number>",t.ANGLE="<angle>",t.OPACITY_VALUE="<opacity-value>",t.SHADOW_BLUR="<shadow-blur>",t.LENGTH="<length>",t.PERCENTAGE="<percentage>",t.LENGTH_PERCENTAGE="<length> | <percentage>",t.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",t.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",t.LIST_OF_POINTS="<list-of-points>",t.PATH="<path>",t.FILTER="<filter>",t.Z_INDEX="<z-index>",t.OFFSET_DISTANCE="<offset-distance>",t.DEFINED_PATH="<defined-path>",t.MARKER="<marker>",t.TRANSFORM="<transform>",t.TRANSFORM_ORIGIN="<transform-origin>",t.TEXT="<text>",t.TEXT_TRANSFORM="<text-transform>"})(PropertySyntax||(PropertySyntax={}));function colorStopToString(t){var r=t.type,e=t.value;return r==="hex"?"#".concat(e):r==="literal"?e:r==="rgb"?"rgb(".concat(e.join(","),")"):"rgba(".concat(e.join(","),")")}var parseGradient$1=function(){var t={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},r="";function e($){throw new Error(r+": "+$)}function n(){var $=a();return r.length>0&&e("Invalid input not EOF"),$}function a(){return w(o)}function o(){return s("linear-gradient",t.linearGradient,u)||s("repeating-linear-gradient",t.repeatingLinearGradient,u)||s("radial-gradient",t.radialGradient,f)||s("repeating-radial-gradient",t.repeatingRadialGradient,f)||s("conic-gradient",t.conicGradient,f)}function s($,W,V){return l(W,function(X){var J=V();return J&&(G(t.comma)||e("Missing comma before color stops")),{type:$,orientation:J,colorStops:w(R)}})}function l($,W){var V=G($);if(V){G(t.startCall)||e("Missing (");var X=W(V);return G(t.endCall)||e("Missing )"),X}}function u(){return c()||d()}function c(){return H("directional",t.sideOrCorner,1)}function d(){return H("angular",t.angleValue,1)}function f(){var $,W=h(),V;return W&&($=[],$.push(W),V=r,G(t.comma)&&(W=h(),W?$.push(W):r=V)),$}function h(){var $=p()||v();if($)$.at=y();else{var W=g();if(W){$=W;var V=y();V&&($.at=V)}else{var X=m();X&&($={type:"default-radial",at:X})}}return $}function p(){var $=H("shape",/^(circle)/i,0);return $&&($.style=k()||g()),$}function v(){var $=H("shape",/^(ellipse)/i,0);return $&&($.style=N()||g()),$}function g(){return H("extent-keyword",t.extentKeywords,1)}function y(){if(H("position",/^at/,0)){var $=m();return $||e("Missing positioning value"),$}}function m(){var $=S();if($.x||$.y)return{type:"position",value:$}}function S(){return{x:N(),y:N()}}function w($){var W=$(),V=[];if(W)for(V.push(W);G(t.comma);)W=$(),W?V.push(W):e("One extra comma");return V}function R(){var $=T();return $||e("Expected color definition"),$.length=N(),$}function T(){return b()||M()||L()||x()}function x(){return H("literal",t.literalColor,0)}function b(){return H("hex",t.hexColor,1)}function L(){return l(t.rgbColor,function(){return{type:"rgb",value:w(D)}})}function M(){return l(t.rgbaColor,function(){return{type:"rgba",value:w(D)}})}function D(){return G(t.number)[1]}function N(){return H("%",t.percentageValue,1)||F()||k()}function F(){return H("position-keyword",t.positionKeywords,1)}function k(){return H("px",t.pixelValue,1)||H("em",t.emValue,1)}function H($,W,V){var X=G(W);if(X)return{type:$,value:X[V]}}function G($){var W=/^[\n\r\t\s]+/.exec(r);W&&z(W[0].length);var V=$.exec(r);return V&&z(V[0].length),V}function z($){r=r.substring($)}return function($){return r=$,n()}}();function computeLinearGradient(t,r,e){var n=deg2rad(e.value),a=0,o=0,s=a+t/2,l=o+r/2,u=Math.abs(t*Math.cos(n))+Math.abs(r*Math.sin(n)),c=s-Math.cos(n)*u/2,d=l-Math.sin(n)*u/2,f=s+Math.cos(n)*u/2,h=l+Math.sin(n)*u/2;return{x1:c,y1:d,x2:f,y2:h}}function computeRadialGradient(t,r,e,n,a){var o=e.value,s=n.value;e.unit===UnitType.kPercentage&&(o=e.value/100*t),n.unit===UnitType.kPercentage&&(s=n.value/100*r);var l=Math.max(distanceSquareRoot([0,0],[o,s]),distanceSquareRoot([0,r],[o,s]),distanceSquareRoot([t,r],[o,s]),distanceSquareRoot([t,0],[o,s]));return a&&(a instanceof CSSUnitValue?l=a.value:a instanceof CSSKeywordValue&&(a.value==="closest-side"?l=Math.min(o,t-o,s,r-s):a.value==="farthest-side"?l=Math.max(o,t-o,s,r-s):a.value==="closest-corner"&&(l=Math.min(distanceSquareRoot([0,0],[o,s]),distanceSquareRoot([0,r],[o,s]),distanceSquareRoot([t,r],[o,s]),distanceSquareRoot([t,0],[o,s]))))),{x:o,y:s,r:l}}var regexLG=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,regexRG=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,regexPR=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,regexColorStop=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function spaceColorStops(t){var r,e,n,a=t.length;t[a-1].length=(r=t[a-1].length)!==null&&r!==void 0?r:{type:"%",value:"100"},a>1&&(t[0].length=(e=t[0].length)!==null&&e!==void 0?e:{type:"%",value:"0"});for(var o=0,s=Number(t[0].length.value),l=1;l<a;l++){var u=(n=t[l].length)===null||n===void 0?void 0:n.value;if(!isNil$1(u)&&!isNil$1(s)){for(var c=1;c<l-o;c++)t[o+c].length={type:"%",value:"".concat(s+(Number(u)-s)*c/(l-o))};o=l,s=Number(u)}}}var SideOrCornerToDegMap={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},angleToDeg=memoize$1(function(t){var r;return t.type==="angular"?r=Number(t.value):r=SideOrCornerToDegMap[t.value]||0,getOrCreateUnitValue(r,"deg")}),positonToCSSUnitValue=memoize$1(function(t){var r=50,e=50,n="%",a="%";if((t==null?void 0:t.type)==="position"){var o=t.value,s=o.x,l=o.y;(s==null?void 0:s.type)==="position-keyword"&&(s.value==="left"?r=0:s.value==="center"?r=50:s.value==="right"?r=100:s.value==="top"?e=0:s.value==="bottom"&&(e=100)),(l==null?void 0:l.type)==="position-keyword"&&(l.value==="left"?r=0:l.value==="center"?e=50:l.value==="right"?r=100:l.value==="top"?e=0:l.value==="bottom"&&(e=100)),((s==null?void 0:s.type)==="px"||(s==null?void 0:s.type)==="%"||(s==null?void 0:s.type)==="em")&&(n=s==null?void 0:s.type,r=Number(s.value)),((l==null?void 0:l.type)==="px"||(l==null?void 0:l.type)==="%"||(l==null?void 0:l.type)==="em")&&(a=l==null?void 0:l.type,e=Number(l.value))}return{cx:getOrCreateUnitValue(r,n),cy:getOrCreateUnitValue(e,a)}}),parseGradient=memoize$1(function(t){var r;if(t.indexOf("linear")>-1||t.indexOf("radial")>-1){var e=parseGradient$1(t);return e.map(function(l){var u=l.type,c=l.orientation,d=l.colorStops;spaceColorStops(d);var f=d.map(function(w){return{offset:getOrCreateUnitValue(Number(w.length.value),"%"),color:colorStopToString(w)}});if(u==="linear-gradient")return new CSSGradientValue(GradientType.LinearGradient,{angle:c?angleToDeg(c):Odeg,steps:f});if(u==="radial-gradient"&&(c||(c=[{type:"shape",value:"circle"}]),c[0].type==="shape"&&c[0].value==="circle")){var h=positonToCSSUnitValue(c[0].at),p=h.cx,v=h.cy,g=void 0;if(c[0].style){var y=c[0].style,m=y.type,S=y.value;m==="extent-keyword"?g=getOrCreateKeyword(S):g=getOrCreateUnitValue(S,m)}return new CSSGradientValue(GradientType.RadialGradient,{cx:p,cy:v,size:g,steps:f})}})}var n=t[0];if(t[1]==="("||t[2]==="("){if(n==="l"){var a=regexLG.exec(t);if(a){var o=((r=a[2].match(regexColorStop))===null||r===void 0?void 0:r.map(function(l){return l.split(":")}))||[];return[new CSSGradientValue(GradientType.LinearGradient,{angle:getOrCreateUnitValue(parseFloat(a[1]),"deg"),steps:o.map(function(l){var u=__read(l,2),c=u[0],d=u[1];return{offset:getOrCreateUnitValue(Number(c)*100,"%"),color:d}})})]}}else if(n==="r"){var s=parseRadialGradient(t);if(s)if(isString$1(s))t=s;else return[new CSSGradientValue(GradientType.RadialGradient,s)]}else if(n==="p")return parsePattern(t)}});function parseRadialGradient(t){var r,e=regexRG.exec(t);if(e){var n=((r=e[4].match(regexColorStop))===null||r===void 0?void 0:r.map(function(a){return a.split(":")}))||[];return{cx:getOrCreateUnitValue(50,"%"),cy:getOrCreateUnitValue(50,"%"),steps:n.map(function(a){var o=__read(a,2),s=o[0],l=o[1];return{offset:getOrCreateUnitValue(Number(s)*100,"%"),color:l}})}}return null}function parsePattern(t){var r=regexPR.exec(t);if(r){var e=r[1],n=r[2];switch(e){case"a":e="repeat";break;case"x":e="repeat-x";break;case"y":e="repeat-y";break;case"n":e="no-repeat";break;default:e="no-repeat"}return{image:n,repetition:e}}return null}function isPattern(t){return t&&!!t.image}function isCSSRGB(t){return t&&!isNil$1(t.r)&&!isNil$1(t.g)&&!isNil$1(t.b)}var parseColor=memoize$1(function(t){if(isPattern(t))return __assign({repetition:"repeat"},t);if(isNil$1(t)&&(t=""),t==="transparent")return transparentColor;t==="currentColor"&&(t="black");var r=parseGradient(t);if(r)return r;var e=color(t),n=[0,0,0,0];return e!==null&&(n[0]=e.r||0,n[1]=e.g||0,n[2]=e.b||0,n[3]=e.opacity),getOrCreateRGBA.apply(void 0,__spreadArray([],__read(n),!1))});function mergeColors(t,r){if(!(!isCSSRGB(t)||!isCSSRGB(r)))return[[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],[Number(r.r),Number(r.g),Number(r.b),Number(r.alpha)],function(e){var n=e.slice();if(n[3])for(var a=0;a<3;a++)n[a]=Math.round(clamp$2(n[a],0,255));return n[3]=clamp$2(n[3],0,1),"rgba(".concat(n.join(","),")")}]}function parseDimension(t,r){if(isNil$1(r))return getOrCreateUnitValue(0,"px");if(r="".concat(r).trim().toLowerCase(),isFinite(Number(r))){if("px".search(t)>=0)return getOrCreateUnitValue(Number(r),"px");if("deg".search(t)>=0)return getOrCreateUnitValue(Number(r),"deg")}var e=[];r=r.replace(t,function(a){return e.push(a),"U"+a});var n="U("+t.source+")";return e.map(function(a){return getOrCreateUnitValue(Number(r.replace(new RegExp("U"+a,"g"),"").replace(new RegExp(n,"g"),"*0")),a)})[0]}var parseLengthUnmemoize=function(t){return parseDimension(new RegExp("px","g"),t)},parseLength=memoize$1(parseLengthUnmemoize),parserPercentageUnmemoize=function(t){return parseDimension(new RegExp("%","g"),t)};memoize$1(parserPercentageUnmemoize);var parseLengthOrPercentageUnmemoize=function(t){return isNumber$1(t)||isFinite(Number(t))?getOrCreateUnitValue(Number(t)||0,"px"):parseDimension(new RegExp("px|%|em|rem","g"),t)},parseLengthOrPercentage=memoize$1(parseLengthOrPercentageUnmemoize),parseAngleUnmemoize=function(t){return parseDimension(new RegExp("deg|rad|grad|turn","g"),t)},parseAngle=memoize$1(parseAngleUnmemoize);function mergeDimensions(t,r,e,n,a){a===void 0&&(a=0);var o="",s=t.value||0,l=r.value||0,u=toCanonicalUnit(t.unit),c=t.convertTo(u),d=r.convertTo(u);return c&&d?(s=c.value,l=d.value,o=unitTypeToString(t.unit)):(CSSUnitValue.isLength(t.unit)||CSSUnitValue.isLength(r.unit))&&(s=convertPercentUnit(t,a,e),l=convertPercentUnit(r,a,e),o="px"),[s,l,function(f){return n&&(f=Math.max(f,0)),f+o}]}function convertAngleUnit(t){var r=0;return t.unit===UnitType.kDegrees?r=t.value:t.unit===UnitType.kRadians?r=rad2deg(Number(t.value)):t.unit===UnitType.kTurns&&(r=turn2deg(Number(t.value))),r}function parseDimensionArrayFormat(t,r){var e;return Array.isArray(t)?e=t.map(function(n){return Number(n)}):isString$1(t)?e=t.split(" ").map(function(n){return Number(n)}):isNumber$1(t)&&(e=[t]),r===2?e.length===1?[e[0],e[0]]:[e[0],e[1]]:e.length===1?[e[0],e[0],e[0],e[0]]:e.length===2?[e[0],e[1],e[0],e[1]]:e.length===3?[e[0],e[1],e[2],e[1]]:[e[0],e[1],e[2],e[3]]}function parseDimensionArray(t){return isString$1(t)?t.split(" ").map(function(r){return parseLengthOrPercentage(r)}):t.map(function(r){return parseLengthOrPercentage(r.toString())})}function convertPercentUnit(t,r,e){if(t.value===0)return 0;if(t.unit===UnitType.kPixels)return Number(t.value);if(t.unit===UnitType.kPercentage&&e){var n=e.nodeName===Shape.GROUP?e.getLocalBounds():e.geometry.contentBounds;return t.value/100*n.halfExtents[r]*2}return 0}var parseParam=function(t){return parseDimension(/deg|rad|grad|turn|px|%/g,t)},supportedFilters=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function parseFilter(t){if(t===void 0&&(t=""),t=t.toLowerCase().trim(),t==="none")return[];for(var r=/\s*([\w-]+)\(([^)]*)\)/g,e=[],n,a=0;n=r.exec(t);){if(n.index!==a)return[];if(a=n.index+n[0].length,supportedFilters.indexOf(n[1])>-1&&e.push({name:n[1],params:n[2].split(" ").map(function(o){return parseParam(o)||parseColor(o)})}),r.lastIndex===t.length)return e}return[]}function numberToString(t){return t.toString()}var parseNumberUnmemoize=function(t){return typeof t=="number"?getOrCreateUnitValue(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?getOrCreateUnitValue(Number(t)):getOrCreateUnitValue(0)},parseNumber=memoize$1(parseNumberUnmemoize);memoize$1(function(t){return isString$1(t)?t.split(" ").map(parseNumber):t.map(parseNumber)});function mergeNumbers(t,r){return[t,r,numberToString]}function clampedMergeNumbers(t,r){return function(e,n){return[e,n,function(a){return numberToString(clamp$2(a,t,r))}]}}function mergeNumberLists(t,r){if(t.length===r.length)return[t,r,function(e){return e}]}function getOrCalculatePathTotalLength(t){return t.parsedStyle.path.totalLength===0&&(t.parsedStyle.path.totalLength=getTotalLength(t.parsedStyle.path.absolutePath)),t.parsedStyle.path.totalLength}function removeRedundantMCommand(t){for(var r=0;r<t.length;r++){var e=t[r-1],n=t[r],a=n[0];if(a==="M"&&e){var o=e[0],s=[n[1],n[2]],l=void 0;o==="L"||o==="M"?l=[e[1],e[2]]:(o==="C"||o==="A"||o==="Q")&&(l=[e[e.length-2],e[e.length-1]]),l&&isSamePoint(s,l)&&(t.splice(r,1),r--)}}}function hasArcOrBezier(t){for(var r=!1,e=t.length,n=0;n<e;n++){var a=t[n],o=a[0];if(o==="C"||o==="A"||o==="Q"){r=!0;break}}return r}function extractPolygons(t){for(var r=[],e=[],n=[],a=0;a<t.length;a++){var o=t[a],s=o[0];s==="M"?(n.length&&(e.push(n),n=[]),n.push([o[1],o[2]])):s==="Z"?n.length&&(r.push(n),n=[]):n.push([o[1],o[2]])}return n.length>0&&e.push(n),{polygons:r,polylines:e}}function isSamePoint(t,r){return t[0]===r[0]&&t[1]===r[1]}function getPathBBox(t,r){for(var e=[],n=[],a=[],o=0;o<t.length;o++){var s=t[o],l=s.currentPoint,u=s.params,c=s.prePoint,d=void 0;switch(s.command){case"Q":d=box(c[0],c[1],u[1],u[2],u[3],u[4]);break;case"C":d=box$3(c[0],c[1],u[1],u[2],u[3],u[4],u[5],u[6]);break;case"A":var f=s.arcParams;d=box$5(f.cx,f.cy,f.rx,f.ry,f.xRotation,f.startAngle,f.endAngle);break;default:e.push(l[0]),n.push(l[1]);break}d&&(s.box=d,e.push(d.x,d.x+d.width),n.push(d.y,d.y+d.height)),r&&(s.command==="L"||s.command==="M")&&s.prePoint&&s.nextPoint&&a.push(s)}e=e.filter(function(m){return!Number.isNaN(m)&&m!==1/0&&m!==-1/0}),n=n.filter(function(m){return!Number.isNaN(m)&&m!==1/0&&m!==-1/0});var h=min$2(e),p=min$2(n),v=max$2(e),g=max$2(n);if(a.length===0)return{x:h,y:p,width:v-h,height:g-p};for(var o=0;o<a.length;o++){var s=a[o],l=s.currentPoint,y=void 0;l[0]===h?(y=getExtraFromSegmentWithAngle(s,r),h=h-y.xExtra):l[0]===v&&(y=getExtraFromSegmentWithAngle(s,r),v=v+y.xExtra),l[1]===p?(y=getExtraFromSegmentWithAngle(s,r),p=p-y.yExtra):l[1]===g&&(y=getExtraFromSegmentWithAngle(s,r),g=g+y.yExtra)}return{x:h,y:p,width:v-h,height:g-p}}function getExtraFromSegmentWithAngle(t,r){var e=t.prePoint,n=t.currentPoint,a=t.nextPoint,o=Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2),s=Math.pow(n[0]-a[0],2)+Math.pow(n[1]-a[1],2),l=Math.pow(e[0]-a[0],2)+Math.pow(e[1]-a[1],2),u=Math.acos((o+s-l)/(2*Math.sqrt(o)*Math.sqrt(s)));if(!u||Math.sin(u)===0||isNumberEqual(u,0))return{xExtra:0,yExtra:0};var c=Math.abs(Math.atan2(a[1]-n[1],a[0]-n[0])),d=Math.abs(Math.atan2(a[0]-n[0],a[1]-n[1]));c=c>Math.PI/2?Math.PI-c:c,d=d>Math.PI/2?Math.PI-d:d;var f={xExtra:Math.cos(u/2-c)*(r/2*(1/Math.sin(u/2)))-r/2||0,yExtra:Math.cos(d-u/2)*(r/2*(1/Math.sin(u/2)))-r/2||0};return f}function toSymmetry(t,r){return[r[0]+(r[0]-t[0]),r[1]+(r[1]-t[1])]}var angleBetween=function(t,r){var e=t.x*r.x+t.y*r.y,n=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(r.x,2)+Math.pow(r.y,2))),a=t.x*r.y-t.y*r.x<0?-1:1,o=a*Math.acos(e/n);return o},pointOnEllipticalArc=function(t,r,e,n,a,o,s,l){r=Math.abs(r),e=Math.abs(e),n=mod$1(n,360);var u=deg2rad(n);if(t.x===s.x&&t.y===s.y)return{x:t.x,y:t.y,ellipticalArcAngle:0};if(r===0||e===0)return{x:0,y:0,ellipticalArcAngle:0};var c=(t.x-s.x)/2,d=(t.y-s.y)/2,f={x:Math.cos(u)*c+Math.sin(u)*d,y:-Math.sin(u)*c+Math.cos(u)*d},h=Math.pow(f.x,2)/Math.pow(r,2)+Math.pow(f.y,2)/Math.pow(e,2);h>1&&(r=Math.sqrt(h)*r,e=Math.sqrt(h)*e);var p=Math.pow(r,2)*Math.pow(e,2)-Math.pow(r,2)*Math.pow(f.y,2)-Math.pow(e,2)*Math.pow(f.x,2),v=Math.pow(r,2)*Math.pow(f.y,2)+Math.pow(e,2)*Math.pow(f.x,2),g=p/v;g=g<0?0:g;var y=(a!==o?1:-1)*Math.sqrt(g),m={x:y*(r*f.y/e),y:y*(-(e*f.x)/r)},S={x:Math.cos(u)*m.x-Math.sin(u)*m.y+(t.x+s.x)/2,y:Math.sin(u)*m.x+Math.cos(u)*m.y+(t.y+s.y)/2},w={x:(f.x-m.x)/r,y:(f.y-m.y)/e},R=angleBetween({x:1,y:0},w),T={x:(-f.x-m.x)/r,y:(-f.y-m.y)/e},x=angleBetween(w,T);!o&&x>0?x-=2*Math.PI:o&&x<0&&(x+=2*Math.PI),x%=2*Math.PI;var b=R+x*l,L=r*Math.cos(b),M=e*Math.sin(b),D={x:Math.cos(u)*L-Math.sin(u)*M+S.x,y:Math.sin(u)*L+Math.cos(u)*M+S.y,ellipticalArcStartAngle:R,ellipticalArcEndAngle:R+x,ellipticalArcAngle:b,ellipticalArcCenter:S,resultantRx:r,resultantRy:e};return D};function path2Segments(t){for(var r=[],e=null,n=null,a=null,o=0,s=t.length,l=0;l<s;l++){var u=t[l];n=t[l+1];var c=u[0],d={command:c,prePoint:e,params:u,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(c){case"M":a=[u[1],u[2]],o=l;break;case"A":var f=getArcParams(e,u);d.arcParams=f;break}if(c==="Z")e=a,n=t[o+1];else{var h=u.length;e=[u[h-2],u[h-1]]}n&&n[0]==="Z"&&(n=t[o],r[o]&&(r[o].prePoint=e)),d.currentPoint=e,r[o]&&isSamePoint(e,r[o].currentPoint)&&(r[o].prePoint=d.prePoint);var p=n?[n[n.length-2],n[n.length-1]]:null;d.nextPoint=p;var v=d.prePoint;if(["L","H","V"].includes(c))d.startTangent=[v[0]-e[0],v[1]-e[1]],d.endTangent=[e[0]-v[0],e[1]-v[1]];else if(c==="Q"){var g=[u[1],u[2]];d.startTangent=[v[0]-g[0],v[1]-g[1]],d.endTangent=[e[0]-g[0],e[1]-g[1]]}else if(c==="T"){var y=r[l-1],g=toSymmetry(y.currentPoint,v);y.command==="Q"?(d.command="Q",d.startTangent=[v[0]-g[0],v[1]-g[1]],d.endTangent=[e[0]-g[0],e[1]-g[1]]):(d.command="TL",d.startTangent=[v[0]-e[0],v[1]-e[1]],d.endTangent=[e[0]-v[0],e[1]-v[1]])}else if(c==="C"){var m=[u[1],u[2]],S=[u[3],u[4]];d.startTangent=[v[0]-m[0],v[1]-m[1]],d.endTangent=[e[0]-S[0],e[1]-S[1]],d.startTangent[0]===0&&d.startTangent[1]===0&&(d.startTangent=[m[0]-S[0],m[1]-S[1]]),d.endTangent[0]===0&&d.endTangent[1]===0&&(d.endTangent=[S[0]-m[0],S[1]-m[1]])}else if(c==="S"){var y=r[l-1],m=toSymmetry(y.currentPoint,v),S=[u[1],u[2]];y.command==="C"?(d.command="C",d.startTangent=[v[0]-m[0],v[1]-m[1]],d.endTangent=[e[0]-S[0],e[1]-S[1]]):(d.command="SQ",d.startTangent=[v[0]-S[0],v[1]-S[1]],d.endTangent=[e[0]-S[0],e[1]-S[1]])}else if(c==="A"){var w=getTangentAtRatio(d,0),R=w.x,T=w.y,x=getTangentAtRatio(d,1,!1),b=x.x,L=x.y;d.startTangent=[R,T],d.endTangent=[b,L]}r.push(d)}return r}function getTangentAtRatio(t,r,e){e===void 0&&(e=!0);var n=t.arcParams,a=n.rx,o=a===void 0?0:a,s=n.ry,l=s===void 0?0:s,u=n.xRotation,c=n.arcFlag,d=n.sweepFlag,f=pointOnEllipticalArc({x:t.prePoint[0],y:t.prePoint[1]},o,l,u,!!c,!!d,{x:t.currentPoint[0],y:t.currentPoint[1]},r),h=pointOnEllipticalArc({x:t.prePoint[0],y:t.prePoint[1]},o,l,u,!!c,!!d,{x:t.currentPoint[0],y:t.currentPoint[1]},e?r+.005:r-.005),p=h.x-f.x,v=h.y-f.y,g=Math.sqrt(p*p+v*v);return{x:-p/g,y:-v/g}}function vMag(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function vRatio(t,r){return vMag(t)*vMag(r)?(t[0]*r[0]+t[1]*r[1])/(vMag(t)*vMag(r)):1}function vAngle(t,r){return(t[0]*r[1]<t[1]*r[0]?-1:1)*Math.acos(vRatio(t,r))}function getArcParams(t,r){var e=r[1],n=r[2],a=mod$1(deg2rad(r[3]),Math.PI*2),o=r[4],s=r[5],l=t[0],u=t[1],c=r[6],d=r[7],f=Math.cos(a)*(l-c)/2+Math.sin(a)*(u-d)/2,h=-1*Math.sin(a)*(l-c)/2+Math.cos(a)*(u-d)/2,p=f*f/(e*e)+h*h/(n*n);p>1&&(e*=Math.sqrt(p),n*=Math.sqrt(p));var v=e*e*(h*h)+n*n*(f*f),g=v?Math.sqrt((e*e*(n*n)-v)/v):1;o===s&&(g*=-1),isNaN(g)&&(g=0);var y=n?g*e*h/n:0,m=e?g*-n*f/e:0,S=(l+c)/2+Math.cos(a)*y-Math.sin(a)*m,w=(u+d)/2+Math.sin(a)*y+Math.cos(a)*m,R=[(f-y)/e,(h-m)/n],T=[(-1*f-y)/e,(-1*h-m)/n],x=vAngle([1,0],R),b=vAngle(R,T);return vRatio(R,T)<=-1&&(b=Math.PI),vRatio(R,T)>=1&&(b=0),s===0&&b>0&&(b=b-2*Math.PI),s===1&&b<0&&(b=b+2*Math.PI),{cx:S,cy:w,rx:isSamePoint(t,[c,d])?0:e,ry:isSamePoint(t,[c,d])?0:n,startAngle:x,endAngle:x+b,xRotation:a,arcFlag:o,sweepFlag:s}}var internalParsePath=function(t){if(t===""||Array.isArray(t)&&t.length===0)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var r;try{r=normalizePath(t)}catch{r=normalizePath(""),console.error("[g]: Invalid SVG Path definition: ".concat(t))}removeRedundantMCommand(r);var e=hasArcOrBezier(r),n=extractPolygons(r),a=n.polygons,o=n.polylines,s=path2Segments(r),l=getPathBBox(s,0),u=l.x,c=l.y,d=l.width,f=l.height;return{absolutePath:r,hasArc:e,segments:s,polygons:a,polylines:o,totalLength:0,rect:{x:Number.isFinite(u)?u:0,y:Number.isFinite(c)?c:0,width:Number.isFinite(d)?d:0,height:Number.isFinite(f)?f:0}}},memoizedParsePath=memoize$1(internalParsePath);function parsePath(t){return isString$1(t)?memoizedParsePath(t):internalParsePath(t)}function mergePaths(t,r,e){var n=t.curve,a=r.curve;(!n||n.length===0)&&(n=path2Curve(t.absolutePath,!1),t.curve=n),(!a||a.length===0)&&(a=path2Curve(r.absolutePath,!1),r.curve=a);var o=[n,a];n.length!==a.length&&(o=equalizeSegments(n,a));var s=getDrawDirection(o[0])!==getDrawDirection(o[1])?reverseCurve(o[0]):clonePath(o[0]);return[s,getRotatedCurve(o[1],s),function(l){return l}]}function parsePoints(t,r){var e;isString$1(t)?e=t.split(" ").map(function(d){var f=__read(d.split(","),2),h=f[0],p=f[1];return[Number(h),Number(p)]}):e=t;var n=[],a=0,o,s,l=length$2(e);e.forEach(function(d,f){e[f+1]&&(o=[0,0],o[0]=a/l,s=length$4(d[0],d[1],e[f+1][0],e[f+1][1]),a+=s,o[1]=a/l,n.push(o))});var u=Math.min.apply(Math,__spreadArray([],__read(e.map(function(d){return d[0]})),!1)),c=Math.min.apply(Math,__spreadArray([],__read(e.map(function(d){return d[1]})),!1));return r&&(r.parsedStyle.defX=u,r.parsedStyle.defY=c),{points:e,totalLength:l,segments:n}}function mergePoints(t,r){return[t.points,r.points,function(e){return e}]}var _=null;function cast(t){return function(r){var e=0;return t.map(function(n){return n===_?r[e++]:n})}}function id(t){return t}var transformFunctions={matrix:["NNNNNN",[_,_,0,0,_,_,0,0,0,0,1,0,_,_,0,1],id],matrix3d:["NNNNNNNNNNNNNNNN",id],rotate:["A"],rotatex:["A"],rotatey:["A"],rotatez:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",cast([_,_,new CSSUnitValue(1)]),id],scalex:["N",cast([_,new CSSUnitValue(1),new CSSUnitValue(1)]),cast([_,new CSSUnitValue(1)])],scaley:["N",cast([new CSSUnitValue(1),_,new CSSUnitValue(1)]),cast([new CSSUnitValue(1),_])],scalez:["N",cast([new CSSUnitValue(1),new CSSUnitValue(1),_])],scale3d:["NNN",id],skew:["Aa",null,id],skewx:["A",null,cast([_,Odeg])],skewy:["A",null,cast([Odeg,_])],translate:["Tt",cast([_,_,Opx]),id],translatex:["T",cast([_,Opx,Opx]),cast([_,Opx])],translatey:["T",cast([Opx,_,Opx]),cast([Opx,_])],translatez:["L",cast([Opx,Opx,_])],translate3d:["TTL",id]};function parseTransform(t){if(t=(t||"none").toLowerCase().trim(),t==="none")return[];for(var r=/\s*(\w+)\(([^)]*)\)/g,e=[],n,a=0;n=r.exec(t);){if(n.index!==a)return[];a=n.index+n[0].length;var o=n[1],s=transformFunctions[o];if(!s)return[];var l=n[2].split(","),u=s[0];if(u.length<l.length)return[];for(var c=[],d=0;d<u.length;d++){var f=l[d],h=u[d],p=void 0;if(f?p={A:function(v){return v.trim()==="0"?Odeg:parseAngle(v)},N:parseNumber,T:parseLengthOrPercentage,L:parseLength}[h.toUpperCase()](f):p={a:Odeg,n:c[0],t:Opx}[h],p===void 0)return[];c.push(p)}if(e.push({t:o,d:c}),r.lastIndex===t.length)return e}return[]}function parseTransformUnmemoize(t){if(t=(t||"none").toLowerCase().trim(),t==="none")return[];for(var r=/\s*(\w+)\(([^)]*)\)/g,e=[],n,a=0;n=r.exec(t);){if(n.index!==a)return[];a=n.index+n[0].length;var o=n[1],s=transformFunctions[o];if(!s)return[];var l=n[2].split(","),u=s[0];if(u.length<l.length)return[];for(var c=[],d=0;d<u.length;d++){var f=l[d],h=u[d],p=void 0;if(f?p={A:function(v){return v.trim()==="0"?Odeg:parseAngleUnmemoize(v)},N:parseNumberUnmemoize,T:parseLengthOrPercentageUnmemoize,L:parseLengthUnmemoize}[h.toUpperCase()](f):p={a:Odeg,n:c[0],t:Opx}[h],p===void 0)return[];c.push(p)}if(e.push({t:o,d:c}),r.lastIndex===t.length)return e}return[]}function convertItemToMatrix(t){var r,e,n,a;switch(t.t){case"rotatex":return a=deg2rad(convertAngleUnit(t.d[0])),[1,0,0,0,0,Math.cos(a),Math.sin(a),0,0,-Math.sin(a),Math.cos(a),0,0,0,0,1];case"rotatey":return a=deg2rad(convertAngleUnit(t.d[0])),[Math.cos(a),0,-Math.sin(a),0,0,1,0,0,Math.sin(a),0,Math.cos(a),0,0,0,0,1];case"rotate":case"rotatez":return a=deg2rad(convertAngleUnit(t.d[0])),[Math.cos(a),Math.sin(a),0,0,-Math.sin(a),Math.cos(a),0,0,0,0,1,0,0,0,0,1];case"rotate3d":r=t.d[0].value,e=t.d[1].value,n=t.d[2].value,a=deg2rad(convertAngleUnit(t.d[3]));var o=r*r+e*e+n*n;if(o===0)r=1,e=0,n=0;else if(o!==1){var s=Math.sqrt(o);r/=s,e/=s,n/=s}var l=Math.sin(a/2),u=l*Math.cos(a/2),c=l*l;return[1-2*(e*e+n*n)*c,2*(r*e*c+n*u),2*(r*n*c-e*u),0,2*(r*e*c-n*u),1-2*(r*r+n*n)*c,2*(e*n*c+r*u),0,2*(r*n*c+e*u),2*(e*n*c-r*u),1-2*(r*r+e*e)*c,0,0,0,0,1];case"scale":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scalex":return[t.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaley":return[1,0,0,0,0,t.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scalez":return[1,0,0,0,0,1,0,0,0,0,t.d[0].value,0,0,0,0,1];case"scale3d":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,t.d[2].value,0,0,0,0,1];case"skew":var d=deg2rad(convertAngleUnit(t.d[0])),f=deg2rad(convertAngleUnit(t.d[1]));return[1,Math.tan(f),0,0,Math.tan(d),1,0,0,0,0,1,0,0,0,0,1];case"skewx":return a=deg2rad(convertAngleUnit(t.d[0])),[1,0,0,0,Math.tan(a),1,0,0,0,0,1,0,0,0,0,1];case"skewy":return a=deg2rad(convertAngleUnit(t.d[0])),[1,Math.tan(a),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return r=convertPercentUnit(t.d[0],0,null)||0,e=convertPercentUnit(t.d[1],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,r,e,0,1];case"translatex":return r=convertPercentUnit(t.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,r,0,0,1];case"translatey":return e=convertPercentUnit(t.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,e,0,1];case"translatez":return n=convertPercentUnit(t.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,n,1];case"translate3d":return r=convertPercentUnit(t.d[0],0,null)||0,e=convertPercentUnit(t.d[1],0,null)||0,n=convertPercentUnit(t.d[2],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,r,e,n,1];case"perspective":var h=convertPercentUnit(t.d[0],0,null)||0,p=h?-1/h:0;return[1,0,0,0,0,1,0,0,0,0,1,p,0,0,0,1];case"matrix":return[t.d[0].value,t.d[1].value,0,0,t.d[2].value,t.d[3].value,0,0,0,0,1,0,t.d[4].value,t.d[5].value,0,1];case"matrix3d":return t.d.map(function(v){return v.value})}}function multiplyMatrices(t,r){return[t[0]*r[0]+t[4]*r[1]+t[8]*r[2]+t[12]*r[3],t[1]*r[0]+t[5]*r[1]+t[9]*r[2]+t[13]*r[3],t[2]*r[0]+t[6]*r[1]+t[10]*r[2]+t[14]*r[3],t[3]*r[0]+t[7]*r[1]+t[11]*r[2]+t[15]*r[3],t[0]*r[4]+t[4]*r[5]+t[8]*r[6]+t[12]*r[7],t[1]*r[4]+t[5]*r[5]+t[9]*r[6]+t[13]*r[7],t[2]*r[4]+t[6]*r[5]+t[10]*r[6]+t[14]*r[7],t[3]*r[4]+t[7]*r[5]+t[11]*r[6]+t[15]*r[7],t[0]*r[8]+t[4]*r[9]+t[8]*r[10]+t[12]*r[11],t[1]*r[8]+t[5]*r[9]+t[9]*r[10]+t[13]*r[11],t[2]*r[8]+t[6]*r[9]+t[10]*r[10]+t[14]*r[11],t[3]*r[8]+t[7]*r[9]+t[11]*r[10]+t[15]*r[11],t[0]*r[12]+t[4]*r[13]+t[8]*r[14]+t[12]*r[15],t[1]*r[12]+t[5]*r[13]+t[9]*r[14]+t[13]*r[15],t[2]*r[12]+t[6]*r[13]+t[10]*r[14]+t[14]*r[15],t[3]*r[12]+t[7]*r[13]+t[11]*r[14]+t[15]*r[15]]}function convertToMatrix(t){return t.length===0?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:t.map(convertItemToMatrix).reduce(multiplyMatrices)}function makeMatrixDecomposition(t){var r=[0,0,0],e=[1,1,1],n=[0,0,0],a=[0,0,0,1],o=[0,0,0,1];return decomposeMat4(convertToMatrix(t),r,e,n,a,o),[[r,e,n,o,a]]}var composeMatrix=function(){function t(n,a){for(var o=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],s=0;s<4;s++)for(var l=0;l<4;l++)for(var u=0;u<4;u++)o[s][l]+=a[s][u]*n[u][l];return o}function r(n){return n[0][2]==0&&n[0][3]==0&&n[1][2]==0&&n[1][3]==0&&n[2][0]==0&&n[2][1]==0&&n[2][2]==1&&n[2][3]==0&&n[3][2]==0&&n[3][3]==1}function e(n,a,o,s,l){for(var u=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],c=0;c<4;c++)u[c][3]=l[c];for(var c=0;c<3;c++)for(var d=0;d<3;d++)u[3][c]+=n[d]*u[d][c];var f=s[0],h=s[1],p=s[2],v=s[3],g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];g[0][0]=1-2*(h*h+p*p),g[0][1]=2*(f*h-p*v),g[0][2]=2*(f*p+h*v),g[1][0]=2*(f*h+p*v),g[1][1]=1-2*(f*f+p*p),g[1][2]=2*(h*p-f*v),g[2][0]=2*(f*p-h*v),g[2][1]=2*(h*p+f*v),g[2][2]=1-2*(f*f+h*h),u=t(u,g);var y=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];o[2]&&(y[2][1]=o[2],u=t(u,y)),o[1]&&(y[2][1]=0,y[2][0]=o[0],u=t(u,y)),o[0]&&(y[2][0]=0,y[1][0]=o[0],u=t(u,y));for(var c=0;c<3;c++)for(var d=0;d<3;d++)u[c][d]*=a[c];return r(u)?[u[0][0],u[0][1],u[1][0],u[1][1],u[3][0],u[3][1]]:u[0].concat(u[1],u[2],u[3])}return e}();function numberToLongString(t){return t.toFixed(6).replace(".000000","")}function mergeMatrices(t,r){var e,n;return t.decompositionPair!==r&&(t.decompositionPair=r,e=makeMatrixDecomposition(t)),r.decompositionPair!==t&&(r.decompositionPair=t,n=makeMatrixDecomposition(r)),e[0]===null||n[0]===null?[[!1],[!0],function(a){return a?r[0].d:t[0].d}]:(e[0].push(0),n[0].push(1),[e,n,function(a){var o=quat(e[0][3],n[0][3],a[5]),s=composeMatrix(a[0],a[1],a[2],o,a[4]),l=s.map(numberToLongString).join(",");return l}])}function dot(t,r){for(var e=0,n=0;n<t.length;n++)e+=t[n]*r[n];return e}function quat(t,r,e){var n=dot(t,r);n=clamp$2(n,-1,1);var a=[];if(n===1)a=t;else for(var o=Math.acos(n),s=Math.sin(e*o)*1/Math.sqrt(1-n*n),l=0;l<4;l++)a.push(t[l]*(Math.cos(e*o)-n*s)+r[l]*s);return a}function typeTo2D(t){return t.replace(/[xy]/,"")}function typeTo3D(t){return t.replace(/(x|y|z|3d)?$/,"3d")}var isMatrixOrPerspective=function(t,r){return t==="perspective"&&r==="perspective"||(t==="matrix"||t==="matrix3d")&&(r==="matrix"||r==="matrix3d")};function mergeTransforms(t,r,e){var n=!1;if(!t.length||!r.length){t.length||(n=!0,t=r,r=[]);for(var a=function(x){var b=t[x],L=b.t,M=b.d,D=L.substring(0,5)==="scale"?1:0;r.push({t:L,d:M.map(function(N){return typeof N=="number"?getOrCreateUnitValue(D):getOrCreateUnitValue(D,N.unit)})})},o=0;o<t.length;o++)a(o)}var s=[],l=[],u=[];if(t.length!==r.length){var c=mergeMatrices(t,r);s=[c[0]],l=[c[1]],u=[["matrix",[c[2]]]]}else for(var o=0;o<t.length;o++){var d=t[o].t,f=r[o].t,h=t[o].d,p=r[o].d,v=transformFunctions[d],g=transformFunctions[f],y=void 0;if(isMatrixOrPerspective(d,f)){var c=mergeMatrices([t[o]],[r[o]]);s.push(c[0]),l.push(c[1]),u.push(["matrix",[c[2]]]);continue}else if(d===f)y=d;else if(v[2]&&g[2]&&typeTo2D(d)===typeTo2D(f))y=typeTo2D(d),h=v[2](h),p=g[2](p);else if(v[1]&&g[1]&&typeTo3D(d)===typeTo3D(f))y=typeTo3D(d),h=v[1](h),p=g[1](p);else{var c=mergeMatrices(t,r);s=[c[0]],l=[c[1]],u=[["matrix",[c[2]]]];break}for(var m=[],S=[],w=[],R=0;R<h.length;R++){var c=mergeDimensions(h[R],p[R],e,!1,R);m[R]=c[0],S[R]=c[1],w.push(c[2])}s.push(m),l.push(S),u.push([y,w])}if(n){var T=s;s=l,l=T}return[s,l,function(x){return x.map(function(b,L){var M=b.map(function(D,N){return u[L][1][N](D)}).join(",");return u[L][0]==="matrix"&&M.split(",").length===16&&(u[L][0]="matrix3d"),u[L][0]==="matrix3d"&&M.split(",").length===6&&(u[L][0]="matrix"),u[L][0]+"("+M+")"}).join(" ")}]}var parseTransformOrigin=memoize$1(function(t){if(isString$1(t)){if(t==="text-anchor")return[getOrCreateUnitValue(0,"px"),getOrCreateUnitValue(0,"px")];var r=t.split(" ");return r.length===1&&(r[0]==="top"||r[0]==="bottom"?(r[1]=r[0],r[0]="center"):r[1]="center"),r.length!==2?null:[parseLengthOrPercentage(convertKeyword2Percent(r[0])),parseLengthOrPercentage(convertKeyword2Percent(r[1]))]}else return[getOrCreateUnitValue(t[0]||0,"px"),getOrCreateUnitValue(t[1]||0,"px")]}),parseTransformOriginUnmemoize=function(t){if(isString$1(t)){if(t==="text-anchor")return[getOrCreateUnitValue(0,"px"),getOrCreateUnitValue(0,"px")];var r=t.split(" ");return r.length===1&&(r[0]==="top"||r[0]==="bottom"?(r[1]=r[0],r[0]="center"):r[1]="center"),r.length!==2?null:[parseLengthOrPercentageUnmemoize(convertKeyword2Percent(r[0])),parseLengthOrPercentageUnmemoize(convertKeyword2Percent(r[1]))]}else return[getOrCreateUnitValue(t[0]||0,"px"),getOrCreateUnitValue(t[1]||0,"px")]};function convertKeyword2Percent(t){return t==="center"?"50%":t==="left"||t==="top"?"0":t==="right"||t==="bottom"?"100%":t}var BUILT_IN_PROPERTIES=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:PropertySyntax.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:PropertySyntax.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:PropertySyntax.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:PropertySyntax.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:PropertySyntax.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:PropertySyntax.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:PropertySyntax.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:PropertySyntax.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:PropertySyntax.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:PropertySyntax.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:PropertySyntax.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:PropertySyntax.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:PropertySyntax.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:PropertySyntax.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:PropertySyntax.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:PropertySyntax.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:PropertySyntax.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:PropertySyntax.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:PropertySyntax.FILTER},{n:"clipPath",syntax:PropertySyntax.DEFINED_PATH},{n:"textPath",syntax:PropertySyntax.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:PropertySyntax.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:PropertySyntax.TRANSFORM},{n:"transformOrigin",p:100,d:function(t){return t===Shape.CIRCLE||t===Shape.ELLIPSE?"center":t===Shape.TEXT?"text-anchor":"left top"},l:!0,syntax:PropertySyntax.TRANSFORM_ORIGIN},{n:"anchor",p:99,d:function(t){return t===Shape.CIRCLE||t===Shape.ELLIPSE?"0.5 0.5":"0 0"},l:!0,syntax:PropertySyntax.LENGTH_PERCENTAGE_12},{n:"cx",int:!0,d:"0",syntax:PropertySyntax.COORDINATE},{n:"cy",int:!0,d:"0",syntax:PropertySyntax.COORDINATE},{n:"cz",int:!0,d:"0",syntax:PropertySyntax.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:PropertySyntax.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:PropertySyntax.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:PropertySyntax.LENGTH_PERCENTAGE},{n:"x",int:!0,d:"0",syntax:PropertySyntax.COORDINATE},{n:"y",int:!0,d:"0",syntax:PropertySyntax.COORDINATE},{n:"z",int:!0,d:"0",syntax:PropertySyntax.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:PropertySyntax.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:PropertySyntax.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:PropertySyntax.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:PropertySyntax.COORDINATE},{n:"y1",int:!0,l:!0,syntax:PropertySyntax.COORDINATE},{n:"z1",int:!0,l:!0,syntax:PropertySyntax.COORDINATE},{n:"x2",int:!0,l:!0,syntax:PropertySyntax.COORDINATE},{n:"y2",int:!0,l:!0,syntax:PropertySyntax.COORDINATE},{n:"z2",int:!0,l:!0,syntax:PropertySyntax.COORDINATE},{n:"path",int:!0,l:!0,d:"",a:["d"],syntax:PropertySyntax.PATH,p:50},{n:"points",int:!0,l:!0,syntax:PropertySyntax.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:PropertySyntax.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:PropertySyntax.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:PropertySyntax.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:PropertySyntax.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:PropertySyntax.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:PropertySyntax.NUMBER,d:function(t){return t===Shape.PATH||t===Shape.POLYGON||t===Shape.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:PropertySyntax.MARKER},{n:"markerEnd",syntax:PropertySyntax.MARKER},{n:"markerMid",syntax:PropertySyntax.MARKER},{n:"markerStartOffset",syntax:PropertySyntax.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:PropertySyntax.LENGTH,l:!0,int:!0,d:"0"}],GEOMETRY_ATTRIBUTE_NAMES=BUILT_IN_PROPERTIES.filter(function(t){return!!t.l}).map(function(t){return t.n}),propertyMetadataCache={},unresolvedProperties=new WeakMap,isPropertyResolved=function(t,r){var e=unresolvedProperties.get(t);return!e||e.length===0?!0:e.includes(r)},DefaultStyleValueRegistry=function(){function t(r){var e=this;this.runtime=r,BUILT_IN_PROPERTIES.forEach(function(n){e.registerMetadata(n)})}return t.prototype.registerMetadata=function(r){__spreadArray([r.n],__read(r.a||[]),!1).forEach(function(e){propertyMetadataCache[e]=r})},t.prototype.unregisterMetadata=function(r){delete propertyMetadataCache[r]},t.prototype.getPropertySyntax=function(r){return this.runtime.CSSPropertySyntaxFactory[r]},t.prototype.processProperties=function(r,e,n){var a=this;if(n===void 0&&(n={skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0}),!this.runtime.enableCSSParsing){Object.assign(r.attributes,e);var o=Object.keys(e),s=r.parsedStyle.clipPath,l=r.parsedStyle.offsetPath;r.parsedStyle=Object.assign(r.parsedStyle,e);var u=!!n.forceUpdateGeometry;if(!u){for(var c=0;c<GEOMETRY_ATTRIBUTE_NAMES.length;c++)if(GEOMETRY_ATTRIBUTE_NAMES[c]in e){u=!0;break}}e.fill&&(r.parsedStyle.fill=parseColor(e.fill)),e.stroke&&(r.parsedStyle.stroke=parseColor(e.stroke)),e.shadowColor&&(r.parsedStyle.shadowColor=parseColor(e.shadowColor)),e.filter&&(r.parsedStyle.filter=parseFilter(e.filter)),isNil$1(e.radius)||(r.parsedStyle.radius=parseDimensionArrayFormat(e.radius,4)),isNil$1(e.lineDash)||(r.parsedStyle.lineDash=parseDimensionArrayFormat(e.lineDash,2)),e.points&&(r.parsedStyle.points=parsePoints(e.points,r)),e.path===""&&(r.parsedStyle.path=__assign({},EMPTY_PARSED_PATH)),e.path&&(r.parsedStyle.path=parsePath(e.path),r.parsedStyle.defX=r.parsedStyle.path.rect.x,r.parsedStyle.defY=r.parsedStyle.path.rect.y),e.textTransform&&this.runtime.CSSPropertySyntaxFactory["<text-transform>"].calculator(null,null,{value:e.textTransform},r,null),e.clipPath&&this.runtime.CSSPropertySyntaxFactory["<defined-path>"].calculator("clipPath",s,e.clipPath,r,this.runtime),e.offsetPath&&this.runtime.CSSPropertySyntaxFactory["<defined-path>"].calculator("offsetPath",l,e.offsetPath,r,this.runtime),e.anchor&&(r.parsedStyle.anchor=parseDimensionArrayFormat(e.anchor,2)),e.transform&&(r.parsedStyle.transform=parseTransform(e.transform)),e.transformOrigin&&(r.parsedStyle.transformOrigin=parseTransformOrigin(e.transformOrigin)),e.markerStart&&(r.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator(null,e.markerStart,e.markerStart,null,null)),e.markerEnd&&(r.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator(null,e.markerEnd,e.markerEnd,null,null)),e.markerMid&&(r.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator("",e.markerMid,e.markerMid,null,null)),((r.nodeName===Shape.CIRCLE||r.nodeName===Shape.ELLIPSE)&&(!isNil$1(e.cx)||!isNil$1(e.cy))||(r.nodeName===Shape.RECT||r.nodeName===Shape.IMAGE||r.nodeName===Shape.GROUP||r.nodeName===Shape.HTML||r.nodeName===Shape.TEXT||r.nodeName===Shape.MESH)&&(!isNil$1(e.x)||!isNil$1(e.y)||!isNil$1(e.z))||r.nodeName===Shape.LINE&&(!isNil$1(e.x1)||!isNil$1(e.y1)||!isNil$1(e.z1)||!isNil$1(e.x2)||!isNil$1(e.y2)||!isNil$1(e.z2)))&&this.runtime.CSSPropertySyntaxFactory["<coordinate>"].postProcessor(r,o),isNil$1(e.zIndex)||this.runtime.CSSPropertySyntaxFactory["<z-index>"].postProcessor(r,o),e.path&&this.runtime.CSSPropertySyntaxFactory["<path>"].postProcessor(r,o),e.points&&this.runtime.CSSPropertySyntaxFactory["<list-of-points>"].postProcessor(r,o),isNil$1(e.offsetDistance)||this.runtime.CSSPropertySyntaxFactory["<offset-distance>"].postProcessor(r,o),e.transform&&this.runtime.CSSPropertySyntaxFactory["<transform>"].postProcessor(r,o),u&&this.updateGeometry(r);return}var d=n.skipUpdateAttribute,f=n.skipParse,h=n.forceUpdateGeometry,p=n.usedAttributes,v=n.memoize,g=h,y=Object.keys(e);y.forEach(function(m){var S;d||(r.attributes[m]=e[m]),!g&&(!((S=propertyMetadataCache[m])===null||S===void 0)&&S.l)&&(g=!0)}),f||y.forEach(function(m){r.computedStyle[m]=a.parseProperty(m,r.attributes[m],r,v)}),p!=null&&p.length&&(y=Array.from(new Set(y.concat(p)))),y.forEach(function(m){m in r.computedStyle&&(r.parsedStyle[m]=a.computeProperty(m,r.computedStyle[m],r,v))}),g&&this.updateGeometry(r),y.forEach(function(m){m in r.parsedStyle&&a.postProcessProperty(m,r,y)}),this.runtime.enableCSSParsing&&r.children.length&&y.forEach(function(m){m in r.parsedStyle&&a.isPropertyInheritable(m)&&r.children.forEach(function(S){S.internalSetAttribute(m,null,{skipUpdateAttribute:!0,skipParse:!0})})})},t.prototype.parseProperty=function(r,e,n,a){var o=propertyMetadataCache[r],s=e;if((e===""||isNil$1(e))&&(e="unset"),e==="unset"||e==="initial"||e==="inherit")s=getOrCreateKeyword(e);else if(o){var l=o.k,u=o.syntax,c=u&&this.getPropertySyntax(u);l&&l.indexOf(e)>-1?s=getOrCreateKeyword(e):c&&(!a&&c.parserUnmemoize?s=c.parserUnmemoize(e,n):c.parser&&(s=c.parser(e,n)))}return s},t.prototype.computeProperty=function(r,e,n,a){var o=propertyMetadataCache[r],s=n.id==="g-root",l=e;if(o){var u=o.syntax,c=o.inh,d=o.d;if(e instanceof CSSKeywordValue){var f=e.value;if(f==="unset"&&(c&&!s?f="inherit":f="initial"),f==="initial")isNil$1(d)||(e=this.parseProperty(r,isFunction$1(d)?d(n.nodeName):d,n,a));else if(f==="inherit"){var h=this.tryToResolveProperty(n,r,{inherited:!0});if(isNil$1(h)){this.addUnresolveProperty(n,r);return}else return h}}var p=u&&this.getPropertySyntax(u);if(p&&p.calculator){var v=n.parsedStyle[r];l=p.calculator(r,v,e,n,this.runtime)}else e instanceof CSSKeywordValue?l=e.value:l=e}return l},t.prototype.postProcessProperty=function(r,e,n){var a=propertyMetadataCache[r];if(a&&a.syntax){var o=a.syntax&&this.getPropertySyntax(a.syntax),s=o;s&&s.postProcessor&&s.postProcessor(e,n)}},t.prototype.addUnresolveProperty=function(r,e){var n=unresolvedProperties.get(r);n||(unresolvedProperties.set(r,[]),n=unresolvedProperties.get(r)),n.indexOf(e)===-1&&n.push(e)},t.prototype.tryToResolveProperty=function(r,e,n){n===void 0&&(n={});var a=n.inherited;if(a&&r.parentElement&&isPropertyResolved(r.parentElement,e)){var o=r.parentElement.parsedStyle[e];return o==="unset"||o==="initial"||o==="inherit"?void 0:o}},t.prototype.recalc=function(r){var e=unresolvedProperties.get(r);if(e&&e.length){var n={};e.forEach(function(a){n[a]=r.attributes[a]}),this.processProperties(r,n),unresolvedProperties.delete(r)}},t.prototype.updateGeometry=function(r){var e=r.nodeName,n=this.runtime.geometryUpdaterFactory[e];if(n){var a=r.geometry;a.contentBounds||(a.contentBounds=new AABB),a.renderBounds||(a.renderBounds=new AABB);var o=r.parsedStyle,s=n.update(o,r),l=s.width,u=s.height,c=s.depth,d=c===void 0?0:c,f=s.offsetX,h=f===void 0?0:f,p=s.offsetY,v=p===void 0?0:p,g=s.offsetZ,y=g===void 0?0:g,m=[Math.abs(l)/2,Math.abs(u)/2,d/2],S=o,w=S.stroke,R=S.lineWidth,T=S.increasedLineWidthForHitTesting,x=S.shadowType,b=S.shadowColor,L=S.filter,M=L===void 0?[]:L,D=S.transformOrigin,N=o.anchor;e===Shape.TEXT?delete o.anchor:e===Shape.MESH&&(o.anchor[2]=.5);var F=[(1-(N&&N[0]||0)*2)*l/2+h,(1-(N&&N[1]||0)*2)*u/2+v,(1-(N&&N[2]||0)*2)*m[2]+y];a.contentBounds.update(F,m);var k=e===Shape.POLYLINE||e===Shape.POLYGON||e===Shape.PATH?Math.SQRT2:.5,H=w&&!w.isNone;if(H){var G=((R||0)+(T||0))*k;m[0]+=G,m[1]+=G}if(a.renderBounds.update(F,m),b&&x&&x!=="inner"){var z=a.renderBounds,$=z.min,W=z.max,V=o,X=V.shadowBlur,J=V.shadowOffsetX,j=V.shadowOffsetY,ne=X||0,Q=J||0,ie=j||0,te=$[0]-ne+Q,oe=W[0]+ne+Q,ae=$[1]-ne+ie,le=W[1]+ne+ie;$[0]=Math.min($[0],te),W[0]=Math.max(W[0],oe),$[1]=Math.min($[1],ae),W[1]=Math.max(W[1],le),a.renderBounds.setMinMax($,W)}M.forEach(function(Ee){var me=Ee.name,ue=Ee.params;if(me==="blur"){var Se=ue[0].value;a.renderBounds.update(a.renderBounds.center,addVec3(a.renderBounds.halfExtents,a.renderBounds.halfExtents,[Se,Se,0]))}else if(me==="drop-shadow"){var xe=ue[0].value,Te=ue[1].value,ve=ue[2].value,we=a.renderBounds,ce=we.min,de=we.max,De=ce[0]-ve+xe,Be=de[0]+ve+xe,be=ce[1]-ve+Te,Re=de[1]+ve+Te;ce[0]=Math.min(ce[0],De),de[0]=Math.max(de[0],Be),ce[1]=Math.min(ce[1],be),de[1]=Math.max(de[1],Re),a.renderBounds.setMinMax(ce,de)}}),N=o.anchor;var se=l<0,fe=u<0,pe=(se?-1:1)*(D?convertPercentUnit(D[0],0,r):0),ye=(fe?-1:1)*(D?convertPercentUnit(D[1],1,r):0);pe=pe-(se?-1:1)*(N&&N[0]||0)*a.contentBounds.halfExtents[0]*2,ye=ye-(fe?-1:1)*(N&&N[1]||0)*a.contentBounds.halfExtents[1]*2,r.setOrigin(pe,ye),this.runtime.sceneGraphService.dirtifyToRoot(r)}},t.prototype.updateSizeAttenuation=function(r,e){r.style.isSizeAttenuation?(r.style.rawLineWidth||(r.style.rawLineWidth=r.style.lineWidth),r.style.lineWidth=r.style.rawLineWidth/e,r.nodeName===Shape.CIRCLE&&(r.style.rawR||(r.style.rawR=r.style.r),r.style.r=r.style.rawR/e)):(r.style.rawLineWidth&&(r.style.lineWidth=r.style.rawLineWidth,delete r.style.rawLineWidth),r.nodeName===Shape.CIRCLE&&r.style.rawR&&(r.style.r=r.style.rawR,delete r.style.rawR))},t.prototype.isPropertyInheritable=function(r){var e=propertyMetadataCache[r];return e?e.inh:!1},t}(),CSSPropertyAngle=function(){function t(){this.parser=parseAngle,this.parserUnmemoize=parseAngleUnmemoize,this.parserWithCSSDisabled=null,this.mixer=mergeNumbers}return t.prototype.calculator=function(r,e,n,a){return convertAngleUnit(n)},t}(),CSSPropertyClipPath=function(){function t(){}return t.prototype.calculator=function(r,e,n,a,o){return n instanceof CSSKeywordValue&&(n=null),o.sceneGraphService.updateDisplayObjectDependency(r,e,n,a),r==="clipPath"&&a.forEach(function(s){s.childNodes.length===0&&o.sceneGraphService.dirtifyToRoot(s)}),n},t}(),CSSPropertyColor=function(){function t(){this.parser=parseColor,this.parserWithCSSDisabled=parseColor,this.mixer=mergeColors}return t.prototype.calculator=function(r,e,n,a){return n instanceof CSSKeywordValue?n.value==="none"?noneColor:transparentColor:n},t}(),CSSPropertyFilter=function(){function t(){this.parser=parseFilter}return t.prototype.calculator=function(r,e,n){return n instanceof CSSKeywordValue?[]:n},t}();function getFontSize(t){var r=t.parsedStyle.fontSize;return isNil$1(r)?null:r}var CSSPropertyLengthOrPercentage=function(){function t(){this.parser=parseLengthOrPercentage,this.parserUnmemoize=parseLengthOrPercentageUnmemoize,this.parserWithCSSDisabled=null,this.mixer=mergeNumbers}return t.prototype.calculator=function(r,e,n,a,o){var s;if(isNumber$1(n))return n;if(CSSUnitValue.isRelativeUnit(n.unit)){var l=o.styleValueRegistry;if(n.unit===UnitType.kPercentage)return 0;if(n.unit===UnitType.kEms){if(a.parentNode){var u=getFontSize(a.parentNode);if(u)return u*=n.value,u;l.addUnresolveProperty(a,r)}else l.addUnresolveProperty(a,r);return 0}else if(n.unit===UnitType.kRems){if(!((s=a==null?void 0:a.ownerDocument)===null||s===void 0)&&s.documentElement){var u=getFontSize(a.ownerDocument.documentElement);if(u)return u*=n.value,u;l.addUnresolveProperty(a,r)}else l.addUnresolveProperty(a,r);return 0}}else return n.value},t}(),CSSPropertyLengthOrPercentage12=function(){function t(){this.mixer=mergeNumberLists}return t.prototype.parser=function(r){var e=parseDimensionArray(isNumber$1(r)?[r]:r),n;return e.length===1?n=[e[0],e[0]]:n=[e[0],e[1]],n},t.prototype.calculator=function(r,e,n){return n.map(function(a){return a.value})},t}(),CSSPropertyLengthOrPercentage14=function(){function t(){this.mixer=mergeNumberLists}return t.prototype.parser=function(r){var e=parseDimensionArray(isNumber$1(r)?[r]:r),n;return e.length===1?n=[e[0],e[0],e[0],e[0]]:e.length===2?n=[e[0],e[1],e[0],e[1]]:e.length===3?n=[e[0],e[1],e[2],e[1]]:n=[e[0],e[1],e[2],e[3]],n},t.prototype.calculator=function(r,e,n){return n.map(function(a){return a.value})},t}(),tmpMat4$1=create$4();function parsedTransformToMat4(t,r){var e=r.parsedStyle.defX||0,n=r.parsedStyle.defY||0;return r.resetLocalTransform(),r.setLocalPosition(e,n),t.forEach(function(a){var o=a.t,s=a.d;if(o==="scale"){var l=(s==null?void 0:s.map(function(S){return S.value}))||[1,1];r.scaleLocal(l[0],l[1],1)}else if(o==="scalex"){var l=(s==null?void 0:s.map(function(w){return w.value}))||[1];r.scaleLocal(l[0],1,1)}else if(o==="scaley"){var l=(s==null?void 0:s.map(function(w){return w.value}))||[1];r.scaleLocal(1,l[0],1)}else if(o==="scalez"){var l=(s==null?void 0:s.map(function(w){return w.value}))||[1];r.scaleLocal(1,1,l[0])}else if(o==="scale3d"){var l=(s==null?void 0:s.map(function(w){return w.value}))||[1,1,1];r.scaleLocal(l[0],l[1],l[2])}else if(o==="translate"){var u=s||[Opx,Opx];r.translateLocal(u[0].value,u[1].value,0)}else if(o==="translatex"){var u=s||[Opx];r.translateLocal(u[0].value,0,0)}else if(o==="translatey"){var u=s||[Opx];r.translateLocal(0,u[0].value,0)}else if(o==="translatez"){var u=s||[Opx];r.translateLocal(0,0,u[0].value)}else if(o==="translate3d"){var u=s||[Opx,Opx,Opx];r.translateLocal(u[0].value,u[1].value,u[2].value)}else if(o==="rotate"){var c=s||[Odeg];r.rotateLocal(0,0,convertAngleUnit(c[0]))}else if(o==="rotatex"){var c=s||[Odeg];r.rotateLocal(convertAngleUnit(c[0]),0,0)}else if(o==="rotatey"){var c=s||[Odeg];r.rotateLocal(0,convertAngleUnit(c[0]),0)}else if(o==="rotatez"){var c=s||[Odeg];r.rotateLocal(0,0,convertAngleUnit(c[0]))}else if(o!=="rotate3d")if(o==="skew"){var d=(s==null?void 0:s.map(function(S){return S.value}))||[0,0];r.setLocalSkew(deg2rad(d[0]),deg2rad(d[1]))}else if(o==="skewx"){var d=(s==null?void 0:s.map(function(w){return w.value}))||[0];r.setLocalSkew(deg2rad(d[0]),r.getLocalSkew()[1])}else if(o==="skewy"){var d=(s==null?void 0:s.map(function(w){return w.value}))||[0];r.setLocalSkew(r.getLocalSkew()[0],deg2rad(d[0]))}else if(o==="matrix"){var f=__read(s.map(function(S){return S.value}),6),h=f[0],p=f[1],v=f[2],g=f[3],y=f[4],m=f[5];r.setLocalTransform(set$2(tmpMat4$1,h,p,0,0,v,g,0,0,0,0,1,0,y+e,m+n,0,1))}else o==="matrix3d"&&(set$2.apply(mat4,__spreadArray([tmpMat4$1],__read(s.map(function(S){return S.value})),!1)),tmpMat4$1[12]+=e,tmpMat4$1[13]+=n,r.setLocalTransform(tmpMat4$1))}),r.getLocalTransform()}var CSSPropertyLocalPosition=function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.postProcessor=function(e,n){var a,o,s;switch(e.nodeName){case Shape.CIRCLE:case Shape.ELLIPSE:var l=e.parsedStyle,u=l.cx,c=l.cy,d=l.cz;isNil$1(u)||(a=u),isNil$1(c)||(o=c),isNil$1(d)||(s=d);break;case Shape.LINE:var f=e.parsedStyle,h=f.x1,p=f.x2,v=f.y1,g=f.y2,y=Math.min(h,p),m=Math.min(v,g);a=y,o=m,s=0;break;case Shape.RECT:case Shape.IMAGE:case Shape.GROUP:case Shape.HTML:case Shape.TEXT:case Shape.MESH:isNil$1(e.parsedStyle.x)||(a=e.parsedStyle.x),isNil$1(e.parsedStyle.y)||(o=e.parsedStyle.y),isNil$1(e.parsedStyle.z)||(s=e.parsedStyle.z);break}e.nodeName!==Shape.PATH&&e.nodeName!==Shape.POLYLINE&&e.nodeName!==Shape.POLYGON&&(e.parsedStyle.defX=a||0,e.parsedStyle.defY=o||0);var S=!isNil$1(a)||!isNil$1(o)||!isNil$1(s);if(S&&n.indexOf("transform")===-1){var w=e.parsedStyle.transform;if(w&&w.length)parsedTransformToMat4(w,e);else{var R=__read(e.getLocalPosition(),3),T=R[0],x=R[1],b=R[2];e.setLocalPosition(isNil$1(a)?T:a,isNil$1(o)?x:o,isNil$1(s)?b:s)}}},r}(CSSPropertyLengthOrPercentage),CSSPropertyMarker=function(){function t(){}return t.prototype.calculator=function(r,e,n,a){n instanceof CSSKeywordValue&&(n=null);var o=n==null?void 0:n.cloneNode(!0);return o&&(o.style.isMarker=!0),o},t}(),CSSPropertyNumber=function(){function t(){this.mixer=mergeNumbers,this.parser=parseNumber,this.parserUnmemoize=parseNumberUnmemoize,this.parserWithCSSDisabled=null}return t.prototype.calculator=function(r,e,n){return n.value},t}(),CSSPropertyOffsetDistance=function(){function t(){this.parser=parseNumber,this.parserUnmemoize=parseNumberUnmemoize,this.parserWithCSSDisabled=null,this.mixer=clampedMergeNumbers(0,1)}return t.prototype.calculator=function(r,e,n){return n.value},t.prototype.postProcessor=function(r){var e=r.parsedStyle,n=e.offsetPath,a=e.offsetDistance;if(n){var o=n.nodeName;if(o===Shape.LINE||o===Shape.PATH||o===Shape.POLYLINE){var s=n.getPoint(a);s&&(r.parsedStyle.defX=s.x,r.parsedStyle.defY=s.y,r.setLocalPosition(s.x,s.y))}}},t}(),CSSPropertyOpacity=function(){function t(){this.parser=parseNumber,this.parserUnmemoize=parseNumberUnmemoize,this.parserWithCSSDisabled=null,this.mixer=clampedMergeNumbers(0,1)}return t.prototype.calculator=function(r,e,n){return n.value},t}(),CSSPropertyPath=function(){function t(){this.parser=parsePath,this.parserWithCSSDisabled=parsePath,this.mixer=mergePaths}return t.prototype.calculator=function(r,e,n){return n instanceof CSSKeywordValue&&n.value==="unset"?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Rectangle(0,0,0,0)}:n},t.prototype.postProcessor=function(r,e){if(r.parsedStyle.defX=r.parsedStyle.path.rect.x,r.parsedStyle.defY=r.parsedStyle.path.rect.y,r.nodeName===Shape.PATH&&e.indexOf("transform")===-1){var n=r.parsedStyle,a=n.defX,o=a===void 0?0:a,s=n.defY,l=s===void 0?0:s;r.setLocalPosition(o,l)}},t}(),CSSPropertyPoints=function(){function t(){this.parser=parsePoints,this.mixer=mergePoints}return t.prototype.postProcessor=function(r,e){if((r.nodeName===Shape.POLYGON||r.nodeName===Shape.POLYLINE)&&e.indexOf("transform")===-1){var n=r.parsedStyle,a=n.defX,o=n.defY;r.setLocalPosition(a,o)}},t}(),CSSPropertyShadowBlur=function(t){__extends(r,t);function r(){var e=t.apply(this,__spreadArray([],__read(arguments),!1))||this;return e.mixer=clampedMergeNumbers(0,1/0),e}return r}(CSSPropertyLengthOrPercentage),CSSPropertyText=function(){function t(){}return t.prototype.calculator=function(r,e,n,a){return n instanceof CSSKeywordValue?n.value==="unset"?"":n.value:"".concat(n)},t.prototype.postProcessor=function(r){r.nodeValue="".concat(r.parsedStyle.text)||""},t}(),CSSPropertyTextTransform=function(){function t(){}return t.prototype.calculator=function(r,e,n,a){var o=a.getAttribute("text");if(o){var s=o;n.value==="capitalize"?s=o.charAt(0).toUpperCase()+o.slice(1):n.value==="lowercase"?s=o.toLowerCase():n.value==="uppercase"&&(s=o.toUpperCase()),a.parsedStyle.text=s}return n.value},t}(),canvasMap={},defaultCanvasIdCounter=0;function cleanExistedCanvas(t,r){if(t){var e=typeof t=="string"?t:t.id||defaultCanvasIdCounter++;canvasMap[e]&&canvasMap[e].destroy(),canvasMap[e]=r}}var isBrowser=typeof window<"u"&&typeof window.document<"u";function isElement(t){return!!t.getAttribute}function sortedIndex(t,r){for(var e=0,n=t.length;e<n;){var a=e+n>>>1;sortByZIndex(t[a],r)<0?e=a+1:n=a}return e}function sortByZIndex(t,r){var e=Number(t.parsedStyle.zIndex),n=Number(r.parsedStyle.zIndex);if(e===n){var a=t.parentNode;if(a){var o=a.childNodes||[];return o.indexOf(t)-o.indexOf(r)}}return e-n}function findClosestClipPathTarget(t){var r,e=t;do{var n=(r=e.parsedStyle)===null||r===void 0?void 0:r.clipPath;if(n)return e;e=e.parentElement}while(e!==null);return null}var PX_SUFFIX="px";function setDOMSize(t,r,e){isBrowser&&t.style&&(t.style.width=r+PX_SUFFIX,t.style.height=e+PX_SUFFIX)}function getStyle(t,r){if(isBrowser)return document.defaultView.getComputedStyle(t,null).getPropertyValue(r)}function getWidth(t){var r=getStyle(t,"width");return r==="auto"?t.offsetWidth:parseFloat(r)}function getHeight(t){var r=getStyle(t,"height");return r==="auto"?t.offsetHeight:parseFloat(r)}var MOUSE_POINTER_ID=1,TOUCH_TO_POINTER={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},clock$1=typeof performance=="object"&&performance.now?performance:Date;function isFillOrStrokeAffected(t,r,e){var n=!1,a=!1,o=!!r&&!r.isNone,s=!!e&&!e.isNone;return t==="visiblepainted"||t==="painted"||t==="auto"?(n=o,a=s):t==="visiblefill"||t==="fill"?n=!0:t==="visiblestroke"||t==="stroke"?a=!0:(t==="visible"||t==="all")&&(n=!0,a=!0),[n,a]}var uId=1,uniqueId=function(){return uId++},root$1=typeof self=="object"&&self.self==self?self:typeof global=="object"&&global.global==global?global:{},nowOffset=Date.now(),pnow=function(){return root$1.performance&&typeof root$1.performance.now=="function"?root$1.performance.now():Date.now()-nowOffset},reservedCBs={},lastTime=Date.now(),polyfillRaf=function(t){if(typeof t!="function")throw new TypeError(t+" is not a function");var r=Date.now(),e=r-lastTime,n=e>16?0:16-e,a=uniqueId();return reservedCBs[a]=t,Object.keys(reservedCBs).length>1||setTimeout(function(){lastTime=r;var o=reservedCBs;reservedCBs={},Object.keys(o).forEach(function(s){return o[s](pnow())})},n),a},polyfillCaf=function(t){delete reservedCBs[t]},vendorPrefixes=["","webkit","moz","ms","o"],getRequestAnimationFrame=function(t){return typeof t!="string"?polyfillRaf:t===""?root$1.requestAnimationFrame:root$1[t+"RequestAnimationFrame"]},getCancelAnimationFrame=function(t){return typeof t!="string"?polyfillCaf:t===""?root$1.cancelAnimationFrame:root$1[t+"CancelAnimationFrame"]||root$1[t+"CancelRequestAnimationFrame"]},find$1=function(t,r){for(var e=0;t[e]!==void 0;){if(r(t[e]))return t[e];e=e+1}},vp=find$1(vendorPrefixes,function(t){return!!getRequestAnimationFrame(t)}),raf=getRequestAnimationFrame(vp),caf=getCancelAnimationFrame(vp);root$1.requestAnimationFrame=raf;root$1.cancelAnimationFrame=caf;var AsyncParallelHook=function(){function t(){this.callbacks=[]}return t.prototype.getCallbacksNum=function(){return this.callbacks.length},t.prototype.tapPromise=function(r,e){this.callbacks.push(e)},t.prototype.promise=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return Promise.all(this.callbacks.map(function(n){return n.apply(void 0,__spreadArray([],__read(r),!1))}))},t}(),AsyncSeriesWaterfallHook=function(){function t(){this.callbacks=[]}return t.prototype.tapPromise=function(r,e){this.callbacks.push(e)},t.prototype.promise=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return __awaiter(this,void 0,void 0,function(){var n,a,o,s;return __generator(this,function(l){switch(l.label){case 0:return this.callbacks.length?[4,(s=this.callbacks)[0].apply(s,__spreadArray([],__read(r),!1))]:[3,6];case 1:n=l.sent(),a=0,l.label=2;case 2:return a<this.callbacks.length-1?(o=this.callbacks[a],[4,o(n)]):[3,5];case 3:n=l.sent(),l.label=4;case 4:return a++,[3,2];case 5:return[2,n];case 6:return[2,null]}})})},t}(),SyncHook=function(){function t(){this.callbacks=[]}return t.prototype.tap=function(r,e){this.callbacks.push(e)},t.prototype.call=function(){var r=arguments;this.callbacks.forEach(function(e){e.apply(void 0,r)})},t}(),SyncWaterfallHook=function(){function t(){this.callbacks=[]}return t.prototype.tap=function(r,e){this.callbacks.push(e)},t.prototype.call=function(){if(this.callbacks.length){for(var r=arguments,e=this.callbacks[0].apply(void 0,r),n=0;n<this.callbacks.length-1;n++){var a=this.callbacks[n];e=a(e)}return e}return null},t}(),genericFontFamilies=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],stringRegExp=/([\"\'])[^\'\"]+\1/;function toFontString(t){for(var r=t.fontSize,e=t.fontFamily,n=t.fontStyle,a=t.fontVariant,o=t.fontWeight,s=isNumber$1(r)&&"".concat(r,"px")||"16px",l=e.split(","),u=l.length-1;u>=0;u--){var c=l[u].trim();!stringRegExp.test(c)&&genericFontFamilies.indexOf(c)<0&&(c='"'.concat(c,'"')),l[u]=c}return"".concat(n," ").concat(a," ").concat(o," ").concat(s," ").concat(l.join(","))}var CSSPropertyTransform=function(){function t(){this.parser=parseTransform,this.parserUnmemoize=parseTransformUnmemoize,this.parserWithCSSDisabled=parseTransformUnmemoize,this.mixer=mergeTransforms}return t.prototype.calculator=function(r,e,n,a){return n instanceof CSSKeywordValue?[]:n},t.prototype.postProcessor=function(r){var e=r.parsedStyle.transform;parsedTransformToMat4(e,r)},t}(),CSSPropertyTransformOrigin=function(){function t(){this.parser=parseTransformOrigin,this.parserUnmemoize=parseTransformOriginUnmemoize}return t}(),CSSPropertyZIndex=function(){function t(){this.parser=parseNumber,this.parserUnmemoize=parseNumberUnmemoize}return t.prototype.calculator=function(r,e,n,a){return n.value},t.prototype.postProcessor=function(r){if(r.parentNode){var e=r.parentNode,n=e.renderable,a=e.sortable;n&&(n.dirty=!0),a&&(a.dirty=!0,a.dirtyReason=SortReason.Z_INDEX_CHANGED)}},t}(),CircleUpdater=function(){function t(){}return t.prototype.update=function(r,e){var n=r.r,a=n*2,o=n*2;return{width:a,height:o}},t}(),EllipseUpdater=function(){function t(){}return t.prototype.update=function(r,e){var n=r.rx,a=r.ry,o=n*2,s=a*2;return{width:o,height:s}},t}(),LineUpdater=function(){function t(){}return t.prototype.update=function(r){var e=r.x1,n=r.y1,a=r.x2,o=r.y2,s=Math.min(e,a),l=Math.max(e,a),u=Math.min(n,o),c=Math.max(n,o),d=l-s,f=c-u;return{width:d,height:f}},t}(),PathUpdater=function(){function t(){}return t.prototype.update=function(r){var e=r.path,n=e.rect,a=n.width,o=n.height;return{width:a,height:o}},t}(),PolylineUpdater=function(){function t(){}return t.prototype.update=function(r){if(r.points&&isArray$1(r.points.points)){var e=r.points.points,n=Math.min.apply(Math,__spreadArray([],__read(e.map(function(c){return c[0]})),!1)),a=Math.max.apply(Math,__spreadArray([],__read(e.map(function(c){return c[0]})),!1)),o=Math.min.apply(Math,__spreadArray([],__read(e.map(function(c){return c[1]})),!1)),s=Math.max.apply(Math,__spreadArray([],__read(e.map(function(c){return c[1]})),!1)),l=a-n,u=s-o;return{width:l,height:u}}return{width:0,height:0}},t}(),RectUpdater=function(){function t(){}return t.prototype.update=function(r,e){var n=r.img,a=r.width,o=a===void 0?0:a,s=r.height,l=s===void 0?0:s,u=o,c=l;return n&&!isString$1(n)&&(u||(u=n.width,r.width=u),c||(c=n.height,r.height=c)),{width:u,height:c}},t}(),TextUpdater=function(){function t(r){this.globalRuntime=r}return t.prototype.isReadyToMeasure=function(r,e){var n=r.text,a=r.textAlign,o=r.textBaseline,s=r.fontSize,l=r.fontStyle,u=r.fontWeight,c=r.fontVariant,d=r.lineWidth;return n&&s&&l&&u&&c&&a&&o&&!isNil$1(d)},t.prototype.update=function(r,e){var n,a,o=r.text,s=r.textAlign,l=r.lineWidth,u=r.textBaseline,c=r.dx,d=r.dy;if(!this.isReadyToMeasure(r,e))return r.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{width:0,height:0,x:0,y:0,offsetX:0,offsetY:0};var f=(((a=(n=e==null?void 0:e.ownerDocument)===null||n===void 0?void 0:n.defaultView)===null||a===void 0?void 0:a.getConfig())||{}).offscreenCanvas,h=this.globalRuntime.textService.measureText(o,r,f);r.metrics=h;var p=h.width,v=h.height,g=h.lineHeight,y=h.fontProperties,m=[p/2,v/2,0],S=[0,1],w=0;s==="center"||s==="middle"?(w=l/2,S=[.5,1]):(s==="right"||s==="end")&&(w=l,S=[1,1]);var R=0;return u==="middle"?R=m[1]:u==="top"||u==="hanging"?R=m[1]*2:u==="alphabetic"?R=this.globalRuntime.enableCSSParsing?g-y.ascent:0:(u==="bottom"||u==="ideographic")&&(R=0),c&&(w+=c),d&&(R+=d),r.anchor=[S[0],S[1],0],{width:m[0]*2,height:m[1]*2,offsetX:w,offsetY:R}},t}();function isFederatedEvent(t){return!!t.type}var FederatedEvent=function(){function t(r){this.eventPhase=t.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Point,this.page=new Point,this.canvas=new Point,this.viewport=new Point,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=r}return Object.defineProperty(t.prototype,"name",{get:function(){return this.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layerX",{get:function(){return this.layer.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layerY",{get:function(){return this.layer.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageX",{get:function(){return this.page.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageY",{get:function(){return this.page.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canvasX",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canvasY",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"viewportX",{get:function(){return this.viewport.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"viewportY",{get:function(){return this.viewport.y},enumerable:!1,configurable:!0}),t.prototype.composedPath=function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path},Object.defineProperty(t.prototype,"propagationPath",{get:function(){return this.composedPath()},enumerable:!1,configurable:!0}),t.prototype.preventDefault=function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0},t.prototype.stopImmediatePropagation=function(){this.propagationImmediatelyStopped=!0},t.prototype.stopPropagation=function(){this.propagationStopped=!0},t.prototype.initEvent=function(){},t.prototype.initUIEvent=function(){},t.prototype.clone=function(){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},t}(),FederatedMouseEvent=function(t){__extends(r,t);function r(){var e=t.apply(this,__spreadArray([],__read(arguments),!1))||this;return e.client=new Point,e.movement=new Point,e.offset=new Point,e.global=new Point,e.screen=new Point,e}return Object.defineProperty(r.prototype,"clientX",{get:function(){return this.client.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"clientY",{get:function(){return this.client.y},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"movementX",{get:function(){return this.movement.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"movementY",{get:function(){return this.movement.y},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"offsetX",{get:function(){return this.offset.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"offsetY",{get:function(){return this.offset.y},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"globalX",{get:function(){return this.global.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"globalY",{get:function(){return this.global.y},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"screenX",{get:function(){return this.screen.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"screenY",{get:function(){return this.screen.y},enumerable:!1,configurable:!0}),r.prototype.getModifierState=function(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)},r.prototype.initMouseEvent=function(){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},r}(FederatedEvent),FederatedPointerEvent=function(t){__extends(r,t);function r(){var e=t.apply(this,__spreadArray([],__read(arguments),!1))||this;return e.width=0,e.height=0,e.isPrimary=!1,e}return r.prototype.getCoalescedEvents=function(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]},r.prototype.getPredictedEvents=function(){throw new Error("getPredictedEvents is not supported!")},r.prototype.clone=function(){return this.manager.clonePointerEvent(this)},r}(FederatedMouseEvent),FederatedWheelEvent=function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.clone=function(){return this.manager.cloneWheelEvent(this)},r}(FederatedMouseEvent),CustomEvent=function(t){__extends(r,t);function r(e,n){var a=t.call(this,null)||this;return a.type=e,a.detail=n,Object.assign(a,n),a}return r}(FederatedEvent),DELEGATION_SPLITTER=":",EventTarget=function(){function t(){this.emitter=new EventEmitter$1}return t.prototype.on=function(r,e,n){return this.addEventListener(r,e,n),this},t.prototype.addEventListener=function(r,e,n){var a=isBoolean$1(n)&&n||isObject$1(n)&&n.capture,o=isObject$1(n)&&n.once,s=isFunction$1(e)?void 0:e,l=!1,u="";if(r.indexOf(DELEGATION_SPLITTER)>-1){var c=__read(r.split(DELEGATION_SPLITTER),2),d=c[0],f=c[1];r=f,u=d,l=!0}if(r=a?"".concat(r,"capture"):r,e=isFunction$1(e)?e:e.handleEvent,l){var h=e;e=function(){for(var p,v=[],g=0;g<arguments.length;g++)v[g]=arguments[g];((p=v[0].target)===null||p===void 0?void 0:p.name)===u&&h.apply(void 0,__spreadArray([],__read(v),!1))}}return o?this.emitter.once(r,e,s):this.emitter.on(r,e,s),this},t.prototype.off=function(r,e,n){return r?this.removeEventListener(r,e,n):this.removeAllEventListeners(),this},t.prototype.removeAllEventListeners=function(){this.emitter.removeAllListeners()},t.prototype.removeEventListener=function(r,e,n){var a=isBoolean$1(n)&&n||isObject$1(n)&&n.capture,o=isFunction$1(e)?void 0:e;return r=a?"".concat(r,"capture"):r,e=isFunction$1(e)?e:e==null?void 0:e.handleEvent,this.emitter.off(r,e,o),this},t.prototype.emit=function(r,e){this.dispatchEvent(new CustomEvent(r,e))},t.prototype.dispatchEvent=function(r,e){var n,a;if(e===void 0&&(e=!1),!isFederatedEvent(r))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");var o;if(this.document?o=this:this.defaultView?o=this.defaultView:o=(n=this.ownerDocument)===null||n===void 0?void 0:n.defaultView,o){if(r.manager=o.getEventService()||null,!r.manager)return!1;r.defaultPrevented=!1,r.path=[],e||(r.target=this),(a=r.manager)===null||a===void 0||a.dispatchEvent(r,r.type,e)}return!r.defaultPrevented},t}(),Node$2=function(t){__extends(r,t);function r(){var e=t.apply(this,__spreadArray([],__read(arguments),!1))||this;return e.shadow=!1,e.ownerDocument=null,e.isConnected=!1,e.baseURI="",e.childNodes=[],e.nodeType=0,e.nodeName="",e.nodeValue=null,e.parentNode=null,e}return r.isNode=function(e){return!!e.childNodes},Object.defineProperty(r.prototype,"textContent",{get:function(){var e,n,a="";this.nodeName===Shape.TEXT&&(a+=this.style.text);try{for(var o=__values(this.childNodes),s=o.next();!s.done;s=o.next()){var l=s.value;l.nodeName===Shape.TEXT?a+=l.nodeValue:a+=l.textContent}}catch(u){e={error:u}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return a},set:function(e){var n=this;this.childNodes.slice().forEach(function(a){n.removeChild(a)}),this.nodeName===Shape.TEXT&&(this.style.text="".concat(e))},enumerable:!1,configurable:!0}),r.prototype.getRootNode=function(e){return e===void 0&&(e={}),this.parentNode?this.parentNode.getRootNode(e):e.composed&&this.host?this.host.getRootNode(e):this},r.prototype.hasChildNodes=function(){return this.childNodes.length>0},r.prototype.isDefaultNamespace=function(e){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},r.prototype.lookupNamespaceURI=function(e){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},r.prototype.lookupPrefix=function(e){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},r.prototype.normalize=function(){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},r.prototype.isEqualNode=function(e){return this===e},r.prototype.isSameNode=function(e){return this.isEqualNode(e)},Object.defineProperty(r.prototype,"parent",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"parentElement",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"nextSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"previousSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"firstChild",{get:function(){return this.childNodes.length>0?this.childNodes[0]:null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"lastChild",{get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null},enumerable:!1,configurable:!0}),r.prototype.compareDocumentPosition=function(e){var n;if(e===this)return 0;for(var a=e,o=this,s=[a],l=[o];(n=a.parentNode)!==null&&n!==void 0?n:o.parentNode;)a=a.parentNode?(s.push(a.parentNode),a.parentNode):a,o=o.parentNode?(l.push(o.parentNode),o.parentNode):o;if(a!==o)return r.DOCUMENT_POSITION_DISCONNECTED|r.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|r.DOCUMENT_POSITION_PRECEDING;var u=s.length>l.length?s:l,c=u===s?l:s;if(u[u.length-c.length]===c[0])return u===s?r.DOCUMENT_POSITION_CONTAINED_BY|r.DOCUMENT_POSITION_FOLLOWING:r.DOCUMENT_POSITION_CONTAINS|r.DOCUMENT_POSITION_PRECEDING;for(var d=u.length-c.length,f=c.length-1;f>=0;f--){var h=c[f],p=u[d+f];if(p!==h){var v=h.parentNode.childNodes;return v.indexOf(h)<v.indexOf(p)?c===s?r.DOCUMENT_POSITION_PRECEDING:r.DOCUMENT_POSITION_FOLLOWING:u===s?r.DOCUMENT_POSITION_PRECEDING:r.DOCUMENT_POSITION_FOLLOWING}}return r.DOCUMENT_POSITION_FOLLOWING},r.prototype.contain=function(e){return this.contains(e)},r.prototype.contains=function(e){for(var n=e;n&&this!==n;)n=n.parentNode;return!!n},r.prototype.getAncestor=function(e){for(var n=this;e>0&&n;)n=n.parentNode,e--;return n},r.prototype.forEach=function(e,n){n===void 0&&(n=!1),e(this)||(n?this.childNodes.slice():this.childNodes).forEach(function(a){a.forEach(e)})},r.DOCUMENT_POSITION_DISCONNECTED=1,r.DOCUMENT_POSITION_PRECEDING=2,r.DOCUMENT_POSITION_FOLLOWING=4,r.DOCUMENT_POSITION_CONTAINS=8,r.DOCUMENT_POSITION_CONTAINED_BY=16,r.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,r}(EventTarget),PROPAGATION_LIMIT=2048,EventService=function(){function t(r,e){var n=this;this.globalRuntime=r,this.context=e,this.emitter=new EventEmitter$1,this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=create$4(),this.tmpVec3=create$3(),this.onPointerDown=function(a){var o=n.createPointerEvent(a);if(n.dispatchEvent(o,"pointerdown"),o.pointerType==="touch")n.dispatchEvent(o,"touchstart");else if(o.pointerType==="mouse"||o.pointerType==="pen"){var s=o.button===2;n.dispatchEvent(o,s?"rightdown":"mousedown")}var l=n.trackingData(a.pointerId);l.pressTargetsByButton[a.button]=o.composedPath(),n.freeEvent(o)},this.onPointerUp=function(a){var o,s=clock$1.now(),l=n.createPointerEvent(a,void 0,void 0,n.context.config.alwaysTriggerPointerEventOnCanvas?n.rootTarget:void 0);if(n.dispatchEvent(l,"pointerup"),l.pointerType==="touch")n.dispatchEvent(l,"touchend");else if(l.pointerType==="mouse"||l.pointerType==="pen"){var u=l.button===2;n.dispatchEvent(l,u?"rightup":"mouseup")}var c=n.trackingData(a.pointerId),d=n.findMountedTarget(c.pressTargetsByButton[a.button]),f=d;if(d&&!l.composedPath().includes(d)){for(var h=d;h&&!l.composedPath().includes(h);){if(l.currentTarget=h,n.notifyTarget(l,"pointerupoutside"),l.pointerType==="touch")n.notifyTarget(l,"touchendoutside");else if(l.pointerType==="mouse"||l.pointerType==="pen"){var u=l.button===2;n.notifyTarget(l,u?"rightupoutside":"mouseupoutside")}Node$2.isNode(h)&&(h=h.parentNode)}delete c.pressTargetsByButton[a.button],f=h}if(f){var p=n.clonePointerEvent(l,"click");p.target=f,p.path=[],c.clicksByButton[a.button]||(c.clicksByButton[a.button]={clickCount:0,target:p.target,timeStamp:s});var v=c.clicksByButton[a.button];v.target===p.target&&s-v.timeStamp<200?++v.clickCount:v.clickCount=1,v.target=p.target,v.timeStamp=s,p.detail=v.clickCount,!((o=l.detail)===null||o===void 0)&&o.preventClick||(!n.context.config.useNativeClickEvent&&(p.pointerType==="mouse"||p.pointerType==="touch")&&n.dispatchEvent(p,"click"),n.dispatchEvent(p,"pointertap")),n.freeEvent(p)}n.freeEvent(l)},this.onPointerMove=function(a){var o=n.createPointerEvent(a,void 0,void 0,n.context.config.alwaysTriggerPointerEventOnCanvas?n.rootTarget:void 0),s=o.pointerType==="mouse"||o.pointerType==="pen",l=n.trackingData(a.pointerId),u=n.findMountedTarget(l.overTargets);if(l.overTargets&&u!==o.target){var c=a.type==="mousemove"?"mouseout":"pointerout",d=n.createPointerEvent(a,c,u||void 0);if(n.dispatchEvent(d,"pointerout"),s&&n.dispatchEvent(d,"mouseout"),!o.composedPath().includes(u)){var f=n.createPointerEvent(a,"pointerleave",u||void 0);for(f.eventPhase=f.AT_TARGET;f.target&&!o.composedPath().includes(f.target);)f.currentTarget=f.target,n.notifyTarget(f),s&&n.notifyTarget(f,"mouseleave"),Node$2.isNode(f.target)&&(f.target=f.target.parentNode);n.freeEvent(f)}n.freeEvent(d)}if(u!==o.target){var h=a.type==="mousemove"?"mouseover":"pointerover",p=n.clonePointerEvent(o,h);n.dispatchEvent(p,"pointerover"),s&&n.dispatchEvent(p,"mouseover");for(var v=u&&Node$2.isNode(u)&&u.parentNode;v&&v!==(Node$2.isNode(n.rootTarget)&&n.rootTarget.parentNode)&&v!==o.target;)v=v.parentNode;var g=!v||v===(Node$2.isNode(n.rootTarget)&&n.rootTarget.parentNode);if(g){var y=n.clonePointerEvent(o,"pointerenter");for(y.eventPhase=y.AT_TARGET;y.target&&y.target!==u&&y.target!==(Node$2.isNode(n.rootTarget)&&n.rootTarget.parentNode);)y.currentTarget=y.target,n.notifyTarget(y),s&&n.notifyTarget(y,"mouseenter"),Node$2.isNode(y.target)&&(y.target=y.target.parentNode);n.freeEvent(y)}n.freeEvent(p)}n.dispatchEvent(o,"pointermove"),o.pointerType==="touch"&&n.dispatchEvent(o,"touchmove"),s&&(n.dispatchEvent(o,"mousemove"),n.cursor=n.getCursor(o.target)),l.overTargets=o.composedPath(),n.freeEvent(o)},this.onPointerOut=function(a){var o=n.trackingData(a.pointerId);if(o.overTargets){var s=a.pointerType==="mouse"||a.pointerType==="pen",l=n.findMountedTarget(o.overTargets),u=n.createPointerEvent(a,"pointerout",l||void 0);n.dispatchEvent(u),s&&n.dispatchEvent(u,"mouseout");var c=n.createPointerEvent(a,"pointerleave",l||void 0);for(c.eventPhase=c.AT_TARGET;c.target&&c.target!==(Node$2.isNode(n.rootTarget)&&n.rootTarget.parentNode);)c.currentTarget=c.target,n.notifyTarget(c),s&&n.notifyTarget(c,"mouseleave"),Node$2.isNode(c.target)&&(c.target=c.target.parentNode);o.overTargets=null,n.freeEvent(u),n.freeEvent(c)}n.cursor=null},this.onPointerOver=function(a){var o=n.trackingData(a.pointerId),s=n.createPointerEvent(a),l=s.pointerType==="mouse"||s.pointerType==="pen";n.dispatchEvent(s,"pointerover"),l&&n.dispatchEvent(s,"mouseover"),s.pointerType==="mouse"&&(n.cursor=n.getCursor(s.target));var u=n.clonePointerEvent(s,"pointerenter");for(u.eventPhase=u.AT_TARGET;u.target&&u.target!==(Node$2.isNode(n.rootTarget)&&n.rootTarget.parentNode);)u.currentTarget=u.target,n.notifyTarget(u),l&&n.notifyTarget(u,"mouseenter"),Node$2.isNode(u.target)&&(u.target=u.target.parentNode);o.overTargets=s.composedPath(),n.freeEvent(s),n.freeEvent(u)},this.onPointerUpOutside=function(a){var o=n.trackingData(a.pointerId),s=n.findMountedTarget(o.pressTargetsByButton[a.button]),l=n.createPointerEvent(a);if(s){for(var u=s;u;)l.currentTarget=u,n.notifyTarget(l,"pointerupoutside"),l.pointerType==="touch"||(l.pointerType==="mouse"||l.pointerType==="pen")&&n.notifyTarget(l,l.button===2?"rightupoutside":"mouseupoutside"),Node$2.isNode(u)&&(u=u.parentNode);delete o.pressTargetsByButton[a.button]}n.freeEvent(l)},this.onWheel=function(a){var o=n.createWheelEvent(a);n.dispatchEvent(o),n.freeEvent(o)},this.onClick=function(a){if(n.context.config.useNativeClickEvent){var o=n.createPointerEvent(a);n.dispatchEvent(o),n.freeEvent(o)}},this.onPointerCancel=function(a){var o=n.createPointerEvent(a,void 0,void 0,n.context.config.alwaysTriggerPointerEventOnCanvas?n.rootTarget:void 0);n.dispatchEvent(o),n.freeEvent(o)}}return t.prototype.init=function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)},t.prototype.destroy=function(){this.emitter.removeAllListeners(),this.mappingTable={},this.mappingState={},this.eventPool.clear()},t.prototype.client2Viewport=function(r){var e=this.context.contextService.getBoundingClientRect();return new Point(r.x-((e==null?void 0:e.left)||0),r.y-((e==null?void 0:e.top)||0))},t.prototype.viewport2Client=function(r){var e=this.context.contextService.getBoundingClientRect();return new Point(r.x+((e==null?void 0:e.left)||0),r.y+((e==null?void 0:e.top)||0))},t.prototype.viewport2Canvas=function(r){var e=r.x,n=r.y,a=this.rootTarget.defaultView,o=a.getCamera(),s=this.context.config,l=s.width,u=s.height,c=o.getPerspectiveInverse(),d=o.getWorldTransform(),f=multiply$2(this.tmpMatrix,d,c),h=set$1(this.tmpVec3,e/l*2-1,(1-n/u)*2-1,0);return transformMat4$1(h,h,f),new Point(h[0],h[1])},t.prototype.canvas2Viewport=function(r){var e=this.rootTarget.defaultView,n=e.getCamera(),a=n.getPerspective(),o=n.getViewTransform(),s=multiply$2(this.tmpMatrix,a,o),l=set$1(this.tmpVec3,r.x,r.y,0);transformMat4$1(this.tmpVec3,this.tmpVec3,s);var u=this.context.config,c=u.width,d=u.height;return new Point((l[0]+1)/2*c,(1-(l[1]+1)/2)*d)},t.prototype.setPickHandler=function(r){this.pickHandler=r},t.prototype.addEventMapping=function(r,e){this.mappingTable[r]||(this.mappingTable[r]=[]),this.mappingTable[r].push({fn:e,priority:0}),this.mappingTable[r].sort(function(n,a){return n.priority-a.priority})},t.prototype.mapEvent=function(r){if(this.rootTarget){var e=this.mappingTable[r.type];if(e)for(var n=0,a=e.length;n<a;n++)e[n].fn(r);else console.warn("[EventService]: Event mapping not defined for ".concat(r.type))}},t.prototype.dispatchEvent=function(r,e,n){if(!n)r.propagationStopped=!1,r.propagationImmediatelyStopped=!1,this.propagate(r,e);else{r.eventPhase=r.AT_TARGET;var a=this.rootTarget.defaultView||null;r.currentTarget=a,this.notifyListeners(r,e)}this.emitter.emit(e||r.type,r)},t.prototype.propagate=function(r,e){if(r.target){var n=r.composedPath();r.eventPhase=r.CAPTURING_PHASE;for(var a=n.length-1;a>=1;a--)if(r.currentTarget=n[a],this.notifyTarget(r,e),r.propagationStopped||r.propagationImmediatelyStopped)return;if(r.eventPhase=r.AT_TARGET,r.currentTarget=r.target,this.notifyTarget(r,e),!(r.propagationStopped||r.propagationImmediatelyStopped)){var o=n.indexOf(r.currentTarget);r.eventPhase=r.BUBBLING_PHASE;for(var a=o+1;a<n.length;a++)if(r.currentTarget=n[a],this.notifyTarget(r,e),r.propagationStopped||r.propagationImmediatelyStopped)return}}},t.prototype.propagationPath=function(r){var e=[r],n=this.rootTarget.defaultView||null;if(n&&n===r)return e.unshift(n.document),e;for(var a=0;a<PROPAGATION_LIMIT&&r!==this.rootTarget;a++)Node$2.isNode(r)&&r.parentNode&&(e.push(r.parentNode),r=r.parentNode);return n&&e.push(n),e},t.prototype.hitTest=function(r){var e=r.viewportX,n=r.viewportY,a=this.context.config,o=a.width,s=a.height,l=a.disableHitTesting;return e<0||n<0||e>o||n>s?null:!l&&this.pickHandler(r)||this.rootTarget||null},t.prototype.isNativeEventFromCanvas=function(r){var e,n=this.context.contextService.getDomElement(),a=(e=r.nativeEvent)===null||e===void 0?void 0:e.target;if(a){if(a===n)return!0;if(n&&n.contains)return n.contains(a)}return r.nativeEvent.composedPath?r.nativeEvent.composedPath().indexOf(n)>-1:!1},t.prototype.getExistedHTML=function(r){var e,n;if(r.nativeEvent.composedPath)try{for(var a=__values(r.nativeEvent.composedPath()),o=a.next();!o.done;o=a.next()){var s=o.value,l=this.nativeHTMLMap.get(s);if(l)return l}}catch(u){e={error:u}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return null},t.prototype.pickTarget=function(r){return this.hitTest({clientX:r.clientX,clientY:r.clientY,viewportX:r.viewportX,viewportY:r.viewportY,x:r.canvasX,y:r.canvasY})},t.prototype.createPointerEvent=function(r,e,n,a){var o=this.allocateEvent(FederatedPointerEvent);this.copyPointerData(r,o),this.copyMouseData(r,o),this.copyData(r,o),o.nativeEvent=r.nativeEvent,o.originalEvent=r;var s=this.getExistedHTML(o);return o.target=n??(s||this.isNativeEventFromCanvas(o)&&this.pickTarget(o)||a),typeof e=="string"&&(o.type=e),o},t.prototype.createWheelEvent=function(r){var e=this.allocateEvent(FederatedWheelEvent);this.copyWheelData(r,e),this.copyMouseData(r,e),this.copyData(r,e),e.nativeEvent=r.nativeEvent,e.originalEvent=r;var n=this.getExistedHTML(e);return e.target=n||this.isNativeEventFromCanvas(e)&&this.pickTarget(e),e},t.prototype.trackingData=function(r){return this.mappingState.trackingData[r]||(this.mappingState.trackingData[r]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[r]},t.prototype.cloneWheelEvent=function(r){var e=this.allocateEvent(FederatedWheelEvent);return e.nativeEvent=r.nativeEvent,e.originalEvent=r.originalEvent,this.copyWheelData(r,e),this.copyMouseData(r,e),this.copyData(r,e),e.target=r.target,e.path=r.composedPath().slice(),e.type=r.type,e},t.prototype.clonePointerEvent=function(r,e){var n=this.allocateEvent(FederatedPointerEvent);return n.nativeEvent=r.nativeEvent,n.originalEvent=r.originalEvent,this.copyPointerData(r,n),this.copyMouseData(r,n),this.copyData(r,n),n.target=r.target,n.path=r.composedPath().slice(),n.type=e??n.type,n},t.prototype.copyPointerData=function(r,e){e.pointerId=r.pointerId,e.width=r.width,e.height=r.height,e.isPrimary=r.isPrimary,e.pointerType=r.pointerType,e.pressure=r.pressure,e.tangentialPressure=r.tangentialPressure,e.tiltX=r.tiltX,e.tiltY=r.tiltY,e.twist=r.twist},t.prototype.copyMouseData=function(r,e){e.altKey=r.altKey,e.button=r.button,e.buttons=r.buttons,e.ctrlKey=r.ctrlKey,e.metaKey=r.metaKey,e.shiftKey=r.shiftKey,e.client.copyFrom(r.client),e.movement.copyFrom(r.movement),e.canvas.copyFrom(r.canvas),e.screen.copyFrom(r.screen),e.global.copyFrom(r.global),e.offset.copyFrom(r.offset)},t.prototype.copyWheelData=function(r,e){e.deltaMode=r.deltaMode,e.deltaX=r.deltaX,e.deltaY=r.deltaY,e.deltaZ=r.deltaZ},t.prototype.copyData=function(r,e){e.isTrusted=r.isTrusted,e.timeStamp=clock$1.now(),e.type=r.type,e.detail=r.detail,e.view=r.view,e.page.copyFrom(r.page),e.viewport.copyFrom(r.viewport)},t.prototype.allocateEvent=function(r){this.eventPool.has(r)||this.eventPool.set(r,[]);var e=this.eventPool.get(r).pop()||new r(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=[],e.target=null,e},t.prototype.freeEvent=function(r){if(r.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var e=r.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(r)},t.prototype.notifyTarget=function(r,e){e=e??r.type;var n=r.eventPhase===r.CAPTURING_PHASE||r.eventPhase===r.AT_TARGET?"".concat(e,"capture"):e;this.notifyListeners(r,n),r.eventPhase===r.AT_TARGET&&this.notifyListeners(r,e)},t.prototype.notifyListeners=function(r,e){var n=r.currentTarget.emitter,a=n._events[e];if(a)if("fn"in a)a.once&&n.removeListener(e,a.fn,void 0,!0),a.fn.call(r.currentTarget||a.context,r);else for(var o=0;o<a.length&&!r.propagationImmediatelyStopped;o++)a[o].once&&n.removeListener(e,a[o].fn,void 0,!0),a[o].fn.call(r.currentTarget||a[o].context,r)},t.prototype.findMountedTarget=function(r){if(!r)return null;for(var e=r[r.length-1],n=r.length-2;n>=0;n--){var a=r[n];if(a===this.rootTarget||Node$2.isNode(a)&&a.parentNode===e)e=r[n];else break}return e},t.prototype.getCursor=function(r){for(var e=r;e;){var n=isElement(e)&&e.getAttribute("cursor");if(n)return n;e=Node$2.isNode(e)&&e.parentNode}},t}(),OffscreenCanvasCreator=function(){function t(){}return t.prototype.getOrCreateCanvas=function(r,e){if(this.canvas)return this.canvas;if(r||runtime.offscreenCanvas)this.canvas=r||runtime.offscreenCanvas,this.context=this.canvas.getContext("2d",__assign({willReadFrequently:!0},e));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",__assign({willReadFrequently:!0},e)),(!this.context||!this.context.measureText)&&(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch{this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",__assign({willReadFrequently:!0},e))}return this.canvas.width=10,this.canvas.height=10,this.canvas},t.prototype.getOrCreateContext=function(r,e){return this.context?this.context:(this.getOrCreateCanvas(r,e),this.context)},t}(),RenderReason;(function(t){t[t.CAMERA_CHANGED=0]="CAMERA_CHANGED",t[t.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",t[t.NONE=2]="NONE"})(RenderReason||(RenderReason={}));var RenderingService=function(){function t(r,e){this.globalRuntime=r,this.context=e,this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new SyncHook,initAsync:new AsyncParallelHook,dirtycheck:new SyncWaterfallHook,cull:new SyncWaterfallHook,beginFrame:new SyncHook,beforeRender:new SyncHook,render:new SyncHook,afterRender:new SyncHook,endFrame:new SyncHook,destroy:new SyncHook,pick:new AsyncSeriesWaterfallHook,pickSync:new SyncWaterfallHook,pointerDown:new SyncHook,pointerUp:new SyncHook,pointerMove:new SyncHook,pointerOut:new SyncHook,pointerOver:new SyncHook,pointerWheel:new SyncHook,pointerCancel:new SyncHook,click:new SyncHook}}return t.prototype.init=function(r){var e=this,n=__assign(__assign({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(a){a.apply(n,e.globalRuntime)}),this.hooks.init.call(),this.hooks.initAsync.getCallbacksNum()===0?(this.inited=!0,r()):this.hooks.initAsync.promise().then(function(){e.inited=!0,r()})},t.prototype.getStats=function(){return this.stats},t.prototype.disableDirtyRectangleRendering=function(){var r=this.context.config.renderer,e=r.getConfig().enableDirtyRectangleRendering;return!e||this.context.renderingContext.renderReasons.has(RenderReason.CAMERA_CHANGED)},t.prototype.render=function(r,e){var n=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var a=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(a.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),a.renderReasons.size&&this.inited){a.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var o=a.renderReasons.size===1&&a.renderReasons.has(RenderReason.CAMERA_CHANGED),s=!r.disableRenderHooks||!(r.disableRenderHooks&&o);s&&this.renderDisplayObject(a.root,r,a),this.hooks.beginFrame.call(),s&&a.renderListCurrentFrame.forEach(function(l){n.hooks.beforeRender.call(l),n.hooks.render.call(l),n.hooks.afterRender.call(l)}),this.hooks.endFrame.call(),a.renderListCurrentFrame=[],a.renderReasons.clear(),e()}},t.prototype.renderDisplayObject=function(r,e,n){var a=this,o=e.renderer.getConfig(),s=o.enableDirtyCheck,l=o.enableCulling;this.globalRuntime.enableCSSParsing&&this.globalRuntime.styleValueRegistry.recalc(r);var u=r.renderable,c=s?u.dirty||n.dirtyRectangleRenderingDisabled?r:null:r;if(c){var d=l?this.hooks.cull.call(c,this.context.camera):c;d&&(this.stats.rendered++,n.renderListCurrentFrame.push(d))}r.renderable.dirty=!1,r.sortable.renderOrder=this.zIndexCounter++,this.stats.total++;var f=r.sortable;f.dirty&&(this.sort(r,f),f.dirty=!1,f.dirtyChildren=[],f.dirtyReason=void 0),(f.sorted||r.childNodes).forEach(function(h){a.renderDisplayObject(h,e,n)})},t.prototype.sort=function(r,e){e.sorted&&e.dirtyReason!==SortReason.Z_INDEX_CHANGED?e.dirtyChildren.forEach(function(n){var a=r.childNodes.indexOf(n);if(a===-1){var o=e.sorted.indexOf(n);o>=0&&e.sorted.splice(o,1)}else if(e.sorted.length===0)e.sorted.push(n);else{var s=sortedIndex(e.sorted,n);e.sorted.splice(s,0,n)}}):e.sorted=r.childNodes.slice().sort(sortByZIndex)},t.prototype.destroy=function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()},t.prototype.dirtify=function(){this.context.renderingContext.renderReasons.add(RenderReason.DISPLAY_OBJECT_CHANGED)},t}(),ATTRIBUTE_REGEXP=/\[\s*(.*)=(.*)\s*\]/,DefaultSceneGraphSelector=function(){function t(){}return t.prototype.selectOne=function(r,e){var n=this;if(r.startsWith("."))return e.find(function(l){return((l==null?void 0:l.classList)||[]).indexOf(n.getIdOrClassname(r))>-1});if(r.startsWith("#"))return e.find(function(l){return l.id===n.getIdOrClassname(r)});if(r.startsWith("[")){var a=this.getAttribute(r),o=a.name,s=a.value;return o?e.find(function(l){return e!==l&&(o==="name"?l.name===s:n.attributeToString(l,o)===s)}):null}else return e.find(function(l){return e!==l&&l.nodeName===r})},t.prototype.selectAll=function(r,e){var n=this;if(r.startsWith("."))return e.findAll(function(l){return e!==l&&((l==null?void 0:l.classList)||[]).indexOf(n.getIdOrClassname(r))>-1});if(r.startsWith("#"))return e.findAll(function(l){return e!==l&&l.id===n.getIdOrClassname(r)});if(r.startsWith("[")){var a=this.getAttribute(r),o=a.name,s=a.value;return o?e.findAll(function(l){return e!==l&&(o==="name"?l.name===s:n.attributeToString(l,o)===s)}):[]}else return e.findAll(function(l){return e!==l&&l.nodeName===r})},t.prototype.is=function(r,e){if(r.startsWith("."))return e.className===this.getIdOrClassname(r);if(r.startsWith("#"))return e.id===this.getIdOrClassname(r);if(r.startsWith("[")){var n=this.getAttribute(r),a=n.name,o=n.value;return a==="name"?e.name===o:this.attributeToString(e,a)===o}else return e.nodeName===r},t.prototype.getIdOrClassname=function(r){return r.substring(1)},t.prototype.getAttribute=function(r){var e=r.match(ATTRIBUTE_REGEXP),n="",a="";return e&&e.length>2&&(n=e[1].replace(/"/g,""),a=e[2].replace(/"/g,"")),{name:n,value:a}},t.prototype.attributeToString=function(r,e){if(!r.getAttribute)return"";var n=r.getAttribute(e);return isNil$1(n)?"":n.toString?n.toString():""},t}(),MutationEvent=function(t){__extends(r,t);function r(e,n,a,o,s,l,u,c){var d=t.call(this,null)||this;return d.relatedNode=n,d.prevValue=a,d.newValue=o,d.attrName=s,d.attrChange=l,d.prevParsedValue=u,d.newParsedValue=c,d.type=e,d}return r.ADDITION=2,r.MODIFICATION=1,r.REMOVAL=3,r}(FederatedEvent),ElementEvent;(function(t){t.REPARENT="reparent",t.DESTROY="destroy",t.ATTR_MODIFIED="DOMAttrModified",t.INSERTED="DOMNodeInserted",t.REMOVED="removed",t.MOUNTED="DOMNodeInsertedIntoDocument",t.UNMOUNTED="DOMNodeRemovedFromDocument",t.BOUNDS_CHANGED="bounds-changed",t.CULLED="culled"})(ElementEvent||(ElementEvent={}));function markRenderableDirty(t){var r=t.renderable;r&&(r.renderBoundsDirty=!0,r.boundsDirty=!0)}var reparentEvent=new MutationEvent(ElementEvent.REPARENT,null,"","","",0,"",""),DefaultSceneGraphService=function(){function t(r){var e=this;this.runtime=r,this.pendingEvents=[],this.boundsChangedEvent=new CustomEvent(ElementEvent.BOUNDS_CHANGED),this.rotate=function(){var n=create$1();return function(a,o,s,l){s===void 0&&(s=0),l===void 0&&(l=0),typeof o=="number"&&(o=fromValues$3(o,s,l));var u=a.transformable;if(a.parentNode===null||!a.parentNode.transformable)e.rotateLocal(a,o);else{var c=create$1();fromEuler(c,o[0],o[1],o[2]);var d=e.getRotation(a),f=e.getRotation(a.parentNode);copy$1(n,f),invert(n,n),multiply(c,n,c),multiply(u.localRotation,c,d),normalize$2(u.localRotation,u.localRotation),e.dirtifyLocal(a,u)}}}(),this.rotateLocal=function(){var n=create$1();return function(a,o,s,l){s===void 0&&(s=0),l===void 0&&(l=0),typeof o=="number"&&(o=fromValues$3(o,s,l));var u=a.transformable;fromEuler(n,o[0],o[1],o[2]),mul$1(u.localRotation,u.localRotation,n),e.dirtifyLocal(a,u)}}(),this.setEulerAngles=function(){var n=create$1();return function(a,o,s,l){s===void 0&&(s=0),l===void 0&&(l=0),typeof o=="number"&&(o=fromValues$3(o,s,l));var u=a.transformable;if(a.parentNode===null||!a.parentNode.transformable)e.setLocalEulerAngles(a,o);else{fromEuler(u.localRotation,o[0],o[1],o[2]);var c=e.getRotation(a.parentNode);copy$1(n,invert(create$1(),c)),mul$1(u.localRotation,u.localRotation,n),e.dirtifyLocal(a,u)}}}(),this.translateLocal=function(){return function(n,a,o,s){o===void 0&&(o=0),s===void 0&&(s=0),typeof a=="number"&&(a=fromValues$3(a,o,s));var l=n.transformable;equals(a,create$3())||(transformQuat(a,a,l.localRotation),add$1(l.localPosition,l.localPosition,a),e.dirtifyLocal(n,l))}}(),this.setPosition=function(){var n=create$4(),a=create$3();return function(o,s){var l=o.transformable;if(a[0]=s[0],a[1]=s[1],a[2]=s[2]||0,!equals(e.getPosition(o),a)){if(copy$3(l.position,a),o.parentNode===null||!o.parentNode.transformable)copy$3(l.localPosition,a);else{var u=o.parentNode.transformable;copy$4(n,u.worldTransform),invert$1(n,n),transformMat4$1(l.localPosition,a,n)}e.dirtifyLocal(o,l)}}}(),this.setLocalPosition=function(){var n=create$3();return function(a,o){var s=a.transformable;n[0]=o[0],n[1]=o[1],n[2]=o[2]||0,!equals(s.localPosition,n)&&(copy$3(s.localPosition,n),e.dirtifyLocal(a,s))}}(),this.translate=function(){var n=create$3(),a=create$3(),o=create$3();return function(s,l,u,c){u===void 0&&(u=0),c===void 0&&(c=0),typeof l=="number"&&(l=set$1(a,l,u,c)),!equals(l,n)&&(add$1(o,e.getPosition(s),l),e.setPosition(s,o))}}(),this.setRotation=function(){var n=create$1();return function(a,o,s,l,u){var c=a.transformable;if(typeof o=="number"&&(o=fromValues$1(o,s,l,u)),a.parentNode===null||!a.parentNode.transformable)e.setLocalRotation(a,o);else{var d=e.getRotation(a.parentNode);copy$1(n,d),invert(n,n),multiply(c.localRotation,n,o),normalize$2(c.localRotation,c.localRotation),e.dirtifyLocal(a,c)}}},this.displayObjectDependencyMap=new WeakMap,this.calcLocalTransform=function(){var n=create$4(),a=create$3(),o=fromValues$1(0,0,0,1);return function(s){var l=s.localSkew[0]!==0||s.localSkew[1]!==0;if(l){if(fromRotationTranslationScaleOrigin(s.localTransform,s.localRotation,s.localPosition,fromValues$3(1,1,1),s.origin),s.localSkew[0]!==0||s.localSkew[1]!==0){var u=identity$1(n);u[4]=Math.tan(s.localSkew[0]),u[1]=Math.tan(s.localSkew[1]),multiply$2(s.localTransform,s.localTransform,u)}var c=fromRotationTranslationScaleOrigin(n,o,a,s.localScale,s.origin);multiply$2(s.localTransform,s.localTransform,c)}else fromRotationTranslationScaleOrigin(s.localTransform,s.localRotation,s.localPosition,s.localScale,s.origin)}}()}return t.prototype.matches=function(r,e){return this.runtime.sceneGraphSelector.is(r,e)},t.prototype.querySelector=function(r,e){return this.runtime.sceneGraphSelector.selectOne(r,e)},t.prototype.querySelectorAll=function(r,e){return this.runtime.sceneGraphSelector.selectAll(r,e)},t.prototype.attach=function(r,e,n){var a,o,s=!1;r.parentNode&&(s=r.parentNode!==e,this.detach(r)),r.parentNode=e,isNil$1(n)?r.parentNode.childNodes.push(r):r.parentNode.childNodes.splice(n,0,r);var l=e.sortable;(!((a=l==null?void 0:l.sorted)===null||a===void 0)&&a.length||!((o=r.style)===null||o===void 0)&&o.zIndex)&&(l.dirtyChildren.indexOf(r)===-1&&l.dirtyChildren.push(r),l.dirty=!0,l.dirtyReason=SortReason.ADDED);var u=r.transformable;u&&this.dirtifyWorld(r,u),u.frozen&&this.unfreezeParentToRoot(r),s&&r.dispatchEvent(reparentEvent)},t.prototype.detach=function(r){var e,n;if(r.parentNode){var a=r.transformable,o=r.parentNode.sortable;(!((e=o==null?void 0:o.sorted)===null||e===void 0)&&e.length||!((n=r.style)===null||n===void 0)&&n.zIndex)&&(o.dirtyChildren.indexOf(r)===-1&&o.dirtyChildren.push(r),o.dirty=!0,o.dirtyReason=SortReason.REMOVED);var s=r.parentNode.childNodes.indexOf(r);s>-1&&r.parentNode.childNodes.splice(s,1),a&&this.dirtifyWorld(r,a),r.parentNode=null}},t.prototype.getOrigin=function(r){return r.transformable.origin},t.prototype.setOrigin=function(r,e,n,a){n===void 0&&(n=0),a===void 0&&(a=0),typeof e=="number"&&(e=[e,n,a]);var o=r.transformable;if(!(e[0]===o.origin[0]&&e[1]===o.origin[1]&&e[2]===o.origin[2])){var s=o.origin;s[0]=e[0],s[1]=e[1],s[2]=e[2]||0,this.dirtifyLocal(r,o)}},t.prototype.setLocalEulerAngles=function(r,e,n,a){n===void 0&&(n=0),a===void 0&&(a=0),typeof e=="number"&&(e=fromValues$3(e,n,a));var o=r.transformable;fromEuler(o.localRotation,e[0],e[1],e[2]),this.dirtifyLocal(r,o)},t.prototype.scaleLocal=function(r,e){var n=r.transformable;multiply$1(n.localScale,n.localScale,fromValues$3(e[0],e[1],e[2]||1)),this.dirtifyLocal(r,n)},t.prototype.setLocalScale=function(r,e){var n=r.transformable,a=fromValues$3(e[0],e[1],e[2]||n.localScale[2]);equals(a,n.localScale)||(copy$3(n.localScale,a),this.dirtifyLocal(r,n))},t.prototype.setLocalRotation=function(r,e,n,a,o){typeof e=="number"&&(e=fromValues$1(e,n,a,o));var s=r.transformable;copy$1(s.localRotation,e),this.dirtifyLocal(r,s)},t.prototype.setLocalSkew=function(r,e,n){typeof e=="number"&&(e=fromValues(e,n));var a=r.transformable;copy(a.localSkew,e),this.dirtifyLocal(r,a)},t.prototype.dirtifyLocal=function(r,e){e.localDirtyFlag||(e.localDirtyFlag=!0,e.dirtyFlag||this.dirtifyWorld(r,e))},t.prototype.dirtifyWorld=function(r,e){e.dirtyFlag||this.unfreezeParentToRoot(r),this.dirtifyWorldInternal(r,e),this.dirtifyToRoot(r,!0)},t.prototype.triggerPendingEvents=function(){var r=this,e=new Set,n=function(a,o){a.isConnected&&!e.has(a.entity)&&(r.boundsChangedEvent.detail=o,r.boundsChangedEvent.target=a,a.isMutationObserved?a.dispatchEvent(r.boundsChangedEvent):a.ownerDocument.defaultView.dispatchEvent(r.boundsChangedEvent,!0),e.add(a.entity))};this.pendingEvents.forEach(function(a){var o=__read(a,2),s=o[0],l=o[1];l.affectChildren?s.forEach(function(u){n(u,l)}):n(s,l)}),this.clearPendingEvents(),e.clear()},t.prototype.clearPendingEvents=function(){this.pendingEvents=[]},t.prototype.dirtifyToRoot=function(r,e){e===void 0&&(e=!1);var n=r;for(n.renderable&&(n.renderable.dirty=!0);n;)markRenderableDirty(n),n=n.parentNode;e&&r.forEach(function(a){markRenderableDirty(a)}),this.informDependentDisplayObjects(r),this.pendingEvents.push([r,{affectChildren:e}])},t.prototype.updateDisplayObjectDependency=function(r,e,n,a){if(e&&e!==n){var o=this.displayObjectDependencyMap.get(e);if(o&&o[r]){var s=o[r].indexOf(a);o[r].splice(s,1)}}if(n){var l=this.displayObjectDependencyMap.get(n);l||(this.displayObjectDependencyMap.set(n,{}),l=this.displayObjectDependencyMap.get(n)),l[r]||(l[r]=[]),l[r].push(a)}},t.prototype.informDependentDisplayObjects=function(r){var e=this,n=this.displayObjectDependencyMap.get(r);n&&Object.keys(n).forEach(function(a){n[a].forEach(function(o){e.dirtifyToRoot(o,!0),o.dispatchEvent(new MutationEvent(ElementEvent.ATTR_MODIFIED,o,e,e,a,MutationEvent.MODIFICATION,e,e)),o.isCustomElement&&o.isConnected&&o.attributeChangedCallback&&o.attributeChangedCallback(a,e,e)})})},t.prototype.getPosition=function(r){var e=r.transformable;return getTranslation(e.position,this.getWorldTransform(r,e))},t.prototype.getRotation=function(r){var e=r.transformable;return getRotation(e.rotation,this.getWorldTransform(r,e))},t.prototype.getScale=function(r){var e=r.transformable;return getScaling(e.scaling,this.getWorldTransform(r,e))},t.prototype.getWorldTransform=function(r,e){return e===void 0&&(e=r.transformable),!e.localDirtyFlag&&!e.dirtyFlag||(r.parentNode&&r.parentNode.transformable&&this.getWorldTransform(r.parentNode),this.sync(r,e)),e.worldTransform},t.prototype.getLocalPosition=function(r){return r.transformable.localPosition},t.prototype.getLocalRotation=function(r){return r.transformable.localRotation},t.prototype.getLocalScale=function(r){return r.transformable.localScale},t.prototype.getLocalSkew=function(r){return r.transformable.localSkew},t.prototype.getLocalTransform=function(r){var e=r.transformable;return e.localDirtyFlag&&(this.calcLocalTransform(e),e.localDirtyFlag=!1),e.localTransform},t.prototype.setLocalTransform=function(r,e){var n=getTranslation(create$3(),e),a=getRotation(create$1(),e),o=getScaling(create$3(),e);this.setLocalScale(r,o),this.setLocalPosition(r,n),this.setLocalRotation(r,a)},t.prototype.resetLocalTransform=function(r){this.setLocalScale(r,[1,1,1]),this.setLocalPosition(r,[0,0,0]),this.setLocalEulerAngles(r,[0,0,0]),this.setLocalSkew(r,[0,0])},t.prototype.getTransformedGeometryBounds=function(r,e,n){e===void 0&&(e=!1);var a=this.getGeometryBounds(r,e);if(AABB.isEmpty(a))return null;var o=n||new AABB;return o.setFromTransformedAABB(a,this.getWorldTransform(r)),o},t.prototype.getGeometryBounds=function(r,e){e===void 0&&(e=!1);var n=r.geometry,a=e?n.renderBounds:n.contentBounds||null;return a||new AABB},t.prototype.getBounds=function(r,e){var n=this;e===void 0&&(e=!1);var a=r.renderable;if(!a.boundsDirty&&!e&&a.bounds)return a.bounds;if(!a.renderBoundsDirty&&e&&a.renderBounds)return a.renderBounds;var o=e?a.renderBounds:a.bounds,s=this.getTransformedGeometryBounds(r,e,o),l=r.childNodes;if(l.forEach(function(d){var f=n.getBounds(d,e);f&&(s?s.add(f):(s=o||new AABB,s.update(f.center,f.halfExtents)))}),s||(s=new AABB),e){var u=findClosestClipPathTarget(r);if(u){var c=u.parsedStyle.clipPath.getBounds(e);s?c&&(s=c.intersection(s)):s.update(c.center,c.halfExtents)}}return e?(a.renderBounds=s,a.renderBoundsDirty=!1):(a.bounds=s,a.boundsDirty=!1),s},t.prototype.getLocalBounds=function(r){if(r.parentNode){var e=create$4();r.parentNode.transformable&&(e=invert$1(create$4(),this.getWorldTransform(r.parentNode)));var n=this.getBounds(r);if(!AABB.isEmpty(n)){var a=new AABB;return a.setFromTransformedAABB(n,e),a}}return this.getBounds(r)},t.prototype.getBoundingClientRect=function(r){var e,n,a,o=this.getGeometryBounds(r);AABB.isEmpty(o)||(a=new AABB,a.setFromTransformedAABB(o,this.getWorldTransform(r)));var s=(n=(e=r.ownerDocument)===null||e===void 0?void 0:e.defaultView)===null||n===void 0?void 0:n.getContextService().getBoundingClientRect();if(a){var l=__read(a.getMin(),2),u=l[0],c=l[1],d=__read(a.getMax(),2),f=d[0],h=d[1];return new Rectangle(u+((s==null?void 0:s.left)||0),c+((s==null?void 0:s.top)||0),f-u,h-c)}return new Rectangle((s==null?void 0:s.left)||0,(s==null?void 0:s.top)||0,0,0)},t.prototype.dirtifyWorldInternal=function(r,e){var n=this;if(!e.dirtyFlag){e.dirtyFlag=!0,e.frozen=!1,r.childNodes.forEach(function(o){var s=o.transformable;s.dirtyFlag||n.dirtifyWorldInternal(o,s)});var a=r.renderable;a&&(a.renderBoundsDirty=!0,a.boundsDirty=!0,a.dirty=!0)}},t.prototype.syncHierarchy=function(r){var e=r.transformable;if(!e.frozen){e.frozen=!0,(e.localDirtyFlag||e.dirtyFlag)&&this.sync(r,e);for(var n=r.childNodes,a=0;a<n.length;a++)this.syncHierarchy(n[a])}},t.prototype.sync=function(r,e){if(e.localDirtyFlag&&(this.calcLocalTransform(e),e.localDirtyFlag=!1),e.dirtyFlag){var n=r.parentNode,a=n&&n.transformable;n===null||!a?copy$4(e.worldTransform,e.localTransform):multiply$2(e.worldTransform,a.worldTransform,e.localTransform),e.dirtyFlag=!1}},t.prototype.unfreezeParentToRoot=function(r){for(var e=r.parentNode;e;){var n=e.transformable;n&&(n.frozen=!1),e=e.parentNode}},t}(),TEXT_METRICS={MetricsString:"|ÉqÅ",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},LATIN_REGEX=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,regexCannotStartZhCn=/[!%),.:;?\]}¢°·'""†‡›℃∶、。〃〆〕〗〞﹚﹜！＂％＇），．：；？！］｝～]/,regexCannotEndZhCn=/[$(£¥·'"〈《「『【〔〖〝﹙﹛＄（．［｛￡￥]/,regexCannotStartZhTw=/[!),.:;?\]}¢·–—'"•"、。〆〞〕〉》」︰︱︲︳﹐﹑﹒﹓﹔﹕﹖﹘﹚﹜！），．：；？︶︸︺︼︾﹀﹂﹗］｜｝､]/,regexCannotEndZhTw=/[([{£¥'"‵〈《「『〔〝︴﹙﹛（｛︵︷︹︻︽︿﹁﹃﹏]/,regexCannotStartJaJp=/[)\]｝〕〉》」』】〙〗〟'"｠»ヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻‐゠–〜?!‼⁇⁈⁉・、:;,。.]/,regexCannotEndJaJp=/[([｛〔〈《「『【〘〖〝'"｟«—...‥〳〴〵]/,regexCannotStartKoKr=/[!%),.:;?\]}¢°'"†‡℃〆〈《「『〕！％），．：；？］｝]/,regexCannotEndKoKr=/[$([{£¥'"々〇〉》」〔＄（［｛｠￥￦#]/,regexCannotStart=new RegExp("".concat(regexCannotStartZhCn.source,"|").concat(regexCannotStartZhTw.source,"|").concat(regexCannotStartJaJp.source,"|").concat(regexCannotStartKoKr.source)),regexCannotEnd=new RegExp("".concat(regexCannotEndZhCn.source,"|").concat(regexCannotEndZhTw.source,"|").concat(regexCannotEndJaJp.source,"|").concat(regexCannotEndKoKr.source)),TextService=function(){function t(r){var e=this;this.runtime=r,this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(n,a){return e.isBreakingSpace(a)?!1:!!(n&&(regexCannotEnd.exec(a)||regexCannotStart.exec(n)))},this.trimByKinsokuShorui=function(n){var a=__spreadArray([],__read(n),!1),o=a[a.length-2];if(!o)return n;var s=o[o.length-1];return a[a.length-2]=o.slice(0,-1),a[a.length-1]=s+a[a.length-1],a}}return t.prototype.measureFont=function(r,e){if(this.fontMetricsCache[r])return this.fontMetricsCache[r];var n={ascent:0,descent:0,fontSize:0},a=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(e),o=this.runtime.offscreenCanvasCreator.getOrCreateContext(e,{willReadFrequently:!0});o.font=r;var s=TEXT_METRICS.MetricsString+TEXT_METRICS.BaselineSymbol,l=Math.ceil(o.measureText(s).width),u=Math.ceil(o.measureText(TEXT_METRICS.BaselineSymbol).width),c=TEXT_METRICS.HeightMultiplier*u;u=u*TEXT_METRICS.BaselineMultiplier|0,a.width=l,a.height=c,o.fillStyle="#f00",o.fillRect(0,0,l,c),o.font=r,o.textBaseline="alphabetic",o.fillStyle="#000",o.fillText(s,0,u);var d=o.getImageData(0,0,l||1,c||1).data,f=d.length,h=l*4,p=0,v=0,g=!1;for(p=0;p<u;++p){for(var y=0;y<h;y+=4)if(d[v+y]!==255){g=!0;break}if(!g)v+=h;else break}for(n.ascent=u-p,v=f-h,g=!1,p=c;p>u;--p){for(var y=0;y<h;y+=4)if(d[v+y]!==255){g=!0;break}if(!g)v-=h;else break}return n.descent=p-u,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[r]=n,n},t.prototype.measureText=function(r,e,n){var a=e.fontSize,o=e.wordWrap,s=e.lineHeight,l=e.lineWidth,u=e.textBaseline,c=e.textAlign,d=e.letterSpacing,f=e.textPath;e.textPathSide,e.textPathStartOffset;var h=e.leading,p=h===void 0?0:h,v=toFontString(e),g=this.measureFont(v,n);g.fontSize===0&&(g.fontSize=a,g.ascent=a);var y=this.runtime.offscreenCanvasCreator.getOrCreateContext(n);y.font=v,e.isOverflowing=!1;var m=o?this.wordWrap(r,e,n):r,S=m.split(/(?:\r\n|\r|\n)/),w=new Array(S.length),R=0;if(f){f.getTotalLength();for(var T=0;T<S.length;T++)var x=y.measureText(S[T]).width+(S[T].length-1)*d}else{for(var T=0;T<S.length;T++){var b=y.measureText(S[T]).width+(S[T].length-1)*d;w[T]=b,R=Math.max(R,b)}var x=R+l,L=s||g.fontSize+l,M=Math.max(L,g.fontSize+l)+(S.length-1)*(L+p);L+=p;var D=0;return u==="middle"?D=-M/2:u==="bottom"||u==="alphabetic"||u==="ideographic"?D=-M:(u==="top"||u==="hanging")&&(D=0),{font:v,width:x,height:M,lines:S,lineWidths:w,lineHeight:L,maxLineWidth:R,fontProperties:g,lineMetrics:w.map(function(F,k){var H=0;return c==="center"||c==="middle"?H-=F/2:(c==="right"||c==="end")&&(H-=F),new Rectangle(H-l/2,D+k*L,F+l,L)})}}},t.prototype.setGraphemeOnPath=function(){},t.prototype.wordWrap=function(r,e,n){var a=this,o=e.wordWrapWidth,s=o===void 0?0:o,l=e.letterSpacing,u=e.maxLines,c=u===void 0?1/0:u,d=e.textOverflow,f=this.runtime.offscreenCanvasCreator.getOrCreateContext(n),h=s+l,p="";d==="ellipsis"?p="...":d&&d!=="clip"&&(p=d);for(var v=[],g=0,y=0,m={},S=function(G){return a.getFromCache(G,l,m,f)},w=Array.from(p).reduce(function(G,z){return G+S(z)},0),R=Array.from(r),T=0;T<R.length;T++){var x=R[T],b=r[T-1],L=r[T+1],M=S(x);if(this.isNewline(x)){if(g++,g>=c){e.isOverflowing=!0;break}y=0,v[g]="";continue}if(y>0&&y+M>h){if(g+1>=c){if(e.isOverflowing=!0,w>0&&w<=h){for(var D=v[g].length,N=0,F=D,k=0;k<D;k++){var H=S(v[g][k]);if(N+H+w>h){F=k;break}N+=H}v[g]=(v[g]||"").slice(0,F)+p}break}if(g++,y=0,v[g]="",this.isBreakingSpace(x))continue;this.canBreakInLastChar(x)||(v=this.trimToBreakable(v),y=this.sumTextWidthByCache(v[g]||"",m)),this.shouldBreakByKinsokuShorui(x,L)&&(v=this.trimByKinsokuShorui(v),y+=S(b||""))}y+=M,v[g]=(v[g]||"")+x}return v.join(`
`)},t.prototype.isBreakingSpace=function(r){return typeof r!="string"?!1:TEXT_METRICS.BreakingSpaces.indexOf(r.charCodeAt(0))>=0},t.prototype.isNewline=function(r){return typeof r!="string"?!1:TEXT_METRICS.Newlines.indexOf(r.charCodeAt(0))>=0},t.prototype.trimToBreakable=function(r){var e=__spreadArray([],__read(r),!1),n=e[e.length-2],a=this.findBreakableIndex(n);if(a===-1||!n)return e;var o=n.slice(a,a+1),s=this.isBreakingSpace(o),l=a+1,u=a+(s?0:1);return e[e.length-1]+=n.slice(l,n.length),e[e.length-2]=n.slice(0,u),e},t.prototype.canBreakInLastChar=function(r){return!(r&&LATIN_REGEX.test(r))},t.prototype.sumTextWidthByCache=function(r,e){return r.split("").reduce(function(n,a){if(!e[a])throw Error("cannot count the word without cache");return n+e[a]},0)},t.prototype.findBreakableIndex=function(r){for(var e=r.length-1;e>=0;e--)if(!LATIN_REGEX.test(r[e]))return e;return-1},t.prototype.getFromCache=function(r,e,n,a){var o=n[r];if(typeof o!="number"){var s=r.length*e;o=a.measureText(r).width+s,n[r]=o}return o},t}(),runtime={},geometryUpdaterFactory=function(){var t,r=new RectUpdater,e=new PolylineUpdater;return t={},t[Shape.CIRCLE]=new CircleUpdater,t[Shape.ELLIPSE]=new EllipseUpdater,t[Shape.RECT]=r,t[Shape.IMAGE]=r,t[Shape.GROUP]=r,t[Shape.LINE]=new LineUpdater,t[Shape.TEXT]=new TextUpdater(runtime),t[Shape.POLYLINE]=e,t[Shape.POLYGON]=e,t[Shape.PATH]=new PathUpdater,t[Shape.HTML]=null,t[Shape.MESH]=null,t}(),CSSPropertySyntaxFactory=function(){var t,r=new CSSPropertyColor,e=new CSSPropertyLengthOrPercentage;return t={},t[PropertySyntax.PERCENTAGE]=null,t[PropertySyntax.NUMBER]=new CSSPropertyNumber,t[PropertySyntax.ANGLE]=new CSSPropertyAngle,t[PropertySyntax.DEFINED_PATH]=new CSSPropertyClipPath,t[PropertySyntax.PAINT]=r,t[PropertySyntax.COLOR]=r,t[PropertySyntax.FILTER]=new CSSPropertyFilter,t[PropertySyntax.LENGTH]=e,t[PropertySyntax.LENGTH_PERCENTAGE]=e,t[PropertySyntax.LENGTH_PERCENTAGE_12]=new CSSPropertyLengthOrPercentage12,t[PropertySyntax.LENGTH_PERCENTAGE_14]=new CSSPropertyLengthOrPercentage14,t[PropertySyntax.COORDINATE]=new CSSPropertyLocalPosition,t[PropertySyntax.OFFSET_DISTANCE]=new CSSPropertyOffsetDistance,t[PropertySyntax.OPACITY_VALUE]=new CSSPropertyOpacity,t[PropertySyntax.PATH]=new CSSPropertyPath,t[PropertySyntax.LIST_OF_POINTS]=new CSSPropertyPoints,t[PropertySyntax.SHADOW_BLUR]=new CSSPropertyShadowBlur,t[PropertySyntax.TEXT]=new CSSPropertyText,t[PropertySyntax.TEXT_TRANSFORM]=new CSSPropertyTextTransform,t[PropertySyntax.TRANSFORM]=new CSSPropertyTransform,t[PropertySyntax.TRANSFORM_ORIGIN]=new CSSPropertyTransformOrigin,t[PropertySyntax.Z_INDEX]=new CSSPropertyZIndex,t[PropertySyntax.MARKER]=new CSSPropertyMarker,t}(),getGlobalThis=function(){return typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}};runtime.CameraContribution=Camera;runtime.AnimationTimeline=null;runtime.EasingFunction=null;runtime.offscreenCanvasCreator=new OffscreenCanvasCreator;runtime.sceneGraphSelector=new DefaultSceneGraphSelector;runtime.sceneGraphService=new DefaultSceneGraphService(runtime);runtime.textService=new TextService(runtime);runtime.geometryUpdaterFactory=geometryUpdaterFactory;runtime.CSSPropertySyntaxFactory=CSSPropertySyntaxFactory;runtime.styleValueRegistry=new DefaultStyleValueRegistry(runtime);runtime.layoutRegistry=null;runtime.globalThis=getGlobalThis();runtime.enableCSSParsing=!0;runtime.enableDataset=!1;runtime.enableStyleSyntax=!0;runtime.enableSizeAttenuation=!1;var entityCounter=0,insertedEvent=new MutationEvent(ElementEvent.INSERTED,null,"","","",0,"",""),removedEvent=new MutationEvent(ElementEvent.REMOVED,null,"","","",0,"",""),destroyEvent=new CustomEvent(ElementEvent.DESTROY),Element$1=function(t){__extends(r,t);function r(){var e=t.apply(this,__spreadArray([],__read(arguments),!1))||this;return e.entity=entityCounter++,e.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},e.cullable={strategy:Strategy.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},e.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},e.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},e.geometry={contentBounds:void 0,renderBounds:void 0},e.rBushNode={aabb:void 0},e.namespaceURI="g",e.scrollLeft=0,e.scrollTop=0,e.clientTop=0,e.clientLeft=0,e.destroyed=!1,e.style={},e.computedStyle=runtime.enableCSSParsing?{anchor:unsetKeywordValue,opacity:unsetKeywordValue,fillOpacity:unsetKeywordValue,strokeOpacity:unsetKeywordValue,fill:unsetKeywordValue,stroke:unsetKeywordValue,transform:unsetKeywordValue,transformOrigin:unsetKeywordValue,visibility:unsetKeywordValue,pointerEvents:unsetKeywordValue,lineWidth:unsetKeywordValue,lineCap:unsetKeywordValue,lineJoin:unsetKeywordValue,increasedLineWidthForHitTesting:unsetKeywordValue,fontSize:unsetKeywordValue,fontFamily:unsetKeywordValue,fontStyle:unsetKeywordValue,fontWeight:unsetKeywordValue,fontVariant:unsetKeywordValue,textAlign:unsetKeywordValue,textBaseline:unsetKeywordValue,textTransform:unsetKeywordValue,zIndex:unsetKeywordValue,filter:unsetKeywordValue,shadowType:unsetKeywordValue}:null,e.parsedStyle={},e.attributes={},e}return Object.defineProperty(r.prototype,"className",{get:function(){return this.getAttribute("class")||""},set:function(e){this.setAttribute("class",e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"classList",{get:function(){return this.className.split(" ").filter(function(e){return e!==""})},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"tagName",{get:function(){return this.nodeName},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"parentElement",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"nextSibling",{get:function(){if(this.parentNode){var e=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[e+1]||null}return null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"previousSibling",{get:function(){if(this.parentNode){var e=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[e-1]||null}return null},enumerable:!1,configurable:!0}),r.prototype.cloneNode=function(e){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},r.prototype.appendChild=function(e,n){var a;if(e.destroyed)throw new Error(ERROR_MSG_APPEND_DESTROYED_ELEMENT);return runtime.sceneGraphService.attach(e,this,n),!((a=this.ownerDocument)===null||a===void 0)&&a.defaultView&&this.ownerDocument.defaultView.mountChildren(e),insertedEvent.relatedNode=this,e.dispatchEvent(insertedEvent),e},r.prototype.insertBefore=function(e,n){if(!n)this.appendChild(e);else{e.parentElement&&e.parentElement.removeChild(e);var a=this.childNodes.indexOf(n);a===-1?this.appendChild(e):this.appendChild(e,a)}return e},r.prototype.replaceChild=function(e,n){var a=this.childNodes.indexOf(n);return this.removeChild(n),this.appendChild(e,a),n},r.prototype.removeChild=function(e){var n;return removedEvent.relatedNode=this,e.dispatchEvent(removedEvent),!((n=e.ownerDocument)===null||n===void 0)&&n.defaultView&&e.ownerDocument.defaultView.unmountChildren(e),runtime.sceneGraphService.detach(e),e},r.prototype.removeChildren=function(){for(var e=this.childNodes.length-1;e>=0;e--){var n=this.childNodes[e];this.removeChild(n)}},r.prototype.destroyChildren=function(){for(var e=this.childNodes.length-1;e>=0;e--){var n=this.childNodes[e];n.childNodes.length&&n.destroyChildren(),n.destroy()}},r.prototype.matches=function(e){return runtime.sceneGraphService.matches(e,this)},r.prototype.getElementById=function(e){return runtime.sceneGraphService.querySelector("#".concat(e),this)},r.prototype.getElementsByName=function(e){return runtime.sceneGraphService.querySelectorAll('[name="'.concat(e,'"]'),this)},r.prototype.getElementsByClassName=function(e){return runtime.sceneGraphService.querySelectorAll(".".concat(e),this)},r.prototype.getElementsByTagName=function(e){return runtime.sceneGraphService.querySelectorAll(e,this)},r.prototype.querySelector=function(e){return runtime.sceneGraphService.querySelector(e,this)},r.prototype.querySelectorAll=function(e){return runtime.sceneGraphService.querySelectorAll(e,this)},r.prototype.closest=function(e){var n=this;do{if(runtime.sceneGraphService.matches(e,n))return n;n=n.parentElement}while(n!==null);return null},r.prototype.find=function(e){var n=this,a=null;return this.forEach(function(o){return o!==n&&e(o)?(a=o,!0):!1}),a},r.prototype.findAll=function(e){var n=this,a=[];return this.forEach(function(o){o!==n&&e(o)&&a.push(o)}),a},r.prototype.after=function(){for(var e=this,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];if(this.parentNode){var o=this.parentNode.childNodes.indexOf(this);n.forEach(function(s,l){var u;return(u=e.parentNode)===null||u===void 0?void 0:u.appendChild(s,o+l+1)})}},r.prototype.before=function(){for(var e,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];if(this.parentNode){var o=this.parentNode.childNodes.indexOf(this),s=__read(n),l=s[0],u=s.slice(1);this.parentNode.appendChild(l,o),(e=l).after.apply(e,__spreadArray([],__read(u),!1))}},r.prototype.replaceWith=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.after.apply(this,__spreadArray([],__read(e),!1)),this.remove()},r.prototype.append=function(){for(var e=this,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];n.forEach(function(o){return e.appendChild(o)})},r.prototype.prepend=function(){for(var e=this,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];n.forEach(function(o,s){return e.appendChild(o,s)})},r.prototype.replaceChildren=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,__spreadArray([],__read(e),!1))},r.prototype.remove=function(){return this.parentNode?this.parentNode.removeChild(this):this},r.prototype.destroy=function(){this.dispatchEvent(destroyEvent),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0},r.prototype.getGeometryBounds=function(){return runtime.sceneGraphService.getGeometryBounds(this)},r.prototype.getRenderBounds=function(){return runtime.sceneGraphService.getBounds(this,!0)},r.prototype.getBounds=function(){return runtime.sceneGraphService.getBounds(this)},r.prototype.getLocalBounds=function(){return runtime.sceneGraphService.getLocalBounds(this)},r.prototype.getBoundingClientRect=function(){return runtime.sceneGraphService.getBoundingClientRect(this)},r.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},r.prototype.computedStyleMap=function(){return new Map(Object.entries(this.computedStyle))},r.prototype.getAttributeNames=function(){return Object.keys(this.attributes)},r.prototype.getAttribute=function(e){if(isSymbol$1(e))return runtime.enableCSSParsing?null:void 0;var n=this.attributes[e];if(n===void 0){var a=formatAttributeName(e);return n=this.attributes[a],runtime.enableCSSParsing&&isNil$1(n)?null:n}else return n},r.prototype.hasAttribute=function(e){return this.getAttributeNames().includes(e)},r.prototype.hasAttributes=function(){return!!this.getAttributeNames().length},r.prototype.removeAttribute=function(e){this.setAttribute(e,null),delete this.attributes[e]},r.prototype.setAttribute=function(e,n,a){this.attributes[e]=n},r.prototype.getAttributeNS=function(e,n){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},r.prototype.getAttributeNode=function(e){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},r.prototype.getAttributeNodeNS=function(e,n){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},r.prototype.hasAttributeNS=function(e,n){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},r.prototype.removeAttributeNS=function(e,n){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},r.prototype.removeAttributeNode=function(e){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},r.prototype.setAttributeNS=function(e,n,a){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},r.prototype.setAttributeNode=function(e){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},r.prototype.setAttributeNodeNS=function(e){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},r.prototype.toggleAttribute=function(e,n){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},r}(Node$2);function isDisplayObject(t){return!!(t!=null&&t.nodeName)}var mutationEvent=new MutationEvent(ElementEvent.ATTR_MODIFIED,null,null,null,null,MutationEvent.MODIFICATION,null,null),DEFAULT_STYLE_PROPS={anchor:"",opacity:"",fillOpacity:"",strokeOpacity:"",fill:"",stroke:"",transform:"",transformOrigin:"",visibility:"",pointerEvents:"",lineWidth:"",lineCap:"",lineJoin:"",increasedLineWidthForHitTesting:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",zIndex:"",filter:"",shadowType:""},DEFAULT_PARSED_STYLE_PROPS={anchor:[0,0],fill:noneColor,stroke:noneColor,transform:[],zIndex:0,filter:[],shadowType:"outer",miterLimit:10},DEFAULT_PARSED_STYLE_PROPS_CSS_DISABLED=__assign(__assign({},DEFAULT_PARSED_STYLE_PROPS),{opacity:1,fillOpacity:1,strokeOpacity:1,visibility:"visible",pointerEvents:"auto",lineWidth:1,lineCap:"butt",lineJoin:"miter",increasedLineWidthForHitTesting:0,fillRule:"nonzero"}),INHERITABLE_BASE_STYLE_PROPS=["opacity","fillOpacity","strokeOpacity","transformOrigin","visibility","pointerEvents","lineWidth","lineCap","lineJoin","increasedLineWidthForHitTesting"],INHERITABLE_STYLE_PROPS=__spreadArray(__spreadArray([],__read(INHERITABLE_BASE_STYLE_PROPS),!1),["fontSize","fontFamily","fontStyle","fontWeight","fontVariant","textAlign","textBaseline","textTransform"],!1),DATASET_PREFIX="data-",DisplayObject=function(t){__extends(r,t);function r(e){var n,a=t.call(this)||this;a.isCustomElement=!1,a.isMutationObserved=!1,a.activeAnimations=[],a.getClip=function(){return this.style.clipPath||null},a.config=e,a.config.interactive=(n=a.config.capture)!==null&&n!==void 0?n:a.config.interactive,a.id=a.config.id||"",a.name=a.config.name||"",(a.config.className||a.config.class)&&(a.className=a.config.className||a.config.class),a.nodeName=a.config.type||Shape.GROUP,a.config.style=a.config.style||a.config.attrs||{},Object.assign(a.config.style,a.config.attrs),a.config.visible!=null&&(a.config.style.visibility=a.config.visible===!1?"hidden":"visible"),a.config.interactive!=null&&(a.config.style.pointerEvents=a.config.interactive===!1?"none":"auto"),Object.assign(a.parsedStyle,runtime.enableCSSParsing?DEFAULT_PARSED_STYLE_PROPS:DEFAULT_PARSED_STYLE_PROPS_CSS_DISABLED,a.config.initialParsedStyle),runtime.enableCSSParsing&&Object.assign(a.attributes,DEFAULT_STYLE_PROPS),a.initAttributes(a.config.style);var o=runtime.globalThis.Proxy?runtime.globalThis.Proxy:function(){};return runtime.enableDataset&&(a.dataset=new o({},{get:function(s,l){var u="".concat(DATASET_PREFIX).concat(kebabize(l));return s[u]!==void 0?s[u]:a.getAttribute(u)},set:function(s,l,u){return a.setAttribute("".concat(DATASET_PREFIX).concat(kebabize(l)),u),!0}})),runtime.enableStyleSyntax&&(a.style=new o({setProperty:function(s,l){a.setAttribute(s,l)},getPropertyValue:function(s){return a.getAttribute(s)},removeProperty:function(s){a.removeAttribute(s)},item:function(){return""}},{get:function(s,l){return s[l]!==void 0?s[l]:a.getAttribute(l)},set:function(s,l,u){return a.setAttribute(l,u),!0}})),a}return r.prototype.destroy=function(){t.prototype.destroy.call(this),this.getAnimations().forEach(function(e){e.cancel()})},r.prototype.cloneNode=function(e,n){var a=__assign({},this.attributes);for(var o in a){var s=a[o];isDisplayObject(s)&&o!=="clipPath"&&o!=="offsetPath"&&o!=="textPath"&&(a[o]=s.cloneNode(e)),n&&(a[o]=n(o,s))}var l=new this.constructor({id:this.id,name:this.name,className:this.name,interactive:this.interactive,style:a});return l.setLocalTransform(this.getLocalTransform()),e&&this.children.forEach(function(u){if(!u.style.isMarker){var c=u.cloneNode(e);l.appendChild(c)}}),l},r.prototype.initAttributes=function(e){e===void 0&&(e={});var n=this.renderable,a={forceUpdateGeometry:!0};runtime.enableCSSParsing&&(a.usedAttributes=INHERITABLE_STYLE_PROPS);var o={};for(var s in e){var l=formatAttributeName(s);o[l]=e[s]}runtime.styleValueRegistry.processProperties(this,o,a),n.dirty=!0},r.prototype.setAttribute=function(e,n,a,o){a===void 0&&(a=!1),o===void 0&&(o=!0);var s=formatAttributeName(e);isUndefined$1(n)||(a||n!==this.attributes[s])&&(this.internalSetAttribute(s,n,{memoize:o}),t.prototype.setAttribute.call(this,s,n))},r.prototype.internalSetAttribute=function(e,n,a){var o;a===void 0&&(a={});var s=this.renderable,l=this.attributes[e],u=this.parsedStyle[e];runtime.styleValueRegistry.processProperties(this,(o={},o[e]=n,o),a),s.dirty=!0;var c=this.parsedStyle[e];this.isConnected&&(mutationEvent.relatedNode=this,mutationEvent.prevValue=l,mutationEvent.newValue=n,mutationEvent.attrName=e,mutationEvent.prevParsedValue=u,mutationEvent.newParsedValue=c,this.isMutationObserved?this.dispatchEvent(mutationEvent):(mutationEvent.target=this,this.ownerDocument.defaultView.dispatchEvent(mutationEvent,!0))),(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&this.attributeChangedCallback&&this.attributeChangedCallback(e,l,n,u,c)},r.prototype.getBBox=function(){var e=this.getBounds(),n=__read(e.getMin(),2),a=n[0],o=n[1],s=__read(e.getMax(),2),l=s[0],u=s[1];return new Rectangle(a,o,l-a,u-o)},r.prototype.setOrigin=function(e,n,a){return n===void 0&&(n=0),a===void 0&&(a=0),runtime.sceneGraphService.setOrigin(this,createVec3(e,n,a)),this},r.prototype.getOrigin=function(){return runtime.sceneGraphService.getOrigin(this)},r.prototype.setPosition=function(e,n,a){return n===void 0&&(n=0),a===void 0&&(a=0),runtime.sceneGraphService.setPosition(this,createVec3(e,n,a)),this},r.prototype.setLocalPosition=function(e,n,a){return n===void 0&&(n=0),a===void 0&&(a=0),runtime.sceneGraphService.setLocalPosition(this,createVec3(e,n,a)),this},r.prototype.translate=function(e,n,a){return n===void 0&&(n=0),a===void 0&&(a=0),runtime.sceneGraphService.translate(this,createVec3(e,n,a)),this},r.prototype.translateLocal=function(e,n,a){return n===void 0&&(n=0),a===void 0&&(a=0),runtime.sceneGraphService.translateLocal(this,createVec3(e,n,a)),this},r.prototype.getPosition=function(){return runtime.sceneGraphService.getPosition(this)},r.prototype.getLocalPosition=function(){return runtime.sceneGraphService.getLocalPosition(this)},r.prototype.scale=function(e,n,a){return this.scaleLocal(e,n,a)},r.prototype.scaleLocal=function(e,n,a){return typeof e=="number"&&(n=n||e,a=a||e,e=createVec3(e,n,a)),runtime.sceneGraphService.scaleLocal(this,e),this},r.prototype.setLocalScale=function(e,n,a){return typeof e=="number"&&(n=n||e,a=a||e,e=createVec3(e,n,a)),runtime.sceneGraphService.setLocalScale(this,e),this},r.prototype.getLocalScale=function(){return runtime.sceneGraphService.getLocalScale(this)},r.prototype.getScale=function(){return runtime.sceneGraphService.getScale(this)},r.prototype.getEulerAngles=function(){var e=__read(getEuler(create$3(),runtime.sceneGraphService.getWorldTransform(this)),3),n=e[2];return rad2deg(n)},r.prototype.getLocalEulerAngles=function(){var e=__read(getEuler(create$3(),runtime.sceneGraphService.getLocalRotation(this)),3),n=e[2];return rad2deg(n)},r.prototype.setEulerAngles=function(e){return runtime.sceneGraphService.setEulerAngles(this,0,0,e),this},r.prototype.setLocalEulerAngles=function(e){return runtime.sceneGraphService.setLocalEulerAngles(this,0,0,e),this},r.prototype.rotateLocal=function(e,n,a){return isNil$1(n)&&isNil$1(a)?runtime.sceneGraphService.rotateLocal(this,0,0,e):runtime.sceneGraphService.rotateLocal(this,e,n,a),this},r.prototype.rotate=function(e,n,a){return isNil$1(n)&&isNil$1(a)?runtime.sceneGraphService.rotate(this,0,0,e):runtime.sceneGraphService.rotate(this,e,n,a),this},r.prototype.setRotation=function(e,n,a,o){return runtime.sceneGraphService.setRotation(this,e,n,a,o),this},r.prototype.setLocalRotation=function(e,n,a,o){return runtime.sceneGraphService.setLocalRotation(this,e,n,a,o),this},r.prototype.setLocalSkew=function(e,n){return runtime.sceneGraphService.setLocalSkew(this,e,n),this},r.prototype.getRotation=function(){return runtime.sceneGraphService.getRotation(this)},r.prototype.getLocalRotation=function(){return runtime.sceneGraphService.getLocalRotation(this)},r.prototype.getLocalSkew=function(){return runtime.sceneGraphService.getLocalSkew(this)},r.prototype.getLocalTransform=function(){return runtime.sceneGraphService.getLocalTransform(this)},r.prototype.getWorldTransform=function(){return runtime.sceneGraphService.getWorldTransform(this)},r.prototype.setLocalTransform=function(e){return runtime.sceneGraphService.setLocalTransform(this,e),this},r.prototype.resetLocalTransform=function(){runtime.sceneGraphService.resetLocalTransform(this)},r.prototype.getAnimations=function(){return this.activeAnimations},r.prototype.animate=function(e,n){var a,o=(a=this.ownerDocument)===null||a===void 0?void 0:a.timeline;return o?o.play(this,e,n):null},r.prototype.isVisible=function(){var e;return((e=this.parsedStyle)===null||e===void 0?void 0:e.visibility)==="visible"},Object.defineProperty(r.prototype,"interactive",{get:function(){return this.isInteractive()},set:function(e){this.style.pointerEvents=e?"auto":"none"},enumerable:!1,configurable:!0}),r.prototype.isInteractive=function(){var e;return((e=this.parsedStyle)===null||e===void 0?void 0:e.pointerEvents)!=="none"},r.prototype.isCulled=function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible)},r.prototype.toFront=function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,__spreadArray([],__read(this.parentNode.children.map(function(e){return Number(e.style.zIndex)})),!1))+1),this},r.prototype.toBack=function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,__spreadArray([],__read(this.parentNode.children.map(function(e){return Number(e.style.zIndex)})),!1))-1),this},r.prototype.getConfig=function(){return this.config},r.prototype.attr=function(){for(var e=this,n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];var o=__read(n,2),s=o[0],l=o[1];return s?isObject$1(s)?(Object.keys(s).forEach(function(u){e.setAttribute(u,s[u])}),this):n.length===2?(this.setAttribute(s,l),this):this.attributes[s]:this.attributes},r.prototype.getMatrix=function(e){var n=e||this.getWorldTransform(),a=__read(getTranslation(create$3(),n),2),o=a[0],s=a[1],l=__read(getScaling(create$3(),n),2),u=l[0],c=l[1],d=getRotation(create$1(),n),f=__read(getEuler(create$3(),d),3),h=f[0],p=f[2];return fromRotationTranslationScale(h||p,o,s,u,c)},r.prototype.getLocalMatrix=function(){return this.getMatrix(this.getLocalTransform())},r.prototype.setMatrix=function(e){var n=__read(decompose(e),5),a=n[0],o=n[1],s=n[2],l=n[3],u=n[4];this.setEulerAngles(u).setPosition(a,o).setLocalScale(s,l)},r.prototype.setLocalMatrix=function(e){var n=__read(decompose(e),5),a=n[0],o=n[1],s=n[2],l=n[3],u=n[4];this.setLocalEulerAngles(u).setLocalPosition(a,o).setLocalScale(s,l)},r.prototype.show=function(){runtime.enableCSSParsing?this.style.visibility="visible":this.forEach(function(e){e.style.visibility="visible"})},r.prototype.hide=function(){runtime.enableCSSParsing?this.style.visibility="hidden":this.forEach(function(e){e.style.visibility="hidden"})},r.prototype.getCount=function(){return this.childElementCount},r.prototype.getParent=function(){return this.parentElement},r.prototype.getChildren=function(){return this.children},r.prototype.getFirst=function(){return this.firstElementChild},r.prototype.getLast=function(){return this.lastElementChild},r.prototype.getChildByIndex=function(e){return this.children[e]||null},r.prototype.add=function(e,n){return this.appendChild(e,n)},r.prototype.setClip=function(e){this.style.clipPath=e},r.prototype.set=function(e,n){this.config[e]=n},r.prototype.get=function(e){return this.config[e]},r.prototype.moveTo=function(e,n,a){return n===void 0&&(n=0),a===void 0&&(a=0),this.setPosition(e,n,a),this},r.prototype.move=function(e,n,a){return n===void 0&&(n=0),a===void 0&&(a=0),this.setPosition(e,n,a),this},r.prototype.setZIndex=function(e){return this.style.zIndex=e,this},r}(Element$1),Circle=function(t){__extends(r,t);function r(e){e===void 0&&(e={});var n=e.style,a=__rest(e,["style"]);return t.call(this,__assign({type:Shape.CIRCLE,style:runtime.enableCSSParsing?__assign({cx:"",cy:"",r:""},n):__assign({},n),initialParsedStyle:{anchor:[.5,.5],transformOrigin:runtime.enableCSSParsing?null:[PECENTAGE_50,PECENTAGE_50]}},a))||this}return r}(DisplayObject);(function(t){__extends(r,t);function r(e){e===void 0&&(e={});var n=this,a=e.style,o=__rest(e,["style"]);return n=t.call(this,__assign({style:runtime.enableCSSParsing?__assign({x:"",y:""},a):__assign({},a)},o))||this,n.isCustomElement=!0,n}return r})(DisplayObject);var Ellipse=function(t){__extends(r,t);function r(e){e===void 0&&(e={});var n=e.style,a=__rest(e,["style"]);return t.call(this,__assign({type:Shape.ELLIPSE,style:runtime.enableCSSParsing?__assign({cx:"",cy:"",rx:"",ry:""},n):__assign({},n),initialParsedStyle:{anchor:[.5,.5],transformOrigin:runtime.enableCSSParsing?null:[PECENTAGE_50,PECENTAGE_50]}},a))||this}return r}(DisplayObject),Group=function(t){__extends(r,t);function r(e){e===void 0&&(e={});var n=e.style,a=__rest(e,["style"]);return t.call(this,__assign({type:Shape.GROUP,style:runtime.enableCSSParsing?__assign({x:"",y:"",width:"",height:""},n):__assign({},n)},a))||this}return r}(DisplayObject),HTML=function(t){__extends(r,t);function r(e){e===void 0&&(e={});var n=this,a=e.style,o=__rest(e,["style"]);return n=t.call(this,__assign({type:Shape.HTML,style:runtime.enableCSSParsing?__assign({x:"",y:"",width:"auto",height:"auto",innerHTML:""},a):__assign({},a)},o))||this,n.cullable.enable=!1,n}return r.prototype.getDomElement=function(){return this.parsedStyle.$el},r.prototype.getBoundingClientRect=function(){if(this.parsedStyle.$el)return this.parsedStyle.$el.getBoundingClientRect();var e=this.parsedStyle,n=e.x,a=e.y,o=e.width,s=e.height;return new Rectangle(n,a,o,s)},r.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},r.prototype.getBounds=function(){var e,n,a=this.getBoundingClientRect(),o=(n=(e=this.ownerDocument)===null||e===void 0?void 0:e.defaultView)===null||n===void 0?void 0:n.getContextService().getBoundingClientRect(),s=new AABB,l=a.left-((o==null?void 0:o.left)||0),u=a.top-((o==null?void 0:o.top)||0);return s.setMinMax([l,u,0],[l+a.width,u+a.height,0]),s},r.prototype.getLocalBounds=function(){if(this.parentNode){var e=invert$1(create$4(),this.parentNode.getWorldTransform()),n=this.getBounds();if(!AABB.isEmpty(n)){var a=new AABB;return a.setFromTransformedAABB(n,e),a}}return this.getBounds()},r}(DisplayObject),Image$1=function(t){__extends(r,t);function r(e){e===void 0&&(e={});var n=e.style,a=__rest(e,["style"]);return t.call(this,__assign({type:Shape.IMAGE,style:runtime.enableCSSParsing?__assign({x:"",y:"",img:"",width:"",height:""},n):__assign({},n)},a))||this}return r}(DisplayObject),Line=function(t){__extends(r,t);function r(e){e===void 0&&(e={});var n=this,a=e.style,o=__rest(e,["style"]);n=t.call(this,__assign({type:Shape.LINE,style:__assign({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},a)},o))||this,n.markerStartAngle=0,n.markerEndAngle=0;var s=n.parsedStyle,l=s.markerStart,u=s.markerEnd;return l&&isDisplayObject(l)&&(n.markerStartAngle=l.getLocalEulerAngles(),n.appendChild(l)),u&&isDisplayObject(u)&&(n.markerEndAngle=u.getLocalEulerAngles(),n.appendChild(u)),n.transformMarker(!0),n.transformMarker(!1),n}return r.prototype.attributeChangedCallback=function(e,n,a,o,s){e==="x1"||e==="y1"||e==="x2"||e==="y2"||e==="markerStartOffset"||e==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):e==="markerStart"?(o&&isDisplayObject(o)&&(this.markerStartAngle=0,o.remove()),s&&isDisplayObject(s)&&(this.markerStartAngle=s.getLocalEulerAngles(),this.appendChild(s),this.transformMarker(!0))):e==="markerEnd"&&(o&&isDisplayObject(o)&&(this.markerEndAngle=0,o.remove()),s&&isDisplayObject(s)&&(this.markerEndAngle=s.getLocalEulerAngles(),this.appendChild(s),this.transformMarker(!1)))},r.prototype.transformMarker=function(e){var n=this.parsedStyle,a=n.markerStart,o=n.markerEnd,s=n.markerStartOffset,l=n.markerEndOffset,u=n.x1,c=n.x2,d=n.y1,f=n.y2,h=n.defX,p=n.defY,v=e?a:o;if(!(!v||!isDisplayObject(v))){var g=0,y,m,S,w,R,T;e?(S=u-h,w=d-p,y=c-u,m=f-d,R=s||0,T=this.markerStartAngle):(S=c-h,w=f-p,y=u-c,m=d-f,R=l||0,T=this.markerEndAngle),g=Math.atan2(m,y),v.setLocalEulerAngles(g*180/Math.PI+T),v.setLocalPosition(S+Math.cos(g)*R,w+Math.sin(g)*R)}},r.prototype.getPoint=function(e,n){n===void 0&&(n=!1);var a=this.parsedStyle,o=a.x1,s=a.y1,l=a.x2,u=a.y2,c=a.defX,d=a.defY,f=pointAt$3(o,s,l,u,e),h=f.x,p=f.y,v=transformMat4$1(create$3(),fromValues$3(h-c,p-d,0),n?this.getWorldTransform():this.getLocalTransform());return new Point(v[0],v[1])},r.prototype.getPointAtLength=function(e,n){return n===void 0&&(n=!1),this.getPoint(e/this.getTotalLength(),n)},r.prototype.getTotalLength=function(){var e=this.parsedStyle,n=e.x1,a=e.y1,o=e.x2,s=e.y2;return length$4(n,a,o,s)},r}(DisplayObject),Path=function(t){__extends(r,t);function r(e){e===void 0&&(e={});var n=this,a=e.style,o=__rest(e,["style"]);n=t.call(this,__assign({type:Shape.PATH,style:runtime.enableCSSParsing?__assign({path:"",miterLimit:""},a):__assign({},a),initialParsedStyle:runtime.enableCSSParsing?null:{miterLimit:4,path:__assign({},EMPTY_PARSED_PATH)}},o))||this,n.markerStartAngle=0,n.markerEndAngle=0,n.markerMidList=[];var s=n.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerMid;return l&&isDisplayObject(l)&&(n.markerStartAngle=l.getLocalEulerAngles(),n.appendChild(l)),c&&isDisplayObject(c)&&n.placeMarkerMid(c),u&&isDisplayObject(u)&&(n.markerEndAngle=u.getLocalEulerAngles(),n.appendChild(u)),n.transformMarker(!0),n.transformMarker(!1),n}return r.prototype.attributeChangedCallback=function(e,n,a,o,s){e==="path"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):e==="markerStartOffset"||e==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):e==="markerStart"?(o&&isDisplayObject(o)&&(this.markerStartAngle=0,o.remove()),s&&isDisplayObject(s)&&(this.markerStartAngle=s.getLocalEulerAngles(),this.appendChild(s),this.transformMarker(!0))):e==="markerEnd"?(o&&isDisplayObject(o)&&(this.markerEndAngle=0,o.remove()),s&&isDisplayObject(s)&&(this.markerEndAngle=s.getLocalEulerAngles(),this.appendChild(s),this.transformMarker(!1))):e==="markerMid"&&this.placeMarkerMid(s)},r.prototype.transformMarker=function(e){var n=this.parsedStyle,a=n.markerStart,o=n.markerEnd,s=n.markerStartOffset,l=n.markerEndOffset,u=n.defX,c=n.defY,d=e?a:o;if(!(!d||!isDisplayObject(d))){var f=0,h,p,v,g,y,m;if(e){var S=__read(this.getStartTangent(),2),w=S[0],R=S[1];v=R[0]-u,g=R[1]-c,h=w[0]-R[0],p=w[1]-R[1],y=s||0,m=this.markerStartAngle}else{var T=__read(this.getEndTangent(),2),w=T[0],R=T[1];v=R[0]-u,g=R[1]-c,h=w[0]-R[0],p=w[1]-R[1],y=l||0,m=this.markerEndAngle}f=Math.atan2(p,h),d.setLocalEulerAngles(f*180/Math.PI+m),d.setLocalPosition(v+Math.cos(f)*y,g+Math.sin(f)*y)}},r.prototype.placeMarkerMid=function(e){var n=this.parsedStyle,a=n.path.segments,o=n.defX,s=n.defY;if(this.markerMidList.forEach(function(h){h.remove()}),e&&isDisplayObject(e))for(var l=1;l<a.length-1;l++){var u=__read(a[l].currentPoint,2),c=u[0],d=u[1],f=l===1?e:e.cloneNode(!0);this.markerMidList.push(f),this.appendChild(f),f.setLocalPosition(c-o,d-s)}},r.prototype.getTotalLength=function(){return getOrCalculatePathTotalLength(this)},r.prototype.getPointAtLength=function(e,n){n===void 0&&(n=!1);var a=this.parsedStyle,o=a.defX,s=a.defY,l=a.path.absolutePath,u=getPointAtLength(l,e),c=u.x,d=u.y,f=transformMat4$1(create$3(),fromValues$3(c-o,d-s,0),n?this.getWorldTransform():this.getLocalTransform());return new Point(f[0],f[1])},r.prototype.getPoint=function(e,n){return n===void 0&&(n=!1),this.getPointAtLength(e*getOrCalculatePathTotalLength(this),n)},r.prototype.getStartTangent=function(){var e=this.parsedStyle.path.segments,n=[];if(e.length>1){var a=e[0].currentPoint,o=e[1].currentPoint,s=e[1].startTangent;n=[],s?(n.push([a[0]-s[0],a[1]-s[1]]),n.push([a[0],a[1]])):(n.push([o[0],o[1]]),n.push([a[0],a[1]]))}return n},r.prototype.getEndTangent=function(){var e=this.parsedStyle.path.segments,n=e.length,a=[];if(n>1){var o=e[n-2].currentPoint,s=e[n-1].currentPoint,l=e[n-1].endTangent;a=[],l?(a.push([s[0]-l[0],s[1]-l[1]]),a.push([s[0],s[1]])):(a.push([o[0],o[1]]),a.push([s[0],s[1]]))}return a},r}(DisplayObject),Polygon=function(t){__extends(r,t);function r(e){e===void 0&&(e={});var n=this,a=e.style,o=__rest(e,["style"]);n=t.call(this,__assign({type:Shape.POLYGON,style:runtime.enableCSSParsing?__assign({points:"",miterLimit:"",isClosed:!0},a):__assign({},a),initialParsedStyle:runtime.enableCSSParsing?null:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},o))||this,n.markerStartAngle=0,n.markerEndAngle=0,n.markerMidList=[];var s=n.parsedStyle,l=s.markerStart,u=s.markerEnd,c=s.markerMid;return l&&isDisplayObject(l)&&(n.markerStartAngle=l.getLocalEulerAngles(),n.appendChild(l)),c&&isDisplayObject(c)&&n.placeMarkerMid(c),u&&isDisplayObject(u)&&(n.markerEndAngle=u.getLocalEulerAngles(),n.appendChild(u)),n.transformMarker(!0),n.transformMarker(!1),n}return r.prototype.attributeChangedCallback=function(e,n,a,o,s){e==="points"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):e==="markerStartOffset"||e==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):e==="markerStart"?(o&&isDisplayObject(o)&&(this.markerStartAngle=0,o.remove()),s&&isDisplayObject(s)&&(this.markerStartAngle=s.getLocalEulerAngles(),this.appendChild(s),this.transformMarker(!0))):e==="markerEnd"?(o&&isDisplayObject(o)&&(this.markerEndAngle=0,o.remove()),s&&isDisplayObject(s)&&(this.markerEndAngle=s.getLocalEulerAngles(),this.appendChild(s),this.transformMarker(!1))):e==="markerMid"&&this.placeMarkerMid(s)},r.prototype.transformMarker=function(e){var n=this.parsedStyle,a=n.markerStart,o=n.markerEnd,s=n.markerStartOffset,l=n.markerEndOffset,u=n.points,c=n.defX,d=n.defY,f=(u||{}).points,h=e?a:o;if(!(!h||!isDisplayObject(h)||!f)){var p=0,v,g,y,m,S,w;if(y=f[0][0]-c,m=f[0][1]-d,e)v=f[1][0]-f[0][0],g=f[1][1]-f[0][1],S=s||0,w=this.markerStartAngle;else{var R=f.length;this.parsedStyle.isClosed?(v=f[R-1][0]-f[0][0],g=f[R-1][1]-f[0][1]):(y=f[R-1][0]-c,m=f[R-1][1]-d,v=f[R-2][0]-f[R-1][0],g=f[R-2][1]-f[R-1][1]),S=l||0,w=this.markerEndAngle}p=Math.atan2(g,v),h.setLocalEulerAngles(p*180/Math.PI+w),h.setLocalPosition(y+Math.cos(p)*S,m+Math.sin(p)*S)}},r.prototype.placeMarkerMid=function(e){var n=this.parsedStyle,a=n.points,o=n.defX,s=n.defY,l=(a||{}).points;if(this.markerMidList.forEach(function(h){h.remove()}),this.markerMidList=[],e&&isDisplayObject(e)&&l)for(var u=1;u<(this.parsedStyle.isClosed?l.length:l.length-1);u++){var c=l[u][0]-o,d=l[u][1]-s,f=u===1?e:e.cloneNode(!0);this.markerMidList.push(f),this.appendChild(f),f.setLocalPosition(c,d)}},r}(DisplayObject),Polyline=function(t){__extends(r,t);function r(e){e===void 0&&(e={});var n=e.style,a=__rest(e,["style"]);return t.call(this,__assign({type:Shape.POLYLINE,style:runtime.enableCSSParsing?__assign({points:"",miterLimit:"",isClosed:!1},n):__assign({},n),initialParsedStyle:runtime.enableCSSParsing?null:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},a))||this}return r.prototype.getTotalLength=function(){return this.parsedStyle.points.totalLength},r.prototype.getPointAtLength=function(e,n){return n===void 0&&(n=!1),this.getPoint(e/this.getTotalLength(),n)},r.prototype.getPoint=function(e,n){n===void 0&&(n=!1);var a=this.parsedStyle,o=a.defX,s=a.defY,l=a.points,u=l.points,c=l.segments,d=0,f=0;c.forEach(function(y,m){e>=y[0]&&e<=y[1]&&(d=(e-y[0])/(y[1]-y[0]),f=m)});var h=pointAt$3(u[f][0],u[f][1],u[f+1][0],u[f+1][1],d),p=h.x,v=h.y,g=transformMat4$1(create$3(),fromValues$3(p-o,v-s,0),n?this.getWorldTransform():this.getLocalTransform());return new Point(g[0],g[1])},r.prototype.getStartTangent=function(){var e=this.parsedStyle.points.points,n=[];return n.push([e[1][0],e[1][1]]),n.push([e[0][0],e[0][1]]),n},r.prototype.getEndTangent=function(){var e=this.parsedStyle.points.points,n=e.length-1,a=[];return a.push([e[n-1][0],e[n-1][1]]),a.push([e[n][0],e[n][1]]),a},r}(Polygon),Rect=function(t){__extends(r,t);function r(e){e===void 0&&(e={});var n=e.style,a=__rest(e,["style"]);return t.call(this,__assign({type:Shape.RECT,style:runtime.enableCSSParsing?__assign({x:"",y:"",width:"",height:"",radius:""},n):__assign({},n)},a))||this}return r}(DisplayObject),Text=function(t){__extends(r,t);function r(e){e===void 0&&(e={});var n=e.style,a=__rest(e,["style"]);return t.call(this,__assign({type:Shape.TEXT,style:runtime.enableCSSParsing?__assign({x:"",y:"",text:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",fill:"black",letterSpacing:"",lineHeight:"",miterLimit:"",wordWrap:!1,wordWrapWidth:0,leading:0,dx:"",dy:""},n):__assign({fill:"black"},n),initialParsedStyle:runtime.enableCSSParsing?{}:{x:0,y:0,fontSize:16,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",lineHeight:0,letterSpacing:0,textBaseline:"alphabetic",textAlign:"start",wordWrap:!1,wordWrapWidth:0,leading:0,dx:0,dy:0}},a))||this}return r.prototype.getComputedTextLength=function(){var e;return((e=this.parsedStyle.metrics)===null||e===void 0?void 0:e.maxLineWidth)||0},r.prototype.getLineBoundingRects=function(){var e;return((e=this.parsedStyle.metrics)===null||e===void 0?void 0:e.lineMetrics)||[]},r.prototype.isOverflowing=function(){return!!this.parsedStyle.isOverflowing},r}(DisplayObject),CustomElementRegistry=function(){function t(){this.registry={},this.define(Shape.CIRCLE,Circle),this.define(Shape.ELLIPSE,Ellipse),this.define(Shape.RECT,Rect),this.define(Shape.IMAGE,Image$1),this.define(Shape.LINE,Line),this.define(Shape.GROUP,Group),this.define(Shape.PATH,Path),this.define(Shape.POLYGON,Polygon),this.define(Shape.POLYLINE,Polyline),this.define(Shape.TEXT,Text),this.define(Shape.HTML,HTML)}return t.prototype.define=function(r,e){this.registry[r]=e},t.prototype.get=function(r){return this.registry[r]},t}(),Document=function(t){__extends(r,t);function r(){var e=t.call(this)||this;e.defaultView=null,e.ownerDocument=null,e.nodeName="document";try{e.timeline=new runtime.AnimationTimeline(e)}catch{}var n={};return BUILT_IN_PROPERTIES.forEach(function(a){var o=a.n,s=a.inh,l=a.d;s&&l&&(n[o]=isFunction$1(l)?l(Shape.GROUP):l)}),e.documentElement=new Group({id:"g-root",style:n}),e.documentElement.ownerDocument=e,e.documentElement.parentNode=e,e.childNodes=[e.documentElement],e}return Object.defineProperty(r.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),r.prototype.createElement=function(e,n){if(e==="svg")return this.documentElement;var a=this.defaultView.customElements.get(e);a||(console.warn("Unsupported tagName: ",e),a=e==="tspan"?Text:Group);var o=new a(n);return o.ownerDocument=this,o},r.prototype.createElementNS=function(e,n,a){return this.createElement(n,a)},r.prototype.cloneNode=function(e){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},r.prototype.destroy=function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch{}},r.prototype.elementsFromBBox=function(e,n,a,o){var s=this.defaultView.context.rBushRoot,l=s.search({minX:e,minY:n,maxX:a,maxY:o}),u=[];return l.forEach(function(c){var d=c.displayObject,f=d.parsedStyle.pointerEvents,h=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(f);(!h||h&&d.isVisible())&&!d.isCulled()&&d.isInteractive()&&u.push(d)}),u.sort(function(c,d){return d.sortable.renderOrder-c.sortable.renderOrder}),u},r.prototype.elementFromPointSync=function(e,n){var a=this.defaultView.canvas2Viewport({x:e,y:n}),o=a.x,s=a.y,l=this.defaultView.getConfig(),u=l.width,c=l.height;if(o<0||s<0||o>u||s>c)return null;var d=this.defaultView.viewport2Client({x:o,y:s}),f=d.x,h=d.y,p=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:e,y:n,viewportX:o,viewportY:s,clientX:f,clientY:h},picked:[]}).picked;return p&&p[0]||this.documentElement},r.prototype.elementFromPoint=function(e,n){return __awaiter(this,void 0,void 0,function(){var a,o,s,l,u,c,d,f,h,p;return __generator(this,function(v){switch(v.label){case 0:return a=this.defaultView.canvas2Viewport({x:e,y:n}),o=a.x,s=a.y,l=this.defaultView.getConfig(),u=l.width,c=l.height,o<0||s<0||o>u||s>c?[2,null]:(d=this.defaultView.viewport2Client({x:o,y:s}),f=d.x,h=d.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:e,y:n,viewportX:o,viewportY:s,clientX:f,clientY:h},picked:[]})]);case 1:return p=v.sent().picked,[2,p&&p[0]||this.documentElement]}})})},r.prototype.elementsFromPointSync=function(e,n){var a=this.defaultView.canvas2Viewport({x:e,y:n}),o=a.x,s=a.y,l=this.defaultView.getConfig(),u=l.width,c=l.height;if(o<0||s<0||o>u||s>c)return[];var d=this.defaultView.viewport2Client({x:o,y:s}),f=d.x,h=d.y,p=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:e,y:n,viewportX:o,viewportY:s,clientX:f,clientY:h},picked:[]}).picked;return p[p.length-1]!==this.documentElement&&p.push(this.documentElement),p},r.prototype.elementsFromPoint=function(e,n){return __awaiter(this,void 0,void 0,function(){var a,o,s,l,u,c,d,f,h,p;return __generator(this,function(v){switch(v.label){case 0:return a=this.defaultView.canvas2Viewport({x:e,y:n}),o=a.x,s=a.y,l=this.defaultView.getConfig(),u=l.width,c=l.height,o<0||s<0||o>u||s>c?[2,[]]:(d=this.defaultView.viewport2Client({x:o,y:s}),f=d.x,h=d.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:e,y:n,viewportX:o,viewportY:s,clientX:f,clientY:h},picked:[]})]);case 1:return p=v.sent().picked,p[p.length-1]!==this.documentElement&&p.push(this.documentElement),[2,p]}})})},r.prototype.appendChild=function(e,n){throw new Error(ERROR_MSG_USE_DOCUMENT_ELEMENT)},r.prototype.insertBefore=function(e,n){throw new Error(ERROR_MSG_USE_DOCUMENT_ELEMENT)},r.prototype.removeChild=function(e,n){throw new Error(ERROR_MSG_USE_DOCUMENT_ELEMENT)},r.prototype.replaceChild=function(e,n,a){throw new Error(ERROR_MSG_USE_DOCUMENT_ELEMENT)},r.prototype.append=function(){throw new Error(ERROR_MSG_USE_DOCUMENT_ELEMENT)},r.prototype.prepend=function(){throw new Error(ERROR_MSG_USE_DOCUMENT_ELEMENT)},r.prototype.getElementById=function(e){return this.documentElement.getElementById(e)},r.prototype.getElementsByName=function(e){return this.documentElement.getElementsByName(e)},r.prototype.getElementsByTagName=function(e){return this.documentElement.getElementsByTagName(e)},r.prototype.getElementsByClassName=function(e){return this.documentElement.getElementsByClassName(e)},r.prototype.querySelector=function(e){return this.documentElement.querySelector(e)},r.prototype.querySelectorAll=function(e){return this.documentElement.querySelectorAll(e)},r.prototype.find=function(e){return this.documentElement.find(e)},r.prototype.findAll=function(e){return this.documentElement.findAll(e)},r}(Node$2),CullingPlugin=function(){function t(r){this.strategies=r}return t.prototype.apply=function(r){var e=r.camera,n=r.renderingService,a=r.renderingContext,o=this.strategies;n.hooks.cull.tap(t.tag,function(s){if(s){var l=s.cullable;return o.length===0?l.visible=a.unculledEntities.indexOf(s.entity)>-1:l.visible=o.every(function(u){return u.isVisible(e,s)}),!s.isCulled()&&s.isVisible()?s:(s.dispatchEvent(new CustomEvent(ElementEvent.CULLED)),null)}return s}),n.hooks.afterRender.tap(t.tag,function(s){s.cullable.visibilityPlaneMask=-1})},t.tag="Culling",t}(),EventPlugin=function(){function t(){var r=this;this.autoPreventDefault=!1,this.rootPointerEvent=new FederatedPointerEvent(null),this.rootWheelEvent=new FederatedWheelEvent(null),this.onPointerMove=function(e){var n,a,o,s,l=(s=(o=r.context.renderingContext.root)===null||o===void 0?void 0:o.ownerDocument)===null||s===void 0?void 0:s.defaultView;if(!(l.supportsTouchEvents&&e.pointerType==="touch")){var u=r.normalizeToPointerEvent(e,l);try{for(var c=__values(u),d=c.next();!d.done;d=c.next()){var f=d.value,h=r.bootstrapEvent(r.rootPointerEvent,f,l,e);r.context.eventService.mapEvent(h)}}catch(p){n={error:p}}finally{try{d&&!d.done&&(a=c.return)&&a.call(c)}finally{if(n)throw n.error}}r.setCursor(r.context.eventService.cursor)}},this.onClick=function(e){var n,a,o,s,l=(s=(o=r.context.renderingContext.root)===null||o===void 0?void 0:o.ownerDocument)===null||s===void 0?void 0:s.defaultView,u=r.normalizeToPointerEvent(e,l);try{for(var c=__values(u),d=c.next();!d.done;d=c.next()){var f=d.value,h=r.bootstrapEvent(r.rootPointerEvent,f,l,e);r.context.eventService.mapEvent(h)}}catch(p){n={error:p}}finally{try{d&&!d.done&&(a=c.return)&&a.call(c)}finally{if(n)throw n.error}}r.setCursor(r.context.eventService.cursor)}}return t.prototype.apply=function(r){var e=this;this.context=r;var n=r.renderingService,a=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(o){var s=e.context.renderingService.hooks.pickSync.call({position:o,picked:[],topmost:!0}).picked;return s[0]||null}),n.hooks.pointerWheel.tap(t.tag,function(o){var s=e.normalizeWheelEvent(o);e.context.eventService.mapEvent(s)}),n.hooks.pointerDown.tap(t.tag,function(o){var s,l;if(!(a.supportsTouchEvents&&o.pointerType==="touch")){var u=e.normalizeToPointerEvent(o,a);if(e.autoPreventDefault&&u[0].isNormalized){var c=o.cancelable||!("cancelable"in o);c&&o.preventDefault()}try{for(var d=__values(u),f=d.next();!f.done;f=d.next()){var h=f.value,p=e.bootstrapEvent(e.rootPointerEvent,h,a,o);e.context.eventService.mapEvent(p)}}catch(v){s={error:v}}finally{try{f&&!f.done&&(l=d.return)&&l.call(d)}finally{if(s)throw s.error}}e.setCursor(e.context.eventService.cursor)}}),n.hooks.pointerUp.tap(t.tag,function(o){var s,l;if(!(a.supportsTouchEvents&&o.pointerType==="touch")){var u=e.context.contextService.getDomElement(),c="outside";try{c=u&&o.target&&o.target!==u&&u.contains&&!u.contains(o.target)?"outside":""}catch{}var d=e.normalizeToPointerEvent(o,a);try{for(var f=__values(d),h=f.next();!h.done;h=f.next()){var p=h.value,v=e.bootstrapEvent(e.rootPointerEvent,p,a,o);v.type+=c,e.context.eventService.mapEvent(v)}}catch(g){s={error:g}}finally{try{h&&!h.done&&(l=f.return)&&l.call(f)}finally{if(s)throw s.error}}e.setCursor(e.context.eventService.cursor)}}),n.hooks.pointerMove.tap(t.tag,this.onPointerMove),n.hooks.pointerOver.tap(t.tag,this.onPointerMove),n.hooks.pointerOut.tap(t.tag,this.onPointerMove),n.hooks.click.tap(t.tag,this.onClick),n.hooks.pointerCancel.tap(t.tag,function(o){var s,l,u=e.normalizeToPointerEvent(o,a);try{for(var c=__values(u),d=c.next();!d.done;d=c.next()){var f=d.value,h=e.bootstrapEvent(e.rootPointerEvent,f,a,o);e.context.eventService.mapEvent(h)}}catch(p){s={error:p}}finally{try{d&&!d.done&&(l=c.return)&&l.call(c)}finally{if(s)throw s.error}}e.setCursor(e.context.eventService.cursor)})},t.prototype.getViewportXY=function(r){var e,n,a=r.offsetX,o=r.offsetY,s=r.clientX,l=r.clientY;if(this.context.config.supportsCSSTransform&&!isNil$1(a)&&!isNil$1(o))e=a,n=o;else{var u=this.context.eventService.client2Viewport(new Point(s,l));e=u.x,n=u.y}return{x:e,y:n}},t.prototype.bootstrapEvent=function(r,e,n,a){r.view=n,r.originalEvent=null,r.nativeEvent=a,r.pointerId=e.pointerId,r.width=e.width,r.height=e.height,r.isPrimary=e.isPrimary,r.pointerType=e.pointerType,r.pressure=e.pressure,r.tangentialPressure=e.tangentialPressure,r.tiltX=e.tiltX,r.tiltY=e.tiltY,r.twist=e.twist,this.transferMouseData(r,e);var o=this.getViewportXY(e),s=o.x,l=o.y;r.viewport.x=s,r.viewport.y=l;var u=this.context.eventService.viewport2Canvas(r.viewport),c=u.x,d=u.y;return r.canvas.x=c,r.canvas.y=d,r.global.copyFrom(r.canvas),r.offset.copyFrom(r.canvas),r.isTrusted=a.isTrusted,r.type==="pointerleave"&&(r.type="pointerout"),r.type.startsWith("mouse")&&(r.type=r.type.replace("mouse","pointer")),r.type.startsWith("touch")&&(r.type=TOUCH_TO_POINTER[r.type]||r.type),r},t.prototype.normalizeWheelEvent=function(r){var e=this.rootWheelEvent;this.transferMouseData(e,r),e.deltaMode=r.deltaMode,e.deltaX=r.deltaX,e.deltaY=r.deltaY,e.deltaZ=r.deltaZ;var n=this.getViewportXY(r),a=n.x,o=n.y;e.viewport.x=a,e.viewport.y=o;var s=this.context.eventService.viewport2Canvas(e.viewport),l=s.x,u=s.y;return e.canvas.x=l,e.canvas.y=u,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.nativeEvent=r,e.type=r.type,e},t.prototype.transferMouseData=function(r,e){r.isTrusted=e.isTrusted,r.srcElement=e.srcElement,r.timeStamp=clock$1.now(),r.type=e.type,r.altKey=e.altKey,r.metaKey=e.metaKey,r.shiftKey=e.shiftKey,r.ctrlKey=e.ctrlKey,r.button=e.button,r.buttons=e.buttons,r.client.x=e.clientX,r.client.y=e.clientY,r.movement.x=e.movementX,r.movement.y=e.movementY,r.page.x=e.pageX,r.page.y=e.pageY,r.screen.x=e.screenX,r.screen.y=e.screenY,r.relatedTarget=null},t.prototype.setCursor=function(r){this.context.contextService.applyCursorStyle(r||this.context.config.cursor||"default")},t.prototype.normalizeToPointerEvent=function(r,e){var n=[];if(e.isTouchEvent(r))for(var a=0;a<r.changedTouches.length;a++){var o=r.changedTouches[a];isUndefined$1(o.button)&&(o.button=0),isUndefined$1(o.buttons)&&(o.buttons=1),isUndefined$1(o.isPrimary)&&(o.isPrimary=r.touches.length===1&&r.type==="touchstart"),isUndefined$1(o.width)&&(o.width=o.radiusX||1),isUndefined$1(o.height)&&(o.height=o.radiusY||1),isUndefined$1(o.tiltX)&&(o.tiltX=0),isUndefined$1(o.tiltY)&&(o.tiltY=0),isUndefined$1(o.pointerType)&&(o.pointerType="touch"),isUndefined$1(o.pointerId)&&(o.pointerId=o.identifier||0),isUndefined$1(o.pressure)&&(o.pressure=o.force||.5),isUndefined$1(o.twist)&&(o.twist=0),isUndefined$1(o.tangentialPressure)&&(o.tangentialPressure=0),o.isNormalized=!0,o.type=r.type,n.push(o)}else if(e.isMouseEvent(r)){var s=r;isUndefined$1(s.isPrimary)&&(s.isPrimary=!0),isUndefined$1(s.width)&&(s.width=1),isUndefined$1(s.height)&&(s.height=1),isUndefined$1(s.tiltX)&&(s.tiltX=0),isUndefined$1(s.tiltY)&&(s.tiltY=0),isUndefined$1(s.pointerType)&&(s.pointerType="mouse"),isUndefined$1(s.pointerId)&&(s.pointerId=MOUSE_POINTER_ID),isUndefined$1(s.pressure)&&(s.pressure=.5),isUndefined$1(s.twist)&&(s.twist=0),isUndefined$1(s.tangentialPressure)&&(s.tangentialPressure=0),s.isNormalized=!0,n.push(s)}else n.push(r);return n},t.tag="Event",t}(),shape2D=[Shape.CIRCLE,Shape.ELLIPSE,Shape.IMAGE,Shape.RECT,Shape.LINE,Shape.POLYLINE,Shape.POLYGON,Shape.TEXT,Shape.PATH,Shape.HTML],FrustumCullingStrategy=function(){function t(){}return t.prototype.isVisible=function(r,e){var n,a,o=e.cullable;if(!o.enable)return!0;var s=e.getRenderBounds();if(AABB.isEmpty(s))return!1;var l=r.getFrustum(),u=(a=(n=e.parentNode)===null||n===void 0?void 0:n.cullable)===null||a===void 0?void 0:a.visibilityPlaneMask;return o.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(e,s,u||Mask.INDETERMINATE,l.planes),o.visible=o.visibilityPlaneMask!==Mask.OUTSIDE,o.visible},t.prototype.computeVisibilityWithPlaneMask=function(r,e,n,a){if(n===Mask.OUTSIDE||n===Mask.INSIDE)return n;for(var o=Mask.INSIDE,s=shape2D.indexOf(r.nodeName)>-1,l=0,u=a.length;l<u;++l){var c=1<<l;if(n&c&&!(s&&(l===4||l===5))){var d=a[l],f=d.normal,h=d.distance;if(dot$2(f,e.getPositiveFarPoint(a[l]))+h<0)return Mask.OUTSIDE;dot$2(f,e.getNegativeFarPoint(a[l]))+h<0&&(o|=c)}}return o},t}(),PrepareRendererPlugin=function(){function t(){this.toSync=new Set}return t.prototype.apply=function(r){var e=this,n=r.renderingService,a=r.renderingContext,o=r.rBushRoot,s=a.root.ownerDocument.defaultView;this.rBush=o;var l=function(f){var h=f.target;h.renderable.dirty=!0,n.dirtify()},u=function(f){var h=f.detail.affectChildren,p=f.target;h&&p.forEach(function(g){e.toSync.add(g)});for(var v=p;v;)v.renderable&&e.toSync.add(v),v=v.parentElement;n.dirtify()},c=function(f){var h=f.target;runtime.enableSizeAttenuation&&runtime.styleValueRegistry.updateSizeAttenuation(h,s.getCamera().getZoom()),runtime.enableCSSParsing&&runtime.styleValueRegistry.recalc(h),runtime.sceneGraphService.dirtifyToRoot(h),n.dirtify()},d=function(f){var h=f.target,p=h.rBushNode;p.aabb&&e.rBush.remove(p.aabb),e.toSync.delete(h),runtime.sceneGraphService.dirtifyToRoot(h),n.dirtify()};n.hooks.init.tap(t.tag,function(){s.addEventListener(ElementEvent.MOUNTED,c),s.addEventListener(ElementEvent.UNMOUNTED,d),s.addEventListener(ElementEvent.ATTR_MODIFIED,l),s.addEventListener(ElementEvent.BOUNDS_CHANGED,u)}),n.hooks.destroy.tap(t.tag,function(){s.removeEventListener(ElementEvent.MOUNTED,c),s.removeEventListener(ElementEvent.UNMOUNTED,d),s.removeEventListener(ElementEvent.ATTR_MODIFIED,l),s.removeEventListener(ElementEvent.BOUNDS_CHANGED,u),e.toSync.clear()}),n.hooks.endFrame.tap(t.tag,function(){e.syncRTree()})},t.prototype.syncRTree=function(){var r=this,e=[];Array.from(this.toSync).filter(function(n){return n.isConnected}).forEach(function(n){var a=n.rBushNode;a&&a.aabb&&r.rBush.remove(a.aabb);var o=n.getRenderBounds();if(o){var s=__read(o.getMin(),2),l=s[0],u=s[1],c=__read(o.getMax(),2),d=c[0],f=c[1];a.aabb||(a.aabb={}),a.aabb.displayObject=n,a.aabb.minX=l,a.aabb.minY=u,a.aabb.maxX=d,a.aabb.maxY=f}a.aabb&&!isNaN(a.aabb.maxX)&&!isNaN(a.aabb.maxX)&&!isNaN(a.aabb.minX)&&!isNaN(a.aabb.minY)&&e.push(a.aabb)}),this.rBush.load(e),e.length=0,this.toSync.clear()},t.tag="Prepare",t}(),CanvasEvent;(function(t){t.READY="ready",t.BEFORE_RENDER="beforerender",t.RERENDER="rerender",t.AFTER_RENDER="afterrender",t.BEFORE_DESTROY="beforedestroy",t.AFTER_DESTROY="afterdestroy",t.RESIZE="resize",t.DIRTY_RECTANGLE="dirtyrectangle",t.RENDERER_CHANGED="rendererchanged"})(CanvasEvent||(CanvasEvent={}));var DEFAULT_CAMERA_Z=500,DEFAULT_CAMERA_NEAR=.1,DEFAULT_CAMERA_FAR=1e3,mountedEvent=new CustomEvent(ElementEvent.MOUNTED),unmountedEvent=new CustomEvent(ElementEvent.UNMOUNTED),beforeRenderEvent=new CustomEvent(CanvasEvent.BEFORE_RENDER),rerenderEvent=new CustomEvent(CanvasEvent.RERENDER),afterRenderEvent=new CustomEvent(CanvasEvent.AFTER_RENDER),Canvas=function(t){__extends(r,t);function r(e){var n=t.call(this)||this;n.Element=DisplayObject,n.inited=!1,n.context={},n.document=new Document,n.document.defaultView=n,n.customElements=new CustomElementRegistry;var a=e.container,o=e.canvas,s=e.offscreenCanvas,l=e.width,u=e.height,c=e.devicePixelRatio,d=e.renderer,f=e.background,h=e.cursor,p=e.document,v=e.requestAnimationFrame,g=e.cancelAnimationFrame,y=e.createImage,m=e.supportsPointerEvents,S=e.supportsTouchEvents,w=e.supportsCSSTransform,R=e.supportsMutipleCanvasesInOneContainer,T=e.useNativeClickEvent,x=e.alwaysTriggerPointerEventOnCanvas,b=e.isTouchEvent,L=e.isMouseEvent;R||cleanExistedCanvas(a,n);var M=l,D=u,N=c;return o&&(N=c||isBrowser&&window.devicePixelRatio||1,N=N>=1?Math.ceil(N):1,M=l||getWidth(o)||o.width/N,D=u||getHeight(o)||o.height/N),s&&(runtime.offscreenCanvas=s),n.devicePixelRatio=N,n.requestAnimationFrame=v??raf.bind(runtime.globalThis),n.cancelAnimationFrame=g??caf.bind(runtime.globalThis),n.supportsTouchEvents=S??"ontouchstart"in runtime.globalThis,n.supportsPointerEvents=m??!!runtime.globalThis.PointerEvent,n.isTouchEvent=b??function(F){return n.supportsTouchEvents&&F instanceof runtime.globalThis.TouchEvent},n.isMouseEvent=L??function(F){return!runtime.globalThis.MouseEvent||F instanceof runtime.globalThis.MouseEvent&&(!n.supportsPointerEvents||!(F instanceof runtime.globalThis.PointerEvent))},n.initRenderingContext({container:a,canvas:o,width:M,height:D,renderer:d,offscreenCanvas:s,devicePixelRatio:N,cursor:h||"default",background:f||"transparent",createImage:y,document:p,supportsCSSTransform:w,useNativeClickEvent:T,alwaysTriggerPointerEventOnCanvas:x}),n.initDefaultCamera(M,D,d.clipSpaceNearZ),n.initRenderer(d,!0),n}return r.prototype.initRenderingContext=function(e){this.context.config=e,this.context.renderingContext={root:this.document.documentElement,renderListCurrentFrame:[],unculledEntities:[],renderReasons:new Set,force:!1,dirty:!1}},r.prototype.initDefaultCamera=function(e,n,a){var o=this,s=new runtime.CameraContribution;s.clipSpaceNearZ=a,s.setType(CameraType.EXPLORING,CameraTrackingMode.DEFAULT).setPosition(e/2,n/2,DEFAULT_CAMERA_Z).setFocalPoint(e/2,n/2,0).setOrthographic(e/-2,e/2,n/2,n/-2,DEFAULT_CAMERA_NEAR,DEFAULT_CAMERA_FAR),s.canvas=this,s.eventEmitter.on(CameraEvent.UPDATED,function(){o.context.renderingContext.renderReasons.add(RenderReason.CAMERA_CHANGED),runtime.enableSizeAttenuation&&o.getConfig().renderer.getConfig().enableSizeAttenuation&&o.updateSizeAttenuation()}),this.context.camera=s},r.prototype.updateSizeAttenuation=function(){var e=this.getCamera().getZoom();this.document.documentElement.forEach(function(n){runtime.styleValueRegistry.updateSizeAttenuation(n,e)})},r.prototype.getConfig=function(){return this.context.config},r.prototype.getRoot=function(){return this.document.documentElement},r.prototype.getCamera=function(){return this.context.camera},r.prototype.getContextService=function(){return this.context.contextService},r.prototype.getEventService=function(){return this.context.eventService},r.prototype.getRenderingService=function(){return this.context.renderingService},r.prototype.getRenderingContext=function(){return this.context.renderingContext},r.prototype.getStats=function(){return this.getRenderingService().getStats()},Object.defineProperty(r.prototype,"ready",{get:function(){var e=this;return this.readyPromise||(this.readyPromise=new Promise(function(n){e.resolveReadyPromise=function(){n(e)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),r.prototype.destroy=function(e,n){if(e===void 0&&(e=!0),n===void 0&&(n=!1),n||this.dispatchEvent(new CustomEvent(CanvasEvent.BEFORE_DESTROY)),this.frameId){var a=this.getConfig().cancelAnimationFrame||cancelAnimationFrame;a(this.frameId)}var o=this.getRoot();this.unmountChildren(o),e&&(this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),e&&this.context.rBushRoot&&(this.context.rBushRoot.clear(),this.context.rBushRoot=null,this.context.renderingContext.root=null),n||this.dispatchEvent(new CustomEvent(CanvasEvent.AFTER_DESTROY))},r.prototype.changeSize=function(e,n){this.resize(e,n)},r.prototype.resize=function(e,n){var a=this.context.config;a.width=e,a.height=n,this.getContextService().resize(e,n);var o=this.context.camera,s=o.getProjectionMode();o.setPosition(e/2,n/2,DEFAULT_CAMERA_Z).setFocalPoint(e/2,n/2,0),s===CameraProjectionMode.ORTHOGRAPHIC?o.setOrthographic(e/-2,e/2,n/2,n/-2,o.getNear(),o.getFar()):o.setAspect(e/n),this.dispatchEvent(new CustomEvent(CanvasEvent.RESIZE,{width:e,height:n}))},r.prototype.appendChild=function(e,n){return this.document.documentElement.appendChild(e,n)},r.prototype.insertBefore=function(e,n){return this.document.documentElement.insertBefore(e,n)},r.prototype.removeChild=function(e){return this.document.documentElement.removeChild(e)},r.prototype.removeChildren=function(){this.document.documentElement.removeChildren()},r.prototype.destroyChildren=function(){this.document.documentElement.destroyChildren()},r.prototype.render=function(){var e=this;this.dispatchEvent(beforeRenderEvent);var n=this.getRenderingService();n.render(this.getConfig(),function(){e.dispatchEvent(rerenderEvent)}),this.dispatchEvent(afterRenderEvent)},r.prototype.run=function(){var e=this,n=function(){e.render(),e.frameId=e.requestAnimationFrame(n)};n()},r.prototype.initRenderer=function(e,n){var a=this;if(n===void 0&&(n=!1),!e)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new RBush,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new EventPlugin,new PrepareRendererPlugin,new CullingPlugin([new FrustumCullingStrategy])),this.loadRendererContainerModule(e),this.context.contextService=new this.context.ContextService(__assign(__assign({},runtime),this.context)),this.context.renderingService=new RenderingService(runtime,this.context),this.context.eventService=new EventService(runtime,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(e,n,!0)):this.context.contextService.initAsync().then(function(){a.initRenderingService(e,n)})},r.prototype.initRenderingService=function(e,n,a){var o=this;n===void 0&&(n=!1),a===void 0&&(a=!1),this.context.renderingService.init(function(){o.inited=!0,n?(a?o.requestAnimationFrame(function(){o.dispatchEvent(new CustomEvent(CanvasEvent.READY))}):o.dispatchEvent(new CustomEvent(CanvasEvent.READY)),o.readyPromise&&o.resolveReadyPromise()):o.dispatchEvent(new CustomEvent(CanvasEvent.RENDERER_CHANGED)),n||o.getRoot().forEach(function(s){var l=s.renderable;l&&(l.renderBoundsDirty=!0,l.boundsDirty=!0,l.dirty=!0)}),o.mountChildren(o.getRoot()),e.getConfig().enableAutoRendering&&o.run()})},r.prototype.loadRendererContainerModule=function(e){var n=this,a=e.getPlugins();a.forEach(function(o){o.context=n.context,o.init(runtime)})},r.prototype.setRenderer=function(e){var n=this.getConfig();if(n.renderer!==e){var a=n.renderer;n.renderer=e,this.destroy(!1,!0),__spreadArray([],__read(a==null?void 0:a.getPlugins()),!1).reverse().forEach(function(o){o.destroy(runtime)}),this.initRenderer(e)}},r.prototype.setCursor=function(e){var n=this.getConfig();n.cursor=e,this.getContextService().applyCursorStyle(e)},r.prototype.unmountChildren=function(e){var n=this;e.childNodes.forEach(function(a){n.unmountChildren(a)}),this.inited&&(e.isMutationObserved?e.dispatchEvent(unmountedEvent):(unmountedEvent.target=e,this.dispatchEvent(unmountedEvent,!0)),e!==this.document.documentElement&&(e.ownerDocument=null),e.isConnected=!1),e.isCustomElement&&e.disconnectedCallback&&e.disconnectedCallback()},r.prototype.mountChildren=function(e){var n=this;this.inited?e.isConnected||(e.ownerDocument=this.document,e.isConnected=!0,e.isMutationObserved?e.dispatchEvent(mountedEvent):(mountedEvent.target=e,this.dispatchEvent(mountedEvent,!0))):console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",e.nodeName),e.childNodes.forEach(function(a){n.mountChildren(a)}),e.isCustomElement&&e.connectedCallback&&e.connectedCallback()},r.prototype.client2Viewport=function(e){return this.getEventService().client2Viewport(e)},r.prototype.viewport2Client=function(e){return this.getEventService().viewport2Client(e)},r.prototype.viewport2Canvas=function(e){return this.getEventService().viewport2Canvas(e)},r.prototype.canvas2Viewport=function(e){return this.getEventService().canvas2Viewport(e)},r.prototype.getPointByClient=function(e,n){return this.client2Viewport({x:e,y:n})},r.prototype.getClientByPoint=function(e,n){return this.viewport2Client({x:e,y:n})},r}(EventTarget),AdvancedCamera=function(t){__extends(r,t);function r(){var e=t.apply(this,__spreadArray([],__read(arguments),!1))||this;return e.landmarks=[],e}return r.prototype.rotate=function(e,n,a){if(this.relElevation=getAngle(n),this.relAzimuth=getAngle(e),this.relRoll=getAngle(a),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===CameraType.EXPLORING){var o=setAxisAngle(create$1(),[1,0,0],deg2rad((this.rotateWorld?1:-1)*this.relElevation)),s=setAxisAngle(create$1(),[0,1,0],deg2rad((this.rotateWorld?1:-1)*this.relAzimuth)),l=setAxisAngle(create$1(),[0,0,1],deg2rad(this.relRoll)),u=multiply(create$1(),s,o);u=multiply(create$1(),u,l);var c=fromQuat(create$4(),u);translate(this.matrix,this.matrix,[0,0,-this.distance]),multiply$2(this.matrix,this.matrix,c),translate(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===CameraType.ORBITING||this.type===CameraType.EXPLORING?this._getPosition():this.type===CameraType.TRACKING&&this._getFocalPoint(),this._update(),this},r.prototype.pan=function(e,n){var a=createVec3(e,n,0),o=clone$2(this.position);return add$1(o,o,scale$1(create$3(),this.right,a[0])),add$1(o,o,scale$1(create$3(),this.up,a[1])),this._setPosition(o),this.triggerUpdate(),this},r.prototype.dolly=function(e){var n=this.forward,a=clone$2(this.position),o=e*this.dollyingStep,s=this.distance+e*this.dollyingStep;return o=Math.max(Math.min(s,this.maxDistance),this.minDistance)-this.distance,a[0]+=o*n[0],a[1]+=o*n[1],a[2]+=o*n[2],this._setPosition(a),this.type===CameraType.ORBITING||this.type===CameraType.EXPLORING?this._getDistance():this.type===CameraType.TRACKING&&add$1(this.focalPoint,a,this.distanceVector),this.triggerUpdate(),this},r.prototype.cancelLandmarkAnimation=function(){this.landmarkAnimationID!==void 0&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)},r.prototype.createLandmark=function(e,n){var a,o,s,l;n===void 0&&(n={});var u=n.position,c=u===void 0?this.position:u,d=n.focalPoint,f=d===void 0?this.focalPoint:d,h=n.roll,p=n.zoom,v=new runtime.CameraContribution;v.setType(this.type,void 0),v.setPosition(c[0],(a=c[1])!==null&&a!==void 0?a:this.position[1],(o=c[2])!==null&&o!==void 0?o:this.position[2]),v.setFocalPoint(f[0],(s=f[1])!==null&&s!==void 0?s:this.focalPoint[1],(l=f[2])!==null&&l!==void 0?l:this.focalPoint[2]),v.setRoll(h??this.roll),v.setZoom(p??this.zoom);var g={name:e,matrix:clone$3(v.getWorldTransform()),right:clone$2(v.right),up:clone$2(v.up),forward:clone$2(v.forward),position:clone$2(v.getPosition()),focalPoint:clone$2(v.getFocalPoint()),distanceVector:clone$2(v.getDistanceVector()),distance:v.getDistance(),dollyingStep:v.getDollyingStep(),azimuth:v.getAzimuth(),elevation:v.getElevation(),roll:v.getRoll(),relAzimuth:v.relAzimuth,relElevation:v.relElevation,relRoll:v.relRoll,zoom:v.getZoom()};return this.landmarks.push(g),g},r.prototype.gotoLandmark=function(e,n){var a=this;n===void 0&&(n={});var o=isString$1(e)?this.landmarks.find(function(D){return D.name===e}):e;if(o){var s=isNumber$1(n)?{duration:n}:n,l=s.easing,u=l===void 0?"linear":l,c=s.duration,d=c===void 0?100:c,f=s.easingFunction,h=f===void 0?void 0:f,p=s.onfinish,v=p===void 0?void 0:p,g=s.onframe,y=g===void 0?void 0:g,m=.01;if(d===0){this.syncFromLandmark(o),v&&v();return}this.cancelLandmarkAnimation();var S=o.position,w=o.focalPoint,R=o.zoom,T=o.roll,x=h||runtime.EasingFunction(u),b,L=function(){a.setFocalPoint(w),a.setPosition(S),a.setRoll(T),a.setZoom(R),a.computeMatrix(),a.triggerUpdate(),v&&v()},M=function(D){b===void 0&&(b=D);var N=D-b;if(N>d){L();return}var F=x(N/d),k=create$3(),H=create$3(),G=1,z=0;lerp(k,a.focalPoint,w,F),lerp(H,a.position,S,F),z=a.roll*(1-F)+T*F,G=a.zoom*(1-F)+R*F,a.setFocalPoint(k),a.setPosition(H),a.setRoll(z),a.setZoom(G);var $=dist(k,w)+dist(H,S);if($<=m&&R==null&&T==null){L();return}a.computeMatrix(),a.triggerUpdate(),N<d&&(y&&y(F),a.landmarkAnimationID=a.canvas.requestAnimationFrame(M))};this.canvas.requestAnimationFrame(M)}},r.prototype.syncFromLandmark=function(e){this.matrix=copy$4(this.matrix,e.matrix),this.right=copy$3(this.right,e.right),this.up=copy$3(this.up,e.up),this.forward=copy$3(this.forward,e.forward),this.position=copy$3(this.position,e.position),this.focalPoint=copy$3(this.focalPoint,e.focalPoint),this.distanceVector=copy$3(this.distanceVector,e.distanceVector),this.azimuth=e.azimuth,this.elevation=e.elevation,this.roll=e.roll,this.relAzimuth=e.relAzimuth,this.relElevation=e.relElevation,this.relRoll=e.relRoll,this.dollyingStep=e.dollyingStep,this.distance=e.distance,this.zoom=e.zoom},r}(Camera);runtime.CameraContribution=AdvancedCamera;var AnimationEvent=function(t){__extends(r,t);function r(e,n,a,o){var s=t.call(this,e)||this;return s.currentTime=a,s.timelineTime=o,s.target=n,s.type="finish",s.bubbles=!1,s.currentTarget=n,s.defaultPrevented=!1,s.eventPhase=s.AT_TARGET,s.timeStamp=Date.now(),s.currentTime=a,s.timelineTime=o,s}return r}(FederatedEvent),sequenceNumber=0,Animation=function(){function t(r,e){var n;this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=r,r.animation=this,this.timeline=e,this.id="".concat(sequenceNumber++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number((n=this.effect)===null||n===void 0?void 0:n.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}return Object.defineProperty(t.prototype,"pending",{get:function(){return this._startTime===null&&!this._paused&&this.playbackRate!==0||this.currentTimePending},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playState",{get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ready",{get:function(){var r=this;return this.readyPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(e,n){r.resolveReadyPromise=function(){e(r)},r.rejectReadyPromise=function(){n(new Error)}}),this.pending||this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"finished",{get:function(){var r=this;return this.finishedPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(e,n){r.resolveFinishedPromise=function(){e(r)},r.rejectFinishedPromise=function(){n(new Error)}}),this.playState==="finished"&&this.resolveFinishedPromise()),this.finishedPromise},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentTime",{get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(r){var e;r=Number(r),!isNaN(r)&&(this.timeline.restart(),!this._paused&&this._startTime!==null&&(this._startTime=Number((e=this.timeline)===null||e===void 0?void 0:e.currentTime)-r/this.playbackRate),this.currentTimePending=!1,this._currentTime!==r&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(r,!0),this.timeline.applyDirtiedAnimation(this)))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"startTime",{get:function(){return this._startTime},set:function(r){if(r!==null){if(this.updatePromises(),r=Number(r),isNaN(r)||this._paused||this._idle)return;this._startTime=r,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(r){if(r!==this._playbackRate){this.updatePromises();var e=this.currentTime;this._playbackRate=r,this.startTime=null,this.playState!=="paused"&&this.playState!=="idle"&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),e!==null&&(this.currentTime=e),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isFinished",{get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalDuration",{get:function(){return this._totalDuration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_needsTick",{get:function(){return this.pending||this.playState==="running"||!this._finishedFlag},enumerable:!1,configurable:!0}),t.prototype.updatePromises=function(){var r=this.oldPlayState,e=this.pending?"pending":this.playState;return this.readyPromise&&e!==r&&(e==="idle"?(this.rejectReadyPromise(),this.readyPromise=void 0):r==="pending"?this.resolveReadyPromise():e==="pending"&&(this.readyPromise=void 0)),this.finishedPromise&&e!==r&&(e==="idle"?(this.rejectFinishedPromise(),this.finishedPromise=void 0):e==="finished"?this.resolveFinishedPromise():r==="finished"&&(this.finishedPromise=void 0)),this.oldPlayState=e,this.readyPromise||this.finishedPromise},t.prototype.play=function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),this.timeline.animations.indexOf(this)===-1&&this.timeline.animations.push(this),this.updatePromises()},t.prototype.pause=function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),!this._isFinished&&!this._paused&&!this._idle?this.currentTimePending=!0:this._idle&&(this.rewind(),this._idle=!1),this._startTime=null,this._paused=!0,this.updatePromises()},t.prototype.finish=function(){this.updatePromises(),!this._idle&&(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())},t.prototype.cancel=function(){var r=this;if(this.updatePromises(),!!this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var e=new AnimationEvent(null,this,this.currentTime,null);setTimeout(function(){r.oncancel(e)})}},t.prototype.reverse=function(){this.updatePromises();var r=this.currentTime;this.playbackRate*=-1,this.play(),r!==null&&(this.currentTime=r),this.updatePromises()},t.prototype.updatePlaybackRate=function(r){this.playbackRate=r},t.prototype.targetAnimations=function(){var r,e=(r=this.effect)===null||r===void 0?void 0:r.target;return e.getAnimations()},t.prototype.markTarget=function(){var r=this.targetAnimations();r.indexOf(this)===-1&&r.push(this)},t.prototype.unmarkTarget=function(){var r=this.targetAnimations(),e=r.indexOf(this);e!==-1&&r.splice(e,1)},t.prototype.tick=function(r,e){!this._idle&&!this._paused&&(this._startTime===null?e&&(this.startTime=r-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((r-this._startTime)*this.playbackRate)),e&&(this.currentTimePending=!1,this.fireEvents(r))},t.prototype.rewind=function(){if(this.playbackRate>=0)this.currentTime=0;else if(this._totalDuration<1/0)this.currentTime=this._totalDuration;else throw new Error("Unable to rewind negative playback rate animation with infinite duration")},t.prototype.persist=function(){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},t.prototype.addEventListener=function(r,e,n){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},t.prototype.removeEventListener=function(r,e,n){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},t.prototype.dispatchEvent=function(r){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},t.prototype.commitStyles=function(){throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED)},t.prototype.ensureAlive=function(){var r,e;this.playbackRate<0&&this.currentTime===0?this._inEffect=!!(!((r=this.effect)===null||r===void 0)&&r.update(-1)):this._inEffect=!!(!((e=this.effect)===null||e===void 0)&&e.update(this.currentTime)),!this._inTimeline&&(this._inEffect||!this._finishedFlag)&&(this._inTimeline=!0,this.timeline.animations.push(this))},t.prototype.tickCurrentTime=function(r,e){r!==this._currentTime&&(this._currentTime=r,this._isFinished&&!e&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())},t.prototype.fireEvents=function(r){var e=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var n=new AnimationEvent(null,this,this.currentTime,r);setTimeout(function(){e.onfinish&&e.onfinish(n)})}this._finishedFlag=!0}}else{if(this.onframe&&this.playState==="running"){var a=new AnimationEvent(null,this,this.currentTime,r);this.onframe(a)}this._finishedFlag=!1}},t}(),NEWTON_ITERATIONS=4,NEWTON_MIN_SLOPE=.001,SUBDIVISION_PRECISION=1e-7,SUBDIVISION_MAX_ITERATIONS=10,kSplineTableSize=11,kSampleStepSize=1/(kSplineTableSize-1),float32ArraySupported=typeof Float32Array=="function",A=function(t,r){return 1-3*r+3*t},B=function(t,r){return 3*r-6*t},C=function(t){return 3*t},calcBezier=function(t,r,e){return((A(r,e)*t+B(r,e))*t+C(r))*t},getSlope=function(t,r,e){return 3*A(r,e)*t*t+2*B(r,e)*t+C(r)},binarySubdivide=function(t,r,e,n,a){var o,s,l=0;do s=r+(e-r)/2,o=calcBezier(s,n,a)-t,o>0?e=s:r=s;while(Math.abs(o)>SUBDIVISION_PRECISION&&++l<SUBDIVISION_MAX_ITERATIONS);return s},newtonRaphsonIterate=function(t,r,e,n){for(var a=0;a<NEWTON_ITERATIONS;++a){var o=getSlope(r,e,n);if(o===0)return r;var s=calcBezier(r,e,n)-t;r-=s/o}return r},bezier=function(t,r,e,n){if(!(0<=t&&t<=1&&0<=e&&e<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===r&&e===n)return function(l){return l};for(var a=float32ArraySupported?new Float32Array(kSplineTableSize):new Array(kSplineTableSize),o=0;o<kSplineTableSize;++o)a[o]=calcBezier(o*kSampleStepSize,t,e);var s=function(l){for(var u=0,c=1,d=kSplineTableSize-1;c!==d&&a[c]<=l;++c)u+=kSampleStepSize;--c;var f=(l-a[c])/(a[c+1]-a[c]),h=u+f*kSampleStepSize,p=getSlope(h,t,e);return p>=NEWTON_MIN_SLOPE?newtonRaphsonIterate(l,h,t,e):p===0?h:binarySubdivide(l,u,u+kSampleStepSize,t,e)};return function(l){return l===0||l===1?l:calcBezier(s(l),r,n)}},convertToDash=function(t){return t=t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())}),t.charAt(0)==="-"?t.substring(1):t},Quad=function(t){return Math.pow(t,2)},Cubic=function(t){return Math.pow(t,3)},Quart=function(t){return Math.pow(t,4)},Quint=function(t){return Math.pow(t,5)},Expo=function(t){return Math.pow(t,6)},Sine=function(t){return 1-Math.cos(t*Math.PI/2)},Circ=function(t){return 1-Math.sqrt(1-t*t)},Back=function(t){return t*t*(3*t-2)},Bounce=function(t){for(var r,e=4;t<((r=Math.pow(2,--e))-1)/11;);return 1/Math.pow(4,3-e)-7.5625*Math.pow((r*3-2)/22-t,2)},Elastic=function(t,r){r===void 0&&(r=[]);var e=__read(r,2),n=e[0],a=n===void 0?1:n,o=e[1],s=o===void 0?.5:o,l=clamp$2(Number(a),1,10),u=clamp$2(Number(s),.1,2);return t===0||t===1?t:-l*Math.pow(2,10*(t-1))*Math.sin((t-1-u/(Math.PI*2)*Math.asin(1/l))*(Math.PI*2)/u)},Spring=function(t,r,e){r===void 0&&(r=[]);var n=__read(r,4),a=n[0],o=a===void 0?1:a,s=n[1],l=s===void 0?100:s,u=n[2],c=u===void 0?10:u,d=n[3],f=d===void 0?0:d;o=clamp$2(o,.1,1e3),l=clamp$2(l,.1,1e3),c=clamp$2(c,.1,1e3),f=clamp$2(f,.1,1e3);var h=Math.sqrt(l/o),p=c/(2*Math.sqrt(l*o)),v=p<1?h*Math.sqrt(1-p*p):0,g=1,y=p<1?(p*h+-f)/v:-f+h,m=e?e*t/1e3:t;return p<1?m=Math.exp(-m*p*h)*(g*Math.cos(v*m)+y*Math.sin(v*m)):m=(g+y*m)*Math.exp(-m*h),t===0||t===1?t:1-m},Steps=function(t,r){r===void 0&&(r=[]);var e=__read(r,2),n=e[0],a=n===void 0?10:n,o=e[1],s=o=="start"?Math.ceil:Math.floor;return s(clamp$2(t,0,1)*a)/a},Bezier=function(t,r){r===void 0&&(r=[]);var e=__read(r,4),n=e[0],a=e[1],o=e[2],s=e[3];return bezier(n,a,o,s)(t)},easein=bezier(.42,0,1,1),EaseOut=function(t){return function(r,e,n){return e===void 0&&(e=[]),1-t(1-r,e,n)}},EaseInOut=function(t){return function(r,e,n){return e===void 0&&(e=[]),r<.5?t(r*2,e,n)/2:1-t(r*-2+2,e,n)/2}},EaseOutIn=function(t){return function(r,e,n){return e===void 0&&(e=[]),r<.5?(1-t(1-r*2,e,n))/2:(t(r*2-1,e,n)+1)/2}},EasingFunctions={steps:Steps,"step-start":function(t){return Steps(t,[1,"start"])},"step-end":function(t){return Steps(t,[1,"end"])},linear:function(t){return t},"cubic-bezier":Bezier,ease:function(t){return Bezier(t,[.25,.1,.25,1])},in:easein,out:EaseOut(easein),"in-out":EaseInOut(easein),"out-in":EaseOutIn(easein),"in-quad":Quad,"out-quad":EaseOut(Quad),"in-out-quad":EaseInOut(Quad),"out-in-quad":EaseOutIn(Quad),"in-cubic":Cubic,"out-cubic":EaseOut(Cubic),"in-out-cubic":EaseInOut(Cubic),"out-in-cubic":EaseOutIn(Cubic),"in-quart":Quart,"out-quart":EaseOut(Quart),"in-out-quart":EaseInOut(Quart),"out-in-quart":EaseOutIn(Quart),"in-quint":Quint,"out-quint":EaseOut(Quint),"in-out-quint":EaseInOut(Quint),"out-in-quint":EaseOutIn(Quint),"in-expo":Expo,"out-expo":EaseOut(Expo),"in-out-expo":EaseInOut(Expo),"out-in-expo":EaseOutIn(Expo),"in-sine":Sine,"out-sine":EaseOut(Sine),"in-out-sine":EaseInOut(Sine),"out-in-sine":EaseOutIn(Sine),"in-circ":Circ,"out-circ":EaseOut(Circ),"in-out-circ":EaseInOut(Circ),"out-in-circ":EaseOutIn(Circ),"in-back":Back,"out-back":EaseOut(Back),"in-out-back":EaseInOut(Back),"out-in-back":EaseOutIn(Back),"in-bounce":Bounce,"out-bounce":EaseOut(Bounce),"in-out-bounce":EaseInOut(Bounce),"out-in-bounce":EaseOutIn(Bounce),"in-elastic":Elastic,"out-elastic":EaseOut(Elastic),"in-out-elastic":EaseInOut(Elastic),"out-in-elastic":EaseOutIn(Elastic),spring:Spring,"spring-in":Spring,"spring-out":EaseOut(Spring),"spring-in-out":EaseInOut(Spring),"spring-out-in":EaseOutIn(Spring)},complexEasingSyntax=function(t){return convertToDash(t).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()},getEasingFunction=function(t){return EasingFunctions[complexEasingSyntax(t)]||EasingFunctions.linear},linear$1=function(t){return t},Start=1,Middle=.5,End=0;function step(t,r){return function(e){if(e>=1)return 1;var n=1/t;return e+=r*n,e-e%n}}var numberString="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",cubicBezierRe=new RegExp("cubic-bezier\\("+numberString+","+numberString+","+numberString+","+numberString+"\\)"),step1Re=/steps\(\s*(\d+)\s*\)/,step2Re=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function parseEasingFunction(t){var r=cubicBezierRe.exec(t);if(r)return bezier.apply(void 0,__spreadArray([],__read(r.slice(1).map(Number)),!1));var e=step1Re.exec(t);if(e)return step(Number(e[1]),End);var n=step2Re.exec(t);return n?step(Number(n[1]),{start:Start,middle:Middle,end:End}[n[2]]):getEasingFunction(t)}function calculateActiveDuration(t){return Math.abs(repeatedDuration(t)/(t.playbackRate||1))}function repeatedDuration(t){var r;return t.duration===0||t.iterations===0?0:(t.duration==="auto"?0:Number(t.duration))*((r=t.iterations)!==null&&r!==void 0?r:1)}var PhaseNone=0,PhaseBefore=1,PhaseAfter=2,PhaseActive=3;function calculatePhase(t,r,e){if(r===null)return PhaseNone;var n=e.endTime;return r<Math.min(e.delay,n)?PhaseBefore:r>=Math.min(e.delay+t+e.endDelay,n)?PhaseAfter:PhaseActive}function calculateActiveTime(t,r,e,n,a){switch(n){case PhaseBefore:return r==="backwards"||r==="both"?0:null;case PhaseActive:return e-a;case PhaseAfter:return r==="forwards"||r==="both"?t:null;case PhaseNone:return null}}function calculateOverallProgress(t,r,e,n,a){var o=a;return t===0?r!==PhaseBefore&&(o+=e):o+=n/t,o}function calculateSimpleIterationProgress(t,r,e,n,a,o){var s=t===1/0?r%1:t%1;return s===0&&e===PhaseAfter&&n!==0&&(a!==0||o===0)&&(s=1),s}function calculateCurrentIteration(t,r,e,n){return t===PhaseAfter&&r===1/0?1/0:e===1?Math.floor(n)-1:Math.floor(n)}function calculateDirectedProgress(t,r,e){var n=t;if(t!=="normal"&&t!=="reverse"){var a=r;t==="alternate-reverse"&&(a+=1),n="normal",a!==1/0&&a%2!==0&&(n="reverse")}return n==="normal"?e:1-e}function calculateIterationProgress(t,r,e){var n=calculatePhase(t,r,e),a=calculateActiveTime(t,e.fill,r,n,e.delay);if(a===null)return null;var o=e.duration==="auto"?0:e.duration,s=calculateOverallProgress(o,n,e.iterations,a,e.iterationStart),l=calculateSimpleIterationProgress(s,e.iterationStart,n,e.iterations,a,o),u=calculateCurrentIteration(n,e.iterations,l,s),c=calculateDirectedProgress(e.direction,u,l);return e.currentIteration=u,e.progress=c,e.easingFunction(c)}function convertEffectInput(t,r,e){var n=makePropertySpecificKeyframeGroups(t,r),a=makeInterpolations(n,e);return function(o,s){if(s!==null)a.filter(function(u){return s>=u.applyFrom&&s<u.applyTo}).forEach(function(u){var c=s-u.startOffset,d=u.endOffset-u.startOffset,f=d===0?0:u.easingFunction(c/d);o.setAttribute(u.property,u.interpolation(f),!1,!1)});else for(var l in n)isNotReservedWord(l)&&o.setAttribute(l,null)}}function isNotReservedWord(t){return t!=="offset"&&t!=="easing"&&t!=="composite"&&t!=="computedOffset"}function makePropertySpecificKeyframeGroups(t,r){for(var e={},n=0;n<t.length;n++)for(var a in t[n])if(isNotReservedWord(a)){var o={offset:t[n].offset,computedOffset:t[n].computedOffset,easing:t[n].easing,easingFunction:parseEasingFunction(t[n].easing)||r.easingFunction,value:t[n][a]};e[a]=e[a]||[],e[a].push(o)}return e}function makeInterpolations(t,r){var e=[];for(var n in t)for(var a=t[n],o=0;o<a.length-1;o++){var s=o,l=o+1,u=a[s].computedOffset,c=a[l].computedOffset,d=u,f=c;o===0&&(d=-1/0,c===0&&(l=s)),o===a.length-2&&(f=1/0,u===1&&(s=l)),e.push({applyFrom:d,applyTo:f,startOffset:a[s].computedOffset,endOffset:a[l].computedOffset,easingFunction:a[s].easingFunction,property:n,interpolation:propertyInterpolation(n,a[s].value,a[l].value,r)})}return e.sort(function(h,p){return h.startOffset-p.startOffset}),e}var InterpolationFactory=function(t,r,e){return function(n){var a=interpolate(t,r,n);return!runtime.enableCSSParsing&&isNumber$1(a)?a:e(a)}};function propertyInterpolation(t,r,e,n){var a=propertyMetadataCache[t];if(a&&a.syntax&&a.int){var o=runtime.styleValueRegistry.getPropertySyntax(a.syntax);if(o){var s=void 0,l=void 0;if(runtime.enableCSSParsing){var u=runtime.styleValueRegistry.parseProperty(t,r,n,!1),c=runtime.styleValueRegistry.parseProperty(t,e,n,!1);s=runtime.styleValueRegistry.computeProperty(t,u,n,!1),l=runtime.styleValueRegistry.computeProperty(t,c,n,!1)}else{var d=o.parserWithCSSDisabled;s=d?d(r,n):r,l=d?d(e,n):e}var f=o.mixer(s,l,n);if(f){var h=InterpolationFactory.apply(void 0,__spreadArray([],__read(f),!1));return function(p){return p===0?r:p===1?e:h(p)}}}}return InterpolationFactory(!1,!0,function(p){return p?e:r})}function interpolate(t,r,e){if(typeof t=="number"&&typeof r=="number")return t*(1-e)+r*e;if(typeof t=="boolean"&&typeof r=="boolean"||typeof t=="string"&&typeof r=="string")return e<.5?t:r;if(Array.isArray(t)&&Array.isArray(r)){for(var n=t.length,a=r.length,o=Math.max(n,a),s=[],l=0;l<o;l++)s.push(interpolate(t[l<n?l:n-1],r[l<a?l:a-1],e));return s}throw new Error("Mismatched interpolation arguments "+t+":"+r)}var AnimationEffectTiming=function(){function t(){this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=linear$1,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}return Object.defineProperty(t.prototype,"easing",{get:function(){return this._easing},set:function(r){this.easingFunction=parseEasingFunction(r),this._easing=r},enumerable:!1,configurable:!0}),t}();function convertToArrayForm(t){var r=[];for(var e in t)if(!(e in["easing","offset","composite"])){var n=t[e];Array.isArray(n)||(n=[n]);for(var a=n.length,o=0;o<a;o++){if(!r[o]){var s={};"offset"in t&&(s.offset=Number(t.offset)),"easing"in t&&(s.easing=t.easing),"composite"in t&&(s.composite=t.composite),r[o]=s}n[o]!==void 0&&n[o]!==null&&(r[o][e]=n[o])}}return r.sort(function(l,u){return(l.computedOffset||0)-(u.computedOffset||0)}),r}function normalizeKeyframes(t,r){if(t===null)return[];Array.isArray(t)||(t=convertToArrayForm(t));for(var e=t.map(function(u){var c={};r!=null&&r.composite&&(c.composite="auto");for(var d in u){var f=u[d];if(d==="offset"){if(f!==null){if(f=Number(f),!isFinite(f))throw new Error("Keyframe offsets must be numbers.");if(f<0||f>1)throw new Error("Keyframe offsets must be between 0 and 1.");c.computedOffset=f}}else if(d==="composite"&&["replace","add","accumulate","auto"].indexOf(f)===-1)throw new Error("".concat(f," compositing is not supported"));c[d]=f}return c.offset===void 0&&(c.offset=null),c.easing===void 0&&(c.easing=(r==null?void 0:r.easing)||"linear"),c.composite===void 0&&(c.composite="auto"),c}),n=!0,a=-1/0,o=0;o<e.length;o++){var s=e[o].offset;if(isNil$1(s))n=!1;else{if(s<a)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");a=s}}e=e.filter(function(u){return Number(u.offset)>=0&&Number(u.offset)<=1});function l(){var u,c,d=e.length;e[d-1].computedOffset=Number((u=e[d-1].offset)!==null&&u!==void 0?u:1),d>1&&(e[0].computedOffset=Number((c=e[0].offset)!==null&&c!==void 0?c:0));for(var f=0,h=Number(e[0].computedOffset),p=1;p<d;p++){var v=e[p].computedOffset;if(!isNil$1(v)&&!isNil$1(h)){for(var g=1;g<p-f;g++)e[f+g].computedOffset=h+(Number(v)-h)*g/(p-f);f=p,h=Number(v)}}}return n||l(),e}var fills="backwards|forwards|both|none".split("|"),directions="reverse|alternate|alternate-reverse".split("|");function makeTiming(t,r){var e=new AnimationEffectTiming;return r&&(e.fill="both",e.duration="auto"),typeof t=="number"&&!isNaN(t)?e.duration=t:t!==void 0&&Object.keys(t).forEach(function(n){if(t[n]!==void 0&&t[n]!==null&&t[n]!=="auto"){if((typeof e[n]=="number"||n==="duration")&&(typeof t[n]!="number"||isNaN(t[n]))||n==="fill"&&fills.indexOf(t[n])===-1||n==="direction"&&directions.indexOf(t[n])===-1)return;e[n]=t[n]}}),e}function normalizeTimingInput(t,r){return t=numericTimingToObject(t??{duration:"auto"}),makeTiming(t,r)}function numericTimingToObject(t){return typeof t=="number"&&(isNaN(t)?t={duration:"auto"}:t={duration:t}),t}var KeyframeEffect=function(){function t(r,e,n){var a=this;this.composite="replace",this.iterationComposite="replace",this.target=r,this.timing=normalizeTimingInput(n,!1),this.timing.effect=this,this.timing.activeDuration=calculateActiveDuration(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=normalizeKeyframes(e,this.timing),this.interpolations=convertEffectInput(this.normalizedKeyframes,this.timing,this.target);var o=runtime.globalThis.Proxy;this.computedTiming=o?new o(this.timing,{get:function(s,l){return l==="duration"?s.duration==="auto"?0:s.duration:l==="fill"?s.fill==="auto"?"none":s.fill:l==="localTime"?a.animation&&a.animation.currentTime||null:l==="currentIteration"?!a.animation||a.animation.playState!=="running"?null:s.currentIteration||0:l==="progress"?!a.animation||a.animation.playState!=="running"?null:s.progress||0:s[l]},set:function(){return!0}}):this.timing}return t.prototype.applyInterpolations=function(){this.interpolations(this.target,Number(this.timeFraction))},t.prototype.update=function(r){return r===null?!1:(this.timeFraction=calculateIterationProgress(this.timing.activeDuration,r,this.timing),this.timeFraction!==null)},t.prototype.getKeyframes=function(){return this.normalizedKeyframes},t.prototype.setKeyframes=function(r){this.normalizedKeyframes=normalizeKeyframes(r)},t.prototype.getComputedTiming=function(){return this.computedTiming},t.prototype.getTiming=function(){return this.timing},t.prototype.updateTiming=function(r){var e=this;Object.keys(r||{}).forEach(function(n){e.timing[n]=r[n]})},t}();function compareAnimations(t,r){return Number(t.id)-Number(r.id)}var AnimationTimeline=function(){function t(r){var e=this;this.document=r,this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(n){e.currentTime=n,e.discardAnimations(),e.animations.length===0?e.timelineTicking=!1:e.requestAnimationFrame(e.webAnimationsNextTick)},this.processRafCallbacks=function(n){var a=e.rafCallbacks;e.rafCallbacks=[],n<Number(e.currentTime)&&(n=Number(e.currentTime)),e.animations.sort(compareAnimations),e.animations=e.tick(n,!0,e.animations)[0],a.forEach(function(o){o[1](n)}),e.applyPendingEffects()}}return t.prototype.getAnimations=function(){return this.discardAnimations(),this.animations.slice()},t.prototype.isTicking=function(){return this.inTick},t.prototype.play=function(r,e,n){var a=new KeyframeEffect(r,e,n),o=new Animation(a,this);return this.animations.push(o),this.restartWebAnimationsNextTick(),o.updatePromises(),o.play(),o.updatePromises(),o},t.prototype.applyDirtiedAnimation=function(r){var e=this;if(!this.inTick){r.markTarget();var n=r.targetAnimations();n.sort(compareAnimations);var a=this.tick(Number(this.currentTime),!1,n.slice())[1];a.forEach(function(o){var s=e.animations.indexOf(o);s!==-1&&e.animations.splice(s,1)}),this.applyPendingEffects()}},t.prototype.restart=function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame},t.prototype.destroy=function(){this.document.defaultView.cancelAnimationFrame(this.frameId)},t.prototype.applyPendingEffects=function(){this.pendingEffects.forEach(function(r){r==null||r.applyInterpolations()}),this.pendingEffects=[]},t.prototype.updateAnimationsPromises=function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(r){return r.updatePromises()})},t.prototype.discardAnimations=function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(r){return r.playState!=="finished"&&r.playState!=="idle"})},t.prototype.restartWebAnimationsNextTick=function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))},t.prototype.rAF=function(r){var e=this.rafId++;return this.rafCallbacks.length===0&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([e,r]),e},t.prototype.requestAnimationFrame=function(r){var e=this;return this.rAF(function(n){e.updateAnimationsPromises(),r(n),e.updateAnimationsPromises()})},t.prototype.tick=function(r,e,n){var a,o,s=this;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=r,this.ticking=!1;var l=[],u=[],c=[],d=[];return n.forEach(function(f){f.tick(r,e),f._inEffect?(u.push(f.effect),f.markTarget()):(l.push(f.effect),f.unmarkTarget()),f._needsTick&&(s.ticking=!0);var h=f._inEffect||f._needsTick;f._inTimeline=h,h?c.push(f):d.push(f)}),(a=this.pendingEffects).push.apply(a,__spreadArray([],__read(l),!1)),(o=this.pendingEffects).push.apply(o,__spreadArray([],__read(u),!1)),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[c,d]},t}();runtime.EasingFunction=parseEasingFunction;runtime.AnimationTimeline=AnimationTimeline;var VALUE_FIELD="$$value$$",EXTRA_FIELD="$$extra$$",ORIGIN_FIELD="$$origin$$",EXTRA_COLUMN_FIELD="$$extra_column$$",TOTAL_VALUE="$$total$$",MULTI_VALUE="$$multi$$",SERIES_NUMBER_FIELD="$$series_number$$",EMPTY_FIELD_VALUE="$$empty_field_value$$",EMPTY_EXTRA_FIELD_PLACEHOLDER="$$empty_extra_placeholder$$",NULL_SYMBOL_ID="$$null$$",UNDEFINED_SYMBOL_ID="$$undefined$$",InteractionEvent;(function(t){t.DATA_CELL_CLICK_EVENT="interaction:data-cell-click",t.MERGED_CELLS_CLICK_EVENT="interaction:merged-cells-click",t.CORNER_TEXT_CLICK_EVENT="interaction:corner-cell-text-click",t.ROW_COLUMN_CLICK_EVENT="interaction:row-column-click",t.ROW_TEXT_CLICK_EVENT="interaction:row-text-click",t.HOVER_EVENT="interaction:hover"})(InteractionEvent||(InteractionEvent={}));var OriginEventType;(function(t){t.MOUSE_DOWN="mousedown",t.MOUSE_MOVE="mousemove",t.MOUSE_UP="mouseup",t.MOUSE_OUT="mouseout",t.MOUSE_LEAVE="mouseleave",t.TOUCH_START="touchstart",t.KEY_DOWN="keydown",t.KEY_UP="keyup",t.CLICK="click",t.HOVER="hover",t.DOUBLE_CLICK="dblclick",t.CONTEXT_MENU="contextmenu",t.POINTER_DOWN="pointerdown",t.POINTER_MOVE="pointermove",t.POINTER_OUT="pointerout",t.POINTER_LEAVE="pointerleave",t.POINTER_UP="pointerup",t.POINTER_CANCEL="pointercancel",t.POINTER_ENTER="pointerenter",t.POINTER_OVER="pointerover"})(OriginEventType||(OriginEventType={}));var S2Event;(function(t){t.ROW_CELL_HOVER="row-cell:hover",t.ROW_CELL_CLICK="row-cell:click",t.ROW_CELL_DOUBLE_CLICK="row-cell:double-click",t.ROW_CELL_CONTEXT_MENU="row-cell:context-menu",t.ROW_CELL_MOUSE_DOWN="row-cell:mouse-down",t.ROW_CELL_MOUSE_UP="row-cell:mouse-up",t.ROW_CELL_MOUSE_MOVE="row-cell:mouse-move",t.ROW_CELL_SCROLL="row-cell:scroll",t.ROW_CELL_BRUSH_SELECTION="row-cell:brush-selection",t.ROW_CELL_COLLAPSED="row-cell:collapsed",t.ROW_CELL_ALL_COLLAPSED="row-cell:all-collapsed",t.ROW_CELL_RENDER="row-cell:render",t.ROW_CELL_COLLAPSED__PRIVATE="row-cell:collapsed__private",t.ROW_CELL_ALL_COLLAPSED__PRIVATE="row-cell:all-collapsed__private",t.COL_CELL_HOVER="col-cell:hover",t.COL_CELL_CLICK="col-cell:click",t.COL_CELL_DOUBLE_CLICK="col-cell:double-click",t.COL_CELL_CONTEXT_MENU="col-cell:context-menu",t.COL_CELL_MOUSE_DOWN="col-cell:mouse-down",t.COL_CELL_MOUSE_UP="col-cell:mouse-up",t.COL_CELL_MOUSE_MOVE="col-cell:mouse-move",t.COL_CELL_BRUSH_SELECTION="col-cell:brush-selection",t.COL_CELL_EXPANDED="col-cell:expanded",t.COL_CELL_HIDDEN="col-cell:hidden",t.COL_CELL_RENDER="col-cell:render",t.DATA_CELL_HOVER="data-cell:hover",t.DATA_CELL_CLICK="data-cell:click",t.DATA_CELL_DOUBLE_CLICK="data-cell:double-click",t.DATA_CELL_CONTEXT_MENU="data-cell:context-menu",t.DATA_CELL_MOUSE_UP="data-cell:mouse-up",t.DATA_CELL_MOUSE_DOWN="data-cell:mouse-down",t.DATA_CELL_MOUSE_MOVE="data-cell:mouse-move",t.DATA_CELL_BRUSH_SELECTION="data-cell:brush-selection",t.DATA_CELL_SELECT_MOVE="data-cell:select-move",t.DATA_CELL_RENDER="data-cell:render",t.CORNER_CELL_HOVER="corner-cell:hover",t.CORNER_CELL_CLICK="corner-cell:click",t.CORNER_CELL_DOUBLE_CLICK="corner-cell:double-click",t.CORNER_CELL_CONTEXT_MENU="corner-cell:context-menu",t.CORNER_CELL_MOUSE_DOWN="corner-cell:mouse-down",t.CORNER_CELL_MOUSE_UP="corner-cell:mouse-up",t.CORNER_CELL_MOUSE_MOVE="corner-cell:mouse-move",t.CORNER_CELL_RENDER="corner-cell:render",t.MERGED_CELLS_HOVER="merged-cells:hover",t.MERGED_CELLS_CLICK="merged-cells:click",t.MERGED_CELLS_DOUBLE_CLICK="merged-cells:double-click",t.MERGED_CELLS_CONTEXT_MENU="merged-cells:context-menu",t.MERGED_CELLS_MOUSE_DOWN="merged-cells:mouse-down",t.MERGED_CELLS_MOUSE_UP="merged-cells:mouse-up",t.MERGED_CELLS_MOUSE_MOVE="merged-cells:mouse-move",t.MERGED_CELLS_RENDER="merged-cells:render",t.SERIES_NUMBER_CELL_RENDER="series-number-cell:render",t.RANGE_SORT="sort:range-sort",t.RANGE_SORTED="sort:range-sorted",t.RANGE_FILTER="filter:range-filter",t.RANGE_FILTERED="filter:range-filtered",t.LAYOUT_AFTER_HEADER_LAYOUT="layout:after-header-layout",t.LAYOUT_CELL_RENDER="layout:cell-render",t.LAYOUT_PAGINATION="layout:pagination",t.LAYOUT_AFTER_REAL_DATA_CELL_RENDER="layout:after-real-data-cell-render",t.LAYOUT_AFTER_RENDER="layout:after-render",t.LAYOUT_BEFORE_RENDER="layout:before-render",t.LAYOUT_DESTROY="layout:destroy",t.LAYOUT_RESIZE="layout:resize",t.LAYOUT_RESIZE_SERIES_WIDTH="layout:resize-series-width",t.LAYOUT_RESIZE_ROW_WIDTH="layout:resize-row-width",t.LAYOUT_RESIZE_ROW_HEIGHT="layout:resize-row-height",t.LAYOUT_RESIZE_COL_WIDTH="layout:resize-column-width",t.LAYOUT_RESIZE_COL_HEIGHT="layout:resize-column-height",t.LAYOUT_RESIZE_TREE_WIDTH="layout:resize-tree-width",t.LAYOUT_RESIZE_MOUSE_DOWN="layout:resize:mouse-down",t.LAYOUT_RESIZE_MOUSE_MOVE="layout:resize:mouse-move",t.LAYOUT_RESIZE_MOUSE_UP="layout:resize-mouse-up",t.GLOBAL_KEYBOARD_DOWN="global:keyboard-down",t.GLOBAL_KEYBOARD_UP="global:keyboard-up",t.GLOBAL_COPIED="global:copied",t.GLOBAL_MOUSE_UP="global:mouse-up",t.GLOBAL_MOUSE_MOVE="global:mouse-move",t.GLOBAL_ACTION_ICON_CLICK="global:action-icon-click",t.GLOBAL_ACTION_ICON_HOVER="global:action-icon-hover",t.GLOBAL_ACTION_ICON_HOVER_OFF="global:action-icon-hover-off",t.GLOBAL_CONTEXT_MENU="global:context-menu",t.GLOBAL_CLICK="global:click",t.GLOBAL_DOUBLE_CLICK="global:double-click",t.GLOBAL_SELECTED="global:selected",t.GLOBAL_HOVER="global:hover",t.GLOBAL_RESET="global:reset",t.GLOBAL_LINK_FIELD_JUMP="global:link-field-jump",t.GLOBAL_SCROLL="global:scroll"})(S2Event||(S2Event={}));var GEventType;(function(t){t.RIGHT_MOUSE_UP="rightup"})(GEventType||(GEventType={}));var freeGlobal=typeof global=="object"&&global&&global.Object===Object&&global,freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),Symbol$1=root.Symbol,objectProto$j=Object.prototype,hasOwnProperty$g=objectProto$j.hasOwnProperty,nativeObjectToString$1=objectProto$j.toString,symToStringTag$1=Symbol$1?Symbol$1.toStringTag:void 0;function getRawTag(t){var r=hasOwnProperty$g.call(t,symToStringTag$1),e=t[symToStringTag$1];try{t[symToStringTag$1]=void 0;var n=!0}catch{}var a=nativeObjectToString$1.call(t);return n&&(r?t[symToStringTag$1]=e:delete t[symToStringTag$1]),a}var objectProto$i=Object.prototype,nativeObjectToString=objectProto$i.toString;function objectToString(t){return nativeObjectToString.call(t)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$1?Symbol$1.toStringTag:void 0;function baseGetTag(t){return t==null?t===void 0?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(t)?getRawTag(t):objectToString(t)}function isObjectLike(t){return t!=null&&typeof t=="object"}var symbolTag$3="[object Symbol]";function isSymbol(t){return typeof t=="symbol"||isObjectLike(t)&&baseGetTag(t)==symbolTag$3}function arrayMap(t,r){for(var e=-1,n=t==null?0:t.length,a=Array(n);++e<n;)a[e]=r(t[e],e,t);return a}var isArray=Array.isArray,INFINITY$3=1/0,symbolProto$2=Symbol$1?Symbol$1.prototype:void 0,symbolToString=symbolProto$2?symbolProto$2.toString:void 0;function baseToString(t){if(typeof t=="string")return t;if(isArray(t))return arrayMap(t,baseToString)+"";if(isSymbol(t))return symbolToString?symbolToString.call(t):"";var r=t+"";return r=="0"&&1/t==-INFINITY$3?"-0":r}var reWhitespace=/\s/;function trimmedEndIndex(t){for(var r=t.length;r--&&reWhitespace.test(t.charAt(r)););return r}var reTrimStart=/^\s+/;function baseTrim(t){return t&&t.slice(0,trimmedEndIndex(t)+1).replace(reTrimStart,"")}function isObject(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}var NAN=NaN,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(t){if(typeof t=="number")return t;if(isSymbol(t))return NAN;if(isObject(t)){var r=typeof t.valueOf=="function"?t.valueOf():t;t=isObject(r)?r+"":r}if(typeof t!="string")return t===0?t:+t;t=baseTrim(t);var e=reIsBinary.test(t);return e||reIsOctal.test(t)?freeParseInt(t.slice(2),e?2:8):reIsBadHex.test(t)?NAN:+t}var INFINITY$2=1/0,MAX_INTEGER=17976931348623157e292;function toFinite(t){if(!t)return t===0?t:0;if(t=toNumber(t),t===INFINITY$2||t===-INFINITY$2){var r=t<0?-1:1;return r*MAX_INTEGER}return t===t?t:0}function toInteger(t){var r=toFinite(t),e=r%1;return r===r?e?r-e:r:0}function identity(t){return t}var asyncTag="[object AsyncFunction]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(t){if(!isObject(t))return!1;var r=baseGetTag(t);return r==funcTag$2||r==genTag$1||r==asyncTag||r==proxyTag}var coreJsData=root["__core-js_shared__"],maskSrcKey=function(){var t=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function isMasked(t){return!!maskSrcKey&&maskSrcKey in t}var funcProto$2=Function.prototype,funcToString$2=funcProto$2.toString;function toSource(t){if(t!=null){try{return funcToString$2.call(t)}catch{}try{return t+""}catch{}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$h=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$f=objectProto$h.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$f).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(t){if(!isObject(t)||isMasked(t))return!1;var r=isFunction(t)?reIsNative:reIsHostCtor;return r.test(toSource(t))}function getValue(t,r){return t==null?void 0:t[r]}function getNative(t,r){var e=getValue(t,r);return baseIsNative(e)?e:void 0}var WeakMap$1=getNative(root,"WeakMap"),objectCreate=Object.create,baseCreate=function(){function t(){}return function(r){if(!isObject(r))return{};if(objectCreate)return objectCreate(r);t.prototype=r;var e=new t;return t.prototype=void 0,e}}();function apply(t,r,e){switch(e.length){case 0:return t.call(r);case 1:return t.call(r,e[0]);case 2:return t.call(r,e[0],e[1]);case 3:return t.call(r,e[0],e[1],e[2])}return t.apply(r,e)}function noop(){}function copyArray(t,r){var e=-1,n=t.length;for(r||(r=Array(n));++e<n;)r[e]=t[e];return r}var HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(t){var r=0,e=0;return function(){var n=nativeNow(),a=HOT_SPAN-(n-e);if(e=n,a>0){if(++r>=HOT_COUNT)return arguments[0]}else r=0;return t.apply(void 0,arguments)}}function constant$1(t){return function(){return t}}var defineProperty=function(){try{var t=getNative(Object,"defineProperty");return t({},"",{}),t}catch{}}(),baseSetToString=defineProperty?function(t,r){return defineProperty(t,"toString",{configurable:!0,enumerable:!1,value:constant$1(r),writable:!0})}:identity,baseSetToString$1=baseSetToString,setToString=shortOut(baseSetToString$1);function arrayEach(t,r){for(var e=-1,n=t==null?0:t.length;++e<n&&r(t[e],e,t)!==!1;);return t}function baseFindIndex(t,r,e,n){for(var a=t.length,o=e+(n?1:-1);n?o--:++o<a;)if(r(t[o],o,t))return o;return-1}function baseIsNaN(t){return t!==t}function strictIndexOf(t,r,e){for(var n=e-1,a=t.length;++n<a;)if(t[n]===r)return n;return-1}function baseIndexOf(t,r,e){return r===r?strictIndexOf(t,r,e):baseFindIndex(t,baseIsNaN,e)}function arrayIncludes(t,r){var e=t==null?0:t.length;return!!e&&baseIndexOf(t,r,0)>-1}var MAX_SAFE_INTEGER$3=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(t,r){var e=typeof t;return r=r??MAX_SAFE_INTEGER$3,!!r&&(e=="number"||e!="symbol"&&reIsUint.test(t))&&t>-1&&t%1==0&&t<r}function baseAssignValue(t,r,e){r=="__proto__"&&defineProperty?defineProperty(t,r,{configurable:!0,enumerable:!0,value:e,writable:!0}):t[r]=e}function eq(t,r){return t===r||t!==t&&r!==r}var objectProto$g=Object.prototype,hasOwnProperty$e=objectProto$g.hasOwnProperty;function assignValue(t,r,e){var n=t[r];(!(hasOwnProperty$e.call(t,r)&&eq(n,e))||e===void 0&&!(r in t))&&baseAssignValue(t,r,e)}function copyObject(t,r,e,n){var a=!e;e||(e={});for(var o=-1,s=r.length;++o<s;){var l=r[o],u=n?n(e[l],t[l],l,e,t):void 0;u===void 0&&(u=t[l]),a?baseAssignValue(e,l,u):assignValue(e,l,u)}return e}var nativeMax$8=Math.max;function overRest(t,r,e){return r=nativeMax$8(r===void 0?t.length-1:r,0),function(){for(var n=arguments,a=-1,o=nativeMax$8(n.length-r,0),s=Array(o);++a<o;)s[a]=n[r+a];a=-1;for(var l=Array(r+1);++a<r;)l[a]=n[a];return l[r]=e(s),apply(t,this,l)}}function baseRest(t,r){return setToString(overRest(t,r,identity),t+"")}var MAX_SAFE_INTEGER$2=9007199254740991;function isLength(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=MAX_SAFE_INTEGER$2}function isArrayLike(t){return t!=null&&isLength(t.length)&&!isFunction(t)}function isIterateeCall(t,r,e){if(!isObject(e))return!1;var n=typeof r;return(n=="number"?isArrayLike(e)&&isIndex(r,e.length):n=="string"&&r in e)?eq(e[r],t):!1}function createAssigner(t){return baseRest(function(r,e){var n=-1,a=e.length,o=a>1?e[a-1]:void 0,s=a>2?e[2]:void 0;for(o=t.length>3&&typeof o=="function"?(a--,o):void 0,s&&isIterateeCall(e[0],e[1],s)&&(o=a<3?void 0:o,a=1),r=Object(r);++n<a;){var l=e[n];l&&t(r,l,n,o)}return r})}var objectProto$f=Object.prototype;function isPrototype(t){var r=t&&t.constructor,e=typeof r=="function"&&r.prototype||objectProto$f;return t===e}function baseTimes(t,r){for(var e=-1,n=Array(t);++e<t;)n[e]=r(e);return n}var argsTag$3="[object Arguments]";function baseIsArguments(t){return isObjectLike(t)&&baseGetTag(t)==argsTag$3}var objectProto$e=Object.prototype,hasOwnProperty$d=objectProto$e.hasOwnProperty,propertyIsEnumerable$1=objectProto$e.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(t){return isObjectLike(t)&&hasOwnProperty$d.call(t,"callee")&&!propertyIsEnumerable$1.call(t,"callee")};function stubFalse(){return!1}var freeExports$2=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$2=freeExports$2&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2,Buffer$1=moduleExports$2?root.Buffer:void 0,nativeIsBuffer=Buffer$1?Buffer$1.isBuffer:void 0,isBuffer=nativeIsBuffer||stubFalse,isBuffer$1=isBuffer,argsTag$2="[object Arguments]",arrayTag$2="[object Array]",boolTag$4="[object Boolean]",dateTag$3="[object Date]",errorTag$2="[object Error]",funcTag$1="[object Function]",mapTag$7="[object Map]",numberTag$4="[object Number]",objectTag$4="[object Object]",regexpTag$4="[object RegExp]",setTag$7="[object Set]",stringTag$4="[object String]",weakMapTag$2="[object WeakMap]",arrayBufferTag$3="[object ArrayBuffer]",dataViewTag$4="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",typedArrayTags={};typedArrayTags[float32Tag$2]=typedArrayTags[float64Tag$2]=typedArrayTags[int8Tag$2]=typedArrayTags[int16Tag$2]=typedArrayTags[int32Tag$2]=typedArrayTags[uint8Tag$2]=typedArrayTags[uint8ClampedTag$2]=typedArrayTags[uint16Tag$2]=typedArrayTags[uint32Tag$2]=!0;typedArrayTags[argsTag$2]=typedArrayTags[arrayTag$2]=typedArrayTags[arrayBufferTag$3]=typedArrayTags[boolTag$4]=typedArrayTags[dataViewTag$4]=typedArrayTags[dateTag$3]=typedArrayTags[errorTag$2]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag$7]=typedArrayTags[numberTag$4]=typedArrayTags[objectTag$4]=typedArrayTags[regexpTag$4]=typedArrayTags[setTag$7]=typedArrayTags[stringTag$4]=typedArrayTags[weakMapTag$2]=!1;function baseIsTypedArray(t){return isObjectLike(t)&&isLength(t.length)&&!!typedArrayTags[baseGetTag(t)]}function baseUnary(t){return function(r){return t(r)}}var freeExports$1=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal.process,nodeUtil=function(){try{var t=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return t||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch{}}(),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray,isTypedArray$1=isTypedArray,objectProto$d=Object.prototype,hasOwnProperty$c=objectProto$d.hasOwnProperty;function arrayLikeKeys(t,r){var e=isArray(t),n=!e&&isArguments(t),a=!e&&!n&&isBuffer$1(t),o=!e&&!n&&!a&&isTypedArray$1(t),s=e||n||a||o,l=s?baseTimes(t.length,String):[],u=l.length;for(var c in t)(r||hasOwnProperty$c.call(t,c))&&!(s&&(c=="length"||a&&(c=="offset"||c=="parent")||o&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||isIndex(c,u)))&&l.push(c);return l}function overArg(t,r){return function(e){return t(r(e))}}var nativeKeys=overArg(Object.keys,Object),objectProto$c=Object.prototype,hasOwnProperty$b=objectProto$c.hasOwnProperty;function baseKeys(t){if(!isPrototype(t))return nativeKeys(t);var r=[];for(var e in Object(t))hasOwnProperty$b.call(t,e)&&e!="constructor"&&r.push(e);return r}function keys(t){return isArrayLike(t)?arrayLikeKeys(t):baseKeys(t)}var objectProto$b=Object.prototype,hasOwnProperty$a=objectProto$b.hasOwnProperty,assign=createAssigner(function(t,r){if(isPrototype(r)||isArrayLike(r)){copyObject(r,keys(r),t);return}for(var e in r)hasOwnProperty$a.call(r,e)&&assignValue(t,e,r[e])});function nativeKeysIn(t){var r=[];if(t!=null)for(var e in Object(t))r.push(e);return r}var objectProto$a=Object.prototype,hasOwnProperty$9=objectProto$a.hasOwnProperty;function baseKeysIn(t){if(!isObject(t))return nativeKeysIn(t);var r=isPrototype(t),e=[];for(var n in t)n=="constructor"&&(r||!hasOwnProperty$9.call(t,n))||e.push(n);return e}function keysIn(t){return isArrayLike(t)?arrayLikeKeys(t,!0):baseKeysIn(t)}var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(t,r){if(isArray(t))return!1;var e=typeof t;return e=="number"||e=="symbol"||e=="boolean"||t==null||isSymbol(t)?!0:reIsPlainProp.test(t)||!reIsDeepProp.test(t)||r!=null&&t in Object(r)}var nativeCreate=getNative(Object,"create");function hashClear(){this.__data__=nativeCreate?nativeCreate(null):{},this.size=0}function hashDelete(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}var HASH_UNDEFINED$2="__lodash_hash_undefined__",objectProto$9=Object.prototype,hasOwnProperty$8=objectProto$9.hasOwnProperty;function hashGet(t){var r=this.__data__;if(nativeCreate){var e=r[t];return e===HASH_UNDEFINED$2?void 0:e}return hasOwnProperty$8.call(r,t)?r[t]:void 0}var objectProto$8=Object.prototype,hasOwnProperty$7=objectProto$8.hasOwnProperty;function hashHas(t){var r=this.__data__;return nativeCreate?r[t]!==void 0:hasOwnProperty$7.call(r,t)}var HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(t,r){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=nativeCreate&&r===void 0?HASH_UNDEFINED$1:r,this}function Hash(t){var r=-1,e=t==null?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}Hash.prototype.clear=hashClear;Hash.prototype.delete=hashDelete;Hash.prototype.get=hashGet;Hash.prototype.has=hashHas;Hash.prototype.set=hashSet;function listCacheClear(){this.__data__=[],this.size=0}function assocIndexOf(t,r){for(var e=t.length;e--;)if(eq(t[e][0],r))return e;return-1}var arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(t){var r=this.__data__,e=assocIndexOf(r,t);if(e<0)return!1;var n=r.length-1;return e==n?r.pop():splice.call(r,e,1),--this.size,!0}function listCacheGet(t){var r=this.__data__,e=assocIndexOf(r,t);return e<0?void 0:r[e][1]}function listCacheHas(t){return assocIndexOf(this.__data__,t)>-1}function listCacheSet(t,r){var e=this.__data__,n=assocIndexOf(e,t);return n<0?(++this.size,e.push([t,r])):e[n][1]=r,this}function ListCache(t){var r=-1,e=t==null?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}ListCache.prototype.clear=listCacheClear;ListCache.prototype.delete=listCacheDelete;ListCache.prototype.get=listCacheGet;ListCache.prototype.has=listCacheHas;ListCache.prototype.set=listCacheSet;var Map$1=getNative(root,"Map");function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map$1||ListCache),string:new Hash}}function isKeyable(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}function getMapData(t,r){var e=t.__data__;return isKeyable(r)?e[typeof r=="string"?"string":"hash"]:e.map}function mapCacheDelete(t){var r=getMapData(this,t).delete(t);return this.size-=r?1:0,r}function mapCacheGet(t){return getMapData(this,t).get(t)}function mapCacheHas(t){return getMapData(this,t).has(t)}function mapCacheSet(t,r){var e=getMapData(this,t),n=e.size;return e.set(t,r),this.size+=e.size==n?0:1,this}function MapCache(t){var r=-1,e=t==null?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}MapCache.prototype.clear=mapCacheClear;MapCache.prototype.delete=mapCacheDelete;MapCache.prototype.get=mapCacheGet;MapCache.prototype.has=mapCacheHas;MapCache.prototype.set=mapCacheSet;var FUNC_ERROR_TEXT$3="Expected a function";function memoize(t,r){if(typeof t!="function"||r!=null&&typeof r!="function")throw new TypeError(FUNC_ERROR_TEXT$3);var e=function(){var n=arguments,a=r?r.apply(this,n):n[0],o=e.cache;if(o.has(a))return o.get(a);var s=t.apply(this,n);return e.cache=o.set(a,s)||o,s};return e.cache=new(memoize.Cache||MapCache),e}memoize.Cache=MapCache;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(t){var r=memoize(t,function(n){return e.size===MAX_MEMOIZE_SIZE&&e.clear(),n}),e=r.cache;return r}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped(function(t){var r=[];return t.charCodeAt(0)===46&&r.push(""),t.replace(rePropName,function(e,n,a,o){r.push(a?o.replace(reEscapeChar,"$1"):n||e)}),r});function toString(t){return t==null?"":baseToString(t)}function castPath(t,r){return isArray(t)?t:isKey(t,r)?[t]:stringToPath(toString(t))}var INFINITY$1=1/0;function toKey(t){if(typeof t=="string"||isSymbol(t))return t;var r=t+"";return r=="0"&&1/t==-INFINITY$1?"-0":r}function baseGet(t,r){r=castPath(r,t);for(var e=0,n=r.length;t!=null&&e<n;)t=t[toKey(r[e++])];return e&&e==n?t:void 0}function get(t,r,e){var n=t==null?void 0:baseGet(t,r);return n===void 0?e:n}function arrayPush(t,r){for(var e=-1,n=r.length,a=t.length;++e<n;)t[a+e]=r[e];return t}var spreadableSymbol=Symbol$1?Symbol$1.isConcatSpreadable:void 0;function isFlattenable(t){return isArray(t)||isArguments(t)||!!(spreadableSymbol&&t&&t[spreadableSymbol])}function baseFlatten(t,r,e,n,a){var o=-1,s=t.length;for(e||(e=isFlattenable),a||(a=[]);++o<s;){var l=t[o];r>0&&e(l)?r>1?baseFlatten(l,r-1,e,n,a):arrayPush(a,l):n||(a[a.length]=l)}return a}function flatten(t){var r=t==null?0:t.length;return r?baseFlatten(t,1):[]}function flatRest(t){return setToString(overRest(t,void 0,flatten),t+"")}var getPrototype=overArg(Object.getPrototypeOf,Object),objectTag$3="[object Object]",funcProto=Function.prototype,objectProto$7=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$6=objectProto$7.hasOwnProperty,objectCtorString=funcToString.call(Object);function isPlainObject(t){if(!isObjectLike(t)||baseGetTag(t)!=objectTag$3)return!1;var r=getPrototype(t);if(r===null)return!0;var e=hasOwnProperty$6.call(r,"constructor")&&r.constructor;return typeof e=="function"&&e instanceof e&&funcToString.call(e)==objectCtorString}function baseSlice(t,r,e){var n=-1,a=t.length;r<0&&(r=-r>a?0:a+r),e=e>a?a:e,e<0&&(e+=a),a=r>e?0:e-r>>>0,r>>>=0;for(var o=Array(a);++n<a;)o[n]=t[n+r];return o}function castSlice(t,r,e){var n=t.length;return e=e===void 0?n:e,!r&&e>=n?t:baseSlice(t,r,e)}var rsAstralRange$3="\\ud800-\\udfff",rsComboMarksRange$4="\\u0300-\\u036f",reComboHalfMarksRange$4="\\ufe20-\\ufe2f",rsComboSymbolsRange$4="\\u20d0-\\u20ff",rsComboRange$4=rsComboMarksRange$4+reComboHalfMarksRange$4+rsComboSymbolsRange$4,rsVarRange$3="\\ufe0e\\ufe0f",rsZWJ$3="\\u200d",reHasUnicode=RegExp("["+rsZWJ$3+rsAstralRange$3+rsComboRange$4+rsVarRange$3+"]");function hasUnicode(t){return reHasUnicode.test(t)}function asciiToArray(t){return t.split("")}var rsAstralRange$2="\\ud800-\\udfff",rsComboMarksRange$3="\\u0300-\\u036f",reComboHalfMarksRange$3="\\ufe20-\\ufe2f",rsComboSymbolsRange$3="\\u20d0-\\u20ff",rsComboRange$3=rsComboMarksRange$3+reComboHalfMarksRange$3+rsComboSymbolsRange$3,rsVarRange$2="\\ufe0e\\ufe0f",rsAstral$1="["+rsAstralRange$2+"]",rsCombo$3="["+rsComboRange$3+"]",rsFitz$2="\\ud83c[\\udffb-\\udfff]",rsModifier$2="(?:"+rsCombo$3+"|"+rsFitz$2+")",rsNonAstral$2="[^"+rsAstralRange$2+"]",rsRegional$2="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair$2="[\\ud800-\\udbff][\\udc00-\\udfff]",rsZWJ$2="\\u200d",reOptMod$2=rsModifier$2+"?",rsOptVar$2="["+rsVarRange$2+"]?",rsOptJoin$2="(?:"+rsZWJ$2+"(?:"+[rsNonAstral$2,rsRegional$2,rsSurrPair$2].join("|")+")"+rsOptVar$2+reOptMod$2+")*",rsSeq$2=rsOptVar$2+reOptMod$2+rsOptJoin$2,rsSymbol$1="(?:"+[rsNonAstral$2+rsCombo$3+"?",rsCombo$3,rsRegional$2,rsSurrPair$2,rsAstral$1].join("|")+")",reUnicode$1=RegExp(rsFitz$2+"(?="+rsFitz$2+")|"+rsSymbol$1+rsSeq$2,"g");function unicodeToArray(t){return t.match(reUnicode$1)||[]}function stringToArray(t){return hasUnicode(t)?unicodeToArray(t):asciiToArray(t)}function arrayReduce(t,r,e,n){var a=-1,o=t==null?0:t.length;for(n&&o&&(e=t[++a]);++a<o;)e=r(e,t[a],a,t);return e}function basePropertyOf(t){return function(r){return t==null?void 0:t[r]}}var deburredLetters={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},deburrLetter=basePropertyOf(deburredLetters),deburrLetter$1=deburrLetter,reLatin=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,rsComboMarksRange$2="\\u0300-\\u036f",reComboHalfMarksRange$2="\\ufe20-\\ufe2f",rsComboSymbolsRange$2="\\u20d0-\\u20ff",rsComboRange$2=rsComboMarksRange$2+reComboHalfMarksRange$2+rsComboSymbolsRange$2,rsCombo$2="["+rsComboRange$2+"]",reComboMark=RegExp(rsCombo$2,"g");function deburr(t){return t=toString(t),t&&t.replace(reLatin,deburrLetter$1).replace(reComboMark,"")}var reAsciiWord=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function asciiWords(t){return t.match(reAsciiWord)||[]}var reHasUnicodeWord=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function hasUnicodeWord(t){return reHasUnicodeWord.test(t)}var rsAstralRange$1="\\ud800-\\udfff",rsComboMarksRange$1="\\u0300-\\u036f",reComboHalfMarksRange$1="\\ufe20-\\ufe2f",rsComboSymbolsRange$1="\\u20d0-\\u20ff",rsComboRange$1=rsComboMarksRange$1+reComboHalfMarksRange$1+rsComboSymbolsRange$1,rsDingbatRange="\\u2700-\\u27bf",rsLowerRange="a-z\\xdf-\\xf6\\xf8-\\xff",rsMathOpRange="\\xac\\xb1\\xd7\\xf7",rsNonCharRange="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",rsPunctuationRange="\\u2000-\\u206f",rsSpaceRange=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",rsUpperRange="A-Z\\xc0-\\xd6\\xd8-\\xde",rsVarRange$1="\\ufe0e\\ufe0f",rsBreakRange=rsMathOpRange+rsNonCharRange+rsPunctuationRange+rsSpaceRange,rsApos$1="['’]",rsBreak="["+rsBreakRange+"]",rsCombo$1="["+rsComboRange$1+"]",rsDigits="\\d+",rsDingbat="["+rsDingbatRange+"]",rsLower="["+rsLowerRange+"]",rsMisc="[^"+rsAstralRange$1+rsBreakRange+rsDigits+rsDingbatRange+rsLowerRange+rsUpperRange+"]",rsFitz$1="\\ud83c[\\udffb-\\udfff]",rsModifier$1="(?:"+rsCombo$1+"|"+rsFitz$1+")",rsNonAstral$1="[^"+rsAstralRange$1+"]",rsRegional$1="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair$1="[\\ud800-\\udbff][\\udc00-\\udfff]",rsUpper="["+rsUpperRange+"]",rsZWJ$1="\\u200d",rsMiscLower="(?:"+rsLower+"|"+rsMisc+")",rsMiscUpper="(?:"+rsUpper+"|"+rsMisc+")",rsOptContrLower="(?:"+rsApos$1+"(?:d|ll|m|re|s|t|ve))?",rsOptContrUpper="(?:"+rsApos$1+"(?:D|LL|M|RE|S|T|VE))?",reOptMod$1=rsModifier$1+"?",rsOptVar$1="["+rsVarRange$1+"]?",rsOptJoin$1="(?:"+rsZWJ$1+"(?:"+[rsNonAstral$1,rsRegional$1,rsSurrPair$1].join("|")+")"+rsOptVar$1+reOptMod$1+")*",rsOrdLower="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",rsOrdUpper="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",rsSeq$1=rsOptVar$1+reOptMod$1+rsOptJoin$1,rsEmoji="(?:"+[rsDingbat,rsRegional$1,rsSurrPair$1].join("|")+")"+rsSeq$1,reUnicodeWord=RegExp([rsUpper+"?"+rsLower+"+"+rsOptContrLower+"(?="+[rsBreak,rsUpper,"$"].join("|")+")",rsMiscUpper+"+"+rsOptContrUpper+"(?="+[rsBreak,rsUpper+rsMiscLower,"$"].join("|")+")",rsUpper+"?"+rsMiscLower+"+"+rsOptContrLower,rsUpper+"+"+rsOptContrUpper,rsOrdUpper,rsOrdLower,rsDigits,rsEmoji].join("|"),"g");function unicodeWords(t){return t.match(reUnicodeWord)||[]}function words(t,r,e){return t=toString(t),r=e?void 0:r,r===void 0?hasUnicodeWord(t)?unicodeWords(t):asciiWords(t):t.match(r)||[]}var rsApos="['’]",reApos=RegExp(rsApos,"g");function createCompounder(t){return function(r){return arrayReduce(words(deburr(r).replace(reApos,"")),t,"")}}var nativeIsFinite=root.isFinite,nativeMin$4=Math.min;function createRound(t){var r=Math[t];return function(e,n){if(e=toNumber(e),n=n==null?0:nativeMin$4(toInteger(n),292),n&&nativeIsFinite(e)){var a=(toString(e)+"e").split("e"),o=r(a[0]+"e"+(+a[1]+n));return a=(toString(o)+"e").split("e"),+(a[0]+"e"+(+a[1]-n))}return r(e)}}function baseClamp(t,r,e){return t===t&&(e!==void 0&&(t=t<=e?t:e),r!==void 0&&(t=t>=r?t:r)),t}function clamp$1(t,r,e){return e===void 0&&(e=r,r=void 0),e!==void 0&&(e=toNumber(e),e=e===e?e:0),r!==void 0&&(r=toNumber(r),r=r===r?r:0),baseClamp(toNumber(t),r,e)}function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(t){var r=this.__data__,e=r.delete(t);return this.size=r.size,e}function stackGet(t){return this.__data__.get(t)}function stackHas(t){return this.__data__.has(t)}var LARGE_ARRAY_SIZE$2=200;function stackSet(t,r){var e=this.__data__;if(e instanceof ListCache){var n=e.__data__;if(!Map$1||n.length<LARGE_ARRAY_SIZE$2-1)return n.push([t,r]),this.size=++e.size,this;e=this.__data__=new MapCache(n)}return e.set(t,r),this.size=e.size,this}function Stack(t){var r=this.__data__=new ListCache(t);this.size=r.size}Stack.prototype.clear=stackClear;Stack.prototype.delete=stackDelete;Stack.prototype.get=stackGet;Stack.prototype.has=stackHas;Stack.prototype.set=stackSet;function baseAssign(t,r){return t&&copyObject(r,keys(r),t)}function baseAssignIn(t,r){return t&&copyObject(r,keysIn(r),t)}var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer$2=moduleExports?root.Buffer:void 0,allocUnsafe=Buffer$2?Buffer$2.allocUnsafe:void 0;function cloneBuffer(t,r){if(r)return t.slice();var e=t.length,n=allocUnsafe?allocUnsafe(e):new t.constructor(e);return t.copy(n),n}function arrayFilter(t,r){for(var e=-1,n=t==null?0:t.length,a=0,o=[];++e<n;){var s=t[e];r(s,e,t)&&(o[a++]=s)}return o}function stubArray(){return[]}var objectProto$6=Object.prototype,propertyIsEnumerable=objectProto$6.propertyIsEnumerable,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols$1?function(t){return t==null?[]:(t=Object(t),arrayFilter(nativeGetSymbols$1(t),function(r){return propertyIsEnumerable.call(t,r)}))}:stubArray;function copySymbols(t,r){return copyObject(t,getSymbols(t),r)}var nativeGetSymbols=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols?function(t){for(var r=[];t;)arrayPush(r,getSymbols(t)),t=getPrototype(t);return r}:stubArray;function copySymbolsIn(t,r){return copyObject(t,getSymbolsIn(t),r)}function baseGetAllKeys(t,r,e){var n=r(t);return isArray(t)?n:arrayPush(n,e(t))}function getAllKeys(t){return baseGetAllKeys(t,keys,getSymbols)}function getAllKeysIn(t){return baseGetAllKeys(t,keysIn,getSymbolsIn)}var DataView$1=getNative(root,"DataView"),Promise$1=getNative(root,"Promise"),Set$1=getNative(root,"Set"),mapTag$6="[object Map]",objectTag$2="[object Object]",promiseTag="[object Promise]",setTag$6="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$3="[object DataView]",dataViewCtorString=toSource(DataView$1),mapCtorString=toSource(Map$1),promiseCtorString=toSource(Promise$1),setCtorString=toSource(Set$1),weakMapCtorString=toSource(WeakMap$1),getTag=baseGetTag;(DataView$1&&getTag(new DataView$1(new ArrayBuffer(1)))!=dataViewTag$3||Map$1&&getTag(new Map$1)!=mapTag$6||Promise$1&&getTag(Promise$1.resolve())!=promiseTag||Set$1&&getTag(new Set$1)!=setTag$6||WeakMap$1&&getTag(new WeakMap$1)!=weakMapTag$1)&&(getTag=function(t){var r=baseGetTag(t),e=r==objectTag$2?t.constructor:void 0,n=e?toSource(e):"";if(n)switch(n){case dataViewCtorString:return dataViewTag$3;case mapCtorString:return mapTag$6;case promiseCtorString:return promiseTag;case setCtorString:return setTag$6;case weakMapCtorString:return weakMapTag$1}return r});var getTag$1=getTag,objectProto$5=Object.prototype,hasOwnProperty$5=objectProto$5.hasOwnProperty;function initCloneArray(t){var r=t.length,e=new t.constructor(r);return r&&typeof t[0]=="string"&&hasOwnProperty$5.call(t,"index")&&(e.index=t.index,e.input=t.input),e}var Uint8Array$1=root.Uint8Array,Uint8Array$1$1=Uint8Array$1;function cloneArrayBuffer(t){var r=new t.constructor(t.byteLength);return new Uint8Array$1$1(r).set(new Uint8Array$1$1(t)),r}function cloneDataView(t,r){var e=r?cloneArrayBuffer(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.byteLength)}var reFlags=/\w*$/;function cloneRegExp(t){var r=new t.constructor(t.source,reFlags.exec(t));return r.lastIndex=t.lastIndex,r}var symbolProto$1=Symbol$1?Symbol$1.prototype:void 0,symbolValueOf$1=symbolProto$1?symbolProto$1.valueOf:void 0;function cloneSymbol(t){return symbolValueOf$1?Object(symbolValueOf$1.call(t)):{}}function cloneTypedArray(t,r){var e=r?cloneArrayBuffer(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}var boolTag$3="[object Boolean]",dateTag$2="[object Date]",mapTag$5="[object Map]",numberTag$3="[object Number]",regexpTag$3="[object RegExp]",setTag$5="[object Set]",stringTag$3="[object String]",symbolTag$2="[object Symbol]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(t,r,e){var n=t.constructor;switch(r){case arrayBufferTag$2:return cloneArrayBuffer(t);case boolTag$3:case dateTag$2:return new n(+t);case dataViewTag$2:return cloneDataView(t,e);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(t,e);case mapTag$5:return new n;case numberTag$3:case stringTag$3:return new n(t);case regexpTag$3:return cloneRegExp(t);case setTag$5:return new n;case symbolTag$2:return cloneSymbol(t)}}function initCloneObject(t){return typeof t.constructor=="function"&&!isPrototype(t)?baseCreate(getPrototype(t)):{}}var mapTag$4="[object Map]";function baseIsMap(t){return isObjectLike(t)&&getTag$1(t)==mapTag$4}var nodeIsMap=nodeUtil&&nodeUtil.isMap,isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap,setTag$4="[object Set]";function baseIsSet(t){return isObjectLike(t)&&getTag$1(t)==setTag$4}var nodeIsSet=nodeUtil&&nodeUtil.isSet,isSet=nodeIsSet?baseUnary(nodeIsSet):baseIsSet,CLONE_DEEP_FLAG$2=1,CLONE_FLAT_FLAG$1=2,CLONE_SYMBOLS_FLAG$3=4,argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$2="[object Boolean]",dateTag$1="[object Date]",errorTag$1="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag$3="[object Map]",numberTag$2="[object Number]",objectTag$1="[object Object]",regexpTag$2="[object RegExp]",setTag$3="[object Set]",stringTag$2="[object String]",symbolTag$1="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",cloneableTags={};cloneableTags[argsTag$1]=cloneableTags[arrayTag$1]=cloneableTags[arrayBufferTag$1]=cloneableTags[dataViewTag$1]=cloneableTags[boolTag$2]=cloneableTags[dateTag$1]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag$3]=cloneableTags[numberTag$2]=cloneableTags[objectTag$1]=cloneableTags[regexpTag$2]=cloneableTags[setTag$3]=cloneableTags[stringTag$2]=cloneableTags[symbolTag$1]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0;cloneableTags[errorTag$1]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=!1;function baseClone(t,r,e,n,a,o){var s,l=r&CLONE_DEEP_FLAG$2,u=r&CLONE_FLAT_FLAG$1,c=r&CLONE_SYMBOLS_FLAG$3;if(e&&(s=a?e(t,n,a,o):e(t)),s!==void 0)return s;if(!isObject(t))return t;var d=isArray(t);if(d){if(s=initCloneArray(t),!l)return copyArray(t,s)}else{var f=getTag$1(t),h=f==funcTag||f==genTag;if(isBuffer$1(t))return cloneBuffer(t,l);if(f==objectTag$1||f==argsTag$1||h&&!a){if(s=u||h?{}:initCloneObject(t),!l)return u?copySymbolsIn(t,baseAssignIn(s,t)):copySymbols(t,baseAssign(s,t))}else{if(!cloneableTags[f])return a?t:{};s=initCloneByTag(t,f,l)}}o||(o=new Stack);var p=o.get(t);if(p)return p;o.set(t,s),isSet(t)?t.forEach(function(y){s.add(baseClone(y,r,e,y,t,o))}):isMap(t)&&t.forEach(function(y,m){s.set(m,baseClone(y,r,e,m,t,o))});var v=c?u?getAllKeysIn:getAllKeys:u?keysIn:keys,g=d?void 0:v(t);return arrayEach(g||t,function(y,m){g&&(m=y,y=t[m]),assignValue(s,m,baseClone(y,r,e,m,t,o))}),s}var CLONE_SYMBOLS_FLAG$2=4;function clone$1(t){return baseClone(t,CLONE_SYMBOLS_FLAG$2)}var CLONE_DEEP_FLAG$1=1,CLONE_SYMBOLS_FLAG$1=4;function cloneDeep(t){return baseClone(t,CLONE_DEEP_FLAG$1|CLONE_SYMBOLS_FLAG$1)}function compact(t){for(var r=-1,e=t==null?0:t.length,n=0,a=[];++r<e;){var o=t[r];o&&(a[n++]=o)}return a}function concat(){var t=arguments.length;if(!t)return[];for(var r=Array(t-1),e=arguments[0],n=t;n--;)r[n-1]=arguments[n];return arrayPush(isArray(e)?copyArray(e):[e],baseFlatten(r,1))}var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(t){return this.__data__.set(t,HASH_UNDEFINED),this}function setCacheHas(t){return this.__data__.has(t)}function SetCache(t){var r=-1,e=t==null?0:t.length;for(this.__data__=new MapCache;++r<e;)this.add(t[r])}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd;SetCache.prototype.has=setCacheHas;function arraySome(t,r){for(var e=-1,n=t==null?0:t.length;++e<n;)if(r(t[e],e,t))return!0;return!1}function cacheHas(t,r){return t.has(r)}var COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function equalArrays(t,r,e,n,a,o){var s=e&COMPARE_PARTIAL_FLAG$5,l=t.length,u=r.length;if(l!=u&&!(s&&u>l))return!1;var c=o.get(t),d=o.get(r);if(c&&d)return c==r&&d==t;var f=-1,h=!0,p=e&COMPARE_UNORDERED_FLAG$3?new SetCache:void 0;for(o.set(t,r),o.set(r,t);++f<l;){var v=t[f],g=r[f];if(n)var y=s?n(g,v,f,r,t,o):n(v,g,f,t,r,o);if(y!==void 0){if(y)continue;h=!1;break}if(p){if(!arraySome(r,function(m,S){if(!cacheHas(p,S)&&(v===m||a(v,m,e,n,o)))return p.push(S)})){h=!1;break}}else if(!(v===g||a(v,g,e,n,o))){h=!1;break}}return o.delete(t),o.delete(r),h}function mapToArray(t){var r=-1,e=Array(t.size);return t.forEach(function(n,a){e[++r]=[a,n]}),e}function setToArray(t){var r=-1,e=Array(t.size);return t.forEach(function(n){e[++r]=n}),e}var COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2,boolTag$1="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",mapTag$2="[object Map]",numberTag$1="[object Number]",regexpTag$1="[object RegExp]",setTag$2="[object Set]",stringTag$1="[object String]",symbolTag="[object Symbol]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",symbolProto=Symbol$1?Symbol$1.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function equalByTag(t,r,e,n,a,o,s){switch(e){case dataViewTag:if(t.byteLength!=r.byteLength||t.byteOffset!=r.byteOffset)return!1;t=t.buffer,r=r.buffer;case arrayBufferTag:return!(t.byteLength!=r.byteLength||!o(new Uint8Array$1$1(t),new Uint8Array$1$1(r)));case boolTag$1:case dateTag:case numberTag$1:return eq(+t,+r);case errorTag:return t.name==r.name&&t.message==r.message;case regexpTag$1:case stringTag$1:return t==r+"";case mapTag$2:var l=mapToArray;case setTag$2:var u=n&COMPARE_PARTIAL_FLAG$4;if(l||(l=setToArray),t.size!=r.size&&!u)return!1;var c=s.get(t);if(c)return c==r;n|=COMPARE_UNORDERED_FLAG$2,s.set(t,r);var d=equalArrays(l(t),l(r),n,a,o,s);return s.delete(t),d;case symbolTag:if(symbolValueOf)return symbolValueOf.call(t)==symbolValueOf.call(r)}return!1}var COMPARE_PARTIAL_FLAG$3=1,objectProto$4=Object.prototype,hasOwnProperty$4=objectProto$4.hasOwnProperty;function equalObjects(t,r,e,n,a,o){var s=e&COMPARE_PARTIAL_FLAG$3,l=getAllKeys(t),u=l.length,c=getAllKeys(r),d=c.length;if(u!=d&&!s)return!1;for(var f=u;f--;){var h=l[f];if(!(s?h in r:hasOwnProperty$4.call(r,h)))return!1}var p=o.get(t),v=o.get(r);if(p&&v)return p==r&&v==t;var g=!0;o.set(t,r),o.set(r,t);for(var y=s;++f<u;){h=l[f];var m=t[h],S=r[h];if(n)var w=s?n(S,m,h,r,t,o):n(m,S,h,t,r,o);if(!(w===void 0?m===S||a(m,S,e,n,o):w)){g=!1;break}y||(y=h=="constructor")}if(g&&!y){var R=t.constructor,T=r.constructor;R!=T&&"constructor"in t&&"constructor"in r&&!(typeof R=="function"&&R instanceof R&&typeof T=="function"&&T instanceof T)&&(g=!1)}return o.delete(t),o.delete(r),g}var COMPARE_PARTIAL_FLAG$2=1,argsTag="[object Arguments]",arrayTag="[object Array]",objectTag="[object Object]",objectProto$3=Object.prototype,hasOwnProperty$3=objectProto$3.hasOwnProperty;function baseIsEqualDeep(t,r,e,n,a,o){var s=isArray(t),l=isArray(r),u=s?arrayTag:getTag$1(t),c=l?arrayTag:getTag$1(r);u=u==argsTag?objectTag:u,c=c==argsTag?objectTag:c;var d=u==objectTag,f=c==objectTag,h=u==c;if(h&&isBuffer$1(t)){if(!isBuffer$1(r))return!1;s=!0,d=!1}if(h&&!d)return o||(o=new Stack),s||isTypedArray$1(t)?equalArrays(t,r,e,n,a,o):equalByTag(t,r,u,e,n,a,o);if(!(e&COMPARE_PARTIAL_FLAG$2)){var p=d&&hasOwnProperty$3.call(t,"__wrapped__"),v=f&&hasOwnProperty$3.call(r,"__wrapped__");if(p||v){var g=p?t.value():t,y=v?r.value():r;return o||(o=new Stack),a(g,y,e,n,o)}}return h?(o||(o=new Stack),equalObjects(t,r,e,n,a,o)):!1}function baseIsEqual(t,r,e,n,a){return t===r?!0:t==null||r==null||!isObjectLike(t)&&!isObjectLike(r)?t!==t&&r!==r:baseIsEqualDeep(t,r,e,n,baseIsEqual,a)}var COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2;function baseIsMatch(t,r,e,n){var a=e.length,o=a,s=!n;if(t==null)return!o;for(t=Object(t);a--;){var l=e[a];if(s&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++a<o;){l=e[a];var u=l[0],c=t[u],d=l[1];if(s&&l[2]){if(c===void 0&&!(u in t))return!1}else{var f=new Stack;if(n)var h=n(c,d,u,t,r,f);if(!(h===void 0?baseIsEqual(d,c,COMPARE_PARTIAL_FLAG$1|COMPARE_UNORDERED_FLAG$1,n,f):h))return!1}}return!0}function isStrictComparable(t){return t===t&&!isObject(t)}function getMatchData(t){for(var r=keys(t),e=r.length;e--;){var n=r[e],a=t[n];r[e]=[n,a,isStrictComparable(a)]}return r}function matchesStrictComparable(t,r){return function(e){return e==null?!1:e[t]===r&&(r!==void 0||t in Object(e))}}function baseMatches(t){var r=getMatchData(t);return r.length==1&&r[0][2]?matchesStrictComparable(r[0][0],r[0][1]):function(e){return e===t||baseIsMatch(e,t,r)}}function baseHasIn(t,r){return t!=null&&r in Object(t)}function hasPath(t,r,e){r=castPath(r,t);for(var n=-1,a=r.length,o=!1;++n<a;){var s=toKey(r[n]);if(!(o=t!=null&&e(t,s)))break;t=t[s]}return o||++n!=a?o:(a=t==null?0:t.length,!!a&&isLength(a)&&isIndex(s,a)&&(isArray(t)||isArguments(t)))}function hasIn(t,r){return t!=null&&hasPath(t,r,baseHasIn)}var COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function baseMatchesProperty(t,r){return isKey(t)&&isStrictComparable(r)?matchesStrictComparable(toKey(t),r):function(e){var n=get(e,t);return n===void 0&&n===r?hasIn(e,t):baseIsEqual(r,n,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}function baseProperty(t){return function(r){return r==null?void 0:r[t]}}function basePropertyDeep(t){return function(r){return baseGet(r,t)}}function property(t){return isKey(t)?baseProperty(toKey(t)):basePropertyDeep(t)}function baseIteratee(t){return typeof t=="function"?t:t==null?identity:typeof t=="object"?isArray(t)?baseMatchesProperty(t[0],t[1]):baseMatches(t):property(t)}function arrayAggregator(t,r,e,n){for(var a=-1,o=t==null?0:t.length;++a<o;){var s=t[a];r(n,s,e(s),t)}return n}function createBaseFor(t){return function(r,e,n){for(var a=-1,o=Object(r),s=n(r),l=s.length;l--;){var u=s[t?l:++a];if(e(o[u],u,o)===!1)break}return r}}var baseFor=createBaseFor();function baseForOwn(t,r){return t&&baseFor(t,r,keys)}function createBaseEach(t,r){return function(e,n){if(e==null)return e;if(!isArrayLike(e))return t(e,n);for(var a=e.length,o=r?a:-1,s=Object(e);(r?o--:++o<a)&&n(s[o],o,s)!==!1;);return e}}var baseEach=createBaseEach(baseForOwn),baseEach$1=baseEach;function baseAggregator(t,r,e,n){return baseEach$1(t,function(a,o,s){r(n,a,e(a),s)}),n}function createAggregator(t,r){return function(e,n){var a=isArray(e)?arrayAggregator:baseAggregator,o=r?r():{};return a(e,t,baseIteratee(n),o)}}var now$2=function(){return root.Date.now()},FUNC_ERROR_TEXT$2="Expected a function",nativeMax$7=Math.max,nativeMin$3=Math.min;function debounce(t,r,e){var n,a,o,s,l,u,c=0,d=!1,f=!1,h=!0;if(typeof t!="function")throw new TypeError(FUNC_ERROR_TEXT$2);r=toNumber(r)||0,isObject(e)&&(d=!!e.leading,f="maxWait"in e,o=f?nativeMax$7(toNumber(e.maxWait)||0,r):o,h="trailing"in e?!!e.trailing:h);function p(x){var b=n,L=a;return n=a=void 0,c=x,s=t.apply(L,b),s}function v(x){return c=x,l=setTimeout(m,r),d?p(x):s}function g(x){var b=x-u,L=x-c,M=r-b;return f?nativeMin$3(M,o-L):M}function y(x){var b=x-u,L=x-c;return u===void 0||b>=r||b<0||f&&L>=o}function m(){var x=now$2();if(y(x))return S(x);l=setTimeout(m,g(x))}function S(x){return l=void 0,h&&n?p(x):(n=a=void 0,s)}function w(){l!==void 0&&clearTimeout(l),c=0,n=u=a=l=void 0}function R(){return l===void 0?s:S(now$2())}function T(){var x=now$2(),b=y(x);if(n=arguments,a=this,u=x,b){if(l===void 0)return v(u);if(f)return clearTimeout(l),l=setTimeout(m,r),p(u)}return l===void 0&&(l=setTimeout(m,r)),s}return T.cancel=w,T.flush=R,T}function assignMergeValue(t,r,e){(e!==void 0&&!eq(t[r],e)||e===void 0&&!(r in t))&&baseAssignValue(t,r,e)}function isArrayLikeObject(t){return isObjectLike(t)&&isArrayLike(t)}function safeGet(t,r){if(!(r==="constructor"&&typeof t[r]=="function")&&r!="__proto__")return t[r]}function toPlainObject(t){return copyObject(t,keysIn(t))}function baseMergeDeep(t,r,e,n,a,o,s){var l=safeGet(t,e),u=safeGet(r,e),c=s.get(u);if(c){assignMergeValue(t,e,c);return}var d=o?o(l,u,e+"",t,r,s):void 0,f=d===void 0;if(f){var h=isArray(u),p=!h&&isBuffer$1(u),v=!h&&!p&&isTypedArray$1(u);d=u,h||p||v?isArray(l)?d=l:isArrayLikeObject(l)?d=copyArray(l):p?(f=!1,d=cloneBuffer(u,!0)):v?(f=!1,d=cloneTypedArray(u,!0)):d=[]:isPlainObject(u)||isArguments(u)?(d=l,isArguments(l)?d=toPlainObject(l):(!isObject(l)||isFunction(l))&&(d=initCloneObject(u))):f=!1}f&&(s.set(u,d),a(d,u,n,o,s),s.delete(u)),assignMergeValue(t,e,d)}function baseMerge(t,r,e,n,a){t!==r&&baseFor(r,function(o,s){if(a||(a=new Stack),isObject(o))baseMergeDeep(t,r,s,e,baseMerge,n,a);else{var l=n?n(safeGet(t,s),o,s+"",t,r,a):void 0;l===void 0&&(l=o),assignMergeValue(t,s,l)}},keysIn)}var mergeWith=createAssigner(function(t,r,e,n){baseMerge(t,r,e,n)}),FUNC_ERROR_TEXT$1="Expected a function";function baseDelay(t,r,e){if(typeof t!="function")throw new TypeError(FUNC_ERROR_TEXT$1);return setTimeout(function(){t.apply(void 0,e)},r)}var delay=baseRest(function(t,r,e){return baseDelay(t,toNumber(r)||0,e)});function arrayIncludesWith(t,r,e){for(var n=-1,a=t==null?0:t.length;++n<a;)if(e(r,t[n]))return!0;return!1}var LARGE_ARRAY_SIZE$1=200;function baseDifference(t,r,e,n){var a=-1,o=arrayIncludes,s=!0,l=t.length,u=[],c=r.length;if(!l)return u;e&&(r=arrayMap(r,baseUnary(e))),n?(o=arrayIncludesWith,s=!1):r.length>=LARGE_ARRAY_SIZE$1&&(o=cacheHas,s=!1,r=new SetCache(r));e:for(;++a<l;){var d=t[a],f=e==null?d:e(d);if(d=n||d!==0?d:0,s&&f===f){for(var h=c;h--;)if(r[h]===f)continue e;u.push(d)}else o(r,f,n)||u.push(d)}return u}var difference=baseRest(function(t,r){return isArrayLikeObject(t)?baseDifference(t,baseFlatten(r,1,isArrayLikeObject,!0)):[]});function last(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}var differenceWith=baseRest(function(t,r){var e=last(r);return isArrayLikeObject(e)&&(e=void 0),isArrayLikeObject(t)?baseDifference(t,baseFlatten(r,1,isArrayLikeObject,!0),void 0,e):[]});function castFunction(t){return typeof t=="function"?t:identity}function forEach(t,r){var e=isArray(t)?arrayEach:baseEach$1;return e(t,castFunction(r))}function endsWith(t,r,e){t=toString(t),r=baseToString(r);var n=t.length;e=e===void 0?n:baseClamp(toInteger(e),0,n);var a=e;return e-=r.length,e>=0&&t.slice(e,a)==r}var htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},escapeHtmlChar=basePropertyOf(htmlEscapes),escapeHtmlChar$1=escapeHtmlChar,reUnescapedHtml=/[&<>"']/g,reHasUnescapedHtml=RegExp(reUnescapedHtml.source);function escape(t){return t=toString(t),t&&reHasUnescapedHtml.test(t)?t.replace(reUnescapedHtml,escapeHtmlChar$1):t}function arrayEvery(t,r){for(var e=-1,n=t==null?0:t.length;++e<n;)if(!r(t[e],e,t))return!1;return!0}function baseEvery(t,r){var e=!0;return baseEach$1(t,function(n,a,o){return e=!!r(n,a,o),e}),e}function every(t,r,e){var n=isArray(t)?arrayEvery:baseEvery;return e&&isIterateeCall(t,r,e)&&(r=void 0),n(t,baseIteratee(r))}function baseFilter(t,r){var e=[];return baseEach$1(t,function(n,a,o){r(n,a,o)&&e.push(n)}),e}function filter(t,r){var e=isArray(t)?arrayFilter:baseFilter;return e(t,baseIteratee(r))}function createFind(t){return function(r,e,n){var a=Object(r);if(!isArrayLike(r)){var o=baseIteratee(e);r=keys(r),e=function(l){return o(a[l],l,a)}}var s=t(r,e,n);return s>-1?a[o?r[s]:s]:void 0}}var nativeMax$6=Math.max;function findIndex(t,r,e){var n=t==null?0:t.length;if(!n)return-1;var a=e==null?0:toInteger(e);return a<0&&(a=nativeMax$6(n+a,0)),baseFindIndex(t,baseIteratee(r),a)}var find=createFind(findIndex),nativeMax$5=Math.max,nativeMin$2=Math.min;function findLastIndex(t,r,e){var n=t==null?0:t.length;if(!n)return-1;var a=n-1;return e!==void 0&&(a=toInteger(e),a=e<0?nativeMax$5(n+a,0):nativeMin$2(a,n-1)),baseFindIndex(t,baseIteratee(r),a,!0)}var findLast=createFind(findLastIndex);function head(t){return t&&t.length?t[0]:void 0}function baseMap(t,r){var e=-1,n=isArrayLike(t)?Array(t.length):[];return baseEach$1(t,function(a,o,s){n[++e]=r(a,o,s)}),n}function map(t,r){var e=isArray(t)?arrayMap:baseMap;return e(t,baseIteratee(r))}function flatMap(t,r){return baseFlatten(map(t,r),1)}var floor$2=createRound("floor");function forIn(t,r){return t==null?t:baseFor(t,castFunction(r),keysIn)}var objectProto$2=Object.prototype,hasOwnProperty$2=objectProto$2.hasOwnProperty,groupBy=createAggregator(function(t,r,e){hasOwnProperty$2.call(t,e)?t[e].push(r):baseAssignValue(t,e,[r])});function baseGt(t,r){return t>r}var objectProto$1=Object.prototype,hasOwnProperty$1=objectProto$1.hasOwnProperty;function baseHas(t,r){return t!=null&&hasOwnProperty$1.call(t,r)}function has(t,r){return t!=null&&hasPath(t,r,baseHas)}var nativeMax$4=Math.max,nativeMin$1=Math.min;function baseInRange(t,r,e){return t>=nativeMin$1(r,e)&&t<nativeMax$4(r,e)}function inRange(t,r,e){return r=toFinite(r),e===void 0?(e=r,r=0):e=toFinite(e),t=toNumber(t),baseInRange(t,r,e)}var stringTag="[object String]";function isString(t){return typeof t=="string"||!isArray(t)&&isObjectLike(t)&&baseGetTag(t)==stringTag}function baseValues(t,r){return arrayMap(r,function(e){return t[e]})}function values(t){return t==null?[]:baseValues(t,keys(t))}var nativeMax$3=Math.max;function includes(t,r,e,n){t=isArrayLike(t)?t:values(t),e=e&&!n?toInteger(e):0;var a=t.length;return e<0&&(e=nativeMax$3(a+e,0)),isString(t)?e<=a&&t.indexOf(r,e)>-1:!!a&&baseIndexOf(t,r,e)>-1}var nativeMax$2=Math.max;function indexOf(t,r,e){var n=t==null?0:t.length;if(!n)return-1;var a=e==null?0:toInteger(e);return a<0&&(a=nativeMax$2(n+a,0)),baseIndexOf(t,r,a)}var nativeMin=Math.min;function baseIntersection(t,r,e){for(var n=e?arrayIncludesWith:arrayIncludes,a=t[0].length,o=t.length,s=o,l=Array(o),u=1/0,c=[];s--;){var d=t[s];s&&r&&(d=arrayMap(d,baseUnary(r))),u=nativeMin(d.length,u),l[s]=!e&&(r||a>=120&&d.length>=120)?new SetCache(s&&d):void 0}d=t[0];var f=-1,h=l[0];e:for(;++f<a&&c.length<u;){var p=d[f],v=r?r(p):p;if(p=e||p!==0?p:0,!(h?cacheHas(h,v):n(c,v,e))){for(s=o;--s;){var g=l[s];if(!(g?cacheHas(g,v):n(t[s],v,e)))continue e}h&&h.push(v),c.push(p)}}return c}function castArrayLikeObject(t){return isArrayLikeObject(t)?t:[]}var intersection=baseRest(function(t){var r=arrayMap(t,castArrayLikeObject);return r.length&&r[0]===t[0]?baseIntersection(r):[]});function parent(t,r){return r.length<2?t:baseGet(t,baseSlice(r,0,-1))}var boolTag="[object Boolean]";function isBoolean(t){return t===!0||t===!1||isObjectLike(t)&&baseGetTag(t)==boolTag}var mapTag$1="[object Map]",setTag$1="[object Set]",objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty;function isEmpty(t){if(t==null)return!0;if(isArrayLike(t)&&(isArray(t)||typeof t=="string"||typeof t.splice=="function"||isBuffer$1(t)||isTypedArray$1(t)||isArguments(t)))return!t.length;var r=getTag$1(t);if(r==mapTag$1||r==setTag$1)return!t.size;if(isPrototype(t))return!baseKeys(t).length;for(var e in t)if(hasOwnProperty.call(t,e))return!1;return!0}function isEqual(t,r){return baseIsEqual(t,r)}var numberTag="[object Number]";function isNumber(t){return typeof t=="number"||isObjectLike(t)&&baseGetTag(t)==numberTag}function isNil(t){return t==null}function isNull(t){return t===null}var regexpTag="[object RegExp]";function baseIsRegExp(t){return isObjectLike(t)&&baseGetTag(t)==regexpTag}var nodeIsRegExp=nodeUtil&&nodeUtil.isRegExp,isRegExp=nodeIsRegExp?baseUnary(nodeIsRegExp):baseIsRegExp;function isUndefined(t){return t===void 0}var lowerCase=createCompounder(function(t,r,e){return t+(e?" ":"")+r.toLowerCase()});function baseLt(t,r){return t<r}function mapKeys(t,r){var e={};return r=baseIteratee(r),baseForOwn(t,function(n,a,o){baseAssignValue(e,r(n,a,o),n)}),e}function baseExtremum(t,r,e){for(var n=-1,a=t.length;++n<a;){var o=t[n],s=r(o);if(s!=null&&(l===void 0?s===s&&!isSymbol(s):e(s,l)))var l=s,u=o}return u}function max$1(t){return t&&t.length?baseExtremum(t,identity,baseGt):void 0}function maxBy(t,r){return t&&t.length?baseExtremum(t,baseIteratee(r),baseGt):void 0}function baseSum(t,r){for(var e,n=-1,a=t.length;++n<a;){var o=r(t[n]);o!==void 0&&(e=e===void 0?o:e+o)}return e}var merge=createAssigner(function(t,r,e){baseMerge(t,r,e)});function min$1(t){return t&&t.length?baseExtremum(t,identity,baseLt):void 0}function baseUnset(t,r){return r=castPath(r,t),t=parent(t,r),t==null||delete t[toKey(last(r))]}function customOmitClone(t){return isPlainObject(t)?void 0:t}var CLONE_DEEP_FLAG=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG=4,omit=flatRest(function(t,r){var e={};if(t==null)return e;var n=!1;r=arrayMap(r,function(o){return o=castPath(o,t),n||(n=o.length>1),o}),copyObject(t,getAllKeysIn(t),e),n&&(e=baseClone(e,CLONE_DEEP_FLAG|CLONE_FLAT_FLAG|CLONE_SYMBOLS_FLAG,customOmitClone));for(var a=r.length;a--;)baseUnset(e,r[a]);return e});function baseSet(t,r,e,n){if(!isObject(t))return t;r=castPath(r,t);for(var a=-1,o=r.length,s=o-1,l=t;l!=null&&++a<o;){var u=toKey(r[a]),c=e;if(u==="__proto__"||u==="constructor"||u==="prototype")return t;if(a!=s){var d=l[u];c=n?n(d,u,l):void 0,c===void 0&&(c=isObject(d)?d:isIndex(r[a+1])?[]:{})}assignValue(l,u,c),l=l[u]}return t}function basePickBy(t,r,e){for(var n=-1,a=r.length,o={};++n<a;){var s=r[n],l=baseGet(t,s);e(l,s)&&baseSet(o,castPath(s,t),l)}return o}function pickBy(t,r){if(t==null)return{};var e=arrayMap(getAllKeysIn(t),function(n){return[n]});return r=baseIteratee(r),basePickBy(t,e,function(n,a){return r(n,a[0])})}function baseSortBy(t,r){var e=t.length;for(t.sort(r);e--;)t[e]=t[e].value;return t}function compareAscending(t,r){if(t!==r){var e=t!==void 0,n=t===null,a=t===t,o=isSymbol(t),s=r!==void 0,l=r===null,u=r===r,c=isSymbol(r);if(!l&&!c&&!o&&t>r||o&&s&&u&&!l&&!c||n&&s&&u||!e&&u||!a)return 1;if(!n&&!o&&!c&&t<r||c&&e&&a&&!n&&!o||l&&e&&a||!s&&a||!u)return-1}return 0}function compareMultiple(t,r,e){for(var n=-1,a=t.criteria,o=r.criteria,s=a.length,l=e.length;++n<s;){var u=compareAscending(a[n],o[n]);if(u){if(n>=l)return u;var c=e[n];return u*(c=="desc"?-1:1)}}return t.index-r.index}function baseOrderBy(t,r,e){r.length?r=arrayMap(r,function(o){return isArray(o)?function(s){return baseGet(s,o.length===1?o[0]:o)}:o}):r=[identity];var n=-1;r=arrayMap(r,baseUnary(baseIteratee));var a=baseMap(t,function(o,s,l){var u=arrayMap(r,function(c){return c(o)});return{criteria:u,index:++n,value:o}});return baseSortBy(a,function(o,s){return compareMultiple(o,s,e)})}function orderBy(t,r,e,n){return t==null?[]:(isArray(r)||(r=r==null?[]:[r]),e=n?void 0:e,isArray(e)||(e=e==null?[]:[e]),baseOrderBy(t,r,e))}var MAX_SAFE_INTEGER$1=9007199254740991,nativeFloor=Math.floor;function baseRepeat(t,r){var e="";if(!t||r<1||r>MAX_SAFE_INTEGER$1)return e;do r%2&&(e+=t),r=nativeFloor(r/2),r&&(t+=t);while(r);return e}var asciiSize=baseProperty("length"),rsAstralRange="\\ud800-\\udfff",rsComboMarksRange="\\u0300-\\u036f",reComboHalfMarksRange="\\ufe20-\\ufe2f",rsComboSymbolsRange="\\u20d0-\\u20ff",rsComboRange=rsComboMarksRange+reComboHalfMarksRange+rsComboSymbolsRange,rsVarRange="\\ufe0e\\ufe0f",rsAstral="["+rsAstralRange+"]",rsCombo="["+rsComboRange+"]",rsFitz="\\ud83c[\\udffb-\\udfff]",rsModifier="(?:"+rsCombo+"|"+rsFitz+")",rsNonAstral="[^"+rsAstralRange+"]",rsRegional="(?:\\ud83c[\\udde6-\\uddff]){2}",rsSurrPair="[\\ud800-\\udbff][\\udc00-\\udfff]",rsZWJ="\\u200d",reOptMod=rsModifier+"?",rsOptVar="["+rsVarRange+"]?",rsOptJoin="(?:"+rsZWJ+"(?:"+[rsNonAstral,rsRegional,rsSurrPair].join("|")+")"+rsOptVar+reOptMod+")*",rsSeq=rsOptVar+reOptMod+rsOptJoin,rsSymbol="(?:"+[rsNonAstral+rsCombo+"?",rsCombo,rsRegional,rsSurrPair,rsAstral].join("|")+")",reUnicode=RegExp(rsFitz+"(?="+rsFitz+")|"+rsSymbol+rsSeq,"g");function unicodeSize(t){for(var r=reUnicode.lastIndex=0;reUnicode.test(t);)++r;return r}function stringSize(t){return hasUnicode(t)?unicodeSize(t):asciiSize(t)}function basePick(t,r){return basePickBy(t,r,function(e,n){return hasIn(t,n)})}var pick=flatRest(function(t,r){return t==null?{}:basePick(t,r)}),nativeCeil=Math.ceil,nativeMax$1=Math.max;function baseRange(t,r,e,n){for(var a=-1,o=nativeMax$1(nativeCeil((r-t)/(e||1)),0),s=Array(o);o--;)s[n?o:++a]=t,t+=e;return s}function createRange(t){return function(r,e,n){return n&&typeof n!="number"&&isIterateeCall(r,e,n)&&(e=n=void 0),r=toFinite(r),e===void 0?(e=r,r=0):e=toFinite(e),n=n===void 0?r<e?1:-1:toFinite(n),baseRange(r,e,n,t)}}var range=createRange();function baseReduce(t,r,e,n,a){return a(t,function(o,s,l){e=n?(n=!1,o):r(e,o,s,l)}),e}function reduce(t,r,e){var n=isArray(t)?arrayReduce:baseReduce,a=arguments.length<3;return n(t,baseIteratee(r),e,a,baseEach$1)}function repeat(t,r,e){return(e?isIterateeCall(t,r,e):r===void 0)?r=1:r=toInteger(r),baseRepeat(toString(t),r)}function set(t,r,e){return t==null?t:baseSet(t,r,e)}var mapTag="[object Map]",setTag="[object Set]";function size(t){if(t==null)return 0;if(isArrayLike(t))return isString(t)?stringSize(t):t.length;var r=getTag$1(t);return r==mapTag||r==setTag?t.size:baseKeys(t).length}function slice(t,r,e){var n=t==null?0:t.length;return n?(e&&typeof e!="number"&&isIterateeCall(t,r,e)?(r=0,e=n):(r=r==null?0:toInteger(r),e=e===void 0?n:toInteger(e)),baseSlice(t,r,e)):[]}function baseSome(t,r){var e;return baseEach$1(t,function(n,a,o){return e=r(n,a,o),!e}),!!e}function some(t,r,e){var n=isArray(t)?arraySome:baseSome;return e&&isIterateeCall(t,r,e)&&(r=void 0),n(t,baseIteratee(r))}var sortBy=baseRest(function(t,r){if(t==null)return[];var e=r.length;return e>1&&isIterateeCall(t,r[0],r[1])?r=[]:e>2&&isIterateeCall(r[0],r[1],r[2])&&(r=[r[0]]),baseOrderBy(t,baseFlatten(r,1),[])}),MAX_ARRAY_LENGTH=4294967295;function split(t,r,e){return e&&typeof e!="number"&&isIterateeCall(t,r,e)&&(r=e=void 0),e=e===void 0?MAX_ARRAY_LENGTH:e>>>0,e?(t=toString(t),t&&(typeof r=="string"||r!=null&&!isRegExp(r))&&(r=baseToString(r),!r&&hasUnicode(t))?castSlice(stringToArray(t),0,e):t.split(r,e)):[]}function sumBy(t,r){return t&&t.length?baseSum(t,baseIteratee(r)):0}var FUNC_ERROR_TEXT="Expected a function";function throttle(t,r,e){var n=!0,a=!0;if(typeof t!="function")throw new TypeError(FUNC_ERROR_TEXT);return isObject(e)&&(n="leading"in e?!!e.leading:n,a="trailing"in e?!!e.trailing:a),debounce(t,r,{leading:n,maxWait:r,trailing:a})}function toUpper(t){return toString(t).toUpperCase()}var INFINITY=1/0,createSet=Set$1&&1/setToArray(new Set$1([,-0]))[1]==INFINITY?function(t){return new Set$1(t)}:noop,LARGE_ARRAY_SIZE=200;function baseUniq(t,r,e){var n=-1,a=arrayIncludes,o=t.length,s=!0,l=[],u=l;if(e)s=!1,a=arrayIncludesWith;else if(o>=LARGE_ARRAY_SIZE){var c=r?null:createSet(t);if(c)return setToArray(c);s=!1,a=cacheHas,u=new SetCache}else u=r?[]:l;e:for(;++n<o;){var d=t[n],f=r?r(d):d;if(d=e||d!==0?d:0,s&&f===f){for(var h=u.length;h--;)if(u[h]===f)continue e;r&&u.push(f),l.push(d)}else a(u,f,e)||(u!==l&&u.push(f),l.push(d))}return l}var unionBy=baseRest(function(t){var r=last(t);return isArrayLikeObject(r)&&(r=void 0),baseUniq(baseFlatten(t,1,isArrayLikeObject,!0),baseIteratee(r))});function uniq(t){return t&&t.length?baseUniq(t):[]}function unset(t,r){return t==null?!0:baseUnset(t,r)}var nativeMax=Math.max;function unzip(t){if(!(t&&t.length))return[];var r=0;return t=arrayFilter(t,function(e){if(isArrayLikeObject(e))return r=nativeMax(e.length,r),!0}),baseTimes(r,function(e){return arrayMap(t,baseProperty(e))})}var zip=baseRest(unzip),ZH_CN={小计:"小计",总计:"总计",总和:"（总和）",项:"项",已选择:"已选择",序号:"序号",度量:"度量",数值:"数值",共计:"共计",条:"条",趋势:"趋势",隐藏:"隐藏",组内升序:"组内升序",升序:"升序",降序:"降序",组内降序:"组内降序",不排序:"不排序","，":"，"},EN_US={小计:"Total",总计:"Total",总和:"(SUM)",项:"items",已选择:"selected",序号:"Index",度量:"Measure",数值:"Measure",共计:"Total",条:"",隐藏:"Hide",组内升序:"Group ASC",组内降序:"Group DESC",升序:"ASC",降序:"DESC",不排序:"No order","，":", "},DEFAULT_LANG="zh_CN",lang=DEFAULT_LANG,locale={zh_CN:ZH_CN,en_US:EN_US},i18n=function(t,r){return r===void 0&&(r=t),get(locale,[lang,t],r)},BACK_GROUND_GROUP_CONTAINER_Z_INDEX=0,FRONT_GROUND_GROUP_CONTAINER_Z_INDEX=3,FRONT_GROUND_GROUP_SCROLL_Z_INDEX=3,FRONT_GROUND_GROUP_FROZEN_Z_INDEX=4,FRONT_GROUND_GROUP_RESIZE_AREA_Z_INDEX=5,FRONT_GROUND_GROUP_BRUSH_SELECTION_Z_INDEX=5,PANEL_GROUP_GROUP_CONTAINER_Z_INDEX=1,PANEL_GROUP_SCROLL_GROUP_Z_INDEX=1,PANEL_GRID_GROUP_Z_INDEX=2,PANEL_MERGE_GROUP_Z_INDEX=3,PANEL_GROUP_FROZEN_GROUP_Z_INDEX=4,KEY_GROUP_BACK_GROUND="backGroundGroup",KEY_GROUP_FORE_GROUND="foreGroundGroup",KEY_GROUP_PANEL_GROUND="panelGroup",KEY_GROUP_PANEL_SCROLL="panelScrollGroup",KEY_GROUP_MERGED_CELLS="mergedCellsGroup",KEY_GROUP_PANEL_FROZEN_ROW="frozenRowGroup",KEY_GROUP_PANEL_FROZEN_COL="frozenColGroup",KEY_GROUP_PANEL_FROZEN_TRAILING_ROW="frozenTrailingRowGroup",KEY_GROUP_PANEL_FROZEN_TRAILING_COL="frozenTrailingColGroup",KEY_GROUP_PANEL_FROZEN_TOP="frozenTopGroup",KEY_GROUP_PANEL_FROZEN_BOTTOM="frozenBottomGroup",KEY_GROUP_ROW_RESIZE_AREA="rowResizeAreaGroup",KEY_GROUP_FROZEN_ROW_RESIZE_AREA="rowFrozenResizeAreaGroup",KEY_GROUP_FROZEN_SPLIT_LINE="frozenSplitLine",KEY_GROUP_ROW_INDEX_RESIZE_AREA="rowIndexResizeAreaGroup",KEY_GROUP_CORNER_RESIZE_AREA="cornerResizeAreaGroup",KEY_GROUP_COL_RESIZE_AREA="colResizeAreaGroup",KEY_GROUP_FROZEN_COL_RESIZE_AREA="colFrozenResizeAreaGroup",KEY_GROUP_COL_SCROLL="colScrollGroup",KEY_GROUP_COL_FROZEN="colFrozenGroup",KEY_GROUP_COL_FROZEN_TRAILING="colFrozenTrailingGroup",KEY_GROUP_GRID_GROUP="gridGroup",KEY_GROUP_ROW_SCROLL="rowScrollGroup",KEY_GROUP_ROW_HEADER_FROZEN="rowHeaderFrozenGroup",HORIZONTAL_RESIZE_AREA_KEY_PRE="horizontal-resize-area-",EMPTY_PLACEHOLDER="-",PRECISION=16,DEFAULT_CORNER_MAX_WIDTH_RATIO=.5,LAYOUT_SAMPLE_COUNT=50,MiniChartType;(function(t){t.Line="line",t.Bar="bar",t.Bullet="bullet"})(MiniChartType||(MiniChartType={}));var getDefaultSeriesNumberText=function(t){return t??i18n("序号")},getDefaultCornerText=function(){return i18n("指标")},S2_PREFIX_CLS="antv-s2",VALUE_RANGES_KEY="valueRanges",DEFAULT_VALUE_RANGES={},DEFAULT_FONT_COLOR="#000000",REVERSE_FONT_COLOR="#FFFFFF",DEFAULT_DATA_CONFIG={data:[],fields:{rows:[],columns:[],values:[],valueInCols:!0},meta:[],sortParams:[],filterParams:[]},_a$2,FrozenCellType;(function(t){t.ROW="row",t.COL="col",t.TRAILING_ROW="trailingRow",t.TRAILING_COL="trailingCol",t.SCROLL="scroll",t.TOP="top",t.BOTTOM="bottom"})(FrozenCellType||(FrozenCellType={}));var FrozenGroupType;(function(t){t.FROZEN_COL="frozenCol",t.FROZEN_ROW="frozenRow",t.FROZEN_TRAILING_COL="frozenTrailingCol",t.FROZEN_TRAILING_ROW="frozenTrailingRow"})(FrozenGroupType||(FrozenGroupType={}));var FrozenCellGroupMap=(_a$2={},_a$2[FrozenCellType.ROW]="frozenRowGroup",_a$2[FrozenCellType.COL]="frozenColGroup",_a$2[FrozenCellType.TRAILING_COL]="frozenTrailingColGroup",_a$2[FrozenCellType.TRAILING_ROW]="frozenTrailingRowGroup",_a$2[FrozenCellType.SCROLL]="panelScrollGroup",_a$2[FrozenCellType.TOP]="frozenTopGroup",_a$2[FrozenCellType.BOTTOM]="frozenBottomGroup",_a$2),InteractionName;(function(t){t.CORNER_CELL_CLICK="cornerCellClick",t.DATA_CELL_CLICK="dataCellClick",t.MERGED_CELLS_CLICK="mergedCellsClick",t.ROW_COLUMN_CLICK="rowColumnClick",t.ROW_TEXT_CLICK="rowTextClick",t.HOVER="hover",t.DATA_CELL_BRUSH_SELECTION="dataCellBrushSelection",t.ROW_CELL_BRUSH_SELECTION="rowCellBrushSelection",t.COL_CELL_BRUSH_SELECTION="colCellBrushSelection",t.COL_ROW_RESIZE="rowColResize",t.DATA_CELL_MULTI_SELECTION="dataCellMultiSelection",t.RANGE_SELECTION="rangeSelection",t.SELECTED_CELL_MOVE="selectedCellMove"})(InteractionName||(InteractionName={}));var InteractionStateName;(function(t){t.ALL_SELECTED="allSelected",t.SELECTED="selected",t.ROW_CELL_BRUSH_SELECTED="rowCellBrushSelected",t.COL_CELL_BRUSH_SELECTED="colCellBrushSelected",t.DATA_CELL_BRUSH_SELECTED="dataCellBrushSelected",t.UNSELECTED="unselected",t.HOVER="hover",t.HOVER_FOCUS="hoverFocus",t.HIGHLIGHT="highlight",t.SEARCH_RESULT="searchResult",t.PREPARE_SELECT="prepareSelect"})(InteractionStateName||(InteractionStateName={}));var CellType;(function(t){t.DATA_CELL="dataCell",t.ROW_CELL="rowCell",t.COL_CELL="colCell",t.SERIES_NUMBER_CELL="seriesNumberCell",t.CORNER_CELL="cornerCell",t.MERGED_CELL="mergedCell"})(CellType||(CellType={}));var HOVER_FOCUS_DURATION=800,SHAPE_STYLE_MAP={textOpacity:"fillOpacity",backgroundOpacity:"fillOpacity",backgroundColor:"fill",borderOpacity:"strokeOpacity",borderColor:"stroke",borderWidth:"lineWidth",opacity:"opacity"},SHAPE_ATTRS_MAP={textShape:["textOpacity"],textShapes:["textOpacity"],linkFieldShape:["opacity"],interactiveBgShape:["backgroundColor","backgroundOpacity"],interactiveBorderShape:["borderColor","borderOpacity","borderWidth"]},INTERACTION_STATE_INFO_KEY="interactionStateInfo",InteractionBrushSelectionStage;(function(t){t.CLICK="click",t.UN_DRAGGED="unDragged",t.DRAGGED="dragged"})(InteractionBrushSelectionStage||(InteractionBrushSelectionStage={}));var InteractionKeyboardKey;(function(t){t.SHIFT="Shift",t.COPY="c",t.ESC="Escape",t.META="Meta",t.CONTROL="Control",t.ARROW_UP="ArrowUp",t.ARROW_DOWN="ArrowDown",t.ARROW_LEFT="ArrowLeft",t.ARROW_RIGHT="ArrowRight"})(InteractionKeyboardKey||(InteractionKeyboardKey={}));var SortMethodType;(function(t){t.ASC="ASC",t.DESC="DESC"})(SortMethodType||(SortMethodType={}));var InterceptType;(function(t){t.HOVER="hover",t.CLICK="click",t.DATA_CELL_BRUSH_SELECTION="dataCellBrushSelection",t.ROW_CELL_BRUSH_SELECTION="rowCellBrushSelection",t.COL_CELL_BRUSH_SELECTION="colCellBrushSelection",t.MULTI_SELECTION="multiSelection",t.RESIZE="resize"})(InterceptType||(InterceptType={}));var BRUSH_AUTO_SCROLL_INITIAL_CONFIG={x:{value:0,scroll:!1},y:{value:0,scroll:!1}},ScrollbarPositionType;(function(t){t.CONTENT="content",t.CANVAS="canvas"})(ScrollbarPositionType||(ScrollbarPositionType={}));var ScrollDirection;(function(t){t.SCROLL_UP="scrollUp",t.SCROLL_DOWN="scrollDown"})(ScrollDirection||(ScrollDirection={}));var ScrollDirectionRowIndexDiff;(function(t){t[t.SCROLL_UP=-1]="SCROLL_UP",t[t.SCROLL_DOWN=1]="SCROLL_DOWN"})(ScrollDirectionRowIndexDiff||(ScrollDirectionRowIndexDiff={}));var RESIZE_START_GUIDE_LINE_ID="RESIZE_START_GUIDE_LINE",RESIZE_END_GUIDE_LINE_ID="RESIZE_END_GUIDE_LINE",RESIZE_MASK_ID="RESIZE_MASK",RESIZE_MIN_CELL_WIDTH=20,RESIZE_MIN_CELL_HEIGHT=20,ResizeDirectionType;(function(t){t.Horizontal="col",t.Vertical="row"})(ResizeDirectionType||(ResizeDirectionType={}));var ResizeAreaEffect;(function(t){t.Field="field",t.Cell="cell",t.Tree="tree",t.Series="series"})(ResizeAreaEffect||(ResizeAreaEffect={}));var ResizeType;(function(t){t.ALL="all",t.CURRENT="current",t.SELECTED="selected"})(ResizeType||(ResizeType={}));var DeviceType;(function(t){t.PC="pc",t.MOBILE="mobile"})(DeviceType||(DeviceType={}));var MIN_DEVICE_PIXEL_RATIO=1,LayoutWidthType;(function(t){t.Adaptive="adaptive",t.ColAdaptive="colAdaptive",t.Compact="compact"})(LayoutWidthType||(LayoutWidthType={}));var SPLIT_LINE_WIDTH=1,DEFAULT_TREE_ROW_CELL_WIDTH=120,DEFAULT_CELL_TEXT_WORD_WRAP_STYLE={wordWrap:!0,maxLines:1,textOverflow:"ellipsis"},DEFAULT_STYLE={layoutWidthType:LayoutWidthType.Adaptive,seriesNumberCell:DEFAULT_CELL_TEXT_WORD_WRAP_STYLE,cornerCell:DEFAULT_CELL_TEXT_WORD_WRAP_STYLE,rowCell:__assign(__assign({},DEFAULT_CELL_TEXT_WORD_WRAP_STYLE),{showTreeLeafNodeAlignDot:!1,widthByField:null,heightByField:null}),colCell:__assign(__assign({},DEFAULT_CELL_TEXT_WORD_WRAP_STYLE),{height:30,widthByField:null,heightByField:null}),dataCell:__assign(__assign({},DEFAULT_CELL_TEXT_WORD_WRAP_STYLE),{width:96,height:30})},DEFAULT_OPTIONS={width:600,height:480,debug:!1,hierarchyType:"grid",device:DeviceType.PC,conditions:{},totals:{},tooltip:{enable:!1,autoAdjustBoundary:"body",operation:{hiddenColumns:!1,sort:!1,menu:{items:[]}}},interaction:{copy:{enable:!0,withFormat:!0,withHeader:!1},linkFields:[],hiddenColumnFields:[],selectedCellsSpotlight:!1,hoverHighlight:!0,hoverFocus:{duration:HOVER_FOCUS_DURATION},scrollSpeedRatio:{horizontal:1,vertical:1},autoResetSheetStyle:!0,brushSelection:{dataCell:!0,rowCell:!0,colCell:!0},multiSelection:!0,rangeSelection:!0,scrollbarPosition:ScrollbarPositionType.CONTENT,resize:{rowCellVertical:!0,cornerCellHorizontal:!0,colCellHorizontal:!0,colCellVertical:!0,rowResizeType:ResizeType.CURRENT,colResizeType:ResizeType.CURRENT,minCellWidth:RESIZE_MIN_CELL_WIDTH,minCellHeight:RESIZE_MIN_CELL_HEIGHT},eventListenerOptions:!1,selectedCellHighlight:!1,overscrollBehavior:"auto"},seriesNumber:{enable:!1},customSVGIcons:[],showDefaultHeaderActionIcon:!1,headerActionIcons:[],style:DEFAULT_STYLE,frozen:{rowHeader:!0,rowCount:0,colCount:0,trailingRowCount:0,trailingColCount:0},hd:!0,cornerText:"",cornerExtraFieldText:"",placeholder:EMPTY_PLACEHOLDER};function _typeof(t){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},_typeof(t)}var trimLeft=/^\s+/,trimRight=/\s+$/;function tinycolor(t,r){if(t=t||"",r=r||{},t instanceof tinycolor)return t;if(!(this instanceof tinycolor))return new tinycolor(t,r);var e=inputToRGB(t);this._originalInput=t,this._r=e.r,this._g=e.g,this._b=e.b,this._a=e.a,this._roundA=Math.round(100*this._a)/100,this._format=r.format||e.format,this._gradientType=r.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=e.ok}tinycolor.prototype={isDark:function t(){return this.getBrightness()<128},isLight:function t(){return!this.isDark()},isValid:function t(){return this._ok},getOriginalInput:function t(){return this._originalInput},getFormat:function t(){return this._format},getAlpha:function t(){return this._a},getBrightness:function t(){var r=this.toRgb();return(r.r*299+r.g*587+r.b*114)/1e3},getLuminance:function t(){var r=this.toRgb(),e,n,a,o,s,l;return e=r.r/255,n=r.g/255,a=r.b/255,e<=.03928?o=e/12.92:o=Math.pow((e+.055)/1.055,2.4),n<=.03928?s=n/12.92:s=Math.pow((n+.055)/1.055,2.4),a<=.03928?l=a/12.92:l=Math.pow((a+.055)/1.055,2.4),.2126*o+.7152*s+.0722*l},setAlpha:function t(r){return this._a=boundAlpha(r),this._roundA=Math.round(100*this._a)/100,this},toHsv:function t(){var r=rgbToHsv(this._r,this._g,this._b);return{h:r.h*360,s:r.s,v:r.v,a:this._a}},toHsvString:function t(){var r=rgbToHsv(this._r,this._g,this._b),e=Math.round(r.h*360),n=Math.round(r.s*100),a=Math.round(r.v*100);return this._a==1?"hsv("+e+", "+n+"%, "+a+"%)":"hsva("+e+", "+n+"%, "+a+"%, "+this._roundA+")"},toHsl:function t(){var r=rgbToHsl(this._r,this._g,this._b);return{h:r.h*360,s:r.s,l:r.l,a:this._a}},toHslString:function t(){var r=rgbToHsl(this._r,this._g,this._b),e=Math.round(r.h*360),n=Math.round(r.s*100),a=Math.round(r.l*100);return this._a==1?"hsl("+e+", "+n+"%, "+a+"%)":"hsla("+e+", "+n+"%, "+a+"%, "+this._roundA+")"},toHex:function t(r){return rgbToHex(this._r,this._g,this._b,r)},toHexString:function t(r){return"#"+this.toHex(r)},toHex8:function t(r){return rgbaToHex(this._r,this._g,this._b,this._a,r)},toHex8String:function t(r){return"#"+this.toHex8(r)},toRgb:function t(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function t(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function t(){return{r:Math.round(bound01(this._r,255)*100)+"%",g:Math.round(bound01(this._g,255)*100)+"%",b:Math.round(bound01(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function t(){return this._a==1?"rgb("+Math.round(bound01(this._r,255)*100)+"%, "+Math.round(bound01(this._g,255)*100)+"%, "+Math.round(bound01(this._b,255)*100)+"%)":"rgba("+Math.round(bound01(this._r,255)*100)+"%, "+Math.round(bound01(this._g,255)*100)+"%, "+Math.round(bound01(this._b,255)*100)+"%, "+this._roundA+")"},toName:function t(){return this._a===0?"transparent":this._a<1?!1:hexNames[rgbToHex(this._r,this._g,this._b,!0)]||!1},toFilter:function t(r){var e="#"+rgbaToArgbHex(this._r,this._g,this._b,this._a),n=e,a=this._gradientType?"GradientType = 1, ":"";if(r){var o=tinycolor(r);n="#"+rgbaToArgbHex(o._r,o._g,o._b,o._a)}return"progid:DXImageTransform.Microsoft.gradient("+a+"startColorstr="+e+",endColorstr="+n+")"},toString:function t(r){var e=!!r;r=r||this._format;var n=!1,a=this._a<1&&this._a>=0,o=!e&&a&&(r==="hex"||r==="hex6"||r==="hex3"||r==="hex4"||r==="hex8"||r==="name");return o?r==="name"&&this._a===0?this.toName():this.toRgbString():(r==="rgb"&&(n=this.toRgbString()),r==="prgb"&&(n=this.toPercentageRgbString()),(r==="hex"||r==="hex6")&&(n=this.toHexString()),r==="hex3"&&(n=this.toHexString(!0)),r==="hex4"&&(n=this.toHex8String(!0)),r==="hex8"&&(n=this.toHex8String()),r==="name"&&(n=this.toName()),r==="hsl"&&(n=this.toHslString()),r==="hsv"&&(n=this.toHsvString()),n||this.toHexString())},clone:function t(){return tinycolor(this.toString())},_applyModification:function t(r,e){var n=r.apply(null,[this].concat([].slice.call(e)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function t(){return this._applyModification(_lighten,arguments)},brighten:function t(){return this._applyModification(_brighten,arguments)},darken:function t(){return this._applyModification(_darken,arguments)},desaturate:function t(){return this._applyModification(_desaturate,arguments)},saturate:function t(){return this._applyModification(_saturate,arguments)},greyscale:function t(){return this._applyModification(_greyscale,arguments)},spin:function t(){return this._applyModification(_spin,arguments)},_applyCombination:function t(r,e){return r.apply(null,[this].concat([].slice.call(e)))},analogous:function t(){return this._applyCombination(_analogous,arguments)},complement:function t(){return this._applyCombination(_complement,arguments)},monochromatic:function t(){return this._applyCombination(_monochromatic,arguments)},splitcomplement:function t(){return this._applyCombination(_splitcomplement,arguments)},triad:function t(){return this._applyCombination(polyad,[3])},tetrad:function t(){return this._applyCombination(polyad,[4])}};tinycolor.fromRatio=function(t,r){if(_typeof(t)=="object"){var e={};for(var n in t)t.hasOwnProperty(n)&&(n==="a"?e[n]=t[n]:e[n]=convertToPercentage(t[n]));t=e}return tinycolor(t,r)};function inputToRGB(t){var r={r:0,g:0,b:0},e=1,n=null,a=null,o=null,s=!1,l=!1;return typeof t=="string"&&(t=stringInputToObject(t)),_typeof(t)=="object"&&(isValidCSSUnit(t.r)&&isValidCSSUnit(t.g)&&isValidCSSUnit(t.b)?(r=rgbToRgb(t.r,t.g,t.b),s=!0,l=String(t.r).substr(-1)==="%"?"prgb":"rgb"):isValidCSSUnit(t.h)&&isValidCSSUnit(t.s)&&isValidCSSUnit(t.v)?(n=convertToPercentage(t.s),a=convertToPercentage(t.v),r=hsvToRgb(t.h,n,a),s=!0,l="hsv"):isValidCSSUnit(t.h)&&isValidCSSUnit(t.s)&&isValidCSSUnit(t.l)&&(n=convertToPercentage(t.s),o=convertToPercentage(t.l),r=hslToRgb(t.h,n,o),s=!0,l="hsl"),t.hasOwnProperty("a")&&(e=t.a)),e=boundAlpha(e),{ok:s,format:t.format||l,r:Math.min(255,Math.max(r.r,0)),g:Math.min(255,Math.max(r.g,0)),b:Math.min(255,Math.max(r.b,0)),a:e}}function rgbToRgb(t,r,e){return{r:bound01(t,255)*255,g:bound01(r,255)*255,b:bound01(e,255)*255}}function rgbToHsl(t,r,e){t=bound01(t,255),r=bound01(r,255),e=bound01(e,255);var n=Math.max(t,r,e),a=Math.min(t,r,e),o,s,l=(n+a)/2;if(n==a)o=s=0;else{var u=n-a;switch(s=l>.5?u/(2-n-a):u/(n+a),n){case t:o=(r-e)/u+(r<e?6:0);break;case r:o=(e-t)/u+2;break;case e:o=(t-r)/u+4;break}o/=6}return{h:o,s,l}}function hslToRgb(t,r,e){var n,a,o;t=bound01(t,360),r=bound01(r,100),e=bound01(e,100);function s(c,d,f){return f<0&&(f+=1),f>1&&(f-=1),f<1/6?c+(d-c)*6*f:f<1/2?d:f<2/3?c+(d-c)*(2/3-f)*6:c}if(r===0)n=a=o=e;else{var l=e<.5?e*(1+r):e+r-e*r,u=2*e-l;n=s(u,l,t+1/3),a=s(u,l,t),o=s(u,l,t-1/3)}return{r:n*255,g:a*255,b:o*255}}function rgbToHsv(t,r,e){t=bound01(t,255),r=bound01(r,255),e=bound01(e,255);var n=Math.max(t,r,e),a=Math.min(t,r,e),o,s,l=n,u=n-a;if(s=n===0?0:u/n,n==a)o=0;else{switch(n){case t:o=(r-e)/u+(r<e?6:0);break;case r:o=(e-t)/u+2;break;case e:o=(t-r)/u+4;break}o/=6}return{h:o,s,v:l}}function hsvToRgb(t,r,e){t=bound01(t,360)*6,r=bound01(r,100),e=bound01(e,100);var n=Math.floor(t),a=t-n,o=e*(1-r),s=e*(1-a*r),l=e*(1-(1-a)*r),u=n%6,c=[e,s,o,o,l,e][u],d=[l,e,e,s,o,o][u],f=[o,o,l,e,e,s][u];return{r:c*255,g:d*255,b:f*255}}function rgbToHex(t,r,e,n){var a=[pad2(Math.round(t).toString(16)),pad2(Math.round(r).toString(16)),pad2(Math.round(e).toString(16))];return n&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0):a.join("")}function rgbaToHex(t,r,e,n,a){var o=[pad2(Math.round(t).toString(16)),pad2(Math.round(r).toString(16)),pad2(Math.round(e).toString(16)),pad2(convertDecimalToHex(n))];return a&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)&&o[3].charAt(0)==o[3].charAt(1)?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0):o.join("")}function rgbaToArgbHex(t,r,e,n){var a=[pad2(convertDecimalToHex(n)),pad2(Math.round(t).toString(16)),pad2(Math.round(r).toString(16)),pad2(Math.round(e).toString(16))];return a.join("")}tinycolor.equals=function(t,r){return!t||!r?!1:tinycolor(t).toRgbString()==tinycolor(r).toRgbString()};tinycolor.random=function(){return tinycolor.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function _desaturate(t,r){r=r===0?0:r||10;var e=tinycolor(t).toHsl();return e.s-=r/100,e.s=clamp01(e.s),tinycolor(e)}function _saturate(t,r){r=r===0?0:r||10;var e=tinycolor(t).toHsl();return e.s+=r/100,e.s=clamp01(e.s),tinycolor(e)}function _greyscale(t){return tinycolor(t).desaturate(100)}function _lighten(t,r){r=r===0?0:r||10;var e=tinycolor(t).toHsl();return e.l+=r/100,e.l=clamp01(e.l),tinycolor(e)}function _brighten(t,r){r=r===0?0:r||10;var e=tinycolor(t).toRgb();return e.r=Math.max(0,Math.min(255,e.r-Math.round(255*-(r/100)))),e.g=Math.max(0,Math.min(255,e.g-Math.round(255*-(r/100)))),e.b=Math.max(0,Math.min(255,e.b-Math.round(255*-(r/100)))),tinycolor(e)}function _darken(t,r){r=r===0?0:r||10;var e=tinycolor(t).toHsl();return e.l-=r/100,e.l=clamp01(e.l),tinycolor(e)}function _spin(t,r){var e=tinycolor(t).toHsl(),n=(e.h+r)%360;return e.h=n<0?360+n:n,tinycolor(e)}function _complement(t){var r=tinycolor(t).toHsl();return r.h=(r.h+180)%360,tinycolor(r)}function polyad(t,r){if(isNaN(r)||r<=0)throw new Error("Argument to polyad must be a positive number");for(var e=tinycolor(t).toHsl(),n=[tinycolor(t)],a=360/r,o=1;o<r;o++)n.push(tinycolor({h:(e.h+o*a)%360,s:e.s,l:e.l}));return n}function _splitcomplement(t){var r=tinycolor(t).toHsl(),e=r.h;return[tinycolor(t),tinycolor({h:(e+72)%360,s:r.s,l:r.l}),tinycolor({h:(e+216)%360,s:r.s,l:r.l})]}function _analogous(t,r,e){r=r||6,e=e||30;var n=tinycolor(t).toHsl(),a=360/e,o=[tinycolor(t)];for(n.h=(n.h-(a*r>>1)+720)%360;--r;)n.h=(n.h+a)%360,o.push(tinycolor(n));return o}function _monochromatic(t,r){r=r||6;for(var e=tinycolor(t).toHsv(),n=e.h,a=e.s,o=e.v,s=[],l=1/r;r--;)s.push(tinycolor({h:n,s:a,v:o})),o=(o+l)%1;return s}tinycolor.mix=function(t,r,e){e=e===0?0:e||50;var n=tinycolor(t).toRgb(),a=tinycolor(r).toRgb(),o=e/100,s={r:(a.r-n.r)*o+n.r,g:(a.g-n.g)*o+n.g,b:(a.b-n.b)*o+n.b,a:(a.a-n.a)*o+n.a};return tinycolor(s)};tinycolor.readability=function(t,r){var e=tinycolor(t),n=tinycolor(r);return(Math.max(e.getLuminance(),n.getLuminance())+.05)/(Math.min(e.getLuminance(),n.getLuminance())+.05)};tinycolor.isReadable=function(t,r,e){var n=tinycolor.readability(t,r),a,o;switch(o=!1,a=validateWCAG2Parms(e),a.level+a.size){case"AAsmall":case"AAAlarge":o=n>=4.5;break;case"AAlarge":o=n>=3;break;case"AAAsmall":o=n>=7;break}return o};tinycolor.mostReadable=function(t,r,e){var n=null,a=0,o,s,l,u;e=e||{},s=e.includeFallbackColors,l=e.level,u=e.size;for(var c=0;c<r.length;c++)o=tinycolor.readability(t,r[c]),o>a&&(a=o,n=tinycolor(r[c]));return tinycolor.isReadable(t,n,{level:l,size:u})||!s?n:(e.includeFallbackColors=!1,tinycolor.mostReadable(t,["#fff","#000"],e))};var names=tinycolor.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},hexNames=tinycolor.hexNames=flip(names);function flip(t){var r={};for(var e in t)t.hasOwnProperty(e)&&(r[t[e]]=e);return r}function boundAlpha(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function bound01(t,r){isOnePointZero(t)&&(t="100%");var e=isPercentage(t);return t=Math.min(r,Math.max(0,parseFloat(t))),e&&(t=parseInt(t*r,10)/100),Math.abs(t-r)<1e-6?1:t%r/parseFloat(r)}function clamp01(t){return Math.min(1,Math.max(0,t))}function parseIntFromHex(t){return parseInt(t,16)}function isOnePointZero(t){return typeof t=="string"&&t.indexOf(".")!=-1&&parseFloat(t)===1}function isPercentage(t){return typeof t=="string"&&t.indexOf("%")!=-1}function pad2(t){return t.length==1?"0"+t:""+t}function convertToPercentage(t){return t<=1&&(t=t*100+"%"),t}function convertDecimalToHex(t){return Math.round(parseFloat(t)*255).toString(16)}function convertHexToDecimal(t){return parseIntFromHex(t)/255}var matchers=function(){var t="[-\\+]?\\d+%?",r="[-\\+]?\\d*\\.\\d+%?",e="(?:"+r+")|(?:"+t+")",n="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?",a="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?";return{CSS_UNIT:new RegExp(e),rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+a),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+a),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+a),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function isValidCSSUnit(t){return!!matchers.CSS_UNIT.exec(t)}function stringInputToObject(t){t=t.replace(trimLeft,"").replace(trimRight,"").toLowerCase();var r=!1;if(names[t])t=names[t],r=!0;else if(t=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var e;return(e=matchers.rgb.exec(t))?{r:e[1],g:e[2],b:e[3]}:(e=matchers.rgba.exec(t))?{r:e[1],g:e[2],b:e[3],a:e[4]}:(e=matchers.hsl.exec(t))?{h:e[1],s:e[2],l:e[3]}:(e=matchers.hsla.exec(t))?{h:e[1],s:e[2],l:e[3],a:e[4]}:(e=matchers.hsv.exec(t))?{h:e[1],s:e[2],v:e[3]}:(e=matchers.hsva.exec(t))?{h:e[1],s:e[2],v:e[3],a:e[4]}:(e=matchers.hex8.exec(t))?{r:parseIntFromHex(e[1]),g:parseIntFromHex(e[2]),b:parseIntFromHex(e[3]),a:convertHexToDecimal(e[4]),format:r?"name":"hex8"}:(e=matchers.hex6.exec(t))?{r:parseIntFromHex(e[1]),g:parseIntFromHex(e[2]),b:parseIntFromHex(e[3]),format:r?"name":"hex"}:(e=matchers.hex4.exec(t))?{r:parseIntFromHex(e[1]+""+e[1]),g:parseIntFromHex(e[2]+""+e[2]),b:parseIntFromHex(e[3]+""+e[3]),a:convertHexToDecimal(e[4]+""+e[4]),format:r?"name":"hex8"}:(e=matchers.hex3.exec(t))?{r:parseIntFromHex(e[1]+""+e[1]),g:parseIntFromHex(e[2]+""+e[2]),b:parseIntFromHex(e[3]+""+e[3]),format:r?"name":"hex"}:!1}function validateWCAG2Parms(t){var r,e;return t=t||{level:"AA",size:"small"},r=(t.level||"AA").toUpperCase(),e=(t.size||"small").toLowerCase(),r!=="AA"&&r!=="AAA"&&(r="AA"),e!=="small"&&e!=="large"&&(e="small"),{level:r,size:e}}var WHITE_COLOR="#FFFFFF",BLACK_COLOR="#000000",STANDARD_COLOR_MIX_PERCENT=[95,85,75,30,15,0,15,30,45,60,80],BASIC_COLOR_COUNT=15,shouldReverseFontColor=function(t){return tinycolor(t).getLuminance()<=.5},FONT_COLOR_RELATIONS=[{fontColorIndex:0,bgColorIndex:3},{fontColorIndex:13,bgColorIndex:8},{fontColorIndex:14,bgColorIndex:1}],generateStandardColors=function(t){for(var r=[],e=0;e<11;e++){var n=STANDARD_COLOR_MIX_PERCENT[e];r.push(toUpper(n===0?t:tinycolor.mix(t,e<5?WHITE_COLOR:BLACK_COLOR,n).toHexString()))}return r},generatePalette=function(t){t===void 0&&(t={});var r=Array.from(Array(BASIC_COLOR_COUNT)).fill(REVERSE_FONT_COLOR),e=t.basicColorRelations,n=e===void 0?[]:e,a=t.brandColor,o=generateStandardColors(a);return n.forEach(function(s){r[s.basicColorIndex]=o[s.standardColorIndex]}),FONT_COLOR_RELATIONS.forEach(function(s){var l=s.fontColorIndex,u=s.bgColorIndex;r[l]=shouldReverseFontColor(r[u])?REVERSE_FONT_COLOR:DEFAULT_FONT_COLOR}),__assign(__assign({},t),{basicColors:r})},paletteColorfulMeta={brandColor:"#3471F9",semanticColors:{red:"#FF4D4F",green:"#29A294",yellow:"#FAAD14"},others:{highlight:"#87B5FF",results:"#F0F7FF"},basicColorRelations:[{basicColorIndex:1,standardColorIndex:0},{basicColorIndex:2,standardColorIndex:1},{basicColorIndex:3,standardColorIndex:5},{basicColorIndex:4,standardColorIndex:6},{basicColorIndex:5,standardColorIndex:6},{basicColorIndex:6,standardColorIndex:6},{basicColorIndex:7,standardColorIndex:5},{basicColorIndex:9,standardColorIndex:1},{basicColorIndex:10,standardColorIndex:4},{basicColorIndex:11,standardColorIndex:4},{basicColorIndex:12,standardColorIndex:5}]},paletteColorful=generatePalette(paletteColorfulMeta),paletteDefaultMeta={brandColor:"#326EF4",semanticColors:{red:"#FF4D4F",green:"#29A294",yellow:"#FAAD14"},others:{highlight:"#87B5FF",results:"#F0F7FF"},basicColorRelations:[{basicColorIndex:1,standardColorIndex:0},{basicColorIndex:2,standardColorIndex:1},{basicColorIndex:3,standardColorIndex:1},{basicColorIndex:4,standardColorIndex:2},{basicColorIndex:5,standardColorIndex:7},{basicColorIndex:6,standardColorIndex:5},{basicColorIndex:7,standardColorIndex:5},{basicColorIndex:9,standardColorIndex:1},{basicColorIndex:10,standardColorIndex:2},{basicColorIndex:11,standardColorIndex:5},{basicColorIndex:12,standardColorIndex:5}]},paletteDefault=generatePalette(paletteDefaultMeta),paletteGrayMeta={brandColor:"#9DA7B6",semanticColors:{red:"#FF4D4F",green:"#29A294",yellow:"#FAAD14"},others:{highlight:"#87B5FF",results:"#F0F7FF"},basicColorRelations:[{basicColorIndex:1,standardColorIndex:0},{basicColorIndex:2,standardColorIndex:1},{basicColorIndex:3,standardColorIndex:1},{basicColorIndex:4,standardColorIndex:2},{basicColorIndex:5,standardColorIndex:7},{basicColorIndex:6,standardColorIndex:8},{basicColorIndex:7,standardColorIndex:5},{basicColorIndex:9,standardColorIndex:1},{basicColorIndex:10,standardColorIndex:2},{basicColorIndex:11,standardColorIndex:3},{basicColorIndex:12,standardColorIndex:3}]},paletteGray=generatePalette(paletteGrayMeta),paletteDark={brandColor:"#255dff",semanticColors:{red:"#FF4D4F",green:"#29A294",yellow:"#FAAD14"},basicColors:["#ffffff","#151a27","#213f94","#133aad","#213f94","#255dff","#4b91ff","#4b91ff","#191919","#1e2436","#0647b1","#7899ff","#7899ff","#f0f0f0","#dcdcdc"],basicColorRelations:[]},PALETTE_MAP={default:paletteDefault,colorful:paletteColorful,gray:paletteGray,dark:paletteDark},FONT_FAMILY="Roboto, PingFangSC, Microsoft YaHei, Arial, sans-serif",INTERVAL_BAR_HEIGHT=12,STYLE_ELEMENT_ID="antv-s2-core-vars",G2_THEME_TYPE={default:"light",colorful:"light",gray:"light",dark:"dark"},TOOLTIP_PREFIX_CLS="".concat(S2_PREFIX_CLS,"-tooltip"),TOOLTIP_CONTAINER_CLS="".concat(TOOLTIP_PREFIX_CLS,"-container"),TOOLTIP_CONTAINER_SHOW_CLS="".concat(TOOLTIP_CONTAINER_CLS,"-show"),TOOLTIP_CONTAINER_HIDE_CLS="".concat(TOOLTIP_CONTAINER_CLS,"-hide"),TOOLTIP_POSITION_OFFSET={x:15,y:10},getTooltipOperatorHiddenColumnsMenu=function(){return{key:"hiddenColumns",label:i18n("隐藏"),icon:"EyeOutlined"}},getTooltipOperatorSortMenus=function(){return[{key:"asc",icon:"groupAsc",label:i18n("组内升序")},{key:"desc",icon:"groupDesc",label:i18n("组内降序")},{key:"none",label:i18n("不排序")}]},getTooltipOperatorTableSortMenus=function(){return[{key:"asc",icon:"groupAsc",label:i18n("升序")},{key:"desc",icon:"groupDesc",label:i18n("降序")},{key:"none",label:i18n("不排序")}]},CopyType;(function(t){t[t.ALL=0]="ALL",t[t.COL=1]="COL",t[t.ROW=2]="ROW"})(CopyType||(CopyType={}));var NewLine=`\r
`,NewTab="	",AsyncRenderThreshold=5e3,DEFAULT_PAGE_INDEX=1,ROOT_NODE_ID="root",NODE_ID_SEPARATOR="[&]",QueryDataType;(function(t){t.All="all",t.DetailOnly="detailOnly"})(QueryDataType||(QueryDataType={}));var DEBUG_TRANSFORM_DATA="Transform Data",DEBUG_HEADER_LAYOUT="Header Layout",DEBUG_VIEW_RENDER="Data Cell Render",DebuggerUtil=function(){function t(){var r=this;this.debug=!1,this.debugCallback=function(e,n){if(r.debug){var a=performance.now();n();var o=performance.now();console.log(e,"".concat(o-a," ms"))}else n()},this.logger=function(e){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];r.debug&&console.log.apply(console,__spreadArray([e],__read(n),!1))}}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.setDebug=function(r){this.debug=r},t}(),ArrowDown=`
<svg width="10px" height="10px" viewBox="0 0 10 10" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" font-family="Roboto, PingFangSC, BlinkMacSystemFont, Microsoft YaHei, Arial, sans-serif" font-size="12" font-weight="bold">
    <text id="↓" fill="#29A294">
        <tspan x="-0.225097656" y="8.5">↓</tspan>
    </text>
</g>
</svg>`,ArrowUp=`<svg width="10px" height="10px" viewBox="0 0 10 10" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="页面-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" font-family="Roboto, PingFangSC, BlinkMacSystemFont, Microsoft YaHei, Arial, sans-serif" font-size="12" font-weight="bold">
    <text id="↑" fill="#FF4D4F">
        <tspan x="-0.225097656" y="8.5">↑</tspan>
    </text>
</g>
</svg>
`,CellDown=`<?xml version="1.0" encoding="UTF-8"?>
<svg width="7px" height="9px" viewBox="0 0 7 9" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <!-- Generator: Sketch 58 (84663) - https://sketch.com -->
    <title>down</title>
    <desc>Created with Sketch.</desc>
    <g id="一期开发" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <polygon id="down" fill="#58AE57" transform="translate(3.500000, 4.500000) scale(1, -1) translate(-3.500000, -4.500000) " points="3.5 0 7 9 0 9"></polygon>
    </g>
</svg>`,CellUp=`<?xml version="1.0" encoding="UTF-8"?>
<svg width="7px" height="9px" viewBox="0 0 7 9" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <!-- Generator: Sketch 58 (84663) - https://sketch.com -->
    <title>up</title>
    <desc>Created with Sketch.</desc>
    <g id="一期开发" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <polygon id="up" fill="#F46649" points="3.5 0 7 9 0 9"></polygon>
    </g>
</svg> `,GlobalAsc=`<svg t="1557124621626" class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
xmlns="http://www.w3.org/2000/svg" p-id="17452"
xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14">
<defs>
  <style type="text/css"></style>
</defs>
<path d="M182.272 167.04a8 8 0 0 0-12.544 0L57.728 309.056A8 8 0 0 0 64 321.984h76.032v530.048c0 4.352 3.584 7.936 7.936 7.936h56.064a8 8 0 0 0 7.936-7.936V321.92H288a8 8 0 0 0 6.272-12.992l-112-141.888z m209.728 626.944h176c4.416 0 8 3.584 8 8v56a8 8 0 0 1-8 8h-176A8 8 0 0 1 384 857.984v-56c0-4.416 3.584-8 8-8z m0-424h368c4.416 0 8 3.648 8 8v56a8 8 0 0 1-8 8h-368A8 8 0 0 1 384 433.984v-56c0-4.352 3.584-8 8-8z m528-139.968h-528A8 8 0 0 1 384 222.016v-56c0-4.416 3.584-8 8-8h528c4.416 0 8 3.584 8 8v56a8 8 0 0 1-8 8z m-256 424h-272A8 8 0 0 1 384 646.016v-56c0-4.416 3.584-8 8-8h272c4.416 0 8 3.584 8 8v56a8 8 0 0 1-8 8z" p-id="17453"></path>
</svg>`,GlobalDesc=`<svg t="1557124685600" class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" p-id="17561"
  xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14">
  <defs>
    <style type="text/css"></style>
  </defs>
  <path d="M182.272 856.96a8 8 0 0 1-12.544 0l-112-141.952A8 8 0 0 1 64 702.08h76.032V172.032c0-4.416 3.584-8 7.936-8h56.064c4.352 0 7.936 3.584 7.936 8v529.984H288c6.72 0 10.496 7.808 6.272 12.992l-112 141.888z m209.728-626.944h176A8 8 0 0 0 576 222.016v-56a8 8 0 0 0-8-8h-176A8 8 0 0 0 384 166.016v56c0 4.416 3.584 8 8 8z m0 424h368a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8h-368A8 8 0 0 0 384 590.016v56c0 4.416 3.584 8 8 8z m528 139.968h-528a8 8 0 0 0-8 8v56c0 4.416 3.584 8 8 8h528a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8z m-256-424h-272A8 8 0 0 0 384 377.984v56c0 4.416 3.584 8 8 8h272a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8z" p-id="17562"></path>
</svg>`,GroupAsc=`<svg t="1557124695786" class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" p-id="17670"
  xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14">
  <defs>
    <style type="text/css"></style>
  </defs>
  <path d="M182.272 167.04a8 8 0 0 0-12.544 0L57.728 309.056A8 8 0 0 0 64 321.984h76.032v530.048c0 4.352 3.584 7.936 7.936 7.936h56.064a8 8 0 0 0 7.936-7.936V321.92H288a8 8 0 0 0 6.272-12.992l-112-141.888z m209.728 62.976h304A8 8 0 0 0 704 222.016v-56a8 8 0 0 0-8-8h-304A8 8 0 0 0 384 166.016v56c0 4.416 3.584 8 8 8z m0 424h304a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8h-304A8 8 0 0 0 384 590.016v56c0 4.416 3.584 8 8 8z m528 139.968h-528a8 8 0 0 0-8 8v56c0 4.416 3.584 8 8 8h528a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8z m0-424h-528A8 8 0 0 0 384 377.984v56c0 4.416 3.584 8 8 8h528a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8z" p-id="17671"></path>
</svg>`,GroupDesc=`<svg t="1557124710652" class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" p-id="17779"
  xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14">
  <defs>
    <style type="text/css"></style>
  </defs>
  <path d="M182.272 856.96a8 8 0 0 1-12.544 0l-112-141.952A8 8 0 0 1 64 702.08h76.032V172.032c0-4.416 3.584-8 7.936-8h56.064c4.352 0 7.936 3.584 7.936 8v529.984H288c6.72 0 10.496 7.808 6.272 12.992l-112 141.888z m209.728-626.944h304A8 8 0 0 0 704 222.016v-56a8 8 0 0 0-8-8h-304A8 8 0 0 0 384 166.016v56c0 4.416 3.584 8 8 8z m0 424h304a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8h-304A8 8 0 0 0 384 590.016v56c0 4.416 3.584 8 8 8z m528 139.968h-528a8 8 0 0 0-8 8v56c0 4.416 3.584 8 8 8h528a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8z m0-424h-528A8 8 0 0 0 384 377.984v56c0 4.416 3.584 8 8 8h528a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8z" p-id="17780"></path>
</svg>`,GroupNone=`<svg width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="设计输出" stroke="none" stroke-width="1" fill-opacity="0.25" fill-rule="evenodd">
    <g id="设计输出-移动端指标详情页-阅读端" transform="translate(-3275.000000, -724.000000)" fill-rule="nonzero">
        <g id="编组-39" transform="translate(3064.500000, 667.000000)">
            <g id="编组-36" transform="translate(80.500000, 44.000000)">
                <g id="不排序" transform="translate(130.000000, 13.000000)">
                    <path d="M12.0009375,12.40625 C12.0696875,12.40625 12.1259375,12.4625 12.1259375,12.53125 L12.1259375,12.53125 L12.1259375,13.40625 C12.1259375,13.475 12.0696875,13.53125 12.0009375,13.53125 L12.0009375,13.53125 L6.25093747,13.53125 C6.18218747,13.53125 6.12593747,13.475 6.12593747,13.40625 L6.12593747,13.40625 L6.12593747,12.53125 C6.12593747,12.4625 6.18218747,12.40625 6.25093747,12.40625 L6.25093747,12.40625 Z M2.93949997,2.5801875 L2.97437497,2.6109375 L4.72437497,4.828125 C4.78062497,4.89776786 4.74503823,4.99725765 4.66779698,5.02426203 L4.62593747,5.03125 L3.438,5.03089062 L3.43843747,10.9691406 L4.62593747,10.9691406 C4.73062497,10.9691406 4.78999997,11.0910156 4.72437497,11.1722656 L2.97437497,13.3894531 C2.92437497,13.4535156 2.82749997,13.4535156 2.77749997,13.3894531 L1.02749997,11.1722656 C0.961874969,11.0894531 1.02124997,10.9691406 1.12593747,10.9691406 L2.31343747,10.9691406 L2.313,5.03089062 L1.12593747,5.03125 C1.03620533,5.03125 0.979764,4.94285714 1.00679571,4.8654519 L1.02749997,4.828125 L2.77749997,2.6109375 C2.81749997,2.5596875 2.88749997,2.5494375 2.93949997,2.5801875 Z M10.5009375,9.09375 C10.5696875,9.09375 10.6259375,9.15 10.6259375,9.21875 L10.6259375,9.21875 L10.6259375,10.09375 C10.6259375,10.1625 10.5696875,10.21875 10.5009375,10.21875 L10.5009375,10.21875 L6.25093747,10.21875 C6.18218747,10.21875 6.12593747,10.1625 6.12593747,10.09375 L6.12593747,10.09375 L6.12593747,9.21875 C6.12593747,9.15 6.18218747,9.09375 6.25093747,9.09375 L6.25093747,9.09375 Z M14.5009375,5.78125 C14.5696875,5.78125 14.6259375,5.8375 14.6259375,5.90625 L14.6259375,5.90625 L14.6259375,6.78125 C14.6259375,6.85 14.5696875,6.90625 14.5009375,6.90625 L14.5009375,6.90625 L6.25093747,6.90625 C6.18218747,6.90625 6.12593747,6.85 6.12593747,6.78125 L6.12593747,6.78125 L6.12593747,5.90625 C6.12593747,5.8375 6.18218747,5.78125 6.25093747,5.78125 L6.25093747,5.78125 Z M9.00093747,2.46875 C9.06968747,2.46875 9.12593747,2.525 9.12593747,2.59375 L9.12593747,2.59375 L9.12593747,3.46875 C9.12593747,3.5375 9.06968747,3.59375 9.00093747,3.59375 L9.00093747,3.59375 L6.25093747,3.59375 C6.18218747,3.59375 6.12593747,3.5375 6.12593747,3.46875 L6.12593747,3.46875 L6.12593747,2.59375 C6.12593747,2.525 6.18218747,2.46875 6.25093747,2.46875 L6.25093747,2.46875 Z" id="形状结合"></path>
                </g>
            </g>
        </g>
    </g>q
</g>
</svg>`,InfoCircle='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1590389330617" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="19656" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M512 64c-247.4 0-448 200.6-448 448s200.6 448 448 448 448-200.6 448-448-200.6-448-448-448z m0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" fill="" p-id="19657"></path><path d="M464 336c0 26.5 21.5 48 48 48s48-21.5 48-48-21.5-48-48-48-48 21.5-48 48zM536 448h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-272c0-4.4-3.6-8-8-8z" fill="" p-id="19658"></path></svg>',ExpandColIcon=`<?xml version="1.0" encoding="UTF-8"?>
<svg width="23px" height="12px" viewBox="0 0 23 12" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <title>编组 8备份 3</title>
    <g id="----隐藏列标注！" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="隐藏列标注" transform="translate(-275.000000, -824.000000)">
            <rect fill="#FFFFFF" x="0" y="0" width="1333" height="1167"></rect>
            <g id="编组-8备份-3" transform="translate(275.000000, 824.000000)">
                <rect id="矩形" stroke-opacity="0.25" stroke="#000000" fill="#F7F7F7" x="0.5" y="0.5" width="11" height="11"></rect>
                <rect id="矩形备份-9" stroke-opacity="0.25" stroke="#000000" fill="#F7F7F7" x="11.5" y="0.5" width="11" height="11"></rect>
                <g id="7.Icon/arrow/15.down/fill" transform="translate(6.000000, 6.000000) rotate(90.000000) translate(-6.000000, -6.000000) " fill="#000000" fill-rule="nonzero" opacity="0.65">
                    <path d="M7.25020811,6.37218077 L4.91348936,8.20968077 C4.82677061,8.27764952 4.69903624,8.21671202 4.69903624,8.10655577 L4.69903624,4.43272764 C4.69903624,4.32257139 4.82677061,4.26046202 4.91348936,4.32960264 L7.25020811,6.16593077 C7.31700499,6.21866514 7.31700499,6.31944639 7.25020811,6.37218077 Z" id="fill" transform="translate(5.999671, 6.269385) rotate(90.000000) translate(-5.999671, -6.269385) "></path>
                </g>
                <g id="7.Icon/arrow/15.down/fill" transform="translate(17.000000, 6.000000) rotate(270.000000) translate(-17.000000, -6.000000) translate(11.000000, 0.000000)" fill="#000000" fill-rule="nonzero" opacity="0.65">
                    <path d="M7.25020811,6.37218077 L4.91348936,8.20968077 C4.82677061,8.27764952 4.69903624,8.21671202 4.69903624,8.10655577 L4.69903624,4.43272764 C4.69903624,4.32257139 4.82677061,4.26046202 4.91348936,4.32960264 L7.25020811,6.16593077 C7.31700499,6.21866514 7.31700499,6.31944639 7.25020811,6.37218077 Z" id="fill" transform="translate(5.999671, 6.269385) rotate(90.000000) translate(-5.999671, -6.269385) "></path>
                </g>
            </g>
            <line x1="286.5" y1="813" x2="286.5" y2="864.5" id="路径-2备份-3" stroke="#000000" opacity="0.25"></line>
        </g>
    </g>
</svg>`,Minus=`<svg t="1557140120188" class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
xmlns="http://www.w3.org/2000/svg" p-id="16909" xmlns:xlink="http://www.w3.org/1999/xlink"
width="200" height="200">
	<defs>
		<style type="text/css">
		</style>
	</defs>
	<path d="M328 544h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"
	p-id="16910">
	</path>
	<path d="M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32z m-40 728H184V184h656v656z"
	p-id="16911">
	</path>
</svg>`,Plus=`<svg t="1557140186692" class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
xmlns="http://www.w3.org/2000/svg" p-id="17025" xmlns:xlink="http://www.w3.org/1999/xlink"
width="200" height="200">
	<defs>
		<style type="text/css">
		</style>
	</defs>
	<path d="M328 544h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"
	p-id="17026">
	</path>
	<path d="M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32z m-40 728H184V184h656v656z"
	p-id="17027">
	</path>
</svg>`,SortDownSelected=`<svg t="1565940955886" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
     p-id="17472" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200">
  <defs>
    <style type="text/css"></style>
  </defs>
  <path
    d="M948 392.992l-403.008 488.99200001Q532 896 512.992 896t-32-14.016L76 392.992q-18.016-20.992-7.008-46.016T108 321.98400001L916 321.98400001q28 0 39.008 24.99199999T948 392.992z"
    p-id="17473" data-spm-anchor-id="a313x.7781069.0.i2" class="selected"></path>
</svg>
`,SortDown=`<svg t="1565940955886" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
     p-id="17472" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200">
  <defs>
    <style type="text/css"></style>
  </defs>
  <path
    fill-opacity="0.45"
    d="M948 392.992l-403.008 488.99200001Q532 896 512.992 896t-32-14.016L76 392.992q-18.016-20.992-7.008-46.016T108 321.98400001L916 321.98400001q28 0 39.008 24.99199999T948 392.992z"
    p-id="17473" data-spm-anchor-id="a313x.7781069.0.i2" class="selected"></path>
</svg>
`,SortUpSelected=`<svg t="1565940979768" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
p-id="17620" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200">
<defs>
<style type="text/css"></style>
</defs>
<path
d="M76 631.008l403.008-488.99200001Q492 128 511.008 128t32 14.016L948 631.008q18.016 20.992 7.008 46.016T916 702.01599999L108 702.01599999q-28 0-39.008-24.99199999T76 631.008z"
p-id="17621"></path>
</svg>
`,SortUp=`<svg t="1565940979768" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
     p-id="17620" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200">
  <defs>
    <style type="text/css"></style>
  </defs>
  <path
    fill-opacity="0.45"
    d="M76 631.008l403.008-488.99200001Q492 128 511.008 128t32 14.016L948 631.008q18.016 20.992 7.008 46.016T916 702.01599999L108 702.01599999q-28 0-39.008-24.99199999T76 631.008z"
    p-id="17621"></path>
</svg>
`,Trend='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1596433821690" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="20229" width="16" height="16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css"></style></defs><path d="M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM305.8 637.7c3.1 3.1 8.1 3.1 11.3 0l138.3-137.6L583 628.5c3.1 3.1 8.2 3.1 11.3 0l275.4-275.3c3.1-3.1 3.1-8.2 0-11.3l-39.6-39.6c-3.1-3.1-8.2-3.1-11.3 0l-230 229.9L461.4 404c-3.1-3.1-8.2-3.1-11.3 0L266.3 586.7c-3.1 3.1-3.1 8.2 0 11.3l39.5 39.7z" p-id="20230"></path></svg>',DrillDownIcon=`<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1608030723688" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="21482" xmlns:xlink="http://www.w3.org/1999/xlink" width="16" height="16"><defs><style type="text/css"></style></defs><path d="M547.648 696a32 32 0 0 1 31.488 26.24l0.512 5.76v151.68l145.216-144.512a32 32 0 0 1 40.832-3.648l4.416 3.712a32 32 0 0 1 3.584 40.832l-3.712 4.48-203.072 202.24a32 32 0 0 1-40.768 3.648l-4.416-3.712-202.24-202.24a32 32 0 0 1 40.832-48.96l4.416 3.712 150.912 150.912v-158.144a32 32 0 0 1 32-32z m194.56-529.28l4.928 3.072 233.792 180.224a32 32 0 0 1 1.728 49.28l-4.864 3.52-409.792 245.568a32 32 0 0 1-27.328 2.624l-5.184-2.432-422.4-245.568a32 32 0 0 1-7.552-49.28l4.544-4.032 242.816-180.288a32 32 0 0 1 42.432 47.552l-4.288 3.84-203.84 151.296 364.16 211.648 353.28-211.712-196.608-151.552a32 32 0 0 1-8.896-40l3.136-4.864a32 32 0 0 1 40-8.96zM547.712 28.672a32 32 0 0 1 31.488 26.24l0.512 5.76v396.992a32 32 0 0 1-63.488 5.76l-0.512-5.76V60.736a32 32 0 0 1 32-32z" p-id="21483" fill="currentColor"></path></svg>
`,EyeOutlined='<svg viewBox="64 64 896 896" focusable="false" data-icon="eye" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"></path></svg>',InternalSvgIcons=Object.freeze({__proto__:null,ArrowDown,ArrowUp,CellDown,CellUp,DrillDownIcon,ExpandColIcon,EyeOutlined,GlobalAsc,GlobalDesc,GroupAsc,GroupDesc,GroupNone,InfoCircle,Minus,Plus,SortDown,SortDownSelected,SortUp,SortUpSelected,Trend}),SVGMap={},registerIcon=function(t,r){SVGMap[lowerCase(t)]=r},getIcon=function(t){return SVGMap[lowerCase(t)]};keys(InternalSvgIcons).forEach(function(t){var r=get(InternalSvgIcons,t);registerIcon(t,r)});var CustomImage=function(t){__extends(r,t);function r(e,n){var a=t.call(this,n)||this;return a.imgType=e,a}return r}(Image$1),CustomRect=function(t){__extends(r,t);function r(e,n){var a=t.call(this,e)||this;return a.appendInfo=n,a}return r}(Rect),STYLE_PLACEHOLDER="<svg",SVG_CONTENT_TYPE="data:image/svg+xml",ImageCache={},GuiIcon=function(t){__extends(r,t);function r(e){var n=t.call(this,{name:e.name})||this;return n.isOnlineLink=function(a){return/^(?:https?:)?(?:\/\/)/.test(a)},n.cfg=e,n.render(),n}return r.prototype.getCfg=function(){return this.cfg},r.prototype.getImage=function(e,n,a){var o=this;return new Promise(function(s,l){var u=getIcon(e);if(u){var c=new Image;c.onload=function(){ImageCache[n]=c,s(c)},c.onerror=l,u&&(u.includes(SVG_CONTENT_TYPE)||o.isOnlineLink(u))?(c.src=u,c.crossOrigin="anonymous"):(a&&(u=u.replace(/fill=[\'\"]#?\w+[\'\"]/g,""),u=u.replace(/fill>/g,">")),u=u.replace(STYLE_PLACEHOLDER,"".concat(STYLE_PLACEHOLDER,' fill="').concat(a,'"')),c.src="".concat(SVG_CONTENT_TYPE,";utf-8,").concat(encodeURIComponent(u)))}})},r.prototype.render=function(){var e=this.cfg,n=e.name,a=e.fill,o=clone$1(this.cfg),s=new CustomImage(r.type,{style:omit(o,"fill")});this.iconImageShape=s,this.setImageAttrs({name:n,fill:a})},r.prototype.setImageAttrs=function(e){var n=this,a=e.name,o=e.fill,s=this.iconImageShape;a=a||this.cfg.name,o=o||this.cfg.fill;var l="".concat(a,"-").concat(o),u=ImageCache[l];u?(s.attr("img",u),this.appendChild(s)):this.getImage(a,l,o).then(function(c){if(n.destroyed){DebuggerUtil.getInstance().logger("GuiIcon ".concat(a," destroyed."));return}s.attr("img",c),n.appendChild(s)}).catch(function(c){if(c instanceof TypeError){console.warn("GuiIcon ".concat(a," destroyed:"),c);return}console.error("GuiIcon ".concat(a," load failed:"),c)})},r.type="__GUI_ICON__",r}(Group),CellBorderPosition;(function(t){t.TOP="TOP",t.BOTTOM="BOTTOM",t.LEFT="LEFT",t.RIGHT="RIGHT"})(CellBorderPosition||(CellBorderPosition={}));var CellClipBox;(function(t){t.BORDER_BOX="borderBox",t.PADDING_BOX="paddingBox",t.CONTENT_BOX="contentBox"})(CellClipBox||(CellClipBox={}));var Aggregation;(function(t){t.SUM="SUM",t.MIN="MIN",t.MAX="MAX",t.AVG="AVG"})(Aggregation||(Aggregation={}));var CornerNodeType;(function(t){t.Row="row",t.Col="col",t.Series="series"})(CornerNodeType||(CornerNodeType={}));var CopyMIMEType;(function(t){t.PLAIN="text/plain",t.HTML="text/html"})(CopyMIMEType||(CopyMIMEType={}));var Store=function(){function t(){this.store=new Map}return t.prototype.set=function(r,e){return this.store.set(r,e)},t.prototype.get=function(r,e){var n,a=this.store.get(r);return(n=a)!==null&&n!==void 0?n:e},t.prototype.clear=function(){this.store.clear()},t.prototype.size=function(){return this.store.size},t}();function isMobile(t){return t===DeviceType.MOBILE?!0:/(?:iPhone|iPad|SymbianOS|Windows Phone|iPod|iOS|Android)/i.test(navigator.userAgent)}function isWindows(){return/windows/i.test(navigator.userAgent)}var css_248z=`:root {
  --antv-s2-background: #000;
  --antv-s2-tooltip-background: rgba(43, 43, 43, 0.95);
  --antv-s2-tooltip-operator-background: rgba(43, 43, 43, 0.95);
}
`,DarkVars=css_248z,injectCssText=function(t,r){r===void 0&&(r="");var e=document.getElementById(t);return e||(e=document.createElement("style"),e.id=t,document.head.appendChild(e)),e.innerHTML=r,e},getPalette=function(t){var r=t||"default";return PALETTE_MAP[r]},injectThemeVars=function(t){injectCssText(STYLE_ELEMENT_ID,t==="dark"?DarkVars:"")},getTheme=function(t){var r,e,n,a,o,s=(t==null?void 0:t.palette)||getPalette(t==null?void 0:t.name),l=s.basicColors,u=s.semanticColors,c=s.others,d=(r=t==null?void 0:t.spreadsheet)===null||r===void 0?void 0:r.isTableMode(),f=isWindows()?"bold":700,h=function(){var p,v;return{bolderText:{fontFamily:FONT_FAMILY,fontSize:12,fontWeight:f,fill:l[13],opacity:1,textAlign:"right",textBaseline:"middle",linkTextFill:l[6]},text:{fontFamily:FONT_FAMILY,fontSize:12,fontWeight:"normal",fill:l[13],opacity:1,textAlign:"right",textBaseline:"middle",linkTextFill:l[6]},cell:{crossBackgroundColor:l[1],backgroundColor:l[8],backgroundColorOpacity:1,horizontalBorderColor:l[9],horizontalBorderColorOpacity:1,verticalBorderColor:l[9],verticalBorderColorOpacity:1,horizontalBorderWidth:1,verticalBorderWidth:1,padding:{top:8,right:8,bottom:8,left:8},interactionState:{hover:{backgroundColor:l[2],backgroundOpacity:.6},hoverFocus:{backgroundColor:l[2],backgroundOpacity:.6,borderColor:l[14],borderWidth:1,borderOpacity:1},selected:{backgroundColor:l[2],backgroundOpacity:.6},unselected:{backgroundOpacity:.3,textOpacity:.3,opacity:.3},searchResult:{backgroundColor:(p=c==null?void 0:c.results)!==null&&p!==void 0?p:l[2],backgroundOpacity:1},highlight:{backgroundColor:(v=c==null?void 0:c.highlight)!==null&&v!==void 0?v:l[6],backgroundOpacity:1},prepareSelect:{borderColor:l[14],borderOpacity:1,borderWidth:1}}},miniChart:{line:{point:{size:2.2,fill:l[6],opacity:1},linkLine:{size:1.5,fill:l[6],opacity:.6}},bar:{intervalPadding:4,fill:l[6],opacity:1},bullet:{progressBar:{widthPercent:.6,height:10,innerHeight:6},comparativeMeasure:{width:1,height:12,fill:l[13],opacity:.25},rangeColors:{good:u==null?void 0:u.green,satisfactory:u.yellow,bad:u.red},backgroundColor:"#E9E9E9"},interval:{height:INTERVAL_BAR_HEIGHT,fill:l[7]}},icon:{fill:l[13],size:10,margin:{right:4,left:4}}}};return{cornerCell:{text:{fontFamily:FONT_FAMILY,fontSize:12,fontWeight:f,fill:l[0],opacity:1,textAlign:d?"center":"left",textBaseline:"middle"},bolderText:{fontFamily:FONT_FAMILY,fontSize:12,fontWeight:f,fill:l[0],opacity:1,textAlign:d?"center":"right",textBaseline:"middle"},cell:{backgroundColor:l[3],backgroundColorOpacity:1,horizontalBorderColor:l[10],horizontalBorderColorOpacity:1,verticalBorderColor:l[10],verticalBorderColorOpacity:1,horizontalBorderWidth:1,verticalBorderWidth:1,borderDash:[],padding:{top:4,right:8,bottom:4,left:8}},icon:{fill:l[0],size:10,margin:{right:4,left:4}}},rowCell:{seriesText:{fontFamily:FONT_FAMILY,fontSize:12,fontWeight:"normal",fill:l[14],linkTextFill:l[6],opacity:1,textBaseline:"middle",textAlign:"center"},measureText:{fontFamily:FONT_FAMILY,fontSize:12,fontWeight:"normal",fill:l[14],linkTextFill:l[6],opacity:1,textAlign:d?"center":"left",textBaseline:"middle"},bolderText:{fontFamily:FONT_FAMILY,fontSize:12,fontWeight:f,fill:l[14],linkTextFill:l[6],opacity:1,textAlign:d?"center":"left",textBaseline:"middle"},text:{fontFamily:FONT_FAMILY,fontSize:12,fontWeight:"normal",fill:l[14],linkTextFill:l[6],opacity:1,textBaseline:"middle",textAlign:d?"center":"left"},cell:{backgroundColor:l[1],backgroundColorOpacity:1,horizontalBorderColor:l[9],horizontalBorderColorOpacity:1,verticalBorderColor:l[9],verticalBorderColorOpacity:1,horizontalBorderWidth:1,verticalBorderWidth:1,borderDash:[],padding:{top:4,right:8,bottom:4,left:8},interactionState:{hover:{backgroundColor:l[2],backgroundOpacity:.6},selected:{backgroundColor:l[2],backgroundOpacity:.6},unselected:{backgroundOpacity:.3,textOpacity:.3,opacity:.3},prepareSelect:{borderColor:l[14],borderOpacity:1,borderWidth:1},searchResult:{backgroundColor:(e=c==null?void 0:c.results)!==null&&e!==void 0?e:l[2],backgroundOpacity:1},highlight:{backgroundColor:(n=c==null?void 0:c.highlight)!==null&&n!==void 0?n:l[6],backgroundOpacity:1}}},icon:{fill:l[14],size:10,margin:{right:4,left:4}},seriesNumberWidth:80},colCell:{measureText:{fontFamily:FONT_FAMILY,fontSize:12,fontWeight:"normal",fill:l[0],opacity:1,textAlign:"right",textBaseline:"middle"},bolderText:{fontFamily:FONT_FAMILY,fontSize:12,fontWeight:f,fill:l[0],opacity:1,textAlign:"center",textBaseline:"middle"},text:{fontFamily:FONT_FAMILY,fontSize:12,fontWeight:"normal",fill:l[0],opacity:1,textAlign:"center",textBaseline:"middle"},cell:{backgroundColor:l[3],backgroundColorOpacity:1,horizontalBorderColor:l[10],horizontalBorderColorOpacity:1,verticalBorderColor:l[10],verticalBorderColorOpacity:1,horizontalBorderWidth:1,verticalBorderWidth:1,borderDash:[],padding:{top:4,right:8,bottom:4,left:8},interactionState:{hover:{backgroundColor:l[4],backgroundOpacity:.6},selected:{backgroundColor:l[4],backgroundOpacity:.6},unselected:{backgroundOpacity:.3,textOpacity:.3,opacity:.3},prepareSelect:{borderColor:l[14],borderOpacity:1,borderWidth:1},searchResult:{backgroundColor:(a=c==null?void 0:c.results)!==null&&a!==void 0?a:l[2],backgroundOpacity:1},highlight:{backgroundColor:(o=c==null?void 0:c.highlight)!==null&&o!==void 0?o:l[6],backgroundOpacity:1}}},icon:{fill:l[0],size:10,margin:{top:6,right:4,bottom:6,left:4}}},dataCell:h(),mergedCell:h(),resizeArea:{size:3,background:l[7],backgroundOpacity:0,guideLineColor:l[7],guideLineDisableColor:"rgba(0,0,0,0.25)",guideLineDash:[3,3],interactionState:{hover:{backgroundColor:l[7],backgroundOpacity:1}}},scrollBar:{trackColor:"rgba(0,0,0,0.01)",thumbHoverColor:"rgba(0,0,0,0.25)",thumbColor:"rgba(0,0,0,0.15)",thumbHorizontalMinSize:32,thumbVerticalMinSize:32,size:isMobile()?3:6,hoverSize:isMobile()?4:8,lineCap:"round"},splitLine:{horizontalBorderColor:l[12],horizontalBorderColorOpacity:.2,horizontalBorderWidth:2,verticalBorderColor:l[11],verticalBorderColorOpacity:.25,verticalBorderWidth:2,showShadow:!0,shadowWidth:8,shadowColors:{left:"rgba(0,0,0,0.1)",right:"rgba(0,0,0,0)"},borderDash:[]},prepareSelectMask:{backgroundColor:l[5],backgroundOpacity:.3},background:{color:l[8],opacity:1}}},Node$1=function(){function t(r){this.x=0,this.y=0,this.width=0,this.height=0,this.colIndex=-1,this.level=0,this.isLeaf=!1,this.children=[],this.padding=0;var e=r.id,n=r.field,a=r.value,o=r.parent,s=r.level,l=r.rowIndex,u=r.isTotals,c=r.isGrandTotals,d=r.isSubTotals,f=r.isCollapsed,h=r.isTotalRoot,p=r.hierarchy,v=r.isPivotMode,g=r.seriesNumberWidth,y=r.spreadsheet,m=r.query,S=r.belongsCell,w=r.inCollapseNode,R=r.isTotalMeasure,T=r.isLeaf,x=r.extra;this.id=e,this.field=n,this.value=a,this.parent=o,this.level=s,this.rowIndex=l,this.isTotals=u,this.isCollapsed=f,this.hierarchy=p,this.isPivotMode=v,this.seriesNumberWidth=g,this.spreadsheet=y,this.query=m,this.inCollapseNode=w,this.isTotalMeasure=R,this.isLeaf=T,this.isGrandTotals=c,this.isSubTotals=d,this.belongsCell=S,this.isTotalRoot=h,this.extra=x}return t.getFieldPath=function(r,e){if(r&&!r.isTotals||r&&e){for(var n=r.parent,a=[r.field];n&&n.id!==ROOT_NODE_ID;)a.push(n.field),n=n.parent;return a.reverse()}return[]},t.getAllLeaveNodes=function(r){var e=[];if(r.isLeaf)return[r];for(var n=__spreadArray([],__read(r.children||[]),!1),a=n.shift();a;)a.isLeaf?e.push(a):n.unshift.apply(n,__spreadArray([],__read(a.children),!1)),a=n.shift();return e},t.getAllChildrenNodes=function(r){var e=[];if(r.isLeaf)return[r];for(var n=__spreadArray([],__read(r.children||[]),!1),a=n.shift();a;)e.push(a),n.unshift.apply(n,__spreadArray([],__read(a.children),!1)),a=n.shift();return e},t.getBranchNodes=function(r){if(r&&!r.isTotals){for(var e=r.parent,n=[r];e&&e.id!==ROOT_NODE_ID;)n.push(e),e=e.parent;return n.reverse()}return[]},t.blankNode=function(){return new t({id:"",field:"",value:""})},t.rootNode=function(){return new t({id:ROOT_NODE_ID,field:"",value:""})},t.prototype.getHeadLeafChild=function(){for(var r=this;!isEmpty(r==null?void 0:r.children);)r=head(r==null?void 0:r.children);return r},t.prototype.getTotalHeightForTreeHierarchy=function(){return this.height===0||isEmpty(this.children)?this.height:this.children.reduce(function(r,e){return r+e.getTotalHeightForTreeHierarchy()},this.height)},t.prototype.isSeriesNumberNode=function(){return this.field===SERIES_NUMBER_FIELD},t}(),Hierarchy=function(){function t(){this.width=0,this.height=0,this.maxLevel=-1,this.sampleNodesForAllLevels=[],this.sampleNodeForLastLevel=null,this.allNodesWithoutRoot=[],this.indexNode=[]}return t.prototype.getLeaves=function(){return this.allNodesWithoutRoot.filter(function(r){return r.isLeaf})},t.prototype.getNodes=function(r){return r!==void 0?this.allNodesWithoutRoot.filter(function(e){return e.level===r}):this.allNodesWithoutRoot},t.prototype.getNodesLessThanLevel=function(r){return this.allNodesWithoutRoot.filter(function(e){return e.level<=r})},t.prototype.pushNode=function(r,e){e===void 0&&(e=-1),e===-1?this.allNodesWithoutRoot.push(r):this.allNodesWithoutRoot.splice(e,0,r)},t.prototype.pushIndexNode=function(r){this.indexNode.push(r)},t.prototype.getIndexNodes=function(){return this.indexNode},t}(),TotalClass=function(){function t(r){var e=r.label,n=r.isSubTotals,a=r.isGrandTotals,o=r.isTotalRoot,s=o===void 0?!1:o;this.label=e,this.isSubTotals=n,this.isGrandTotals=a,this.isTotalRoot=s}return t}(),addTotals$1=function(t){var r,e=t.isFirstField,n=t.currentField,a=t.fieldValues,o=t.spreadsheet,s=t.lastField,l=o.getTotalsConfig(e?n:s),u,c;e?l!=null&&l.showGrandTotals&&(u=l.reverseGrandTotalsLayout?"unshift":"push",c=new TotalClass({label:l.grandTotalsLabel,isSubTotals:!1,isGrandTotals:!0,isTotalRoot:!0})):l!=null&&l.showSubTotals&&(size(a)>1||get(l,"showSubTotals.always")!==!1)&&n!==EXTRA_FIELD&&(u=l.reverseSubTotalsLayout?"unshift":"push",c=new TotalClass({label:l.subTotalsLabel,isSubTotals:!0,isGrandTotals:!1,isTotalRoot:!0})),u&&((r=a[u])===null||r===void 0||r.call(a,c))};function getDimsCondition(t,r){for(var e={},n=t;n&&n.field;)(!n.isTotalRoot||r)&&n.value!==EMPTY_FIELD_VALUE&&(e[n.field]=n.value),n=n.parent;return e}var whetherLeafByLevel=function(t){var r,e,n,a,o=t.spreadsheet,s=t.level,l=t.fields,u=o.options,c=o.dataSet,d=c.moreThanOneValue(),f=(e=(r=o.dataCfg.fields)===null||r===void 0?void 0:r.valueInCols)!==null&&e!==void 0?e:!0,h=((a=(n=u==null?void 0:u.style)===null||n===void 0?void 0:n.colCell)===null||a===void 0?void 0:a.hideValue)&&f&&!d&&includes(l,EXTRA_FIELD),p=h?2:1;return s===l.length-p},layoutArrange=function(t,r,e,n){return t.options.layoutArrange?t.options.layoutArrange(t,e,n,r):r},layoutHierarchy=function(t,r,e,n){var a,o,s,l,u=(a=t==null?void 0:t.facet)===null||a===void 0?void 0:a.getHiddenColumnsInfo(e);if(u&&(!((l=(s=(o=t==null?void 0:t.dataSet)===null||o===void 0?void 0:o.fields)===null||s===void 0?void 0:s.columns)===null||l===void 0)&&l.find(function(m){return m===(e==null?void 0:e.field)})))return!1;var c=!0,d=function(m,S,w){S===void 0&&(S=-1),w===void 0&&(w=-1),S===-1?(r.children.push(m),n.pushNode(m)):(r.children.splice(S,0,m),n.pushNode(m,w))};if(t.options.layoutHierarchy){var f=t.options.layoutHierarchy(t,e);if(f){var h=isBoolean(f==null?void 0:f.delete)?f==null?void 0:f.delete:!1;c=!h;var p=f.push,v=f.unshift,g=r.children.length,y=n.getNodes().length;isEmpty(v)||(forEach(v,function(m){d(m)}),g=r.children.length,y=n.getNodes().length),isEmpty(p)||forEach(p,function(m){d(m)}),h||d(e,g,y)}else d(e)}else d(e);return c},layoutCoordinate=function(t,r,e){var n,a;!((n=t.options)===null||n===void 0)&&n.layoutCoordinate&&(r!=null&&r.isLeaf||e!=null&&e.isLeaf)&&((a=t.options)===null||a===void 0||a.layoutCoordinate(t,r,e))},TotalMeasure=function(){function t(r){this.label=r}return t}(),getListBySorted=function(t,r,e){return t.sort(function(n,a){e&&(n=e(n),a=e(a));var o=r.indexOf(n),s=r.indexOf(a);return o===-1&&s===-1?0:o===-1?1:s===-1?-1:o-s})},filterOutDetail=function(t){return t===void 0&&(t=[]),t.filter(function(r){return r!==TOTAL_VALUE&&r!==EMPTY_EXTRA_FIELD_PLACEHOLDER})},sortByItems=function(t,r){var e;return(e=t==null?void 0:t.filter(function(n){return!(r!=null&&r.includes(n))}))===null||e===void 0?void 0:e.concat(r)};function getAggregationAndCalcFuncByQuery(t,r){var e=t.isRowGrandTotal,n=t.isRowSubTotal,a=t.isColGrandTotal,o=t.isColSubTotal,s=r||{},l=s.row,u=s.col,c=l||{},d=c.calcGrandTotals,f=d===void 0?{}:d,h=c.calcSubTotals,p=h===void 0?{}:h,v=u||{},g=v.calcGrandTotals,y=g===void 0?{}:g,m=v.calcSubTotals,S=m===void 0?{}:m,w=function(R,T){if((R.aggregation||R.calcFunc)&&T)return{aggregation:R.aggregation,calcFunc:R.calcFunc}};return w(y,a)||w(S,o)||w(f,e)||w(p,n)}var buildTotalGridHierarchy=function(t){var r=t.addTotalMeasureInTotal,e=t.parentNode,n=t.currentField,a=t.fields,o=t.hierarchy,s=t.spreadsheet,l=a.indexOf(n),u=s.dataSet,c=u.fields.values,d=c===void 0?[]:c,f=[],h={},p=s.getTotalsConfig(n),v=e.isGrandTotals?p.grandTotalsGroupDimensions:p.subTotalsGroupDimensions;if(v!=null&&v.includes(n)){h=getDimsCondition(e);var g=u.getDimensionValues(n,h);f.push.apply(f,__spreadArray([],__read((g||[]).map(function(m){return new TotalClass({label:m,isSubTotals:e.isSubTotals,isGrandTotals:e.isGrandTotals,isTotalRoot:!1})})),!1)),isEmpty(f)&&n&&f.push(EMPTY_FIELD_VALUE)}else if(r&&n===EXTRA_FIELD)h=getDimsCondition(e),f.push.apply(f,__spreadArray([],__read(d.map(function(m){return new TotalMeasure(m)})),!1));else if(whetherLeafByLevel({spreadsheet:s,level:l,fields:a})){e.isLeaf=!0,o.pushIndexNode(e),e.rowIndex=o.getIndexNodes().length-1;return}else{buildTotalGridHierarchy(__assign(__assign({},t),{currentField:a[l+1]}));return}var y=filterOutDetail(f);generateHeaderNodes(__assign(__assign({},t),{fieldValues:y,level:l,parentNode:e,query:h}))},buildNormalGridHierarchy=function(t){var r=t.parentNode,e=t.currentField,n=t.fields,a=t.spreadsheet,o=a.dataSet,s=o.fields.values,l=s===void 0?[]:s,u=n.indexOf(e),c=[],d={};d=getDimsCondition(r,!0);var f=o.getDimensionValues(e,d),h=layoutArrange(a,f,r,e);c.push.apply(c,__spreadArray([],__read(h||[]),!1)),isEmpty(c)&&e&&(e===EXTRA_FIELD?c.push.apply(c,__spreadArray([],__read(l),!1)):c.push(EMPTY_FIELD_VALUE)),addTotals$1({currentField:e,lastField:n[u-1],isFirstField:u===0,fieldValues:c,spreadsheet:a});var p=filterOutDetail(c);generateHeaderNodes(__assign(__assign({},t),{fieldValues:p,level:u,parentNode:r,query:d}))},buildGridHierarchy=function(t){t.parentNode.isTotals?buildTotalGridHierarchy(t):buildNormalGridHierarchy(t)},generateId=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t.map(function(e){return isUndefined(e)?UNDEFINED_SYMBOL_ID:isNull(e)?NULL_SYMBOL_ID:String(e)}).join(NODE_ID_SEPARATOR)},generateHeaderNodes=function(t){var r,e,n,a,o,s,l,u,c,d,f=t.currentField,h=t.fields,p=t.fieldValues,v=t.hierarchy,g=t.parentNode,y=t.level,m=t.query,S=t.addMeasureInTotalQuery,w=t.addTotalMeasureInTotal,R=t.spreadsheet,T=R.isTableMode();try{for(var x=__values(p.entries()),b=x.next();!b.done;b=x.next()){var L=__read(b.value,2),M=L[0],D=L[1],N=D instanceof TotalClass,F=D instanceof TotalMeasure,k=void 0,H=void 0,G=!1,z=!1,$=!1,W=!1,V=f;if(N){var X=D;z=X.isGrandTotals,$=X.isSubTotals,W=X.isTotalRoot,k=i18n(D.label),W?H=m:H=__assign(__assign({},m),(n={},n[f]=k,n)),S&&(H[EXTRA_FIELD]=(l=R==null?void 0:R.dataSet)===null||l===void 0?void 0:l.fields.values[0]),G=whetherLeafByLevel({spreadsheet:R,level:y,fields:h})}else F?(k=i18n(D.label),H=__assign(__assign({},m),(a={},a[EXTRA_FIELD]=k,a)),V=EXTRA_FIELD,z=g.isGrandTotals,$=g.isSubTotals,G=whetherLeafByLevel({spreadsheet:R,level:y,fields:h})):T?(k=D,V=h[M],H=__assign(__assign({},m),(o={},o[V]=k,o)),G=!0):(k=D,H=k===EMPTY_FIELD_VALUE?__assign({},m):__assign(__assign({},m),(s={},s[f]=k,s)),G=whetherLeafByLevel({spreadsheet:R,level:y,fields:h}));var J=T?V:k,j=generateId(g.id,J);if(!j)return;var ne=!1,Q=new Node$1({id:j,value:k,level:y,field:V,parent:g,isTotals:N||F,isGrandTotals:z,isSubTotals:$,isTotalMeasure:F,isCollapsed:ne,isTotalRoot:W,hierarchy:v,query:H,spreadsheet:R,isLeaf:G||ne}),ie=layoutHierarchy(R,g,Q,v),te=(u=R==null?void 0:R.facet)===null||u===void 0?void 0:u.getHiddenColumnsInfo(Q);y>v.maxLevel&&!z&&!g.isGrandTotals&&!g.isSubTotals&&!Q.isSubTotals&&(v.sampleNodesForAllLevels.push(Q),v.maxLevel=y,v.sampleNodeForLastLevel=te?((c=te==null?void 0:te.displaySiblingNode)===null||c===void 0?void 0:c.next)||((d=te==null?void 0:te.displaySiblingNode)===null||d===void 0?void 0:d.prev):Q);var oe=G||ne||!ie;oe?(Q.isLeaf=!0,v.pushIndexNode(Q),Q.rowIndex=v.getIndexNodes().length-1):buildGridHierarchy({addTotalMeasureInTotal:w,addMeasureInTotalQuery:S,parentNode:Q,currentField:h[y+1],fields:h,hierarchy:v,spreadsheet:R})}}catch(ae){r={error:ae}}finally{try{b&&!b.done&&(e=x.return)&&e.call(x)}finally{if(r)throw r.error}}},buildTableHierarchy=function(t){var r,e=t.spreadsheet,n=t.rootNode,a=t.fields,o=t.hierarchy,s=e.dataSet.fields.columns,l=s===void 0?[]:s,u=(r=e.options.seriesNumber)!==null&&r!==void 0?r:{},c=u.enable,d=u.text,f=getDefaultSeriesNumberText(d),h=l.map(function(p){return p===SERIES_NUMBER_FIELD?f:e.dataSet.getFieldName(p)});c&&!a.includes(SERIES_NUMBER_FIELD)&&(a.unshift(SERIES_NUMBER_FIELD),h.unshift(f)),generateHeaderNodes({spreadsheet:e,currentField:a[0],fields:a,fieldValues:h,hierarchy:o,parentNode:n,level:0,query:{},addMeasureInTotalQuery:!1,addTotalMeasureInTotal:!1})},parseNumberWithPrecision=function(t){return Number.parseFloat((toNumber(t)||0).toPrecision(PRECISION))},safeJsonParse=function(t){try{return JSON.parse(t)}catch{return null}},getValidFrozenOptions=function(t,r,e){if(e===void 0&&(e=0),!Object.values(t).find(function(s){return s>0}))return t;var n=__assign({},t);n.colCount>=r&&(n.colCount=r);var a=r-n.colCount;n.trailingColCount>a&&(n.trailingColCount=a),n.rowCount>=e&&(n.rowCount=e);var o=e-n.rowCount;return n.trailingRowCount>o&&(n.trailingRowCount=o),n},CustomText=function(t){__extends(r,t);function r(e,n){var a=t.call(this,e)||this;return a.appendInfo=n,a}return r}(Text);function renderRect(t,r){return t==null?void 0:t.appendChild(new Rect({style:r}))}function renderPolygon(t,r){return t==null?void 0:t.appendChild(new Polygon({style:r}))}function renderPolyline(t,r){return t==null?void 0:t.appendChild(new Polyline({style:r}))}function renderCircle(t,r){return t==null?void 0:t.appendChild(new Circle({style:r}))}function renderText(t){var r=t.group,e=t.textShape,n=t.style,a=t.appendInfo;return e&&r&&r.contains(e)&&r.removeChild(e),r==null?void 0:r.appendChild(new CustomText({style:__assign({fontVariant:"normal",fontStyle:"normal",lineWidth:1},n)},a||{}))}function renderLine(t,r){return t==null?void 0:t.appendChild(new Line({style:__assign({zIndex:100},r)}))}function updateShapeAttr(t,r,e){if(!isEmpty(t)){var n=isArray(t)?t:[t];n.forEach(function(a){var o;(o=a==null?void 0:a.style)===null||o===void 0||o.setProperty(r,e)})}}function renderIcon(t,r){var e=new GuiIcon(r);return t==null||t.appendChild(e),e}function renderTreeIcon(t){var r=t.group,e=t.iconCfg,n=t.isCollapsed,a=t.onClick,o=renderIcon(r,__assign(__assign({},e),{name:n?"Plus":"Minus",cursor:"pointer"}));return isFunction(a)&&o.addEventListener("click",a),o}var normalizeIcons=function(t,r){return r===void 0&&(r="right"),t.map(function(e){return typeof e=="string"?{name:e,position:r}:e})},normalizeActionIconCfg=function(t){return t===void 0&&(t=[]),t.map(function(r){return __assign(__assign({},r),{icons:normalizeIcons(r.icons)})})},shouldShowActionIcons=function(t,r,e){if(!t)return!1;var n=t.icons,a=t.displayCondition,o=t.belongsCell;return isEmpty(n)||o!==e?!1:n.some(function(s){var l,u,c;return(c=(u=(l=s.displayCondition)===null||l===void 0?void 0:l.call(s,r,s.name))!==null&&u!==void 0?u:a==null?void 0:a(r,s.name))!==null&&c!==void 0?c:!0})},getActionIconConfig=function(t,r,e){t===void 0&&(t=[]);var n=normalizeActionIconCfg(t),a=find(n,function(s){return shouldShowActionIcons(s,r,e)});if(a){var o=a.icons.filter(function(s){var l,u,c,d;return(d=(u=(l=s.displayCondition)===null||l===void 0?void 0:l.call(s,r,s.name))!==null&&u!==void 0?u:(c=a.displayCondition)===null||c===void 0?void 0:c.call(a,r,s.name))!==null&&d!==void 0?d:!0});return __assign(__assign({},a),{icons:o})}},getIconTotalWidth=function(t,r){if(t===void 0&&(t=[]),isEmpty(t))return 0;var e=r.margin,n=r.size;return t.reduce(function(a,o){var s=o.position;return a+n+(s==="left"?e.right:e.left)},0)},groupIconsByPosition=function(t,r){t===void 0&&(t=[]);var e=merge({left:[],right:[]},groupBy(t,"position"));return r&&(r.position==="left"?e.left.push(r):e.right.unshift(r)),e},formattedFieldValue=function(t,r){var e=t.value,n=t.field;return isEqual(n,EXTRA_FIELD)?{formattedValue:r||e,value:e}:{formattedValue:e,value:e}},getVerticalTextPosition=function(t,r){var e=t.y,n=t.height;switch(r){case"top":return e;case"middle":return e+n/2;default:return e+n}},getVerticalIconPosition=function(t,r,e,n){var a=(e-t)/2;switch(n){case"top":return r+a;case"middle":return r-t/2;default:return r-a-t}},getHorizontalTextIconPosition=function(t){var r=t.bbox,e=t.textWidth,n=t.textAlign,a=t.groupedIcons,o=t.iconStyle,s=r.x,l=r.width,u=getIconTotalWidth(a.left,o),c=getIconTotalWidth(a.right,o),d,f,h;switch(n){case"left":f=s,d=s+u,h=d+e+(c&&o.margin.left);break;case"right":d=s+l-c,f=d-e-u,h=s+l-c+(c&&o.margin.left);break;default:var p=u+e+c;f=s+l/2-p/2,d=f+u+e/2,h=f+u+e+(c&&o.margin.left);break}return{textX:d,leftIconX:f,rightIconX:h}},getCellBoxByType=function(t,r,e,n){if(n===CellClipBox.BORDER_BOX)return t;var a=t.x,o=t.y,s=t.width,l=t.height,u=e.padding,c=e.horizontalBorderWidth,d=c===void 0?0:c,f=e.verticalBorderWidth,h=f===void 0?0:f;return r.forEach(function(p){var v=[CellBorderPosition.BOTTOM,CellBorderPosition.TOP].includes(p)?d:h;switch(p){case CellBorderPosition.TOP:o+=v,l-=v;break;case CellBorderPosition.BOTTOM:l-=v;break;case CellBorderPosition.LEFT:a+=v,s-=v;break;default:s-=v;break}}),n===CellClipBox.CONTENT_BOX&&(a+=u==null?void 0:u.left,o+=u==null?void 0:u.top,s-=(u==null?void 0:u.left)+(u==null?void 0:u.right),l-=(u==null?void 0:u.top)+(u==null?void 0:u.bottom)),{x:a,y:o,width:s,height:l}},getBorderPositionAndStyle=function(t,r,e){var n=r.x,a=r.y,o=r.width,s=r.height,l=e.horizontalBorderWidth,u=l===void 0?0:l,c=e.horizontalBorderColorOpacity,d=e.horizontalBorderColor,f=e.verticalBorderWidth,h=f===void 0?0:f,p=e.verticalBorderColor,v=e.verticalBorderColorOpacity,g=e.borderDash,y=isEmpty(g)?"":g,m=[CellBorderPosition.TOP,CellBorderPosition.BOTTOM].includes(t)?{lineWidth:u,stroke:d,strokeOpacity:c,lineDash:y}:{lineWidth:h,stroke:p,strokeOpacity:v,lineDash:y},S=0,w=0,R=0,T=0;if(t===CellBorderPosition.TOP||t===CellBorderPosition.BOTTOM){var x=a;t===CellBorderPosition.TOP?x=a+u/2:x=a+s-u/2,w=x,T=x,S=n,R=n+o}if(t===CellBorderPosition.LEFT||t===CellBorderPosition.RIGHT){var b=n;t===CellBorderPosition.LEFT?b=n+h/2:b=n+o-h/2,S=b,R=b,w=a,T=a+s}return{position:{x1:S,x2:R,y1:w,y2:T},style:m}},getIconPosition=function(t){var r;return(r=t==null?void 0:t.position)!==null&&r!==void 0?r:"right"},getIntervalScale=function(t,r){t===void 0&&(t=0),r===void 0&&(r=0),t=parseNumberWithPrecision(t),r=parseNumberWithPrecision(r);var e=t>=0,n=r>=0&&t<=0,a=e?t:r,o=n?0:a,s=r-t;return function(l){var u=e?0:1,c=n?clamp$1(Math.abs(0-t)/s,0,1):u,d=clamp$1((l-o)/s,-1,1);return{zeroScale:c,scale:d}}},scale=function(t,r){var e,n,a=t.data,o=t.encode,s=t.type,l=r.getMeta(),u=l.x,c=l.y,d=l.height,f=l.width,h=r.getStyle(CellType.DATA_CELL),p=h.cell,v=h.miniChart,g=[],y=map(a,function(j){return g.push(j==null?void 0:j[o.y]),{x:j[o.x],y:j[o.y]}}),m=max$1(g)||0,S=min$1(g)||0,w=m-S,R=p.padding,T=R.left,x=T===void 0?0:T,b=R.right,L=b===void 0?0:b,M=R.top,D=M===void 0?0:M,N=R.bottom,F=N===void 0?0:N,k=u+x,H=u+f-L,G=c+D,z=c+d-F,$=z-G,W=(e=v==null?void 0:v.bar)===null||e===void 0?void 0:e.intervalPadding,V=s===MiniChartType.Bar?(H-k-(g.length-1)*W)/g.length+W:(n=(H-k)/(g.length-1))!==null&&n!==void 0?n:0,X=[],J=map(y,function(j,ne){var Q=k+ne*V,ie;if(w!==0?ie=z-((j==null?void 0:j.y)-S)/w*$:ie=S>0?G:z,s===MiniChartType.Bar){var te=void 0,oe=void 0;S<0&&m>0&&w!==0?(te=z-(0-S)/w*$,oe=Math.abs(ie-te),(j==null?void 0:j.y)<0&&(ie=te)):(te=S<0?G:z,w=max$1([Math.abs(m),Math.abs(S)]),oe=w===0?$:Math.abs((j==null?void 0:j.y)-0)/w*$,ie=te);var ae=V-W;X.push([ae,oe])}return[Q,ie]});return{points:J,box:X}},drawLine=function(t,r){if(!(isEmpty(t==null?void 0:t.data)||isEmpty(r))){var e=r.getStyle(CellType.DATA_CELL),n=e.miniChart,a=n==null?void 0:n.line,o=a.point,s=a.linkLine,l=scale(t,r).points;renderPolyline(r,{points:l,stroke:s==null?void 0:s.fill,lineWidth:s==null?void 0:s.size,opacity:s==null?void 0:s.opacity});for(var u=0;u<l.length;u++)renderCircle(r,{cx:l[u][0],cy:l[u][1],r:o.size,fill:o.fill,fillOpacity:o==null?void 0:o.opacity})}},drawBar=function(t,r){if(!(isEmpty(t==null?void 0:t.data)||isEmpty(r)))for(var e=r.getStyle(CellType.DATA_CELL),n=e.miniChart,a=n.bar,o=scale(t,r),s=o.points,l=o.box,u=0;u<s.length;u++)renderRect(r,{x:s[u][0],y:s[u][1],width:l[u][0],height:l[u][1],fill:a.fill,fillOpacity:a.opacity})},getBulletRangeColor=function(t,r,e){var n=Number(r)-Number(t);return Number.isNaN(n)||Number(t)<0?e.bad:n<=.1?e.good:n>.1&&n<=.2?e.satisfactory:e.bad},transformRatioToPercent=function(t,r){var e,n;r===void 0&&(r={min:0,max:0});var a=Number(t);if(Number.isNaN(a))return t;var o=(e=r==null?void 0:r.min)!==null&&e!==void 0?e:r,s=(n=r==null?void 0:r.max)!==null&&n!==void 0?n:r,l=new Intl.NumberFormat("en-US",{minimumFractionDigits:o,maximumFractionDigits:s,useGrouping:!1,style:"percent"});return l.format(a)},drawInterval=function(t){var r,e,n,a,o,s;if(!isEmpty(t)){var l=t.getBBoxByType(CellClipBox.PADDING_BOX),u=l.x,c=l.y,d=l.height,f=l.width,h=t.findFieldCondition((r=t.cellConditions)===null||r===void 0?void 0:r.interval);if(h!=null&&h.mapping){var p=t.mappingValue(h);if(!p)return;var v=p.isCompare?p:t.valueRangeByField,g=parseNumberWithPrecision(v.minValue),y=parseNumberWithPrecision(v.maxValue),m=isNil(p==null?void 0:p.fieldValue)?parseNumberWithPrecision(t.getMeta().fieldValue):parseNumberWithPrecision(p==null?void 0:p.fieldValue);if(m<g||m>y)return;var S=t.getStyle(),w=(n=(e=S==null?void 0:S.miniChart)===null||e===void 0?void 0:e.interval)===null||n===void 0?void 0:n.height,R=(o=(a=S==null?void 0:S.miniChart)===null||a===void 0?void 0:a.interval)===null||o===void 0?void 0:o.fill,T=getIntervalScale(g,y),x=T(m),b=x.zeroScale,L=x.scale,M=(s=p.fill)!==null&&s!==void 0?s:R;return renderRect(t,{x:u+f*b,y:c+d/2-w/2,width:f*L,height:w,fill:M})}}},drawBullet=function(t,r){var e=r.getStyle(CellType.DATA_CELL),n=r.getMeta(),a=n.x,o=n.y,s=n.height,l=n.width;if(isEmpty(t)){r.renderTextShape(__assign(__assign({},e.text),{x:a+l-e.cell.padding.right,y:o+s/2,text:""}));return}var u=e.miniChart.bullet,c=u.progressBar,d=u.comparativeMeasure,f=u.rangeColors,h=u.backgroundColor,p=t.measure,v=t.target,g=Math.max(Number(p),0),y=Math.max(Number(v),0),m=transformRatioToPercent(p,2),S=(c==null?void 0:c.widthPercent)>1?(c==null?void 0:c.widthPercent)/100:c==null?void 0:c.widthPercent,w=e.cell.padding,R=l-w.left-w.right,T=S*R,x=R-T,b=a+l-w.right-T,L=o+s/2-c.height/2;renderRect(r,{x:b,y:L,width:T,height:c.height,fill:h});var M=Math.max(Math.min(T*g,T),0);renderRect(r,{x:b,y:L+(c.height-c.innerHeight)/2,width:M,height:c.innerHeight,fill:getBulletRangeColor(g,y,f)});var D=b+T*y;renderLine(r,{x1:D,y1:o+(s-d.height)/2,x2:D,y2:o+(s-d.height)/2+d.height,stroke:d==null?void 0:d.fill,lineWidth:d.width,opacity:d==null?void 0:d.opacity});var N=x-w.right;r.renderTextShape(__assign(__assign({},e.text),{x:b-w.right,y:o+s/2,text:m,wordWrapWidth:N}))},renderMiniChart=function(t,r){switch(r==null?void 0:r.type){case MiniChartType.Line:drawLine(r,t);break;case MiniChartType.Bar:drawBar(r,t);break;default:drawBullet(r,t);break}},getDisplayText=function(t,r){var e=r??EMPTY_PLACEHOLDER,n=isNil(t)||t===""||t===EMPTY_FIELD_VALUE;return n?e:"".concat(t)},calX=function(t,r,e,n){n===void 0&&(n="left");var a=r.right,o=a===void 0?0:a,s=r.left,l=s===void 0?0:s,u=e||0;return n==="left"?t+o/2+u:n==="right"?t-o/2-u:t+l/2+u},getDrawStyle=function(t){var r,e,n=t.getMeta().isTotals,a=(e=(r=t).isMeasureField)===null||e===void 0?void 0:e.call(r),o=t.getStyle(t.cellType||CellType.DATA_CELL),s;return a?s=o==null?void 0:o.measureText:n?s=o==null?void 0:o.bolderText:s=o==null?void 0:o.text,{cellStyle:o,textStyle:s}},getCurrentTextStyle=function(t){var r,e=t.rowIndex,n=t.colIndex,a=t.meta,o=t.data,s=t.textStyle,l=t.textCondition,u=(r=l==null?void 0:l.mapping)===null||r===void 0?void 0:r.call(l,o,{rowIndex:e,colIndex:n,meta:a});return __assign(__assign({},s),u)},getEmptyPlaceholder=function(t,r){return isFunction(r)?r(t):r},getContentAreaForMultiData=function(t,r,e){for(var n=t.x,a=t.y,o=t.width,s=t.height,l=s/size(r),u=[],c,d,f,h=0,p=map(e,function(m){return m>1?m/100:m}),v=0;v<size(r);v++){d=a+l*v;var g=[];c=n,h=0;for(var y=0;y<size(r[v]);y++)f=isEmpty(p)?o/size(r[0]):o*p[y],c=calX(n,{left:0,right:0},h,"left"),h+=f,g.push({x:c,y:d,width:f,height:l});u.push(g)}return u},drawCustomContent=function(t,r,e){var n,a,o,s,l,u,c,d;e===void 0&&(e=!0);var f=t.getBBoxByType(CellClipBox.CONTENT_BOX),h=f.x,p=f.y,v=f.height,g=f.width,y=t.getMeta(),m=r||y.fieldValue,S=m.values,w=y.spreadsheet.options,R=(a=(n=w==null?void 0:w.conditions)===null||n===void 0?void 0:n.text)===null||a===void 0?void 0:a[0],T=(s=(o=w==null?void 0:w.conditions)===null||o===void 0?void 0:o.icon)===null||s===void 0?void 0:s[0];if(!isArray(S)){renderMiniChart(t,S);return}var x=(c=(u=(l=w.style)===null||l===void 0?void 0:l.dataCell)===null||u===void 0?void 0:u.valuesCfg)===null||c===void 0?void 0:c.widthPercent,b=0;if(m!=null&&m.label){var L=t.getStyle(CellType.DATA_CELL),M=L.bolderText;b=v/(S.length+1),t.renderTextShape(__assign(__assign({},M),{x:h,y:p+b/2,text:m.label,maxLines:1,wordWrapWidth:g,wordWrap:!0,textOverflow:"ellipsis"}),{shallowRender:!0})}for(var D=getDrawStyle(t),N=D.cellStyle,F=D.textStyle,k=N==null?void 0:N.icon,H=T&&T.mapping&&{name:"",size:k==null?void 0:k.size,margin:k==null?void 0:k.margin,position:getIconPosition(T)},G,z=getContentAreaForMultiData({x:h,y:p+b,height:v-b,width:g},S,x),$=0;$<S.length;$++)for(var W=clone$1(S[$]),V=0;V<W.length;V++){G=W[V];var X=e?getCurrentTextStyle({rowIndex:$,colIndex:V,meta:y,data:G,textStyle:F,textCondition:R}):F,J=z[$][V].width-k.size-((H==null?void 0:H.position)==="left"?k.margin.right:k.margin.left),j={left:[],right:[]};H&&j[H.position].push(H),t.renderTextShape(__assign(__assign({},X),{x:0,y:0,maxLines:1,text:G,wordWrapWidth:J}),{shallowRender:!0});var ne=t.getActualTextWidth(),Q=getHorizontalTextIconPosition({bbox:z[$][V],textAlign:X.textAlign,textWidth:ne,iconStyle:k,groupedIcons:j}),ie=Q.textX,te=Q.leftIconX,oe=Q.rightIconX,ae=getVerticalTextPosition(z[$][V],X.textBaseline);if(t.updateTextPosition({x:ie,y:ae}),T&&e){var le=(d=T==null?void 0:T.mapping)===null||d===void 0?void 0:d.call(T,G,{rowIndex:$,colIndex:V,meta:t==null?void 0:t.getMeta()}),se=(H==null?void 0:H.position)==="left"?te:oe,fe=getVerticalIconPosition(k.size,ae,X.fontSize,X.textBaseline);if(le){var pe=renderIcon(t,{x:se,y:fe,name:le.icon,width:k==null?void 0:k.size,height:k==null?void 0:k.size,fill:le.fill});t.addConditionIconShape(pe)}}}},getCellWidth=function(t,r){return r===void 0&&(r=1),(t==null?void 0:t.width)*r},_a$1,matrixPlainTextTransformer=function(t,r){return r===void 0&&(r=NewTab),{type:CopyMIMEType.PLAIN,content:map(t,function(e){return e.join(r)}).join(NewLine)}},matrixHtmlTransformer=function(t){function r(a,o){return a.map(function(s){return"<".concat(o,">").concat(escape(s),"</").concat(o,">")}).join("")}function e(a,o){return a.map(function(s){return"<".concat(o,">").concat(r(s,"td"),"</").concat(o,">")}).join("")}var n=e(t,"tr");return{type:CopyMIMEType.HTML,content:'<meta charset="utf-8"><table><tbody>'.concat(n,"</tbody></table>")}},Transformers=(_a$1={},_a$1[CopyMIMEType.PLAIN]=matrixPlainTextTransformer,_a$1[CopyMIMEType.HTML]=matrixHtmlTransformer,_a$1);function getFormatter(t,r,e){return r===void 0&&(r=!1),r?e.getFieldFormatter(t):function(n){return n}}var assembleMatrix=function(t){var r,e,n,a,o,s,l=t.rowMatrix,u=t.colMatrix,c=t.dataMatrix,d=t.cornerMatrix,f=(e=(r=l==null?void 0:l[0])===null||r===void 0?void 0:r.length)!==null&&e!==void 0?e:0,h=(n=u==null?void 0:u.length)!==null&&n!==void 0?n:0,p=(o=(a=c[0])===null||a===void 0?void 0:a.length)!==null&&o!==void 0?o:0,v=(s=c.length)!==null&&s!==void 0?s:0,g=f+p,y=h+v,m=Array.from(Array(y),function(){return new Array(g)});return m=map(m,function(S,w){return map(S,function(R,T){var x,b;if(T>=0&&T<f&&w>=0&&w<h)return(b=(x=d==null?void 0:d[w])===null||x===void 0?void 0:x[T])!==null&&b!==void 0?b:"";if(T>=f&&T<=g&&w>=0&&w<h)return u[w][T-f];if(T>=0&&T<f&&w>=h&&w<y)return l==null?void 0:l[w-h][T];if(T>=f&&T<=g&&w>=h&&w<y)return c[w-h][T-f]})}),m};function getMaxRowLen(t){var r;return(r=max$1(map(t,function(e){return e.length})))!==null&&r!==void 0?r:0}function completeMatrix(t){var r=getMaxRowLen(t);return map(t,function(e){var n=r-e.length;return n?__spreadArray(__spreadArray([],__read(e),!1),__read(new Array(n).fill("")),!1):e})}var getFormatOptions=function(t){var r,e;return typeof t=="object"?{formatHeader:(r=t.formatHeader)!==null&&r!==void 0?r:!1,formatData:(e=t.formatData)!==null&&e!==void 0?e:!1}:{formatHeader:t??!1,formatData:t??!1}};function getTransformer(t){var r;if(!t)return Transformers;var e=t(Transformers);return r={},r[CopyMIMEType.PLAIN]=e[CopyMIMEType.PLAIN]||Transformers[CopyMIMEType.PLAIN],r[CopyMIMEType.HTML]=e[CopyMIMEType.HTML]||Transformers[CopyMIMEType.HTML],r}function unifyConfig(t){var r,e,n=t.spreadsheet.options.interaction,a=t.config,o=a.formatOptions,s=o===void 0?!1:o,l=a.separator,u=l===void 0?NewTab:l,c=a.selectedCells,d=c===void 0?[]:c,f=a.customTransformer,h=a.isAsyncExport,p=h===void 0?!1:h,v=t.isExport,g=n.copy,y=v?getFormatOptions(s):{formatData:(r=g==null?void 0:g.withFormat)!==null&&r!==void 0?r:!1,formatHeader:(e=g==null?void 0:g.withFormat)!==null&&e!==void 0?e:!1},m=y.formatData,S=y.formatHeader,w=getTransformer(v?f:g==null?void 0:g.customTransformer);return{separator:u,selectedCells:d,transformers:w,formatData:m,formatHeader:S,isAsyncExport:p}}var getNodeFormatLabel=function(t){var r,e,n,a,o=(n=(e=(r=t.spreadsheet)===null||r===void 0?void 0:r.dataSet)===null||e===void 0?void 0:e.getFieldFormatter)===null||n===void 0?void 0:n.call(e,t.field);return(a=o==null?void 0:o(t.value))!==null&&a!==void 0?a:t.value},getNodeFormatData=function(t){var r=[],e=function(n){if(n.id!==ROOT_NODE_ID){var a=getNodeFormatLabel(n);if(r.unshift(a),n!=null&&n.parent)return e(n.parent)}};return e(t),r};function keyEqualTo(t,r){return!t||!r?!1:String(t).toLowerCase()===String(r).toLowerCase()}var convertString=function(t){return/\n/.test(t)?'"'.concat(t.replace(/\r\n?/g,`
`).replace(/"/g,"'"),'"'):t};function getAllLevels(t){var r=new Set;return forEach(t,function(e){var n=e.getMeta().level;r.has(n)||r.add(n)}),r}var getHeaderMeasureFieldNames=function(t,r){return map(t,function(e){return r.dataSet.getFieldName(e)})},getHeaderList=function(t,r){var e=t.split(NODE_ID_SEPARATOR);return r?e.slice(e.length-r):(e.shift(),e)},getColNodeFieldFromNode=function(t,r){return t()?r==null?void 0:r.value:r==null?void 0:r.field},getSelectedCols=function(t){return t.filter(function(r){var e=r.type;return e===CellType.COL_CELL})},getSelectedRows=function(t){return t.filter(function(r){var e=r.type;return e===CellType.ROW_CELL})};function getLastLevelCells(t,r){return filter(t,function(e){var n=e.getMeta(),a=n.level===r,o=n.isTotals&&isEmpty(n.children);return a||o})}function getHeaderCellMatrix(t,r,e){return map(t,function(n){var a=n.getMeta(),o=a.id,s=a.value,l=a.isTotals,u=a.level,c=a.spreadsheet,d=o;return l&&u!==r&&(d=o+NODE_ID_SEPARATOR+repeat(s,r-u)),getHeaderMeasureFieldNames(getHeaderList(d,e.size),c)})}function getBrushHeaderCopyable(t){var r,e=getAllLevels(t),n=(r=max$1(Array.from(e)))!==null&&r!==void 0?r:0,a=getLastLevelCells(t,n),o=t[0].cellType===CellType.COL_CELL,s=getHeaderCellMatrix(a,n,e),l=o?zip.apply(void 0,__spreadArray([],__read(s),!1)):s;return[matrixPlainTextTransformer(l),matrixHtmlTransformer(l)]}var BaseDataCellCopy=function(){function t(r){var e=this;this.matrixHtmlTransformer=function(l){return e.config.transformers[CopyMIMEType.HTML](l)};var n=r.spreadsheet,a=r.isExport,o=a===void 0?!1:a,s=r.config;this.spreadsheet=n,this.config=unifyConfig({config:s,spreadsheet:n,isExport:o})}return t.prototype.matrixPlainTextTransformer=function(r,e){return this.config.transformers[CopyMIMEType.PLAIN](r,e)},t.prototype.matrixTransformer=function(r,e){return e===void 0&&(e=NewTab),[this.matrixPlainTextTransformer(r,e),this.matrixHtmlTransformer(r)]},t}(),PivotDataCellCopy=function(t){__extends(r,t);function r(e){var n=t.call(this,e)||this;return n.leafRowNodes=[],n.leafColNodes=[],n.compatibleHideMeasureColumn=function(){var a,o,s,l,u,c=((l=(s=(o=n.spreadsheet.options)===null||o===void 0?void 0:o.style)===null||s===void 0?void 0:s.colCell)===null||l===void 0?void 0:l.hideValue)&&n.spreadsheet.isValueInCols();return c?(a={},a[EXTRA_FIELD]=(u=n.spreadsheet.dataCfg.fields.values)===null||u===void 0?void 0:u[0],a):{}},n.getDataMatrixByHeaderNode=function(){var a=n.compatibleHideMeasureColumn();return map(n.leafRowNodes,function(o){return n.leafColNodes.map(function(s){return n.getDataCellValue({rowNode:o,colNode:s,config:{measureQuery:a,isPivotMode:n.spreadsheet.isPivotMode,dataSet:n.spreadsheet.dataSet}})})})},n.getDataMatrixByHeaderNodeRIC=function(){var a=[],o=0,s=n.compatibleHideMeasureColumn();return new Promise(function(l,u){try{var c=function(d){for(var f=AsyncRenderThreshold,h=n.leafRowNodes.length;d.timeRemaining()>0&&o<h-1&&f>0;)for(var p=o;p<h&&f>0;p++){for(var v=[],g=n.leafRowNodes[p],y=0;y<n.leafColNodes.length;y++){var m=n.leafColNodes[y],S=n.getDataCellValue({rowNode:g,colNode:m,config:{isPivotMode:n.spreadsheet.isPivotMode,dataSet:n.spreadsheet.dataSet,measureQuery:s}});v.push(S)}o=p,a.push(v),f--}o===h-1?l(a):requestIdleCallback(c)};requestIdleCallback(c)}catch(d){u(d)}})},n.getDataCellValue=function(a){var o,s=a.rowNode,l=a.colNode,u=a.config,c=u.isPivotMode,d=u.dataSet,f=u.measureQuery,h=d.getCellData({query:__assign(__assign(__assign({},s.query),l.query),f),rowNode:s,isTotals:s.isTotals||s.isTotalMeasure||l.isTotals||l.isTotalMeasure}),p=n.spreadsheet.isValueInCols()?l:s,v=(o=getColNodeFieldFromNode(c,p))!==null&&o!==void 0?o:"",g=n.spreadsheet.dataCfg.fields.values;v=g!=null&&g.includes(v)?v:g==null?void 0:g[0];var y=getFormatter(v??l.field,n.config.formatData,d),m=h==null?void 0:h[VALUE_FIELD],S=isPlainObject(m==null?void 0:m.values),w=S?"":m;return y(w??"")},n.getCustomRowCornerMatrix=function(a){var o=getMaxRowLen(a??[]),s=n.spreadsheet.facet.getCornerNodes(),l=sortBy(s,function(u){return u.cornerType===CornerNodeType.Col?0:1});return n.spreadsheet.isHierarchyTreeType()?map(l,function(u){var c=new Array(o).fill("");return c[o-1]=u.value,c}):Object.values(groupBy(l,"y")).map(function(u){var c=new Array(o-u.length).fill(""),d=u.map(function(f){return f.value});return __spreadArray(__spreadArray([],__read(c),!1),__read(d),!1)})},n.getCornerMatrix=function(a){if(n.spreadsheet.isCustomRowFields())return n.getCustomRowCornerMatrix(a);var o=n.spreadsheet.dataCfg.fields,s=o.columns,l=s===void 0?[]:s,u=o.rows,c=u===void 0?[]:u,d=__spreadArray(__spreadArray([],__read(l),!1),[""],!1),f=n.spreadsheet.isHierarchyTreeType()?getMaxRowLen(a??[]):c.length,h=slice(c,0,f);return map(d,function(p,v){return map(h,function(g,y){return v===d.length-1?n.spreadsheet.dataSet.getFieldName(g):y===f-1?n.spreadsheet.dataSet.getFieldName(p):""})})},n.getDataMatrixByDataCell=function(a){var o=n.spreadsheet.options.interaction.copy,s=n.compatibleHideMeasureColumn(),l=map(a,function(d){return map(d,function(f){var h=__read(getHeaderNodeFromMeta(f,n.spreadsheet),2),p=h[0],v=h[1],g=n.getDataCellValue({rowNode:p,colNode:v,config:{isPivotMode:n.spreadsheet.isPivotMode,dataSet:n.spreadsheet.dataSet,measureQuery:s}});return convertString(g)})});if(!(o!=null&&o.withHeader))return n.matrixTransformer(l,n.config.separator);var u=n.getRowMatrix(),c=n.getColMatrix();return n.matrixTransformer(assembleMatrix({rowMatrix:u,colMatrix:c,dataMatrix:l}),n.config.separator)},n.getAsyncAllPivotCopyData=function(){return __awaiter(n,void 0,void 0,function(){var a,o,s,l,u;return __generator(this,function(c){switch(c.label){case 0:return a=this.getRowMatrix(),o=this.getColMatrix(),s=this.getCornerMatrix(a),l=[],this.config.isAsyncExport?[4,this.getDataMatrixByHeaderNodeRIC()]:[3,2];case 1:return l=c.sent(),[3,4];case 2:return[4,Promise.resolve(this.getDataMatrixByHeaderNode())];case 3:l=c.sent(),c.label=4;case 4:return u=this.matrixTransformer(assembleMatrix({rowMatrix:a,colMatrix:o,dataMatrix:l,cornerMatrix:s}),this.config.separator),[2,u]}})})},n.getPivotAllCopyData=function(){var a=n.getRowMatrix(),o=n.getColMatrix(),s=n.getCornerMatrix(a),l=n.getDataMatrixByHeaderNode(),u=n.matrixTransformer(assembleMatrix({rowMatrix:a,colMatrix:o,dataMatrix:l,cornerMatrix:s}),n.config.separator);return u},n.leafRowNodes=n.getLeafRowNodes(),n.leafColNodes=n.getLeafColNodes(),n}return r.prototype.getLeafRowNodes=function(){var e=this.spreadsheet.facet.getRowLeafNodes(),n=getSelectedRows(this.config.selectedCells),a=this.spreadsheet.isHierarchyTreeType();return isEmpty(n)?e:this.getSelectedNode(n,e,a)},r.prototype.getLeafColNodes=function(){var e=this.spreadsheet.facet.getColLeafNodes(),n=getSelectedCols(this.config.selectedCells);return isEmpty(n)?e:this.getSelectedNode(n,e)},r.prototype.getSelectedNode=function(e,n,a){return a===void 0&&(a=!1),e.reduce(function(o,s){var l=n.filter(function(u){return a?u.id===s.id:u.id.startsWith(s.id)});return o.push.apply(o,__spreadArray([],__read(l),!1)),o},[])},r.prototype.getColMatrix=function(){var e=this;return zip.apply(void 0,__spreadArray([],__read(map(this.leafColNodes,function(n){return e.config.formatHeader?getNodeFormatData(n):getHeaderMeasureFieldNames(getHeaderList(n.id),n.spreadsheet)})),!1))},r.prototype.getRowMatrix=function(){var e=this,n=map(this.leafRowNodes,function(a){return e.config.formatHeader?getNodeFormatData(a):getHeaderMeasureFieldNames(getHeaderList(a.id),a.spreadsheet)});return completeMatrix(n)},r.prototype.getPivotCopyData=function(){var e=this.spreadsheet.options.interaction.copy,n=this.getDataMatrixByHeaderNode();if(!(e!=null&&e.withHeader))return this.matrixTransformer(n,this.config.separator);var a=this.getRowMatrix(),o=this.getColMatrix();return this.matrixTransformer(assembleMatrix({rowMatrix:a,colMatrix:o,dataMatrix:n}),this.config.separator)},r}(BaseDataCellCopy);function processSelectedPivotByHeader(t,r){var e=new PivotDataCellCopy({spreadsheet:t,config:{selectedCells:r}});return e.getPivotCopyData()}var processSelectedPivotByDataCell=function(t){var r=t.spreadsheet,e=t.selectedCells,n=t.headerSelectedCells,a=new PivotDataCellCopy({spreadsheet:r,config:{selectedCells:n,formatOptions:!0}});return a.getDataMatrixByDataCell(e)},TableDataCellCopy=function(t){__extends(r,t);function r(e){var n=t.call(this,e)||this;return n.getValueFromMeta=function(a){var o,s=__read(getHeaderNodeFromMeta(a,n.spreadsheet),2),l=s[1],u=getColNodeFieldFromNode(n.spreadsheet.isPivotMode,l),c=n.isSeriesNumberField(u)?a.rowIndex+1:(o=n.displayData[a.rowIndex])===null||o===void 0?void 0:o[u],d=getFormatter(u,n.config.formatData,n.spreadsheet.dataSet);return d(c)},n.displayData=n.getSelectedDisplayData(),n.columnNodes=n.getSelectedColNodes(),n}return r.prototype.getSelectedColNodes=function(){var e=getSelectedCols(this.config.selectedCells),n=this.spreadsheet.facet.getColNodes();return e.length===0?n:map(e,function(a){return n[a.colIndex]})},r.prototype.getSelectedDisplayData=function(){var e=getSelectedRows(this.config.selectedCells),n=this.spreadsheet.dataSet.getDisplayDataSet();return e.length===0?n:map(e,function(a){return n[a.rowIndex]})},r.prototype.getDataMatrix=function(){var e=this,n=this.spreadsheet.options.seriesNumber;return this.displayData.map(function(a,o){return e.columnNodes.map(function(s){var l=s==null?void 0:s.field;if(SERIES_NUMBER_FIELD===l&&(n!=null&&n.enable))return(o+1).toString();var u=getFormatter(l,e.config.formatData,e.spreadsheet.dataSet),c=a==null?void 0:a[l];return u(c)})})},r.prototype.getDataMatrixRIC=function(){var e=this,n=this.spreadsheet.options.seriesNumber,a=[],o=0;return new Promise(function(s,l){try{var u=function(c){for(var d=AsyncRenderThreshold,f=e.displayData.length;c.timeRemaining()>0&&d>0&&o<f-1;)for(var h=o;h<f&&d>0;h++){for(var p=e.displayData[h],v=[],g=0;g<e.columnNodes.length;g++){var y=e.columnNodes[g],m=y.field;if(SERIES_NUMBER_FIELD===m&&(n!=null&&n.enable)){v.push((h+1).toString());continue}var S=getFormatter(m,e.config.formatData,e.spreadsheet.dataSet),w=p[m],R=S(w);v.push(R)}o=h,a.push(v),d--}o===f-1?s(a):requestIdleCallback(u)};requestIdleCallback(u)}catch(c){l(c)}})},r.prototype.isSeriesNumberField=function(e){var n=this.spreadsheet.options.seriesNumber;return SERIES_NUMBER_FIELD===e&&(n==null?void 0:n.enable)},r.prototype.getColMatrix=function(){var e=this,n=this.config.formatHeader;return this.columnNodes.map(function(a){var o=a.field;return n?e.isSeriesNumberField(o)?getDefaultSeriesNumberText():e.spreadsheet.dataSet.getFieldName(o):o})},r.prototype.getDataMatrixByDataCell=function(e){var n=this,a=this.spreadsheet.options.interaction.copy,o=map(e,function(l){return map(l,function(u){return convertString(n.getValueFromMeta(u))})});if(!(a!=null&&a.withHeader))return this.matrixTransformer(o,this.config.separator);var s=this.getColMatrix();return this.matrixTransformer(assembleMatrix({colMatrix:[s],dataMatrix:o}),this.config.separator)},r.prototype.processSelectedTable=function(e){e===void 0&&(e=!1);var n=this.getDataMatrix();if(!e)return this.matrixTransformer(n,this.config.separator);var a=this.getColMatrix();return this.matrixTransformer(assembleMatrix({colMatrix:[a],dataMatrix:n}),this.config.separator)},r.prototype.asyncProcessSelectedTable=function(e){return e===void 0&&(e=!1),__awaiter(this,void 0,void 0,function(){var n,a,o;return __generator(this,function(s){switch(s.label){case 0:return this.config.isAsyncExport?[4,this.getDataMatrixRIC()]:[3,2];case 1:return a=s.sent(),[3,4];case 2:return[4,Promise.resolve(this.getDataMatrix())];case 3:a=s.sent(),s.label=4;case 4:return n=a,e?(o=this.getColMatrix(),[2,this.matrixTransformer(assembleMatrix({colMatrix:[o],dataMatrix:n}),this.config.separator)]):[2,this.matrixTransformer(n,this.config.separator)]}})})},r}(BaseDataCellCopy),processSelectedTableByHeader=function(t,r){var e=new TableDataCellCopy({spreadsheet:t,config:{selectedCells:r}});return e.processSelectedTable()},processSelectedTableByDataCell=function(t){var r=t.spreadsheet,e=t.selectedCells,n=t.headerSelectedCells,a=new TableDataCellCopy({spreadsheet:r,config:{selectedCells:n,formatOptions:!0}});return a.getDataMatrixByDataCell(e)},getHeaderNodeFromMeta=function(t,r){var e=t.rowIndex,n=t.colIndex,a=r.facet;return[a.getRowNodeByIndex(e),a.getColNodeByIndex(n)]},getSelectedCellsMeta=function(t){if(!(t!=null&&t.length))return[];var r=__read([{row:1/0,col:1/0},{row:0,col:0}],2),e=r[0],n=r[1];t.forEach(function(u){var c=u.rowIndex,d=u.colIndex;e.col=Math.min(d,e.col),e.row=Math.min(c,e.row),n.col=Math.max(d,n.col),n.row=Math.max(c,n.row)});var a=__read([n.row-e.row+1,n.col-e.col+1],2),o=a[0],s=a[1],l=new Array(o).fill("").map(function(){return new Array(s).fill("")});return t.forEach(function(u){var c=u.rowIndex,d=u.colIndex,f=__read([c-e.row,d-e.col],2),h=f[0],p=f[1];l[h][p]=u}),l},processSelectedByHeader=function(t,r){return t.isPivotMode()?processSelectedPivotByHeader(t,r):processSelectedTableByHeader(t,r)};function getIsBrushHeader(t){return isEmpty(t)?!1:every(t,function(r){return r.cellType===CellType.ROW_CELL||r.cellType===CellType.COL_CELL})}function processSelectedByData(t,r,e,n){return n.isPivotMode()?processSelectedPivotByDataCell({spreadsheet:n,selectedCells:t,headerSelectedCells:concat(r,e)}):processSelectedTableByDataCell({spreadsheet:n,selectedCells:t,headerSelectedCells:r})}function getDataCellCopyable(t,r){var e,n=getSelectedCols(r),a=getSelectedRows(r);if(t.interaction.getCurrentStateName()===InteractionStateName.ALL_SELECTED)e=processSelectedByHeader(t,[]);else if(n.length)e=processSelectedByHeader(t,n);else if(a.length)e=processSelectedByHeader(t,a);else{if(!r.length)return[{type:CopyMIMEType.PLAIN,content:""},{type:CopyMIMEType.HTML,content:""}];var o=getSelectedCellsMeta(r),s=o[0].map(function(u){var c,d,f;return __assign(__assign({},u),{id:(f=(d=(c=u==null?void 0:u.id)===null||c===void 0?void 0:c.split(EMPTY_PLACEHOLDER))===null||d===void 0?void 0:d[1])!==null&&f!==void 0?f:"",type:CellType.COL_CELL})}),l=o.map(function(u){var c,d,f,h;return __assign(__assign({},u[0]),{id:(h=(f=(d=(c=u[0])===null||c===void 0?void 0:c.id)===null||d===void 0?void 0:d.split(EMPTY_PLACEHOLDER))===null||f===void 0?void 0:f[0])!==null&&h!==void 0?h:"",type:CellType.ROW_CELL})});e=processSelectedByData(o,s,l,t)}return e}var getSelectedData=function(t){var r,e=t.interaction,n=e.getState().cells||[],a=(r=e.getInteractedCells())!==null&&r!==void 0?r:[],o=getIsBrushHeader(a),s=o?getBrushHeaderCopyable(a):getDataCellCopyable(t,n);return s&&copyToClipboard(s),s},copyToClipboardByExecCommand=function(t){return new Promise(function(r,e){var n;Array.isArray(t)?n=get(t.filter(function(s){return s.type===CopyMIMEType.PLAIN}),"[0].content",""):n=t.content||"";var a=document.createElement("textarea");a.value=n,document.body.appendChild(a),a.focus({preventScroll:!0}),a.select();var o=document.execCommand("copy");document.body.removeChild(a),o?r():e()})},copyToClipboardByClipboard=function(t){return navigator.clipboard.write([new ClipboardItem(concat(t).reduce(function(r,e){var n,a=e.type,o=e.content,s=o.replace(/\x00/g,"");return __assign(__assign({},r),(n={},n[a]=new Blob([s],{type:a}),n))},{}))]).catch(function(){return copyToClipboardByExecCommand(t)})},copyToClipboard=function(t,r){r===void 0&&(r=!1);var e;return typeof t=="string"?e={content:t,type:CopyMIMEType.PLAIN}:e=t,!navigator.clipboard||!window.ClipboardItem||r?copyToClipboardByExecCommand(e):copyToClipboardByClipboard(e)},getAppendInfo=function(t){return!t||!("appendInfo"in t)?{}:t.appendInfo},getActiveHoverHeaderCells=function(t,r,e){var n,a=t.split(NODE_ID_SEPARATOR);if(e)n=[t];else{n=[generateId(a[0],a[1])];for(var o=2;o<a.length;o+=1)n.push(generateId(n[o-2],a[o]))}var s=filter(r,function(l){var u;return n.includes((u=l.getMeta())===null||u===void 0?void 0:u.id)});return s},updateAllColHeaderCellState=function(t,r,e){if(t){var n=getActiveHoverHeaderCells(t,r);forEach(n,function(a){a.updateByState(e)})}},checkIsLinkField=function(t,r){return typeof t=="function"?t(r):t.some(function(e){return e===r.field||e===r.id||e===r.valueField})},BaseCell=function(t){__extends(r,t);function r(e,n){for(var a=[],o=2;o<arguments.length;o++)a[o-2]=arguments[o];var s=t.call(this,{})||this;return s.textShapes=[],s.conditionIconShapes=[],s.stateShapes=new Map,s.meta=e,s.spreadsheet=n,s.theme=n.theme,s.conditions=s.spreadsheet.options.conditions,s.groupedIcons={left:[],right:[]},s.handleRestOptions.apply(s,__spreadArray([],__read(a),!1)),s.shouldInit()&&s.initCell(),s}return r.prototype.handleRestOptions=function(){},r.prototype.getMeta=function(){return this.meta},r.prototype.setMeta=function(e){this.meta=e},r.prototype.getIconStyle=function(){var e;return(e=this.theme[this.cellType])===null||e===void 0?void 0:e.icon},r.prototype.isShallowRender=function(){return!1},r.prototype.getCellTextWordWrapStyle=function(e){var n,a,o=((a=(n=this.spreadsheet.options)===null||n===void 0?void 0:n.style)===null||a===void 0?void 0:a[e||this.cellType])||{},s=o.wordWrap,l=o.maxLines,u=o.textOverflow;return{wordWrap:s,maxLines:l,textOverflow:u}},r.prototype.getActualText=function(){return this.actualText},r.prototype.getActualTextWidth=function(){var e;return((e=this.textShape)===null||e===void 0?void 0:e.getComputedTextLength())||0},r.prototype.getActualTextHeight=function(){return this.getMultiLineActualTextHeight()},r.prototype.getMultiLineActualTexts=function(){var e,n;return((n=(e=this.textShape)===null||e===void 0?void 0:e.parsedStyle.metrics)===null||n===void 0?void 0:n.lines)||[]},r.prototype.getMultiLineActualTextWidth=function(){return sumBy(this.getTextLineBoundingRects(),"width")||0},r.prototype.getMultiLineActualTextHeight=function(){return sumBy(this.getTextLineBoundingRects(),"height")||0},r.prototype.getOriginalText=function(){return this.originalText},r.prototype.isTextOverflowing=function(){var e;return(e=this.textShape)===null||e===void 0?void 0:e.isOverflowing()},r.prototype.isMultiLineText=function(){return this.getTextLineBoundingRects().length>1},r.prototype.getEmptyPlaceholder=function(){var e=this.spreadsheet.options.placeholder;return getEmptyPlaceholder(this,e)},r.prototype.getTextLineBoundingRects=function(){var e;return((e=this.textShape)===null||e===void 0?void 0:e.getLineBoundingRects())||[]},r.prototype.getFieldValue=function(){return this.getFormattedFieldValue().formattedValue},r.prototype.shouldInit=function(){var e=this.meta,n=e.width,a=e.height;return n>0&&a>0},r.prototype.getStyle=function(e){return get(this.theme,e||this.cellType)},r.prototype.getLinkFieldShape=function(){return this.linkFieldShape},r.prototype.getBackgroundShape=function(){return this.backgroundShape},r.prototype.getStateShapes=function(){return this.stateShapes},r.prototype.getResizeAreaStyle=function(){return this.getStyle("resizeArea")},r.prototype.shouldDrawResizeAreaByType=function(e,n){var a=this.spreadsheet.options.interaction.resize;return isBoolean(a)?a:isFunction(a==null?void 0:a.visible)?a==null?void 0:a.visible(n):a==null?void 0:a[e]},r.prototype.getBBoxByType=function(e){e===void 0&&(e=CellClipBox.BORDER_BOX);var n={x:this.meta.x,y:this.meta.y,height:this.meta.height,width:this.meta.width},a=this.getStyle()||this.theme.dataCell;return getCellBoxByType(n,this.getBorderPositions(),a==null?void 0:a.cell,e)},r.prototype.drawBorders=function(){var e=this;this.getBorderPositions().forEach(function(n){var a,o=getBorderPositionAndStyle(n,e.getBBoxByType(),(a=e.getStyle())===null||a===void 0?void 0:a.cell),s=o.position,l=o.style;renderLine(e,__assign(__assign({},s),l))})},r.prototype.drawInteractiveBorderShape=function(){this.stateShapes.set("interactiveBorderShape",renderRect(this,__assign(__assign({},this.getBBoxByType(CellClipBox.PADDING_BOX)),{visibility:"hidden",pointerEvents:"none"})))},r.prototype.drawInteractiveBgShape=function(){this.stateShapes.set("interactiveBgShape",renderRect(this,__assign(__assign({},this.getBBoxByType()),{visibility:"hidden",pointerEvents:"none"})))},r.prototype.drawBackgroundShape=function(){var e=this.getBackgroundColor(),n=e.backgroundColor,a=e.backgroundColorOpacity;this.backgroundShape=renderRect(this,__assign(__assign({},this.getBBoxByType()),{fill:n,fillOpacity:a}))},r.prototype.renderTextShape=function(e,n){var a=getDisplayText(e.text,this.getEmptyPlaceholder()),o=(n==null?void 0:n.shallowRender)||this.isShallowRender();if(this.textShape=renderText({group:this,textShape:o?void 0:this.textShape,style:__assign(__assign({},e),{text:a})}),this.addTextShape(this.textShape),o)return this.textShape;var s=this.getMultiLineActualTexts().join("");return this.actualText=s,this.originalText=a,this.textShape},r.prototype.updateTextPosition=function(e){var n,a,o,s,l=this.getTextPosition();(n=this.textShape)===null||n===void 0||n.attr("x",(a=e==null?void 0:e.x)!==null&&a!==void 0?a:l==null?void 0:l.x),(o=this.textShape)===null||o===void 0||o.attr("y",(s=e==null?void 0:e.y)!==null&&s!==void 0?s:l==null?void 0:l.y)},r.prototype.drawTextShape=function(){var e=Math.max(this.getMaxTextWidth(),0),n=this.getTextStyle();this.renderTextShape(__assign(__assign({},n),{x:0,y:0,text:this.getFieldValue(),wordWrapWidth:e})),!this.isShallowRender()&&this.updateTextPosition()},r.prototype.drawLinkFieldShape=function(e,n){if(e){var a=this.spreadsheet.options.device;if(!isMobile(a)){var o=this.getTextStyle(),s=this.getTextPosition(),l=this.getActualTextWidth(),u=s.x;o.textAlign==="center"?u-=l/2:o.textAlign==="right"&&(u-=l);var c=this.textShape.getBBox().bottom;this.linkFieldShape=renderLine(this,{x1:u,y1:c+1,x2:u+l,y2:c+1,stroke:n,lineWidth:1})}this.textShape.style.fill=n,this.textShape.style.cursor="pointer",this.textShape.appendInfo={isLinkFieldText:!0,cellData:this.meta}}},r.prototype.getLinkFieldStyle=function(){return this.getTextStyle().linkTextFill},r.prototype.drawLinkField=function(e){var n=this.spreadsheet.options.interaction.linkFields,a=n===void 0?[]:n,o=this.getLinkFieldStyle(),s=checkIsLinkField(a,e);this.drawLinkFieldShape(s,o)},r.prototype.updateByState=function(e,n){var a=this;this.spreadsheet.interaction.setInteractedCells(n);var o=get(this.theme,"".concat(this.cellType,".cell.interactionState.").concat(e));forEach(o,function(s,l){var u=keys(pickBy(SHAPE_ATTRS_MAP,function(c){return includes(c,l)}));u.forEach(function(c){var d=a.stateShapes.has(c),f=d?a.stateShapes.get(c):a[c],h=isArray(f)?f:[f];if(d&&h.forEach(function(v){v.setAttribute("visibility","visible")}),c==="interactiveBorderShape"&&l==="borderWidth"&&isNumber(s)){var p=a.getInteractiveBorderShapeStyle(s);forEach(p,function(v,g){updateShapeAttr(h,g,v)})}updateShapeAttr(h,SHAPE_STYLE_MAP[l],s)})})},r.prototype.getInteractiveBorderShapeStyle=function(e){var n=this.getBBoxByType(CellClipBox.PADDING_BOX),a=n.x,o=n.y,s=n.height,l=n.width,u=e/2;return{x:a+u,y:o+u,width:l-e,height:s-e}},r.prototype.hideInteractionShape=function(){this.stateShapes.forEach(function(e){updateShapeAttr(e,SHAPE_STYLE_MAP.backgroundOpacity,0),updateShapeAttr(e,SHAPE_STYLE_MAP.backgroundColor,"transparent"),updateShapeAttr(e,SHAPE_STYLE_MAP.borderOpacity,0),updateShapeAttr(e,SHAPE_STYLE_MAP.borderWidth,1),updateShapeAttr(e,SHAPE_STYLE_MAP.borderColor,"transparent")})},r.prototype.clearUnselectedState=function(){updateShapeAttr(this.backgroundShape,SHAPE_STYLE_MAP.backgroundOpacity,1),updateShapeAttr(this.textShapes,SHAPE_STYLE_MAP.textOpacity,1),updateShapeAttr(this.linkFieldShape,SHAPE_STYLE_MAP.opacity,1)},r.prototype.getTextShape=function(){return this.textShape},r.prototype.getTextShapes=function(){return this.textShapes||[this.textShape]},r.prototype.addTextShape=function(e){e&&this.textShapes.push(e)},r.prototype.getConditionIconShape=function(){return this.conditionIconShape},r.prototype.getConditionIconShapes=function(){return this.conditionIconShapes||[this.conditionIconShape]},r.prototype.addConditionIconShape=function(e){e&&this.conditionIconShapes.push(e)},r.prototype.resetTextAndConditionIconShapes=function(){this.textShapes=[],this.conditionIconShapes=[]},Object.defineProperty(r.prototype,"cellConditions",{get:function(){return this.conditions},enumerable:!1,configurable:!0}),r.prototype.drawConditionIconShapes=function(){var e=this.getIconConditionResult();if(e){var n=this.getIconPosition(),a=this.getStyle().icon.size;this.conditionIconShape=renderIcon(this,__assign(__assign({},n),{name:e==null?void 0:e.name,width:a,height:a,fill:e==null?void 0:e.fill})),this.addConditionIconShape(this.conditionIconShape)}},r.prototype.getTextConditionMappingResult=function(){var e,n=this.findFieldCondition((e=this.conditions)===null||e===void 0?void 0:e.text);return n!=null&&n.mapping?this.mappingValue(n):null},r.prototype.getContainConditionMappingResultTextStyle=function(e){var n=this.getDefaultTextFill(e.fill),a=this.getTextConditionMappingResult();return __assign(__assign(__assign({},e),a),{fill:(a==null?void 0:a.fill)||n})},r.prototype.getDefaultTextFill=function(e){var n=this.getBackgroundColor(),a=n.backgroundColor,o=n.intelligentReverseTextColor;return shouldReverseFontColor(a)&&e===DEFAULT_FONT_COLOR&&o&&(e=REVERSE_FONT_COLOR),e||""},r.prototype.getBackgroundConditionFill=function(){var e,n=this.findFieldCondition((e=this.conditions)===null||e===void 0?void 0:e.background);if(n!=null&&n.mapping){var a=this.mappingValue(n);if(a)return{backgroundColor:a.fill,intelligentReverseTextColor:a.intelligentReverseTextColor||!1}}return{intelligentReverseTextColor:!1}},r.prototype.getIconConditionResult=function(){var e,n=this.findFieldCondition((e=this.conditions)===null||e===void 0?void 0:e.icon);if(n!=null&&n.mapping){var a=this.mappingValue(n);if(a&&a.icon)return{name:a.icon,position:getIconPosition(n),fill:a.fill,isConditionIcon:!0}}},r.prototype.getActionAndConditionIconWidth=function(e){var n=this.groupedIcons,a=n.left,o=n.right,s=this.getStyle().icon;return e?getIconTotalWidth(this.groupedIcons[e],s):getIconTotalWidth(a,s)+getIconTotalWidth(o,s)},r.prototype.getCrossBackgroundColor=function(e){var n=this.getStyle().cell,a=n.crossBackgroundColor,o=n.backgroundColorOpacity;return a&&e%2===0?{backgroundColorOpacity:o,backgroundColor:a}:{backgroundColorOpacity:o,backgroundColor:this.getStyle().cell.backgroundColor}},r}(Group),CellData=function(){function t(r,e){this.raw=r,this.extraField=e}return t.getCellData=function(r,e){return new t(r,e)},t.getCellDataList=function(r,e){return e.map(function(n){return t.getCellData(r,n)})},t.getFieldValue=function(r,e){return e===void 0&&(e=""),r instanceof t?e?r.getValueByField(e):r[ORIGIN_FIELD]:r==null?void 0:r[e]},Object.defineProperty(t.prototype,ORIGIN_FIELD,{get:function(){return this.raw},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,EXTRA_FIELD,{get:function(){return this.extraField},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,VALUE_FIELD,{get:function(){return this.raw[this.extraField]},enumerable:!1,configurable:!0}),t.prototype.getValueByField=function(r){return r===VALUE_FIELD||r===EXTRA_FIELD?this[r]:this.raw[r]},t}(),includeCell=function(t,r){var e=r.getMeta().id;return t.some(function(n){return isEqual(n.id,e)})},getDataCellId=function(t,r){return"".concat(t).concat(EMPTY_PLACEHOLDER).concat(r)},shouldUpdateBySelectedCellsHighlight=function(t){var r=t.interaction.getSelectedCellHighlight(),e=r.currentRow,n=r.currentCol,a=r.rowHeader,o=r.colHeader;return e||n||a||o},isDataCell=function(t){return t.type===CellType.DATA_CELL},updateCurrentRowCellState=function(t,r){forEach(t,function(e){isDataCell(e)&&e.rowIndex===r.getMeta().rowIndex&&r.updateByState(InteractionStateName.SELECTED)})},updateCurrentColumnCellState=function(t,r){forEach(t,function(e){isDataCell(e)&&e.colIndex===r.getMeta().colIndex&&r.updateByState(InteractionStateName.SELECTED)})},updateCurrentCellState=function(t,r){forEach(t,function(e){isDataCell(e)&&e.rowIndex===r.getMeta().rowIndex&&e.colIndex===r.getMeta().colIndex&&r.updateByState(InteractionStateName.SELECTED)})},updateBySelectedCellsHighlight=function(t,r,e){var n,a=e.interaction.getSelectedCellHighlight(),o=a.rowHeader,s=a.colHeader,l=a.currentRow,u=a.currentCol,c=r.cellType===CellType.ROW_CELL,d=e.isTableMode()&&((n=e.options.seriesNumber)===null||n===void 0?void 0:n.enable)&&o&&c;(l||d)&&updateCurrentRowCellState(t,r),u&&updateCurrentColumnCellState(t,r),(o||s)&&updateCurrentCellState(t,r)},DataCell=function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return Object.defineProperty(r.prototype,"cellType",{get:function(){return CellType.DATA_CELL},enumerable:!1,configurable:!0}),r.prototype.isMultiData=function(){var e=this.getFieldValue();return isObject(e)},r.prototype.isChartData=function(){var e=this.getFieldValue();return isPlainObject(e==null?void 0:e.values)},r.prototype.getRenderChartData=function(){var e=this.meta.fieldValue;return e==null?void 0:e.values},r.prototype.getRenderChartOptions=function(){var e=this.getRenderChartData(),n=this.getBBoxByType(CellClipBox.CONTENT_BOX),a=this.spreadsheet.getThemeName();return __assign(__assign({autoFit:!0,theme:{type:G2_THEME_TYPE[a]}},n),e)},r.prototype.getBorderPositions=function(){return[CellBorderPosition.BOTTOM,CellBorderPosition.RIGHT]},Object.defineProperty(r.prototype,"valueRangeByField",{get:function(){return this.spreadsheet.dataSet.getValueRangeByField(this.meta.valueField)},enumerable:!1,configurable:!0}),r.prototype.handleByStateName=function(e,n){includeCell(e,this)&&this.updateByState(n)},r.prototype.handleSearchResult=function(e){if(includeCell(e,this)){var n=find(e,function(a){return a==null?void 0:a.isTarget});n.id===this.getMeta().id?this.updateByState(InteractionStateName.HIGHLIGHT):this.updateByState(InteractionStateName.SEARCH_RESULT)}},r.prototype.handleSelect=function(e){var n,a,o=(n=e==null?void 0:e[0])===null||n===void 0?void 0:n.type;switch(o){case CellType.COL_CELL:this.changeRowColSelectState("colIndex");break;case CellType.ROW_CELL:this.changeRowColSelectState("rowIndex");break;case CellType.DATA_CELL:shouldUpdateBySelectedCellsHighlight(this.spreadsheet)?updateBySelectedCellsHighlight(e,this,this.spreadsheet):includeCell(e,this)?this.updateByState(InteractionStateName.SELECTED):!((a=this.spreadsheet.options.interaction)===null||a===void 0)&&a.selectedCellsSpotlight&&this.updateByState(InteractionStateName.UNSELECTED);break}},r.prototype.isDisableHover=function(e){return e.type!==CellType.DATA_CELL},r.prototype.handleHover=function(e){var n=head(e);if(this.isDisableHover(n)){this.hideInteractionShape();return}var a=this.spreadsheet.interaction.getHoverHighlight(),o=a.currentRow,s=a.currentCol;if(o||s){var l=this.meta.colIndex,u=this.meta.rowIndex;s&&l===(n==null?void 0:n.colIndex)||o&&u===(n==null?void 0:n.rowIndex)?this.updateByState(InteractionStateName.HOVER):this.hideInteractionShape()}var c=this.getMeta(),d=c.id,f=c.rowIndex,h=c.colIndex;isEqual(n.id,d)&&isEqual(n.rowIndex,f)&&isEqual(n.colIndex,h)&&this.updateByState(InteractionStateName.HOVER_FOCUS)},r.prototype.update=function(){var e=this.spreadsheet.interaction.getCurrentStateName(),n=this.spreadsheet.interaction.getCells();if(e===InteractionStateName.ALL_SELECTED){this.updateByState(InteractionStateName.SELECTED);return}if(!(isEmpty(n)||!e))switch(e){case InteractionStateName.SELECTED:case InteractionStateName.DATA_CELL_BRUSH_SELECTED:this.handleSelect(n);break;case InteractionStateName.HOVER_FOCUS:case InteractionStateName.HOVER:this.handleHover(n);break;case InteractionStateName.SEARCH_RESULT:this.handleSearchResult(n);break;default:this.handleByStateName(n,e);break}},r.prototype.setMeta=function(e){t.prototype.setMeta.call(this,e),this.initCell()},r.prototype.drawTextShape=function(){t.prototype.drawTextShape.call(this),this.isShallowRender()||this.drawLinkField(this.meta)},r.prototype.initCell=function(){this.resetTextAndConditionIconShapes(),this.generateIconConfig(),this.drawBackgroundShape(),this.drawInteractiveBgShape(),this.shouldHideRowSubtotalData()||this.drawConditionIntervalShape(),this.shouldHideRowSubtotalData()||(this.drawTextShape(),this.drawConditionIconShapes()),this.drawBorders(),this.drawInteractiveBorderShape(),this.update()},r.prototype.generateIconConfig=function(){var e,n=this.findFieldCondition((e=this.conditions)===null||e===void 0?void 0:e.icon),a=n&&n.mapping&&{name:"",position:getIconPosition(n)};this.groupedIcons=groupIconsByPosition([],a)},r.prototype.getTextStyle=function(){var e=this.getCellTextWordWrapStyle(),n=this.meta.isTotals,a=this.theme.dataCell,o=n?a==null?void 0:a.bolderText:a==null?void 0:a.text;return this.getContainConditionMappingResultTextStyle(__assign(__assign({},e),o))},r.prototype.drawConditionIntervalShape=function(){this.conditionIntervalShape=drawInterval(this)},r.prototype.shouldHideRowSubtotalData=function(){var e,n,a=this.meta,o=a.rowId,s=a.rowIndex,l=this.spreadsheet.store.get("drillDownIdPathMap");if(l!=null&&l.has(o))return!1;var u=((e=this.spreadsheet.options.totals)!==null&&e!==void 0?e:{}).row,c=u===void 0?{}:u,d=(n=this.spreadsheet.facet)===null||n===void 0?void 0:n.getRowLeafNodeByIndex(s),f=!(d!=null&&d.isGrandTotals)&&(d==null?void 0:d.isTotals);return this.spreadsheet.isHierarchyTreeType()&&!c.showSubTotals&&f},r.prototype.getFormattedFieldValue=function(){var e;if(this.shouldHideRowSubtotalData())return{value:null,formattedValue:EMPTY_PLACEHOLDER};var n=this.meta,a=n.rowId,o=n.valueField,s=n.fieldValue,l=n.data,u=n.id,c=(e=this.spreadsheet.dataSet.displayFormattedValueMap)===null||e===void 0?void 0:e.get(u),d=this.spreadsheet.dataSet.getFieldMeta(a),f=d?a:o,h=this.spreadsheet.dataSet.getFieldFormatter(f),p=c??h(s,l,this.meta);return{value:s,formattedValue:p}},r.prototype.getMaxTextWidth=function(){var e=this.getBBoxByType(CellClipBox.CONTENT_BOX).width;return e-this.getActionAndConditionIconWidth()},r.prototype.getTextPosition=function(){var e=this.getBBoxByType(CellClipBox.CONTENT_BOX),n=this.getTextStyle(),a=this.getIconStyle(),o=getHorizontalTextIconPosition({bbox:e,iconStyle:a,textWidth:this.getActualTextWidth(),textAlign:n.textAlign,groupedIcons:this.groupedIcons}),s=o.textX,l=o.leftIconX,u=o.rightIconX,c=getVerticalTextPosition(e,n.textBaseline),d=getVerticalIconPosition(a.size,c,n.fontSize,n.textBaseline);return this.iconPosition={x:isEmpty(this.groupedIcons.left)?u:l,y:d},{x:s,y:c}},r.prototype.getIconPosition=function(){return this.iconPosition},r.prototype.getBackgroundColor=function(){var e=this.getCrossBackgroundColor(this.meta.rowIndex),n=e.backgroundColor,a=e.backgroundColorOpacity;return this.shouldHideRowSubtotalData()?{backgroundColor:n,backgroundColorOpacity:a,intelligentReverseTextColor:!1}:merge({backgroundColor:n,backgroundColorOpacity:a},this.getBackgroundConditionFill())},r.prototype.changeRowColSelectState=function(e){var n,a=this.spreadsheet.interaction,o=get(this.meta,e),s=a.getState(),l=s.nodes,u=l===void 0?[]:l,c=s.cells,d=c===void 0?[]:c,f=!1;if(this.spreadsheet.isTableMode()&&u.length){var h=u[0].hierarchy.getLeaves();f=h.some(function(p,v){return u.some(function(g){return g===p})?v===o:!1})}else f=__spreadArray(__spreadArray([],__read(u),!1),__read(d),!1).some(function(p){return get(p,e)===o});f?this.updateByState(InteractionStateName.SELECTED):!((n=this.spreadsheet.options.interaction)===null||n===void 0)&&n.selectedCellsSpotlight?this.updateByState(InteractionStateName.UNSELECTED):this.hideInteractionShape()},r.prototype.drawBorders=function(){},r.prototype.findFieldCondition=function(e){var n=this;return e===void 0&&(e=[]),findLast(e,function(a){return a.field instanceof RegExp?a.field.test(n.meta.valueField):a.field===n.meta.valueField})},r.prototype.mappingValue=function(e){var n=this.meta.fieldValue,a=this.spreadsheet.isTableMode()?this.spreadsheet.dataSet.getCellData({query:{rowIndex:this.meta.rowIndex}}):CellData.getFieldValue(this.meta.data);return e.mapping(n,a,this)},r.prototype.updateByState=function(e){if(t.prototype.updateByState.call(this,e,this),e===InteractionStateName.UNSELECTED){var n=get(this.theme,"".concat(this.cellType,".cell.interactionState.").concat(e));n&&this.toggleConditionIntervalShapeOpacity(n.opacity)}},r.prototype.clearUnselectedState=function(){t.prototype.clearUnselectedState.call(this),this.toggleConditionIntervalShapeOpacity(1)},r.prototype.toggleConditionIntervalShapeOpacity=function(e){updateShapeAttr(this.conditionIntervalShape,SHAPE_STYLE_MAP.backgroundOpacity,e),updateShapeAttr(this.conditionIconShapes,SHAPE_STYLE_MAP.opacity,e)},r}(BaseCell),MergedCell=function(t){__extends(r,t);function r(e,n,a){return t.call(this,a,e,n)||this}return Object.defineProperty(r.prototype,"cellType",{get:function(){return CellType.MERGED_CELL},enumerable:!1,configurable:!0}),r.prototype.handleRestOptions=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var a=__read(e,1),o=a[0];this.cells=o},r.prototype.update=function(){},r.prototype.initCell=function(){this.resetTextAndConditionIconShapes(),this.drawBackgroundShape(),this.drawTextShape(),this.drawBorders()},r.prototype.drawBackgroundShape=function(){var e=getPolygonPoints(this.cells),n=this.theme.dataCell.cell;this.backgroundShape=renderPolygon(this,{points:e,fill:n.backgroundColor})},r.prototype.drawTextShape=function(){if(!isEmpty(this.meta)){if(this.isMultiData())return drawCustomContent(this);t.prototype.drawTextShape.call(this)}},r.prototype.drawBorders=function(){var e=this,n=getRightAndBottomCells(this.cells),a=n.right,o=n.bottom,s=n.bottomRightCornerCell;a.forEach(function(l){var u,c=getBorderPositionAndStyle(CellBorderPosition.RIGHT,l.getBBoxByType(),(u=l.getStyle())===null||u===void 0?void 0:u.cell),d=c.position,f=c.style;renderLine(e,__assign(__assign({},d),f))}),o.forEach(function(l){var u,c=getBorderPositionAndStyle(CellBorderPosition.BOTTOM,l.getBBoxByType(),(u=l.getStyle())===null||u===void 0?void 0:u.cell),d=c.position,f=c.style;renderLine(e,__assign(__assign({},d),f))}),s.forEach(function(l){var u,c=l.getBBoxByType(),d=c.x,f=c.y,h=c.width,p=c.height,v=(u=l.getStyle())===null||u===void 0?void 0:u.cell,g=v.horizontalBorderWidth,y=g===void 0?0:g,m=v.verticalBorderWidth,S=m===void 0?0:m,w=v.verticalBorderColor,R=d+h-S/2,T=R,x=f+p-y,b=f+p;renderLine(e,{x1:R,x2:T,y1:x,y2:b,lineWidth:S,stroke:w,strokeOpacity:S})})},r}(DataCell),getRectangleEdges=function(t,r,e,n){var a=[t,r],o=[t+e,r],s=[t+e,r+n],l=[t,r+n];return[[a,o],[o,s],[s,l],[l,a]]},unique=function(t){var r=[];return forEach(t,function(e){var n=[e[1],e[0]];JSON.stringify(t).includes(JSON.stringify(n))||r.push(e)}),r},getNextEdge=function(t,r){return find(r,function(e){return isEqual(e[0],t[1])})},getPolygonPoints=function(t){var r=[];t.forEach(function(s){var l=s.getMeta(),u=l.x,c=l.y,d=l.width,f=l.height;r=r.concat(getRectangleEdges(u,c,d,f))}),r=unique(r);for(var e=[],n=r[0],a=n,o=[];!isEqual(n,o);)e=e.concat(a),o=getNextEdge(a,r),a=o;return e},getRightAndBottomCells=function(t){var r=[],e=[],n=[];return t.forEach(function(a){var o=__read(a.position,2),s=o[0],l=o[1];find(t,function(u){return u.position[0]===s+1&&u.position[1]===l})||e.push(a),find(t,function(u){return u.position[1]===l+1&&u.position[0]===s})||r.push(a)}),r.forEach(function(a){var o=__read(a.position,2),s=o[0],l=o[1],u=find(t,function(c){return c.position[0]===s-1&&c.position[1]===l});u&&!includes(r,u)&&n.push(u)}),{bottom:e,right:r,bottomRightCornerCell:n}},getInvisibleInfo=function(t,r){var e=[],n;return forEach(t,function(a){var o,s,l,u=(o=r==null?void 0:r.facet)===null||o===void 0?void 0:o.getCellMeta(a.rowIndex,a.colIndex);if(u){var c=(l=(s=r==null?void 0:r.options)===null||s===void 0?void 0:s.dataCell)===null||l===void 0?void 0:l.call(s,u);n=a!=null&&a.showText?u:n,e.push(c)}}),{cells:e,cellsMeta:n}},getVisibleInfo=function(t,r){var e=[],n=[],a;return forEach(t,function(o){var s=find(r,function(l){var u,c=(u=l==null?void 0:l.getMeta)===null||u===void 0?void 0:u.call(l);if((c==null?void 0:c.colIndex)===(o==null?void 0:o.colIndex)&&(c==null?void 0:c.rowIndex)===(o==null?void 0:o.rowIndex))return l});s?(e.push(s),a=o!=null&&o.showText?s==null?void 0:s.getMeta():a):n.push(o)}),{cells:e,invisibleCellInfo:n,cellsMeta:a}},getTempMergedCell=function(t,r,e){var n;e===void 0&&(e=[]);var a=getVisibleInfo(e,t),o=a.cellsMeta,s=a.cells,l=a.invisibleCellInfo,u=o,c=s,d=(l==null?void 0:l.length)>0&&l.length<e.length;if(d){var f=getInvisibleInfo(l,r),h=f.cells,p=f.cellsMeta;u=u||p,c=s.concat(h)}return!isEmpty(s)&&!u&&(u=(n=c[0])===null||n===void 0?void 0:n.getMeta()),{cells:c,viewMeta:u}},getActiveCellsInfo=function(t){var r=t.interaction,e=r.getActiveCells(),n=[];return forEach(e,function(a,o){var s=a.getMeta(),l=o===0?{showText:!0}:{};n.push(__assign(__assign({},l),{colIndex:s==null?void 0:s.colIndex,rowIndex:s==null?void 0:s.rowIndex}))}),n},getMergedCellInstance=function(t,r,e){return t.options.mergedCell?t.options.mergedCell(t,r,e):new MergedCell(t,r,e)},mergeCell=function(t,r,e){var n,a=r||getActiveCellsInfo(t);if((a==null?void 0:a.length)<=1){console.error("then merged cells must be more than one");return}var o=t.facet.getDataCells(),s=getTempMergedCell(o,t,a),l=s.cells,u=s.viewMeta;if(!isEmpty(l)){var c=((n=t.options)===null||n===void 0?void 0:n.mergedCellsInfo)||[];c.push(a),t.setOptions({mergedCellsInfo:c});var d=e?void 0:u;t.facet.panelScrollGroup.addMergeCell(getMergedCellInstance(t,l,d))}},removeUnmergedCellsInfo=function(t,r){var e=map(t.cells,function(n){return{colIndex:n.getMeta().colIndex,rowIndex:n.getMeta().rowIndex}});return filter(r,function(n){var a=n.map(function(o){return o.showText?{colIndex:o.colIndex,rowIndex:o.rowIndex}:o});return!isEqual(a,e)})},unmergeCell=function(t,r){var e,n,a;if(!r||r.cellType!==CellType.MERGED_CELL){console.error("unmergeCell: the ".concat(r," is not a MergedCell"));return}var o=removeUnmergedCellsInfo(r,((e=t.options)===null||e===void 0?void 0:e.mergedCellsInfo)||[]);(o==null?void 0:o.length)!==((a=(n=t.options)===null||n===void 0?void 0:n.mergedCellsInfo)===null||a===void 0?void 0:a.length)&&(t.setOptions({mergedCellsInfo:o}),r.remove())},MergedCellConvertTempMergedCells=function(t){return map(t,function(r){return{cells:r.cells,viewMeta:r.getMeta()}})},differenceTempMergedCells=function(t,r){return differenceWith(t,r,function(e,n){return isEqual(e.viewMeta.id,n.viewMeta.id)})},updateMergedCells=function(t,r){var e,n=(e=t.options)===null||e===void 0?void 0:e.mergedCellsInfo;if(!isEmpty(n)){var a=t.facet.getDataCells();if(!isEmpty(a)){var o=[];n.forEach(function(d){var f=getTempMergedCell(a,t,d);f.cells.length>0&&o.push(f)});var s=r.children,l=MergedCellConvertTempMergedCells(s),u=differenceTempMergedCells(l,o),c=differenceTempMergedCells(o,l);forEach(u,function(d){var f=find(s,function(h){return isEqual(h.getMeta().id,d.viewMeta.id)});f==null||f.remove()}),forEach(c,function(d){var f=d.cells,h=d.viewMeta;r.appendChild(getMergedCellInstance(t,f,h))})}}},NormalizedAlign;(function(t){t[t.Start=0]="Start",t[t.Center=1]="Center",t[t.End=2]="End"})(NormalizedAlign||(NormalizedAlign={}));var normalizeTextAlign=function(t){return["left","top"].includes(t)?NormalizedAlign.Start:["center","middle"].includes(t)?NormalizedAlign.Center:NormalizedAlign.End},adjustTextIconPositionWhileScrolling=function(t,r,e){var n=e.align,a=e.size,o=e.padding,s=a.textSize,l=a.iconStartSize,u=l===void 0?0:l,c=a.iconEndSize,d=c===void 0?0:c,f=o.betweenTextAndEndIcon,h=f===void 0?0:f;h=d?h:0;var p=s+u+d,v={start:r.start-o.start,size:r.size+o.start+o.end},g=v.start+v.size,y=r.start+r.size,m=t.start+t.size;function S(L){switch(n){case NormalizedAlign.Start:return{iconStart:L.start,textStart:L.start+u,iconEnd:L.start+u+s+h};case NormalizedAlign.Center:var M=L.start+L.size/2-p/2;return{iconStart:M,textStart:M+u+s/2,iconEnd:M+u+s+h};default:var D=L.start+L.size;return{iconStart:D-d-s-u,textStart:D-d,iconEnd:D-d+h}}}if(v.start>=t.start&&g<=m)return S(r);if(v.start<t.start&&g<=m){var w={start:t.start+(n!==NormalizedAlign.End?o.start:0),size:r.size-(t.start-r.start)-(n!==NormalizedAlign.End?o.start:0)};return w.size<p&&(w.size=p,w.start=y-p),S(w)}if(v.start>=t.start&&g>m){var R={start:r.start,size:r.size-(y-m)-(n!==NormalizedAlign.Start?o.end:0)};return R.size<p&&(R.size=p,R.start=r.start),S(R)}var T={start:t.start+o.start,size:t.size-o.start-o.end};if(T.size<p){var x=r.start+r.size/2-p/2,b=x+p;x>T.start||(b>T.start+T.size?T.start=x:T.start-=p-T.size),T.size=p}return S(T)},isFrozenCol=function(t,r){return r>0&&t<r},isFrozenTrailingCol=function(t,r,e){return r>0&&t>=e-r},isFrozenRow=function(t,r,e){return e>0&&t<r+e},isFrozenTrailingRow=function(t,r,e){return e>0&&t>=r+1-e},calculateInViewIndexes=function(t){var r=t.scrollX,e=t.scrollY,n=t.widths,a=t.heights,o=t.viewport,s=t.rowRemainWidth,l=findIndex(n,function(h,p){var v=r-(isNil(s)?0:s)+o.x;return v>=h&&v<n[p+1]},0);l=Math.max(l,0);var u=findIndex(n,function(h,p){var v=o.width+r+o.x;return v>=h&&v<n[p+1]},l);u=Math.min(u===-1?1/0:u,n.length-2);var c=a.getIndexRange(e+o.y,o.height+e+o.y),d=c.start,f=c.end;return[l,u,d,f]},optimizeScrollXY=function(t,r,e){var n=2,a=Math.abs(t/r),o=a<=1/n?0:t,s=a>n?0:r;return[o*e.horizontal,s*e.vertical]},translateGroup=function(t,r,e){if(t){var n=__read(t.getPosition(),2),a=n[0],o=n[1];t.translate(r-a,e-o)}},translateGroupX=function(t,r){if(t){var e=__read(t.getPosition(),1),n=e[0];t.translate(r-n,0)}},getFrozenDataCellType=function(t,r,e,n){var a=r.colCount,o=a===void 0?0:a,s=r.rowCount,l=s===void 0?0:s,u=r.trailingColCount,c=u===void 0?0:u,d=r.trailingRowCount,f=d===void 0?0:d,h=t.colIndex,p=t.rowIndex;return isFrozenRow(p,n.start,l)?FrozenCellType.ROW:isFrozenTrailingRow(p,n.end,f)?FrozenCellType.TRAILING_ROW:isFrozenCol(h,o)?FrozenCellType.COL:isFrozenTrailingCol(h,c,e)?FrozenCellType.TRAILING_COL:FrozenCellType.SCROLL},calculateFrozenCornerCells=function(t,r,e){for(var n,a=t.colCount,o=a===void 0?0:a,s=t.rowCount,l=s===void 0?0:s,u=t.trailingColCount,c=u===void 0?0:u,d=t.trailingRowCount,f=d===void 0?0:d,h=(n={},n[FrozenCellType.TOP]=[],n[FrozenCellType.BOTTOM]=[],n),p=0;p<o;p++){for(var v=e.start;v<e.start+l;v++)h[FrozenCellType.TOP].push({x:p,y:v});if(f>0)for(var v=0;v<f;v++){var g=e.end-v;h[FrozenCellType.BOTTOM].push({x:p,y:g})}}for(var p=0;p<c;p++){for(var y=r-1-p,v=e.start;v<e.start+l;v++)h[FrozenCellType.TOP].push({x:y,y:v});if(f>0)for(var v=0;v<f;v++){var g=e.end-v;h[FrozenCellType.BOTTOM].push({x:y,y:g})}}return h},splitInViewIndexesWithFrozen=function(t,r,e,n){var a=r.colCount,o=a===void 0?0:a,s=r.rowCount,l=s===void 0?0:s,u=r.trailingColCount,c=u===void 0?0:u,d=r.trailingRowCount,f=d===void 0?0:d,h=__spreadArray([],__read(t),!1);isFrozenCol(h[0],o)&&(h[0]=o),isFrozenTrailingCol(h[1],c,e)&&(h[1]=e-c-1),isFrozenRow(h[2],n.start,l)&&(h[2]=n.start+l),isFrozenTrailingRow(h[3],n.end,f)&&(h[3]=n.end-f);var p=__spreadArray([],__read(h),!1);p[2]=n.start,p[3]=n.start+l-1;var v=__spreadArray([],__read(h),!1);v[0]=0,v[1]=o-1;var g=__spreadArray([],__read(h),!1);g[2]=n.end+1-f,g[3]=n.end;var y=__spreadArray([],__read(h),!1);return y[0]=e-c,y[1]=e-1,{center:h,frozenRow:p,frozenCol:v,frozenTrailingCol:y,frozenTrailingRow:g}},getCellRange=function(t,r){var e=t,n=0,a=e.getTotalLength()-1;if(r){var o=r.current,s=o===void 0?DEFAULT_PAGE_INDEX:o,l=r.pageSize;n=Math.max((s-1)*l,0),a=Math.min(s*l-1,e.getTotalLength()-1)}return{start:n,end:a}},getFrozenLeafNodesCount=function(t,r,e){var n=function(a){return a.isLeaf?1:a.children?a.children.reduce(function(o,s){return o+=n(s),o},0):0};return r&&(r=t.slice(0,r).reduce(function(a,o){return a+=n(o),a},0)),e&&(e=t.slice(t.length-e).reduce(function(a,o){return a+=n(o),a},0)),{colCount:r,trailingColCount:e}},getLeafColumns=function(t){var r=[],e=function(n){n.forEach(function(a){typeof a=="string"||!a.children?r.push(a):e(a.children)})};return e(t),r},getLeafColumnsWithKey=function(t){t===void 0&&(t=[]);var r=getLeafColumns(t);return r.map(function(e){return typeof e=="string"?e:e.field})},getLeftLeafNode=function(t){var r=t.children[0];return r?r.isLeaf?r:getLeftLeafNode(r):t},areAllFieldsEmpty=function(t){return isEmpty(t.rows)&&isEmpty(t.columns)&&isEmpty(t.values)},getFrozenRowCfgPivot=function(t,r){var e,n=t.pagination,a=t.frozen,o=t.hierarchyType,s=t.seriesNumber,l=n&&n.pageSize,u=!1,c=r==null?void 0:r[0];if(!l&&!(s!=null&&s.enable)&&(a!=null&&a.firstRow)){var d=o==="tree";u=d||((e=c==null?void 0:c.children)===null||e===void 0?void 0:e.length)===0}var f=u&&!!c;return{rowCount:f?1:0,colCount:0,trailingColCount:0,trailingRowCount:0,firstRow:u,rowHeight:f?c.height:0}},BaseHeader=function(t){__extends(r,t);function r(e){var n=t.call(this)||this;return n.isHeaderCellInViewport=function(a){var o=a.cellPosition,s=a.cellSize,l=a.viewportPosition,u=a.viewportSize;return o+s>=l&&l+u>=o},n.headerConfig=e,n}return r.prototype.getHeaderConfig=function(){return this.headerConfig||{}},r.prototype.clearResizeAreaGroup=function(e){var n=this.parentNode,a=n==null?void 0:n.getElementById(e);a==null||a.removeChildren()},r.prototype.render=function(e){this.clearResizeAreaGroup(e),this.clear(),this.layout(),this.offset(),this.clip()},r.prototype.onScrollXY=function(e,n,a){this.headerConfig.scrollX=e,this.headerConfig.scrollY=n,this.render(a)},r.prototype.onRowScrollX=function(e,n){this.headerConfig.scrollX=e,this.render(n)},r.prototype.clear=function(){t.prototype.removeChildren.call(this)},r}(Group),ColHeader=function(t){__extends(r,t);function r(e){var n=t.call(this,e)||this;return n.initScrollGroup(),n}return r.prototype.getCellInstance=function(e){var n=this.getHeaderConfig(),a=this.getHeaderConfig().spreadsheet,o=a.options.colCell;return(o==null?void 0:o(e,a,n))||new ColCell(e,a,n)},r.prototype.initScrollGroup=function(){this.scrollGroup=this.appendChild(new Group({name:KEY_GROUP_COL_SCROLL,style:{zIndex:FRONT_GROUND_GROUP_SCROLL_Z_INDEX}}))},r.prototype.onColScroll=function(e,n){this.headerConfig.scrollX!==e&&(this.headerConfig.scrollX=e,this.render(n))},r.prototype.clip=function(){var e=this.getHeaderConfig(),n=e.height,a=e.width,o=e.spreadsheet,s=e.position,l=o.isFrozenRowHeader();this.scrollGroup.style.clipPath=new Rect({style:{x:l?s.x:0,y:l?s.y:0,width:l?a:s.x+a,height:n}})},r.prototype.clear=function(){var e;(e=this.scrollGroup)===null||e===void 0||e.removeChildren()},r.prototype.getCellGroup=function(e){return this.scrollGroup},r.prototype.isColCellInRect=function(e){var n=this.getHeaderConfig(),a=n.spreadsheet,o=n.cornerWidth,s=n.width,l=n.scrollX,u=l===void 0?0:l;return s+u>e.x&&u-(a.isFrozenRowHeader()?0:o)<e.x+e.width},r.prototype.layout=function(){var e=this,n=this.getHeaderConfig(),a=n.nodes,o=n.spreadsheet;forEach(a,function(s){if(e.isColCellInRect(s)){var l=e.getCellGroup(s);s.isFrozen=l!==e.scrollGroup;var u=e.getCellInstance(s);s.belongsCell=u,l==null||l.appendChild(u),o.emit(S2Event.COL_CELL_RENDER,u),o.emit(S2Event.LAYOUT_CELL_RENDER,u)}})},r.prototype.offset=function(){var e=this.getHeaderConfig(),n=e.position,a=e.scrollX,o=a===void 0?0:a;translateGroupX(this.scrollGroup,n.x-o)},r}(BaseHeader),getResizeAreaAttrs=function(t){var r=t.type,e=t.theme,n=t.width,a=t.height,o=__rest(t,["type","theme","width","height"]),s=r===ResizeDirectionType.Horizontal?e.size:void 0,l=r===ResizeDirectionType.Vertical?e.size:void 0;return{style:{fill:e.background,fillOpacity:e.backgroundOpacity,cursor:"".concat(r,"-resize"),width:s,height:l},appendInfo:__assign(__assign({},o),{isResizeArea:!0,type:r,width:n,height:a,size:e.size})}},getOrCreateResizeAreaGroupById=function(t,r){var e;if(!((e=t.facet)===null||e===void 0)&&e.foregroundGroup){var n=t.facet.foregroundGroup.getElementById(r);return n||t.facet.foregroundGroup.appendChild(new Group({id:r,style:{zIndex:FRONT_GROUND_GROUP_RESIZE_AREA_Z_INDEX}}))}},shouldAddResizeArea=function(t,r,e){var n=e??{},a=n.scrollX,o=a===void 0?0:a,s=n.scrollY,l=s===void 0?0:s,u=!(t.x-o>r.x+r.width||t.x+t.width-o<r.x),c=!(t.y-l>r.y+r.height||t.y+t.height-l<r.y);return u&&c};function filterExtraDimension(t){return t===void 0&&(t=[]),t.filter(function(r){return r!==EXTRA_FIELD})}function isMultiValue(t){return t===MULTI_VALUE}function transformDimensionsValues(t,r,e){return t===void 0&&(t={}),r===void 0&&(r=[]),e===void 0&&(e=TOTAL_VALUE),r.reduce(function(n,a){var o=t[a];return a in t?n.push(String(o)):n.push(e),n},[])}function getExistValues(t,r){var e=r.filter(function(n){return n in t});return isEmpty(e)&&e.push(EMPTY_EXTRA_FIELD_PLACEHOLDER),e}function transformDimensionsValuesWithExtraFields(t,r,e){t===void 0&&(t={}),r===void 0&&(r=[]);var n=[];function a(o,s,l){return s.reduce(function(u,c){var d=o[c];return c in o?u.push(String(d)):c===EXTRA_FIELD&&l?u.push(l):u.push(TOTAL_VALUE),u},[])}return e?e.forEach(function(o){n.push(a(t,r,o))}):n.push(a(t,r)),n}function getDimensionsWithParentPath(t,r,e){var n;r===void 0&&(r=[]);var a=r.slice(0,r.indexOf(t)+1);return(n=e.map(function(o){return a.map(function(s){return o.getValueByField(s)}).join("".concat(NODE_ID_SEPARATOR))}))===null||n===void 0?void 0:n.filter(Boolean)}function getDataPathPrefix(t,r){return t.concat(r).filter(function(e){return e!==EXTRA_FIELD}).join(NODE_ID_SEPARATOR)}function getDataPath(t){var r=t.rowDimensionValues,e=t.colDimensionValues,n=t.isFirstCreate,a=t.onFirstCreate,o=t.rowFields,s=t.colFields,l=t.rowPivotMeta,u=t.colPivotMeta,c=t.prefix,d=c===void 0?"":c,f=function(v,g,y,m){for(var S=y,w=[],R=0;R<g.length;R++){var T=g[R];if(n&&S&&!(S!=null&&S.has(T))){var x=g.slice(0,R+1).map(function(F){return String(F)}),b=x.join(NODE_ID_SEPARATOR),L=T===TOTAL_VALUE,M=void 0;L?M=0:S.has(TOTAL_VALUE)?M=S.size:M=S.size+1,S.set(T,{id:b,dimensions:x,value:T,level:M,children:new Map}),a==null||a({dimension:v==null?void 0:v[R],dimensionPath:b,careRepeated:m})}var D=S==null?void 0:S.get(T);if(w.push(isMultiValue(T)?T:D==null?void 0:D.level),D){var N=v==null?void 0:v[R+1];n&&D.childField!==N&&(D.childField=N),S=D==null?void 0:D.children}}return w},h=f(o,r,l,!1),p=f(s,e,u,!0);return __spreadArray(__spreadArray([d],__read(h),!1),__read(p),!1)}function transformIndexesData(t){var r=t.rows,e=t.columns,n=t.values,a=t.valueInCols,o=t.data,s=o===void 0?[]:o,l=t.indexesData,u=l===void 0?{}:l,c=t.sortedDimensionValues,d=t.rowPivotMeta,f=t.colPivotMeta,h=t.getExistValuesByDataItem,p=[],v=new Set(intersection(r,e)),g=function(m){var S=m.dimension,w=m.dimensionPath,R=m.careRepeated,T=R===void 0?!0:R;T&&v.has(S)||(c[S]||(c[S]=[])).push(w)},y=getDataPathPrefix(r,e);return s.forEach(function(m){var S,w,R,T;if(!(!m||isEmpty(m))){var x=h?h(m,n):getExistValues(m,n),b=transformDimensionsValuesWithExtraFields(m,r,a?null:x),L=transformDimensionsValuesWithExtraFields(m,e,a?x:null);try{for(var M=__values(b),D=M.next();!D.done;D=M.next()){var N=D.value;try{for(var F=(R=void 0,__values(L)),k=F.next();!k.done;k=F.next()){var H=k.value,G=getDataPath({rowDimensionValues:N,colDimensionValues:H,rowPivotMeta:d,colPivotMeta:f,rowFields:r,colFields:e,isFirstCreate:!0,onFirstCreate:g,prefix:y});p.push(G),set(u,G,m)}}catch(z){R={error:z}}finally{try{k&&!k.done&&(T=F.return)&&T.call(F)}finally{if(R)throw R.error}}}}catch(z){S={error:z}}finally{try{D&&!D.done&&(w=M.return)&&w.call(M)}finally{if(S)throw S.error}}}}),{paths:p,indexesData:u,rowPivotMeta:d,colPivotMeta:f,sortedDimensionValues:c}}function deleteMetaById(t,r){if(!(!t||!r)){var e=r.split(NODE_ID_SEPARATOR),n=last(e),a=t;forEach(e,function(o,s){var l=a.get(o);return l?(o===n?(l.children=new Map,l.childField=void 0):a=l.children,!0):s===0&&o===ROOT_NODE_ID})}}function generateExtraFieldMeta(t,r,e){var n=function(s){var l=find(t,function(u){var c=u.field;return c===s});return get(l,"name",s)},a=r||e,o={field:EXTRA_FIELD,name:a,formatter:function(s){return n(s)}};return o}function getHeaderTotalStatus(t,r){return{isRowGrandTotal:t.isGrandTotals,isRowSubTotal:t.isSubTotals,isColGrandTotal:r.isGrandTotals,isColSubTotal:r.isSubTotals}}function existDimensionTotalGroup(t){for(var r=null,e=0;e<t.length;e++){var n=t[e];if(isMultiValue(n))r=e;else if(!isNull(r)&&r<e)return!0}return!1}function getSatisfiedPivotMetaValues(t){var r=t.pivotMeta,e=t.dimensionValues,n=t.fieldIdx,a=t.queryType,o=t.fields,s=t.sortedDimensionValues,l={children:r},u=[l];function c(h,p){var v,g=flatMap(h,function(S){var w,R,T=[];try{for(var x=__values(S.children.values()),b=x.next();!b.done;b=x.next()){var L=b.value;L.value!==EMPTY_EXTRA_FIELD_PLACEHOLDER&&(a===QueryDataType.All||L.value!==TOTAL_VALUE)&&T.push(L)}}catch(M){w={error:M}}finally{try{b&&!b.done&&(R=x.return)&&R.call(x)}finally{if(w)throw w.error}}return T});if(h.length>1){var y=(v=s[p])!==null&&v!==void 0?v:[],m=new Map(y.map(function(S,w){return[S,w]}));return g.sort(function(S,w){var R,T;return((R=m.get(S.id))!==null&&R!==void 0?R:0)-((T=m.get(w.id))!==null&&T!==void 0?T:0)}),g}return g}for(var d=function(h){var p=e[h],v=o[h];isMultiValue(p)?u=c(u,v):u=u.map(function(g){return g.children.get(p)}).filter(Boolean)},f=0;f<=n;f++)d(f);return u}function flattenDimensionValues(t){var r=t.dimensionValues,e=t.pivotMeta,n=t.fields,a=t.sortedDimensionValues,o=t.queryType,s=o===void 0?QueryDataType.All:o;if(!existDimensionTotalGroup(r))return[r];var l=getSatisfiedPivotMetaValues({pivotMeta:e,dimensionValues:r,fieldIdx:r.length-1,queryType:s,fields:n,sortedDimensionValues:a});return l.map(function(u){return u.dimensions})}function getFlattenDimensionValues(t){var r=t.rowFields,e=t.rowDimensionValues,n=t.rowPivotMeta,a=t.colFields,o=t.colDimensionValues,s=t.colPivotMeta,l=t.queryType,u=t.sortedDimensionValues,c=flattenDimensionValues({dimensionValues:e,pivotMeta:n,fields:r,sortedDimensionValues:u,queryType:l}),d=flattenDimensionValues({dimensionValues:o,pivotMeta:s,fields:a,sortedDimensionValues:u,queryType:l});return{rowQueries:c,colQueries:d}}function flattenIndexesData(t,r){return t?isArray(t)?flatMap(t,function(e){if(!isArray(e))return compact([e]);var n=r===QueryDataType.DetailOnly?1:0;return compact(e.slice(n))}):compact([t]):[]}/*!
 *  decimal.js v10.4.3
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2022 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */var EXP_LIMIT=9e15,MAX_DIGITS=1e9,NUMERALS="0123456789abcdef",LN10="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",PI="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",DEFAULTS={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-EXP_LIMIT,maxE:EXP_LIMIT,crypto:!1},inexact,quadrant,external=!0,decimalError="[DecimalError] ",invalidArgument=decimalError+"Invalid argument: ",precisionLimitExceeded=decimalError+"Precision limit exceeded",cryptoUnavailable=decimalError+"crypto unavailable",tag="[object Decimal]",mathfloor=Math.floor,mathpow=Math.pow,isBinary=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,isHex=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,isOctal=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,isDecimal=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,BASE=1e7,LOG_BASE=7,MAX_SAFE_INTEGER=9007199254740991,LN10_PRECISION=LN10.length-1,PI_PRECISION=PI.length-1,P={toStringTag:tag};P.absoluteValue=P.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),finalise(t)};P.ceil=function(){return finalise(new this.constructor(this),this.e+1,2)};P.clampedTo=P.clamp=function(t,r){var e,n=this,a=n.constructor;if(t=new a(t),r=new a(r),!t.s||!r.s)return new a(NaN);if(t.gt(r))throw Error(invalidArgument+r);return e=n.cmp(t),e<0?t:n.cmp(r)>0?r:new a(n)};P.comparedTo=P.cmp=function(t){var r,e,n,a,o=this,s=o.d,l=(t=new o.constructor(t)).d,u=o.s,c=t.s;if(!s||!l)return!u||!c?NaN:u!==c?u:s===l?0:!s^u<0?1:-1;if(!s[0]||!l[0])return s[0]?u:l[0]?-c:0;if(u!==c)return u;if(o.e!==t.e)return o.e>t.e^u<0?1:-1;for(n=s.length,a=l.length,r=0,e=n<a?n:a;r<e;++r)if(s[r]!==l[r])return s[r]>l[r]^u<0?1:-1;return n===a?0:n>a^u<0?1:-1};P.cosine=P.cos=function(){var t,r,e=this,n=e.constructor;return e.d?e.d[0]?(t=n.precision,r=n.rounding,n.precision=t+Math.max(e.e,e.sd())+LOG_BASE,n.rounding=1,e=cosine(n,toLessThanHalfPi(n,e)),n.precision=t,n.rounding=r,finalise(quadrant==2||quadrant==3?e.neg():e,t,r,!0)):new n(1):new n(NaN)};P.cubeRoot=P.cbrt=function(){var t,r,e,n,a,o,s,l,u,c,d=this,f=d.constructor;if(!d.isFinite()||d.isZero())return new f(d);for(external=!1,o=d.s*mathpow(d.s*d,1/3),!o||Math.abs(o)==1/0?(e=digitsToString(d.d),t=d.e,(o=(t-e.length+1)%3)&&(e+=o==1||o==-2?"0":"00"),o=mathpow(e,1/3),t=mathfloor((t+1)/3)-(t%3==(t<0?-1:2)),o==1/0?e="5e"+t:(e=o.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new f(e),n.s=d.s):n=new f(o.toString()),s=(t=f.precision)+3;;)if(l=n,u=l.times(l).times(l),c=u.plus(d),n=divide(c.plus(d).times(l),c.plus(u),s+2,1),digitsToString(l.d).slice(0,s)===(e=digitsToString(n.d)).slice(0,s))if(e=e.slice(s-3,s+1),e=="9999"||!a&&e=="4999"){if(!a&&(finalise(l,t+1,0),l.times(l).times(l).eq(d))){n=l;break}s+=4,a=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(finalise(n,t+1,1),r=!n.times(n).times(n).eq(d));break}return external=!0,finalise(n,t,f.rounding,r)};P.decimalPlaces=P.dp=function(){var t,r=this.d,e=NaN;if(r){if(t=r.length-1,e=(t-mathfloor(this.e/LOG_BASE))*LOG_BASE,t=r[t],t)for(;t%10==0;t/=10)e--;e<0&&(e=0)}return e};P.dividedBy=P.div=function(t){return divide(this,new this.constructor(t))};P.dividedToIntegerBy=P.divToInt=function(t){var r=this,e=r.constructor;return finalise(divide(r,new e(t),0,1,1),e.precision,e.rounding)};P.equals=P.eq=function(t){return this.cmp(t)===0};P.floor=function(){return finalise(new this.constructor(this),this.e+1,3)};P.greaterThan=P.gt=function(t){return this.cmp(t)>0};P.greaterThanOrEqualTo=P.gte=function(t){var r=this.cmp(t);return r==1||r===0};P.hyperbolicCosine=P.cosh=function(){var t,r,e,n,a,o=this,s=o.constructor,l=new s(1);if(!o.isFinite())return new s(o.s?1/0:NaN);if(o.isZero())return l;e=s.precision,n=s.rounding,s.precision=e+Math.max(o.e,o.sd())+4,s.rounding=1,a=o.d.length,a<32?(t=Math.ceil(a/3),r=(1/tinyPow(4,t)).toString()):(t=16,r="2.3283064365386962890625e-10"),o=taylorSeries(s,1,o.times(r),new s(1),!0);for(var u,c=t,d=new s(8);c--;)u=o.times(o),o=l.minus(u.times(d.minus(u.times(d))));return finalise(o,s.precision=e,s.rounding=n,!0)};P.hyperbolicSine=P.sinh=function(){var t,r,e,n,a=this,o=a.constructor;if(!a.isFinite()||a.isZero())return new o(a);if(r=o.precision,e=o.rounding,o.precision=r+Math.max(a.e,a.sd())+4,o.rounding=1,n=a.d.length,n<3)a=taylorSeries(o,2,a,a,!0);else{t=1.4*Math.sqrt(n),t=t>16?16:t|0,a=a.times(1/tinyPow(5,t)),a=taylorSeries(o,2,a,a,!0);for(var s,l=new o(5),u=new o(16),c=new o(20);t--;)s=a.times(a),a=a.times(l.plus(s.times(u.times(s).plus(c))))}return o.precision=r,o.rounding=e,finalise(a,r,e,!0)};P.hyperbolicTangent=P.tanh=function(){var t,r,e=this,n=e.constructor;return e.isFinite()?e.isZero()?new n(e):(t=n.precision,r=n.rounding,n.precision=t+7,n.rounding=1,divide(e.sinh(),e.cosh(),n.precision=t,n.rounding=r)):new n(e.s)};P.inverseCosine=P.acos=function(){var t,r=this,e=r.constructor,n=r.abs().cmp(1),a=e.precision,o=e.rounding;return n!==-1?n===0?r.isNeg()?getPi(e,a,o):new e(0):new e(NaN):r.isZero()?getPi(e,a+4,o).times(.5):(e.precision=a+6,e.rounding=1,r=r.asin(),t=getPi(e,a+4,o).times(.5),e.precision=a,e.rounding=o,t.minus(r))};P.inverseHyperbolicCosine=P.acosh=function(){var t,r,e=this,n=e.constructor;return e.lte(1)?new n(e.eq(1)?0:NaN):e.isFinite()?(t=n.precision,r=n.rounding,n.precision=t+Math.max(Math.abs(e.e),e.sd())+4,n.rounding=1,external=!1,e=e.times(e).minus(1).sqrt().plus(e),external=!0,n.precision=t,n.rounding=r,e.ln()):new n(e)};P.inverseHyperbolicSine=P.asinh=function(){var t,r,e=this,n=e.constructor;return!e.isFinite()||e.isZero()?new n(e):(t=n.precision,r=n.rounding,n.precision=t+2*Math.max(Math.abs(e.e),e.sd())+6,n.rounding=1,external=!1,e=e.times(e).plus(1).sqrt().plus(e),external=!0,n.precision=t,n.rounding=r,e.ln())};P.inverseHyperbolicTangent=P.atanh=function(){var t,r,e,n,a=this,o=a.constructor;return a.isFinite()?a.e>=0?new o(a.abs().eq(1)?a.s/0:a.isZero()?a:NaN):(t=o.precision,r=o.rounding,n=a.sd(),Math.max(n,t)<2*-a.e-1?finalise(new o(a),t,r,!0):(o.precision=e=n-a.e,a=divide(a.plus(1),new o(1).minus(a),e+t,1),o.precision=t+4,o.rounding=1,a=a.ln(),o.precision=t,o.rounding=r,a.times(.5))):new o(NaN)};P.inverseSine=P.asin=function(){var t,r,e,n,a=this,o=a.constructor;return a.isZero()?new o(a):(r=a.abs().cmp(1),e=o.precision,n=o.rounding,r!==-1?r===0?(t=getPi(o,e+4,n).times(.5),t.s=a.s,t):new o(NaN):(o.precision=e+6,o.rounding=1,a=a.div(new o(1).minus(a.times(a)).sqrt().plus(1)).atan(),o.precision=e,o.rounding=n,a.times(2)))};P.inverseTangent=P.atan=function(){var t,r,e,n,a,o,s,l,u,c=this,d=c.constructor,f=d.precision,h=d.rounding;if(c.isFinite()){if(c.isZero())return new d(c);if(c.abs().eq(1)&&f+4<=PI_PRECISION)return s=getPi(d,f+4,h).times(.25),s.s=c.s,s}else{if(!c.s)return new d(NaN);if(f+4<=PI_PRECISION)return s=getPi(d,f+4,h).times(.5),s.s=c.s,s}for(d.precision=l=f+10,d.rounding=1,e=Math.min(28,l/LOG_BASE+2|0),t=e;t;--t)c=c.div(c.times(c).plus(1).sqrt().plus(1));for(external=!1,r=Math.ceil(l/LOG_BASE),n=1,u=c.times(c),s=new d(c),a=c;t!==-1;)if(a=a.times(u),o=s.minus(a.div(n+=2)),a=a.times(u),s=o.plus(a.div(n+=2)),s.d[r]!==void 0)for(t=r;s.d[t]===o.d[t]&&t--;);return e&&(s=s.times(2<<e-1)),external=!0,finalise(s,d.precision=f,d.rounding=h,!0)};P.isFinite=function(){return!!this.d};P.isInteger=P.isInt=function(){return!!this.d&&mathfloor(this.e/LOG_BASE)>this.d.length-2};P.isNaN=function(){return!this.s};P.isNegative=P.isNeg=function(){return this.s<0};P.isPositive=P.isPos=function(){return this.s>0};P.isZero=function(){return!!this.d&&this.d[0]===0};P.lessThan=P.lt=function(t){return this.cmp(t)<0};P.lessThanOrEqualTo=P.lte=function(t){return this.cmp(t)<1};P.logarithm=P.log=function(t){var r,e,n,a,o,s,l,u,c=this,d=c.constructor,f=d.precision,h=d.rounding,p=5;if(t==null)t=new d(10),r=!0;else{if(t=new d(t),e=t.d,t.s<0||!e||!e[0]||t.eq(1))return new d(NaN);r=t.eq(10)}if(e=c.d,c.s<0||!e||!e[0]||c.eq(1))return new d(e&&!e[0]?-1/0:c.s!=1?NaN:e?0:1/0);if(r)if(e.length>1)o=!0;else{for(a=e[0];a%10===0;)a/=10;o=a!==1}if(external=!1,l=f+p,s=naturalLogarithm(c,l),n=r?getLn10(d,l+10):naturalLogarithm(t,l),u=divide(s,n,l,1),checkRoundingDigits(u.d,a=f,h))do if(l+=10,s=naturalLogarithm(c,l),n=r?getLn10(d,l+10):naturalLogarithm(t,l),u=divide(s,n,l,1),!o){+digitsToString(u.d).slice(a+1,a+15)+1==1e14&&(u=finalise(u,f+1,0));break}while(checkRoundingDigits(u.d,a+=10,h));return external=!0,finalise(u,f,h)};P.minus=P.sub=function(t){var r,e,n,a,o,s,l,u,c,d,f,h,p=this,v=p.constructor;if(t=new v(t),!p.d||!t.d)return!p.s||!t.s?t=new v(NaN):p.d?t.s=-t.s:t=new v(t.d||p.s!==t.s?p:NaN),t;if(p.s!=t.s)return t.s=-t.s,p.plus(t);if(c=p.d,h=t.d,l=v.precision,u=v.rounding,!c[0]||!h[0]){if(h[0])t.s=-t.s;else if(c[0])t=new v(p);else return new v(u===3?-0:0);return external?finalise(t,l,u):t}if(e=mathfloor(t.e/LOG_BASE),d=mathfloor(p.e/LOG_BASE),c=c.slice(),o=d-e,o){for(f=o<0,f?(r=c,o=-o,s=h.length):(r=h,e=d,s=c.length),n=Math.max(Math.ceil(l/LOG_BASE),s)+2,o>n&&(o=n,r.length=1),r.reverse(),n=o;n--;)r.push(0);r.reverse()}else{for(n=c.length,s=h.length,f=n<s,f&&(s=n),n=0;n<s;n++)if(c[n]!=h[n]){f=c[n]<h[n];break}o=0}for(f&&(r=c,c=h,h=r,t.s=-t.s),s=c.length,n=h.length-s;n>0;--n)c[s++]=0;for(n=h.length;n>o;){if(c[--n]<h[n]){for(a=n;a&&c[--a]===0;)c[a]=BASE-1;--c[a],c[n]+=BASE}c[n]-=h[n]}for(;c[--s]===0;)c.pop();for(;c[0]===0;c.shift())--e;return c[0]?(t.d=c,t.e=getBase10Exponent(c,e),external?finalise(t,l,u):t):new v(u===3?-0:0)};P.modulo=P.mod=function(t){var r,e=this,n=e.constructor;return t=new n(t),!e.d||!t.s||t.d&&!t.d[0]?new n(NaN):!t.d||e.d&&!e.d[0]?finalise(new n(e),n.precision,n.rounding):(external=!1,n.modulo==9?(r=divide(e,t.abs(),0,3,1),r.s*=t.s):r=divide(e,t,0,n.modulo,1),r=r.times(t),external=!0,e.minus(r))};P.naturalExponential=P.exp=function(){return naturalExponential(this)};P.naturalLogarithm=P.ln=function(){return naturalLogarithm(this)};P.negated=P.neg=function(){var t=new this.constructor(this);return t.s=-t.s,finalise(t)};P.plus=P.add=function(t){var r,e,n,a,o,s,l,u,c,d,f=this,h=f.constructor;if(t=new h(t),!f.d||!t.d)return!f.s||!t.s?t=new h(NaN):f.d||(t=new h(t.d||f.s===t.s?f:NaN)),t;if(f.s!=t.s)return t.s=-t.s,f.minus(t);if(c=f.d,d=t.d,l=h.precision,u=h.rounding,!c[0]||!d[0])return d[0]||(t=new h(f)),external?finalise(t,l,u):t;if(o=mathfloor(f.e/LOG_BASE),n=mathfloor(t.e/LOG_BASE),c=c.slice(),a=o-n,a){for(a<0?(e=c,a=-a,s=d.length):(e=d,n=o,s=c.length),o=Math.ceil(l/LOG_BASE),s=o>s?o+1:s+1,a>s&&(a=s,e.length=1),e.reverse();a--;)e.push(0);e.reverse()}for(s=c.length,a=d.length,s-a<0&&(a=s,e=d,d=c,c=e),r=0;a;)r=(c[--a]=c[a]+d[a]+r)/BASE|0,c[a]%=BASE;for(r&&(c.unshift(r),++n),s=c.length;c[--s]==0;)c.pop();return t.d=c,t.e=getBase10Exponent(c,n),external?finalise(t,l,u):t};P.precision=P.sd=function(t){var r,e=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(invalidArgument+t);return e.d?(r=getPrecision(e.d),t&&e.e+1>r&&(r=e.e+1)):r=NaN,r};P.round=function(){var t=this,r=t.constructor;return finalise(new r(t),t.e+1,r.rounding)};P.sine=P.sin=function(){var t,r,e=this,n=e.constructor;return e.isFinite()?e.isZero()?new n(e):(t=n.precision,r=n.rounding,n.precision=t+Math.max(e.e,e.sd())+LOG_BASE,n.rounding=1,e=sine(n,toLessThanHalfPi(n,e)),n.precision=t,n.rounding=r,finalise(quadrant>2?e.neg():e,t,r,!0)):new n(NaN)};P.squareRoot=P.sqrt=function(){var t,r,e,n,a,o,s=this,l=s.d,u=s.e,c=s.s,d=s.constructor;if(c!==1||!l||!l[0])return new d(!c||c<0&&(!l||l[0])?NaN:l?s:1/0);for(external=!1,c=Math.sqrt(+s),c==0||c==1/0?(r=digitsToString(l),(r.length+u)%2==0&&(r+="0"),c=Math.sqrt(r),u=mathfloor((u+1)/2)-(u<0||u%2),c==1/0?r="5e"+u:(r=c.toExponential(),r=r.slice(0,r.indexOf("e")+1)+u),n=new d(r)):n=new d(c.toString()),e=(u=d.precision)+3;;)if(o=n,n=o.plus(divide(s,o,e+2,1)).times(.5),digitsToString(o.d).slice(0,e)===(r=digitsToString(n.d)).slice(0,e))if(r=r.slice(e-3,e+1),r=="9999"||!a&&r=="4999"){if(!a&&(finalise(o,u+1,0),o.times(o).eq(s))){n=o;break}e+=4,a=1}else{(!+r||!+r.slice(1)&&r.charAt(0)=="5")&&(finalise(n,u+1,1),t=!n.times(n).eq(s));break}return external=!0,finalise(n,u,d.rounding,t)};P.tangent=P.tan=function(){var t,r,e=this,n=e.constructor;return e.isFinite()?e.isZero()?new n(e):(t=n.precision,r=n.rounding,n.precision=t+10,n.rounding=1,e=e.sin(),e.s=1,e=divide(e,new n(1).minus(e.times(e)).sqrt(),t+10,0),n.precision=t,n.rounding=r,finalise(quadrant==2||quadrant==4?e.neg():e,t,r,!0)):new n(NaN)};P.times=P.mul=function(t){var r,e,n,a,o,s,l,u,c,d=this,f=d.constructor,h=d.d,p=(t=new f(t)).d;if(t.s*=d.s,!h||!h[0]||!p||!p[0])return new f(!t.s||h&&!h[0]&&!p||p&&!p[0]&&!h?NaN:!h||!p?t.s/0:t.s*0);for(e=mathfloor(d.e/LOG_BASE)+mathfloor(t.e/LOG_BASE),u=h.length,c=p.length,u<c&&(o=h,h=p,p=o,s=u,u=c,c=s),o=[],s=u+c,n=s;n--;)o.push(0);for(n=c;--n>=0;){for(r=0,a=u+n;a>n;)l=o[a]+p[n]*h[a-n-1]+r,o[a--]=l%BASE|0,r=l/BASE|0;o[a]=(o[a]+r)%BASE|0}for(;!o[--s];)o.pop();return r?++e:o.shift(),t.d=o,t.e=getBase10Exponent(o,e),external?finalise(t,f.precision,f.rounding):t};P.toBinary=function(t,r){return toStringBinary(this,2,t,r)};P.toDecimalPlaces=P.toDP=function(t,r){var e=this,n=e.constructor;return e=new n(e),t===void 0?e:(checkInt32(t,0,MAX_DIGITS),r===void 0?r=n.rounding:checkInt32(r,0,8),finalise(e,t+e.e+1,r))};P.toExponential=function(t,r){var e,n=this,a=n.constructor;return t===void 0?e=finiteToString(n,!0):(checkInt32(t,0,MAX_DIGITS),r===void 0?r=a.rounding:checkInt32(r,0,8),n=finalise(new a(n),t+1,r),e=finiteToString(n,!0,t+1)),n.isNeg()&&!n.isZero()?"-"+e:e};P.toFixed=function(t,r){var e,n,a=this,o=a.constructor;return t===void 0?e=finiteToString(a):(checkInt32(t,0,MAX_DIGITS),r===void 0?r=o.rounding:checkInt32(r,0,8),n=finalise(new o(a),t+a.e+1,r),e=finiteToString(n,!1,t+n.e+1)),a.isNeg()&&!a.isZero()?"-"+e:e};P.toFraction=function(t){var r,e,n,a,o,s,l,u,c,d,f,h,p=this,v=p.d,g=p.constructor;if(!v)return new g(p);if(c=e=new g(1),n=u=new g(0),r=new g(n),o=r.e=getPrecision(v)-p.e-1,s=o%LOG_BASE,r.d[0]=mathpow(10,s<0?LOG_BASE+s:s),t==null)t=o>0?r:c;else{if(l=new g(t),!l.isInt()||l.lt(c))throw Error(invalidArgument+l);t=l.gt(r)?o>0?r:c:l}for(external=!1,l=new g(digitsToString(v)),d=g.precision,g.precision=o=v.length*LOG_BASE*2;f=divide(l,r,0,1,1),a=e.plus(f.times(n)),a.cmp(t)!=1;)e=n,n=a,a=c,c=u.plus(f.times(a)),u=a,a=r,r=l.minus(f.times(a)),l=a;return a=divide(t.minus(e),n,0,1,1),u=u.plus(a.times(c)),e=e.plus(a.times(n)),u.s=c.s=p.s,h=divide(c,n,o,1).minus(p).abs().cmp(divide(u,e,o,1).minus(p).abs())<1?[c,n]:[u,e],g.precision=d,external=!0,h};P.toHexadecimal=P.toHex=function(t,r){return toStringBinary(this,16,t,r)};P.toNearest=function(t,r){var e=this,n=e.constructor;if(e=new n(e),t==null){if(!e.d)return e;t=new n(1),r=n.rounding}else{if(t=new n(t),r===void 0?r=n.rounding:checkInt32(r,0,8),!e.d)return t.s?e:t;if(!t.d)return t.s&&(t.s=e.s),t}return t.d[0]?(external=!1,e=divide(e,t,0,r,1).times(t),external=!0,finalise(e)):(t.s=e.s,e=t),e};P.toNumber=function(){return+this};P.toOctal=function(t,r){return toStringBinary(this,8,t,r)};P.toPower=P.pow=function(t){var r,e,n,a,o,s,l=this,u=l.constructor,c=+(t=new u(t));if(!l.d||!t.d||!l.d[0]||!t.d[0])return new u(mathpow(+l,c));if(l=new u(l),l.eq(1))return l;if(n=u.precision,o=u.rounding,t.eq(1))return finalise(l,n,o);if(r=mathfloor(t.e/LOG_BASE),r>=t.d.length-1&&(e=c<0?-c:c)<=MAX_SAFE_INTEGER)return a=intPow(u,l,e,n),t.s<0?new u(1).div(a):finalise(a,n,o);if(s=l.s,s<0){if(r<t.d.length-1)return new u(NaN);if(t.d[r]&1||(s=1),l.e==0&&l.d[0]==1&&l.d.length==1)return l.s=s,l}return e=mathpow(+l,c),r=e==0||!isFinite(e)?mathfloor(c*(Math.log("0."+digitsToString(l.d))/Math.LN10+l.e+1)):new u(e+"").e,r>u.maxE+1||r<u.minE-1?new u(r>0?s/0:0):(external=!1,u.rounding=l.s=1,e=Math.min(12,(r+"").length),a=naturalExponential(t.times(naturalLogarithm(l,n+e)),n),a.d&&(a=finalise(a,n+5,1),checkRoundingDigits(a.d,n,o)&&(r=n+10,a=finalise(naturalExponential(t.times(naturalLogarithm(l,r+e)),r),r+5,1),+digitsToString(a.d).slice(n+1,n+15)+1==1e14&&(a=finalise(a,n+1,0)))),a.s=s,external=!0,u.rounding=o,finalise(a,n,o))};P.toPrecision=function(t,r){var e,n=this,a=n.constructor;return t===void 0?e=finiteToString(n,n.e<=a.toExpNeg||n.e>=a.toExpPos):(checkInt32(t,1,MAX_DIGITS),r===void 0?r=a.rounding:checkInt32(r,0,8),n=finalise(new a(n),t,r),e=finiteToString(n,t<=n.e||n.e<=a.toExpNeg,t)),n.isNeg()&&!n.isZero()?"-"+e:e};P.toSignificantDigits=P.toSD=function(t,r){var e=this,n=e.constructor;return t===void 0?(t=n.precision,r=n.rounding):(checkInt32(t,1,MAX_DIGITS),r===void 0?r=n.rounding:checkInt32(r,0,8)),finalise(new n(e),t,r)};P.toString=function(){var t=this,r=t.constructor,e=finiteToString(t,t.e<=r.toExpNeg||t.e>=r.toExpPos);return t.isNeg()&&!t.isZero()?"-"+e:e};P.truncated=P.trunc=function(){return finalise(new this.constructor(this),this.e+1,1)};P.valueOf=P.toJSON=function(){var t=this,r=t.constructor,e=finiteToString(t,t.e<=r.toExpNeg||t.e>=r.toExpPos);return t.isNeg()?"-"+e:e};function digitsToString(t){var r,e,n,a=t.length-1,o="",s=t[0];if(a>0){for(o+=s,r=1;r<a;r++)n=t[r]+"",e=LOG_BASE-n.length,e&&(o+=getZeroString(e)),o+=n;s=t[r],n=s+"",e=LOG_BASE-n.length,e&&(o+=getZeroString(e))}else if(s===0)return"0";for(;s%10===0;)s/=10;return o+s}function checkInt32(t,r,e){if(t!==~~t||t<r||t>e)throw Error(invalidArgument+t)}function checkRoundingDigits(t,r,e,n){var a,o,s,l;for(o=t[0];o>=10;o/=10)--r;return--r<0?(r+=LOG_BASE,a=0):(a=Math.ceil((r+1)/LOG_BASE),r%=LOG_BASE),o=mathpow(10,LOG_BASE-r),l=t[a]%o|0,n==null?r<3?(r==0?l=l/100|0:r==1&&(l=l/10|0),s=e<4&&l==99999||e>3&&l==49999||l==5e4||l==0):s=(e<4&&l+1==o||e>3&&l+1==o/2)&&(t[a+1]/o/100|0)==mathpow(10,r-2)-1||(l==o/2||l==0)&&(t[a+1]/o/100|0)==0:r<4?(r==0?l=l/1e3|0:r==1?l=l/100|0:r==2&&(l=l/10|0),s=(n||e<4)&&l==9999||!n&&e>3&&l==4999):s=((n||e<4)&&l+1==o||!n&&e>3&&l+1==o/2)&&(t[a+1]/o/1e3|0)==mathpow(10,r-3)-1,s}function convertBase(t,r,e){for(var n,a=[0],o,s=0,l=t.length;s<l;){for(o=a.length;o--;)a[o]*=r;for(a[0]+=NUMERALS.indexOf(t.charAt(s++)),n=0;n<a.length;n++)a[n]>e-1&&(a[n+1]===void 0&&(a[n+1]=0),a[n+1]+=a[n]/e|0,a[n]%=e)}return a.reverse()}function cosine(t,r){var e,n,a;if(r.isZero())return r;n=r.d.length,n<32?(e=Math.ceil(n/3),a=(1/tinyPow(4,e)).toString()):(e=16,a="2.3283064365386962890625e-10"),t.precision+=e,r=taylorSeries(t,1,r.times(a),new t(1));for(var o=e;o--;){var s=r.times(r);r=s.times(s).minus(s).times(8).plus(1)}return t.precision-=e,r}var divide=function(){function t(n,a,o){var s,l=0,u=n.length;for(n=n.slice();u--;)s=n[u]*a+l,n[u]=s%o|0,l=s/o|0;return l&&n.unshift(l),n}function r(n,a,o,s){var l,u;if(o!=s)u=o>s?1:-1;else for(l=u=0;l<o;l++)if(n[l]!=a[l]){u=n[l]>a[l]?1:-1;break}return u}function e(n,a,o,s){for(var l=0;o--;)n[o]-=l,l=n[o]<a[o]?1:0,n[o]=l*s+n[o]-a[o];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,o,s,l,u){var c,d,f,h,p,v,g,y,m,S,w,R,T,x,b,L,M,D,N,F,k=n.constructor,H=n.s==a.s?1:-1,G=n.d,z=a.d;if(!G||!G[0]||!z||!z[0])return new k(!n.s||!a.s||(G?z&&G[0]==z[0]:!z)?NaN:G&&G[0]==0||!z?H*0:H/0);for(u?(p=1,d=n.e-a.e):(u=BASE,p=LOG_BASE,d=mathfloor(n.e/p)-mathfloor(a.e/p)),N=z.length,M=G.length,m=new k(H),S=m.d=[],f=0;z[f]==(G[f]||0);f++);if(z[f]>(G[f]||0)&&d--,o==null?(x=o=k.precision,s=k.rounding):l?x=o+(n.e-a.e)+1:x=o,x<0)S.push(1),v=!0;else{if(x=x/p+2|0,f=0,N==1){for(h=0,z=z[0],x++;(f<M||h)&&x--;f++)b=h*u+(G[f]||0),S[f]=b/z|0,h=b%z|0;v=h||f<M}else{for(h=u/(z[0]+1)|0,h>1&&(z=t(z,h,u),G=t(G,h,u),N=z.length,M=G.length),L=N,w=G.slice(0,N),R=w.length;R<N;)w[R++]=0;F=z.slice(),F.unshift(0),D=z[0],z[1]>=u/2&&++D;do h=0,c=r(z,w,N,R),c<0?(T=w[0],N!=R&&(T=T*u+(w[1]||0)),h=T/D|0,h>1?(h>=u&&(h=u-1),g=t(z,h,u),y=g.length,R=w.length,c=r(g,w,y,R),c==1&&(h--,e(g,N<y?F:z,y,u))):(h==0&&(c=h=1),g=z.slice()),y=g.length,y<R&&g.unshift(0),e(w,g,R,u),c==-1&&(R=w.length,c=r(z,w,N,R),c<1&&(h++,e(w,N<R?F:z,R,u))),R=w.length):c===0&&(h++,w=[0]),S[f++]=h,c&&w[0]?w[R++]=G[L]||0:(w=[G[L]],R=1);while((L++<M||w[0]!==void 0)&&x--);v=w[0]!==void 0}S[0]||S.shift()}if(p==1)m.e=d,inexact=v;else{for(f=1,h=S[0];h>=10;h/=10)f++;m.e=f+d*p-1,finalise(m,l?o+m.e+1:o,s,v)}return m}}();function finalise(t,r,e,n){var a,o,s,l,u,c,d,f,h,p=t.constructor;e:if(r!=null){if(f=t.d,!f)return t;for(a=1,l=f[0];l>=10;l/=10)a++;if(o=r-a,o<0)o+=LOG_BASE,s=r,d=f[h=0],u=d/mathpow(10,a-s-1)%10|0;else if(h=Math.ceil((o+1)/LOG_BASE),l=f.length,h>=l)if(n){for(;l++<=h;)f.push(0);d=u=0,a=1,o%=LOG_BASE,s=o-LOG_BASE+1}else break e;else{for(d=l=f[h],a=1;l>=10;l/=10)a++;o%=LOG_BASE,s=o-LOG_BASE+a,u=s<0?0:d/mathpow(10,a-s-1)%10|0}if(n=n||r<0||f[h+1]!==void 0||(s<0?d:d%mathpow(10,a-s-1)),c=e<4?(u||n)&&(e==0||e==(t.s<0?3:2)):u>5||u==5&&(e==4||n||e==6&&(o>0?s>0?d/mathpow(10,a-s):0:f[h-1])%10&1||e==(t.s<0?8:7)),r<1||!f[0])return f.length=0,c?(r-=t.e+1,f[0]=mathpow(10,(LOG_BASE-r%LOG_BASE)%LOG_BASE),t.e=-r||0):f[0]=t.e=0,t;if(o==0?(f.length=h,l=1,h--):(f.length=h+1,l=mathpow(10,LOG_BASE-o),f[h]=s>0?(d/mathpow(10,a-s)%mathpow(10,s)|0)*l:0),c)for(;;)if(h==0){for(o=1,s=f[0];s>=10;s/=10)o++;for(s=f[0]+=l,l=1;s>=10;s/=10)l++;o!=l&&(t.e++,f[0]==BASE&&(f[0]=1));break}else{if(f[h]+=l,f[h]!=BASE)break;f[h--]=0,l=1}for(o=f.length;f[--o]===0;)f.pop()}return external&&(t.e>p.maxE?(t.d=null,t.e=NaN):t.e<p.minE&&(t.e=0,t.d=[0])),t}function finiteToString(t,r,e){if(!t.isFinite())return nonFiniteToString(t);var n,a=t.e,o=digitsToString(t.d),s=o.length;return r?(e&&(n=e-s)>0?o=o.charAt(0)+"."+o.slice(1)+getZeroString(n):s>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(t.e<0?"e":"e+")+t.e):a<0?(o="0."+getZeroString(-a-1)+o,e&&(n=e-s)>0&&(o+=getZeroString(n))):a>=s?(o+=getZeroString(a+1-s),e&&(n=e-a-1)>0&&(o=o+"."+getZeroString(n))):((n=a+1)<s&&(o=o.slice(0,n)+"."+o.slice(n)),e&&(n=e-s)>0&&(a+1===s&&(o+="."),o+=getZeroString(n))),o}function getBase10Exponent(t,r){var e=t[0];for(r*=LOG_BASE;e>=10;e/=10)r++;return r}function getLn10(t,r,e){if(r>LN10_PRECISION)throw external=!0,e&&(t.precision=e),Error(precisionLimitExceeded);return finalise(new t(LN10),r,1,!0)}function getPi(t,r,e){if(r>PI_PRECISION)throw Error(precisionLimitExceeded);return finalise(new t(PI),r,e,!0)}function getPrecision(t){var r=t.length-1,e=r*LOG_BASE+1;if(r=t[r],r){for(;r%10==0;r/=10)e--;for(r=t[0];r>=10;r/=10)e++}return e}function getZeroString(t){for(var r="";t--;)r+="0";return r}function intPow(t,r,e,n){var a,o=new t(1),s=Math.ceil(n/LOG_BASE+4);for(external=!1;;){if(e%2&&(o=o.times(r),truncate(o.d,s)&&(a=!0)),e=mathfloor(e/2),e===0){e=o.d.length-1,a&&o.d[e]===0&&++o.d[e];break}r=r.times(r),truncate(r.d,s)}return external=!0,o}function isOdd(t){return t.d[t.d.length-1]&1}function maxOrMin(t,r,e){for(var n,a=new t(r[0]),o=0;++o<r.length;)if(n=new t(r[o]),n.s)a[e](n)&&(a=n);else{a=n;break}return a}function naturalExponential(t,r){var e,n,a,o,s,l,u,c=0,d=0,f=0,h=t.constructor,p=h.rounding,v=h.precision;if(!t.d||!t.d[0]||t.e>17)return new h(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:NaN);for(r==null?(external=!1,u=v):u=r,l=new h(.03125);t.e>-2;)t=t.times(l),f+=5;for(n=Math.log(mathpow(2,f))/Math.LN10*2+5|0,u+=n,e=o=s=new h(1),h.precision=u;;){if(o=finalise(o.times(t),u,1),e=e.times(++d),l=s.plus(divide(o,e,u,1)),digitsToString(l.d).slice(0,u)===digitsToString(s.d).slice(0,u)){for(a=f;a--;)s=finalise(s.times(s),u,1);if(r==null)if(c<3&&checkRoundingDigits(s.d,u-n,p,c))h.precision=u+=10,e=o=l=new h(1),d=0,c++;else return finalise(s,h.precision=v,p,external=!0);else return h.precision=v,s}s=l}}function naturalLogarithm(t,r){var e,n,a,o,s,l,u,c,d,f,h,p=1,v=10,g=t,y=g.d,m=g.constructor,S=m.rounding,w=m.precision;if(g.s<0||!y||!y[0]||!g.e&&y[0]==1&&y.length==1)return new m(y&&!y[0]?-1/0:g.s!=1?NaN:y?0:g);if(r==null?(external=!1,d=w):d=r,m.precision=d+=v,e=digitsToString(y),n=e.charAt(0),Math.abs(o=g.e)<15e14){for(;n<7&&n!=1||n==1&&e.charAt(1)>3;)g=g.times(t),e=digitsToString(g.d),n=e.charAt(0),p++;o=g.e,n>1?(g=new m("0."+e),o++):g=new m(n+"."+e.slice(1))}else return c=getLn10(m,d+2,w).times(o+""),g=naturalLogarithm(new m(n+"."+e.slice(1)),d-v).plus(c),m.precision=w,r==null?finalise(g,w,S,external=!0):g;for(f=g,u=s=g=divide(g.minus(1),g.plus(1),d,1),h=finalise(g.times(g),d,1),a=3;;){if(s=finalise(s.times(h),d,1),c=u.plus(divide(s,new m(a),d,1)),digitsToString(c.d).slice(0,d)===digitsToString(u.d).slice(0,d))if(u=u.times(2),o!==0&&(u=u.plus(getLn10(m,d+2,w).times(o+""))),u=divide(u,new m(p),d,1),r==null)if(checkRoundingDigits(u.d,d-v,S,l))m.precision=d+=v,c=s=g=divide(f.minus(1),f.plus(1),d,1),h=finalise(g.times(g),d,1),a=l=1;else return finalise(u,m.precision=w,S,external=!0);else return m.precision=w,u;u=c,a+=2}}function nonFiniteToString(t){return String(t.s*t.s/0)}function parseDecimal(t,r){var e,n,a;for((e=r.indexOf("."))>-1&&(r=r.replace(".","")),(n=r.search(/e/i))>0?(e<0&&(e=n),e+=+r.slice(n+1),r=r.substring(0,n)):e<0&&(e=r.length),n=0;r.charCodeAt(n)===48;n++);for(a=r.length;r.charCodeAt(a-1)===48;--a);if(r=r.slice(n,a),r){if(a-=n,t.e=e=e-n-1,t.d=[],n=(e+1)%LOG_BASE,e<0&&(n+=LOG_BASE),n<a){for(n&&t.d.push(+r.slice(0,n)),a-=LOG_BASE;n<a;)t.d.push(+r.slice(n,n+=LOG_BASE));r=r.slice(n),n=LOG_BASE-r.length}else n-=a;for(;n--;)r+="0";t.d.push(+r),external&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function parseOther(t,r){var e,n,a,o,s,l,u,c,d;if(r.indexOf("_")>-1){if(r=r.replace(/(\d)_(?=\d)/g,"$1"),isDecimal.test(r))return parseDecimal(t,r)}else if(r==="Infinity"||r==="NaN")return+r||(t.s=NaN),t.e=NaN,t.d=null,t;if(isHex.test(r))e=16,r=r.toLowerCase();else if(isBinary.test(r))e=2;else if(isOctal.test(r))e=8;else throw Error(invalidArgument+r);for(o=r.search(/p/i),o>0?(u=+r.slice(o+1),r=r.substring(2,o)):r=r.slice(2),o=r.indexOf("."),s=o>=0,n=t.constructor,s&&(r=r.replace(".",""),l=r.length,o=l-o,a=intPow(n,new n(e),o,o*2)),c=convertBase(r,e,BASE),d=c.length-1,o=d;c[o]===0;--o)c.pop();return o<0?new n(t.s*0):(t.e=getBase10Exponent(c,d),t.d=c,external=!1,s&&(t=divide(t,a,l*4)),u&&(t=t.times(Math.abs(u)<54?mathpow(2,u):Decimal.pow(2,u))),external=!0,t)}function sine(t,r){var e,n=r.d.length;if(n<3)return r.isZero()?r:taylorSeries(t,2,r,r);e=1.4*Math.sqrt(n),e=e>16?16:e|0,r=r.times(1/tinyPow(5,e)),r=taylorSeries(t,2,r,r);for(var a,o=new t(5),s=new t(16),l=new t(20);e--;)a=r.times(r),r=r.times(o.plus(a.times(s.times(a).minus(l))));return r}function taylorSeries(t,r,e,n,a){var o,s,l,u,c=t.precision,d=Math.ceil(c/LOG_BASE);for(external=!1,u=e.times(e),l=new t(n);;){if(s=divide(l.times(u),new t(r++*r++),c,1),l=a?n.plus(s):n.minus(s),n=divide(s.times(u),new t(r++*r++),c,1),s=l.plus(n),s.d[d]!==void 0){for(o=d;s.d[o]===l.d[o]&&o--;);if(o==-1)break}o=l,l=n,n=s,s=o}return external=!0,s.d.length=d+1,s}function tinyPow(t,r){for(var e=t;--r;)e*=t;return e}function toLessThanHalfPi(t,r){var e,n=r.s<0,a=getPi(t,t.precision,1),o=a.times(.5);if(r=r.abs(),r.lte(o))return quadrant=n?4:1,r;if(e=r.divToInt(a),e.isZero())quadrant=n?3:2;else{if(r=r.minus(e.times(a)),r.lte(o))return quadrant=isOdd(e)?n?2:3:n?4:1,r;quadrant=isOdd(e)?n?1:4:n?3:2}return r.minus(a).abs()}function toStringBinary(t,r,e,n){var a,o,s,l,u,c,d,f,h,p=t.constructor,v=e!==void 0;if(v?(checkInt32(e,1,MAX_DIGITS),n===void 0?n=p.rounding:checkInt32(n,0,8)):(e=p.precision,n=p.rounding),!t.isFinite())d=nonFiniteToString(t);else{for(d=finiteToString(t),s=d.indexOf("."),v?(a=2,r==16?e=e*4-3:r==8&&(e=e*3-2)):a=r,s>=0&&(d=d.replace(".",""),h=new p(1),h.e=d.length-s,h.d=convertBase(finiteToString(h),10,a),h.e=h.d.length),f=convertBase(d,10,a),o=u=f.length;f[--u]==0;)f.pop();if(!f[0])d=v?"0p+0":"0";else{if(s<0?o--:(t=new p(t),t.d=f,t.e=o,t=divide(t,h,e,n,0,a),f=t.d,o=t.e,c=inexact),s=f[e],l=a/2,c=c||f[e+1]!==void 0,c=n<4?(s!==void 0||c)&&(n===0||n===(t.s<0?3:2)):s>l||s===l&&(n===4||c||n===6&&f[e-1]&1||n===(t.s<0?8:7)),f.length=e,c)for(;++f[--e]>a-1;)f[e]=0,e||(++o,f.unshift(1));for(u=f.length;!f[u-1];--u);for(s=0,d="";s<u;s++)d+=NUMERALS.charAt(f[s]);if(v){if(u>1)if(r==16||r==8){for(s=r==16?4:3,--u;u%s;u++)d+="0";for(f=convertBase(d,a,r),u=f.length;!f[u-1];--u);for(s=1,d="1.";s<u;s++)d+=NUMERALS.charAt(f[s])}else d=d.charAt(0)+"."+d.slice(1);d=d+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)d="0"+d;d="0."+d}else if(++o>u)for(o-=u;o--;)d+="0";else o<u&&(d=d.slice(0,o)+"."+d.slice(o))}d=(r==16?"0x":r==2?"0b":r==8?"0o":"")+d}return t.s<0?"-"+d:d}function truncate(t,r){if(t.length>r)return t.length=r,!0}function abs(t){return new this(t).abs()}function acos(t){return new this(t).acos()}function acosh(t){return new this(t).acosh()}function add(t,r){return new this(t).plus(r)}function asin(t){return new this(t).asin()}function asinh(t){return new this(t).asinh()}function atan(t){return new this(t).atan()}function atanh(t){return new this(t).atanh()}function atan2(t,r){t=new this(t),r=new this(r);var e,n=this.precision,a=this.rounding,o=n+4;return!t.s||!r.s?e=new this(NaN):!t.d&&!r.d?(e=getPi(this,o,1).times(r.s>0?.25:.75),e.s=t.s):!r.d||t.isZero()?(e=r.s<0?getPi(this,n,a):new this(0),e.s=t.s):!t.d||r.isZero()?(e=getPi(this,o,1).times(.5),e.s=t.s):r.s<0?(this.precision=o,this.rounding=1,e=this.atan(divide(t,r,o,1)),r=getPi(this,o,1),this.precision=n,this.rounding=a,e=t.s<0?e.minus(r):e.plus(r)):e=this.atan(divide(t,r,o,1)),e}function cbrt(t){return new this(t).cbrt()}function ceil(t){return finalise(t=new this(t),t.e+1,2)}function clamp(t,r,e){return new this(t).clamp(r,e)}function config(t){if(!t||typeof t!="object")throw Error(decimalError+"Object expected");var r,e,n,a=t.defaults===!0,o=["precision",1,MAX_DIGITS,"rounding",0,8,"toExpNeg",-EXP_LIMIT,0,"toExpPos",0,EXP_LIMIT,"maxE",0,EXP_LIMIT,"minE",-EXP_LIMIT,0,"modulo",0,9];for(r=0;r<o.length;r+=3)if(e=o[r],a&&(this[e]=DEFAULTS[e]),(n=t[e])!==void 0)if(mathfloor(n)===n&&n>=o[r+1]&&n<=o[r+2])this[e]=n;else throw Error(invalidArgument+e+": "+n);if(e="crypto",a&&(this[e]=DEFAULTS[e]),(n=t[e])!==void 0)if(n===!0||n===!1||n===0||n===1)if(n)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[e]=!0;else throw Error(cryptoUnavailable);else this[e]=!1;else throw Error(invalidArgument+e+": "+n);return this}function cos(t){return new this(t).cos()}function cosh(t){return new this(t).cosh()}function clone(t){var r,e,n;function a(o){var s,l,u,c=this;if(!(c instanceof a))return new a(o);if(c.constructor=a,isDecimalInstance(o)){c.s=o.s,external?!o.d||o.e>a.maxE?(c.e=NaN,c.d=null):o.e<a.minE?(c.e=0,c.d=[0]):(c.e=o.e,c.d=o.d.slice()):(c.e=o.e,c.d=o.d?o.d.slice():o.d);return}if(u=typeof o,u==="number"){if(o===0){c.s=1/o<0?-1:1,c.e=0,c.d=[0];return}if(o<0?(o=-o,c.s=-1):c.s=1,o===~~o&&o<1e7){for(s=0,l=o;l>=10;l/=10)s++;external?s>a.maxE?(c.e=NaN,c.d=null):s<a.minE?(c.e=0,c.d=[0]):(c.e=s,c.d=[o]):(c.e=s,c.d=[o]);return}else if(o*0!==0){o||(c.s=NaN),c.e=NaN,c.d=null;return}return parseDecimal(c,o.toString())}else if(u!=="string")throw Error(invalidArgument+o);return(l=o.charCodeAt(0))===45?(o=o.slice(1),c.s=-1):(l===43&&(o=o.slice(1)),c.s=1),isDecimal.test(o)?parseDecimal(c,o):parseOther(c,o)}if(a.prototype=P,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.EUCLID=9,a.config=a.set=config,a.clone=clone,a.isDecimal=isDecimalInstance,a.abs=abs,a.acos=acos,a.acosh=acosh,a.add=add,a.asin=asin,a.asinh=asinh,a.atan=atan,a.atanh=atanh,a.atan2=atan2,a.cbrt=cbrt,a.ceil=ceil,a.clamp=clamp,a.cos=cos,a.cosh=cosh,a.div=div,a.exp=exp,a.floor=floor$1,a.hypot=hypot,a.ln=ln,a.log=log,a.log10=log10,a.log2=log2,a.max=max,a.min=min,a.mod=mod,a.mul=mul,a.pow=pow,a.random=random,a.round=round,a.sign=sign,a.sin=sin,a.sinh=sinh,a.sqrt=sqrt,a.sub=sub,a.sum=sum,a.tan=tan,a.tanh=tanh,a.trunc=trunc,t===void 0&&(t={}),t&&t.defaults!==!0)for(n=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],r=0;r<n.length;)t.hasOwnProperty(e=n[r++])||(t[e]=this[e]);return a.config(t),a}function div(t,r){return new this(t).div(r)}function exp(t){return new this(t).exp()}function floor$1(t){return finalise(t=new this(t),t.e+1,3)}function hypot(){var t,r,e=new this(0);for(external=!1,t=0;t<arguments.length;)if(r=new this(arguments[t++]),r.d)e.d&&(e=e.plus(r.times(r)));else{if(r.s)return external=!0,new this(1/0);e=r}return external=!0,e.sqrt()}function isDecimalInstance(t){return t instanceof Decimal||t&&t.toStringTag===tag||!1}function ln(t){return new this(t).ln()}function log(t,r){return new this(t).log(r)}function log2(t){return new this(t).log(2)}function log10(t){return new this(t).log(10)}function max(){return maxOrMin(this,arguments,"lt")}function min(){return maxOrMin(this,arguments,"gt")}function mod(t,r){return new this(t).mod(r)}function mul(t,r){return new this(t).mul(r)}function pow(t,r){return new this(t).pow(r)}function random(t){var r,e,n,a,o=0,s=new this(1),l=[];if(t===void 0?t=this.precision:checkInt32(t,1,MAX_DIGITS),n=Math.ceil(t/LOG_BASE),this.crypto)if(crypto.getRandomValues)for(r=crypto.getRandomValues(new Uint32Array(n));o<n;)a=r[o],a>=429e7?r[o]=crypto.getRandomValues(new Uint32Array(1))[0]:l[o++]=a%1e7;else if(crypto.randomBytes){for(r=crypto.randomBytes(n*=4);o<n;)a=r[o]+(r[o+1]<<8)+(r[o+2]<<16)+((r[o+3]&127)<<24),a>=214e7?crypto.randomBytes(4).copy(r,o):(l.push(a%1e7),o+=4);o=n/4}else throw Error(cryptoUnavailable);else for(;o<n;)l[o++]=Math.random()*1e7|0;for(n=l[--o],t%=LOG_BASE,n&&t&&(a=mathpow(10,LOG_BASE-t),l[o]=(n/a|0)*a);l[o]===0;o--)l.pop();if(o<0)e=0,l=[0];else{for(e=-1;l[0]===0;e-=LOG_BASE)l.shift();for(n=1,a=l[0];a>=10;a/=10)n++;n<LOG_BASE&&(e-=LOG_BASE-n)}return s.e=e,s.d=l,s}function round(t){return finalise(t=new this(t),t.e+1,this.rounding)}function sign(t){return t=new this(t),t.d?t.d[0]?t.s:0*t.s:t.s||NaN}function sin(t){return new this(t).sin()}function sinh(t){return new this(t).sinh()}function sqrt(t){return new this(t).sqrt()}function sub(t,r){return new this(t).sub(r)}function sum(){var t=0,r=arguments,e=new this(r[t]);for(external=!1;e.s&&++t<r.length;)e=e.plus(r[t]);return external=!0,finalise(e,this.precision,this.rounding)}function tan(t){return new this(t).tan()}function tanh(t){return new this(t).tanh()}function trunc(t){return finalise(t=new this(t),t.e+1,1)}P[Symbol.for("nodejs.util.inspect.custom")]=P.toString;P[Symbol.toStringTag]="Decimal";var Decimal=P.constructor=clone(DEFAULTS);LN10=new Decimal(LN10);PI=new Decimal(PI);var _a,isNotNumber=function(t){return typeof t=="number"?Number.isNaN(t):t&&typeof t=="string"?Number.isNaN(Number(t)):!0},canConvertToNumber=function(t){return!isNotNumber(t)},processFieldValues=function(t,r,e){return e===void 0&&(e=!1),t!=null&&t.length?t.reduce(function(n,a){var o=CellData.getFieldValue(a,r),s=isNotNumber(o);if(e&&s)return n;var l=s?0:o;return n.push(new Decimal(l)),n},[]):[]},getDataSumByField=function(t,r){var e=processFieldValues(t,r);return e.length?Decimal.sum.apply(Decimal,__spreadArray([],__read(e),!1)).toNumber():0},getDataExtremumByField=function(t,r,e){var n=processFieldValues(r,e,!0);if(n!=null&&n.length)return Decimal[t].apply(Decimal,__spreadArray([],__read(n),!1)).toNumber()},getDataAvgByField=function(t,r){var e=processFieldValues(t,r);return e!=null&&e.length?Decimal.sum.apply(Decimal,__spreadArray([],__read(e),!1)).dividedBy(e.length).toNumber():0},calcActionByType=(_a={},_a[Aggregation.SUM]=getDataSumByField,_a[Aggregation.MIN]=function(t,r){return getDataExtremumByField("min",t,r)},_a[Aggregation.MAX]=function(t,r){return getDataExtremumByField("max",t,r)},_a[Aggregation.AVG]=getDataAvgByField,_a),isAscSort=function(t){return toUpper(t)==="ASC"},isDescSort=function(t){return toUpper(t)==="DESC"},sortAction=function(t,r,e){var n=isAscSort(r)?1:-1,a=["-",void 0];return t==null?void 0:t.sort(function(o,s){var l=o,u=s;if(e){if(l=o.getValueByField(e),u=s.getValueByField(e),canConvertToNumber(l)&&canConvertToNumber(u))return(Number(l)-Number(u))*n;if(l&&(a!=null&&a.includes(l==null?void 0:l.toString())))return-n;if(Number(l)&&(a!=null&&a.includes(u==null?void 0:u.toString())))return n}return!isNil(l)&&!isNil(u)?l.toString().localeCompare(u.toString(),"zh")*n:l?n:-n})},mergeDataWhenASC=function(t,r,e){return e?sortByItems(r,uniq(t)):__spreadArray([],__read(new Set(__spreadArray(__spreadArray([],__read(t),!1),__read(r),!1))),!1)},sortByCustom=function(t){var r=t.sortByValues,e=r===void 0?[]:r,n=t.originValues,a=n===void 0?[]:n,o=a.filter(function(c){return e.find(function(d){return endsWith(c,d)})}),s=o.map(function(c){var d=c.split(NODE_ID_SEPARATOR);if(d.length>1){var f=d.slice(0,d.length-1).join(NODE_ID_SEPARATOR);return[f,d[d.length-1]]}return d}),l=Array.from(new Set(s.map(function(c){return c[0]})));s.sort(function(c,d){var f=c.slice(0,c.length-1),h=d.slice(0,d.length-1);if(f.join()!==h.join()){var p=l.indexOf(f[0]),v=l.indexOf(h[0]);return p-v}var g=e.indexOf(c[c.length-1]),y=e.indexOf(d[d.length-1]);return g-y});var u=s.map(function(c){return c.join(NODE_ID_SEPARATOR)});return getListBySorted(a,u)},sortByFunc=function(t){var r=t.originValues,e=r===void 0?[]:r,n=t.measureValues,a=t.sortParam,o=t.dataSet,s=a,l=s.sortFunc,u=s.sortFieldId,c=s.sortMethod,d=l==null?void 0:l(__assign({data:n},a));return d!=null&&d.length?(o.fields.rows.indexOf(u)>0||o.fields.columns.indexOf(u)>0)&&!includes(d[0],NODE_ID_SEPARATOR)?sortByCustom({sortByValues:d,originValues:e}):mergeDataWhenASC(d,e,isAscSort(c)):e},sortByMethod=function(t){var r=t.sortParam,e=t.measureValues,n=t.originValues,a=t.dataSet,o=r,s=o.sortByMeasure,l=o.query,u=o.sortFieldId,c=o.sortMethod,d=a.fields,f=d.rows,h=f===void 0?[]:f,p=d.columns,v=p===void 0?[]:p,g=h==null?void 0:h.includes(u),y;if(s){var m=sortAction(e,c,s===TOTAL_VALUE?l==null?void 0:l[EXTRA_FIELD]:s),S=g?h:getLeafColumnsWithKey(v);y=getDimensionsWithParentPath(u,S,m)}else y=sortAction(e,c);return mergeDataWhenASC(y,n,isAscSort(c))},processSort=function(t){var r=t.sortParam,e=t.originValues,n=e===void 0?[]:e,a=t.measureValues,o=t.dataSet,s=r,l=s.sortFunc,u=s.sortMethod,c=s.sortBy,d=n,f={originValues:n,measureValues:a,sortParam:r,dataSet:o};return l?d=sortByFunc(f):c?d=sortByCustom({sortByValues:c,originValues:n}):(isAscSort(u)||isDescSort(u))&&(d=sortByMethod(f)),d},createTotalParams=function(t,r,e){var n,a={},o=includes(t,NODE_ID_SEPARATOR);if(o)for(var s=split(t,NODE_ID_SEPARATOR),l=!((n=r==null?void 0:r.rows)===null||n===void 0)&&n.includes(e)?r.rows:getLeafColumnsWithKey(r.columns),u=0;u<=indexOf(l,e);u++)a[l[u]]=s[u];else a[e]=t;return a},getSortByMeasureValues=function(t){var r=t.dataSet,e=t.sortParam,n=t.originValues,a=r.fields,o=e,s=o.sortByMeasure,l=o.query,u=o.sortFieldId;if(s!==TOTAL_VALUE){var c=r.getCellMultiData({query:l,queryType:QueryDataType.DetailOnly});return c}var d=r.getCellMultiData({query:l,queryType:QueryDataType.All}),f=getLeafColumnsWithKey(a.columns),h=includes(a.rows,u),p=filterExtraDimension(h?a.rows:f),v=filterExtraDimension(h?f:a.rows),g=p[p.indexOf(u)+1],y=keys(l),m=v.filter(function(w){return!y.includes(w)}),S=d.filter(function(w){var R=new Set(keys(w[ORIGIN_FIELD]));if(!R.has(u)||R.has(g))return!1;var T=m.every(function(x){return!R.has(x)});return T});return isEmpty(S)?compact(map(n,function(w){var R=createTotalParams(w,a,u);return r.getTotalValue(__assign(__assign({},l),R))})):S},handleSortAction=function(t){var r=t.dataSet,e=t.sortParam,n=t.originValues,a=t.isSortByMeasure,o;return a?o=getSortByMeasureValues(t):o=n,processSort({sortParam:e,originValues:n,measureValues:o,dataSet:r})},getSortTypeIcon=function(t,r){if(t!=null&&t.sortMethod){if(isAscSort(t==null?void 0:t.sortMethod))return"groupAsc";if(isDescSort(t==null?void 0:t.sortMethod))return"groupDesc"}if(r)return"SortDown"},getSortedPivotMeta=function(t){var r,e,n=t.pivotMeta,a=t.dimensions,o=t.sortedDimensionValues,s=t.sortFieldId,l={children:n},u=[l];try{for(var c=__values(a),d=c.next();!d.done;d=c.next()){var f=d.value;if(f!==s)u=flatMap(u,function(h){return __spreadArray([],__read(h.children.values()),!1)});else{u.forEach(function(h){var p=__spreadArray([],__read(h.children.values()),!1),v=sortBy(p,function(g){return indexOf(o,g.id)}).map(function(g){return[g.value,g]});h.children=new Map(v)});break}}}catch(h){r={error:h}}finally{try{d&&!d.done&&(e=c.return)&&e.call(c)}finally{if(r)throw r.error}}return l.children},HeaderCell=function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.getHeaderConfig=function(){return this.headerConfig||{}},r.prototype.isShallowRender=function(){return this.headerConfig.shallowRender},r.prototype.shouldInit=function(){return t.prototype.shouldInit.call(this)&&!this.isShallowRender()},r.prototype.handleRestOptions=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var a=__read(e,1),o=a[0];this.headerConfig=__assign({},o);var s=this.meta,l=s.value,u=s.query,c=this.spreadsheet.dataCfg.sortParams||[],d=this.isSortCell(),f=find(__spreadArray([],__read(c),!1).reverse(),function(p){return d&&(p==null?void 0:p.sortByMeasure)===l&&isEqual(get(p,"query"),u)}),h=getSortTypeIcon(f,d);this.headerConfig.sortParam=__assign(__assign(__assign({},this.headerConfig.sortParam),f||{query:u}),{type:h})},r.prototype.initCell=function(){this.resetTextAndConditionIconShapes(),this.actionIcons=[],this.hasDefaultHiddenIcon=!1,this.generateIconConfig()},r.prototype.generateIconConfig=function(){var e,n;this.conditionIconMappingResult=this.getIconConditionResult();var a=this.getHeaderConfig().sortParam;this.showSortIcon()?this.actionIconConfig={icons:[{name:get(a,"type","none"),position:"right"}],belongsCell:this.cellType,isSortIcon:!0}:this.actionIconConfig=getActionIconConfig(this.spreadsheet.options.headerActionIcons,this.meta,this.cellType),this.groupedIcons=groupIconsByPosition((n=(e=this.actionIconConfig)===null||e===void 0?void 0:e.icons)!==null&&n!==void 0?n:[],this.conditionIconMappingResult)},r.prototype.getFormattedFieldValue=function(){var e=this.meta,n=e.isTotalRoot,a=e.isGrandTotals,o=e.value,s=this.spreadsheet.dataSet.getFieldFormatter(this.meta.field),l=!0;this.spreadsheet.isTableMode()?l=!1:this.spreadsheet.isHierarchyTreeType()?l=!(a&&n):l=!n;var u=l&&s?s(o,void 0,this.meta):o;return{formattedValue:u,value:o}},r.prototype.showSortIcon=function(){var e=this.spreadsheet,n=e.options,a=e.dataCfg,o=isEmpty(a.fields.values);if(n.showDefaultHeaderActionIcon&&!o){var s=this.getHeaderConfig().sortParam,l=this.meta.query;return l&&isEqual(s==null?void 0:s.query,l)&&(s==null?void 0:s.type)&&(s==null?void 0:s.type)!=="none"}return!1},r.prototype.getActionIconStyle=function(e){var n=this.getStyle().icon,a=this.getTextConditionMappingResult(),o=(a==null?void 0:a.fill)||this.getTextStyle().fill;return{width:n==null?void 0:n.size,height:n==null?void 0:n.size,fill:(e==null?void 0:e.fill)||(n==null?void 0:n.fill)||o,cursor:"pointer"}},r.prototype.hasDefaultHideActionIcon=function(){return this.hasDefaultHiddenIcon},r.prototype.addActionIcon=function(e){var n=this,a=e.x,o=e.y,s=e.name,l=e.defaultHide,u=e.onClick,c=e.onHover,d=e.isSortIcon,f=new GuiIcon(__assign(__assign({},this.getActionIconStyle(e)),{name:s,x:a,y:o}));f.setAttribute("visibility",l?"hidden":"visible"),f.addEventListener("mouseover",function(h){n.spreadsheet.emit(S2Event.GLOBAL_ACTION_ICON_HOVER,h),c==null||c({hovering:!0,name:s,meta:n.meta,event:h})}),f.addEventListener("mouseleave",function(h){n.spreadsheet.emit(S2Event.GLOBAL_ACTION_ICON_HOVER_OFF,h),c==null||c({hovering:!1,name:s,meta:n.meta,event:h})}),f.addEventListener("click",function(h){if(n.spreadsheet.emit(S2Event.GLOBAL_ACTION_ICON_CLICK,h),d){n.spreadsheet.handleGroupSort(h,n.meta);return}u==null||u({name:s,meta:n.meta,event:h})}),this.actionIcons.push(f),this.appendChild(f)},r.prototype.drawActionAndConditionIcons=function(){var e=this;isEmpty(this.groupedIcons.left)&&isEmpty(this.groupedIcons.right)||!this.leftIconPosition||!this.rightIconPosition||forEach(this.groupedIcons,function(n,a){var o=e.getStyle().icon,s=o.size,l=o.margin,u=l.right,c=a==="left"?e.leftIconPosition:e.rightIconPosition;forEach(n,function(d,f){var h,p,v,g=c.x+(s+u)*f,y=c.y;if(d.isConditionIcon){e.conditionIconShape=renderIcon(e,{x:g,y,name:d.name,width:s,height:s,fill:d.fill}),e.addConditionIconShape(e.conditionIconShape);return}var m=e.actionIconConfig,S=m.onClick,w=m.onHover,R=m.defaultHide,T=m.isSortIcon,x=(h=d.defaultHide)!==null&&h!==void 0?h:R,b=typeof x=="function"?x(e.meta,d.name):x;b&&(e.hasDefaultHiddenIcon=!0),e.addActionIcon({name:d.name,fill:d.fill,x:g,y,defaultHide:b,onClick:(p=d.onClick)!==null&&p!==void 0?p:S,onHover:(v=d.onHover)!==null&&v!==void 0?v:w,isSortIcon:T})})})},r.prototype.isSortCell=function(){var e,n,a,o=(n=(e=this.meta.spreadsheet)===null||e===void 0?void 0:e.isValueInCols)===null||n===void 0?void 0:n.call(e),s=this.meta.level===((a=this.meta.hierarchy)===null||a===void 0?void 0:a.maxLevel);return o?s&&this.cellType===CellType.COL_CELL:s&&this.cellType===CellType.ROW_CELL},r.prototype.handleByStateName=function(e,n){includeCell(e,this)&&this.updateByState(n)},r.prototype.handleSearchResult=function(e){if(includeCell(e,this)){var n=find(e,function(a){return a==null?void 0:a.isTarget});n.id===this.getMeta().id?this.updateByState(InteractionStateName.HIGHLIGHT):this.updateByState(InteractionStateName.SEARCH_RESULT)}},r.prototype.handleHover=function(e){var n;includeCell(e,this)&&(this.updateByState(InteractionStateName.HOVER),this.hasDefaultHideActionIcon()&&this.toggleActionIcon((n=e==null?void 0:e[0])===null||n===void 0?void 0:n.id))},r.prototype.handleSelect=function(e,n){n===void 0&&(n=[]),includeCell(e,this)&&this.updateByState(InteractionStateName.SELECTED);var a=map(n,"id");includes(a,this.meta.id)&&this.updateByState(InteractionStateName.SELECTED)},r.prototype.getTextStyle=function(){var e=this.getCellTextWordWrapStyle(),n=this.getStyle(),a=n.text,o=n.bolderText,s=n.measureText,l;return this.isMeasureField()?l=s||a:this.isBolderText()?l=o:l=a,this.getContainConditionMappingResultTextStyle(__assign(__assign({},e),l))},r.prototype.getBackgroundColor=function(){var e,n=((e=this.getStyle())===null||e===void 0?void 0:e.cell)||{},a=n.backgroundColor,o=n.backgroundColorOpacity;return merge({backgroundColor:a,backgroundColorOpacity:o},this.getBackgroundConditionFill())},r.prototype.toggleActionIcon=function(e){if(this.getMeta().id===e){var n=[];forEach(this.actionIcons,function(a){a.parsedStyle.visibility!=="visible"&&(a.setAttribute("visibility","visible"),n.push(a))}),this.spreadsheet.store.set("visibleActionIcons",n)}},r.prototype.getIconPosition=function(){return this.leftIconPosition||this.rightIconPosition},r.prototype.update=function(){var e=this.spreadsheet.interaction,n=e==null?void 0:e.getState(),a=e==null?void 0:e.getCells([CellType.CORNER_CELL,CellType.COL_CELL,CellType.ROW_CELL,CellType.SERIES_NUMBER_CELL]);if(head(a))switch(n==null?void 0:n.stateName){case InteractionStateName.SELECTED:case InteractionStateName.ROW_CELL_BRUSH_SELECTED:case InteractionStateName.COL_CELL_BRUSH_SELECTED:this.handleSelect(a,n==null?void 0:n.nodes);break;case InteractionStateName.HOVER_FOCUS:case InteractionStateName.HOVER:this.handleHover(a);break;case InteractionStateName.SEARCH_RESULT:this.handleSearchResult(a);break;default:this.handleByStateName(a,n==null?void 0:n.stateName);break}},r.prototype.updateByState=function(e){t.prototype.updateByState.call(this,e,this)},r.prototype.hideInteractionShape=function(){t.prototype.hideInteractionShape.call(this)},r.prototype.isMeasureField=function(){return[EXTRA_FIELD,EXTRA_COLUMN_FIELD].includes(this.meta.field)},r.prototype.mappingValue=function(e){var n=this.getMeta().value;return e.mapping(n,this.meta,this)},r.prototype.findFieldCondition=function(e){var n=this;return e===void 0&&(e=[]),findLast(e,function(a){return a.field instanceof RegExp?a.field.test(n.meta.field):a.field===n.meta.field})},r.prototype.getTreeIcon=function(){return this.treeIcon},r.prototype.getActionIcons=function(){return this.actionIcons||[]},r}(BaseCell),CornerCell=function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return Object.defineProperty(r.prototype,"cellType",{get:function(){return CellType.CORNER_CELL},enumerable:!1,configurable:!0}),r.prototype.isBolderText=function(){var e=this.meta.cornerType;return e===CornerNodeType.Col},r.prototype.getBorderPositions=function(){return[CellBorderPosition.TOP,CellBorderPosition.LEFT]},r.prototype.initCell=function(){t.prototype.initCell.call(this),this.resetTextAndConditionIconShapes(),this.drawBackgroundShape(),this.drawTextShape(),this.drawTreeIcon(),this.drawActionAndConditionIcons(),this.drawBorders(),this.drawResizeArea(),this.update()},r.prototype.drawTreeIcon=function(){var e=this,n;if(this.showTreeIcon()){var a=((n=this.spreadsheet.options.style)===null||n===void 0?void 0:n.rowCell).collapseFields,o=a===void 0?{}:a,s=this.getStyle().icon.size,l=s===void 0?0:s,u=this.getTextStyle().fill,c=this.getBBoxByType(CellClipBox.CONTENT_BOX),d=this.spreadsheet.facet.getRowNodes(0),f=values(o).filter(Boolean).length===d.length||d.every(function(p){return p.isCollapsed}),h=f;this.treeIcon=renderTreeIcon({group:this,iconCfg:{x:c.x,y:this.getIconPosition().y,width:l,height:l,fill:u},isCollapsed:h,onClick:function(){e.spreadsheet.facet.resetScrollY(),e.spreadsheet.emit(S2Event.ROW_CELL_ALL_COLLAPSED__PRIVATE,h)}})}},r.prototype.isLastRowCornerCell=function(){var e=this.meta,n=e.cornerType,a=e.field,o=this.spreadsheet.dataSet.fields.rows;return n===CornerNodeType.Row&&(this.spreadsheet.isHierarchyTreeType()||last(o)===a)},r.prototype.getResizeAreaEffect=function(){var e=this.meta.cornerType;return e===CornerNodeType.Series?ResizeAreaEffect.Series:this.isLastRowCornerCell()&&this.spreadsheet.isHierarchyTreeType()?ResizeAreaEffect.Tree:ResizeAreaEffect.Field},r.prototype.drawResizeArea=function(){if(this.shouldDrawResizeAreaByType("cornerCellHorizontal",this)){var e=this.getResizeAreaStyle(),n=getOrCreateResizeAreaGroupById(this.spreadsheet,KEY_GROUP_CORNER_RESIZE_AREA);if(n){var a=this.getHeaderConfig(),o=a.position,s=a.scrollX,l=s===void 0?0:s,u=a.scrollY,c=u===void 0?0:u,d=a.width,f=a.height,h=this.getBBoxByType(),p=h.x,v=h.y,g=h.width,y=h.height,m=this.meta.cornerType,S={x:p+g-e.size,y:v,width:e.size,height:y},w={x:0,y:0,width:d,height:f};if(!(m===CornerNodeType.Col||!shouldAddResizeArea(S,w,{scrollX:l,scrollY:c}))){var R=o.x+p-l,T=o.y+(this.isLastRowCornerCell()?0:v),x=getResizeAreaAttrs({theme:e,type:ResizeDirectionType.Horizontal,effect:this.getResizeAreaEffect(),offsetX:R,offsetY:T,width:g,height:y,meta:this.meta});n.appendChild(new CustomRect({style:__assign(__assign({},x.style),{x:R+g-e.size,y:T,height:this.isLastRowCornerCell()?f:y})},x.appendInfo))}}}},r.prototype.showTreeIcon=function(){return this.spreadsheet.isHierarchyTreeType()&&this.meta.cornerType===CornerNodeType.Row},r.prototype.getTreeIconWidth=function(){var e=this.getStyle().icon,n=e.size,a=e.margin;return this.showTreeIcon()?n+a.right:0},r.prototype.getMaxTextWidth=function(){var e=this.getBBoxByType(CellClipBox.CONTENT_BOX).width;return e-this.getTreeIconWidth()-this.getActionAndConditionIconWidth()},r.prototype.getTextPosition=function(){var e=this.getBBoxByType(CellClipBox.CONTENT_BOX),n=e.x,a=e.y,o=e.height,s=e.width,l=this.getTextStyle(),u=getHorizontalTextIconPosition({bbox:{x:n+this.getTreeIconWidth(),y:a,width:s-this.getTreeIconWidth(),height:o},textAlign:l.textAlign,textWidth:this.getActualTextWidth(),groupedIcons:this.groupedIcons,iconStyle:this.getIconStyle()}),c=u.textX,d=u.leftIconX,f=u.rightIconX,h=getVerticalTextPosition(e,l.textBaseline),p=this.getStyle().icon.size,v=p===void 0?0:p,g=getVerticalIconPosition(v,h,l.fontSize,l.textBaseline);return this.leftIconPosition={x:d,y:g},this.rightIconPosition={x:f,y:g},{x:c,y:h}},r.prototype.getFormattedFieldValue=function(){return formattedFieldValue(this.meta,this.spreadsheet.dataSet.getFieldName(this.meta.field))},r}(HeaderCell),CornerHeader=function(t){__extends(r,t);function r(e){return t.call(this,e)||this}return r.prototype.getCellInstance=function(e){var n=this.getHeaderConfig(),a=n.spreadsheet,o=a.options.cornerCell;return(o==null?void 0:o(e,a,n))||new CornerCell(e,a,n)},r.getCornerHeader=function(e){var n=e.panelBBox,a=e.cornerBBox,o=e.seriesNumberWidth,s=e.layoutResult,l=e.spreadsheet,u=n.width,c=n.height,d=a.originalWidth,f=a.originalHeight,h=a.width,p=a.height,v=this.getCornerNodes({position:{x:a.x,y:a.y},width:d,height:f,layoutResult:s,seriesNumberWidth:o,spreadsheet:l});return new r({nodes:v,position:{x:a.x,y:a.y},width:h,height:p,originalHeight:f,originalWidth:d,viewportWidth:u,viewportHeight:c,seriesNumberWidth:o,spreadsheet:l})},r.getTreeCornerText=function(e){var n=e.spreadsheet,a=n.dataSet.fields.rows,o=a===void 0?[]:a,s=n.options.cornerText;if(s)return s;var l=n.store.get("drillDownFieldInLevel",[]),u=l.map(function(d){return d.drillField}),c=o.filter(function(d){return!includes(u,d)}).map(function(d){return n.dataSet.getFieldName(d)}).join("/");return c||getDefaultCornerText()},r.getCornerNodes=function(e){var n,a,o,s,l,u,c=e.position,d=e.width,f=e.layoutResult,h=e.seriesNumberWidth,p=e.spreadsheet,v=f.rowsHierarchy,g=f.colsHierarchy,y=((n=p==null?void 0:p.dataSet)===null||n===void 0?void 0:n.fields)||{},m=y.rows,S=m===void 0?[]:m,w=y.columns,R=w===void 0?[]:w,T=p.options.style.colCell,x=[],b=g==null?void 0:g.sampleNodeForLastLevel;if(h){var L=new Node$1({id:"",field:"",value:getDefaultSeriesNumberText((a=p.options.seriesNumber)===null||a===void 0?void 0:a.text)});L.x=c==null?void 0:c.x,L.y=(o=b==null?void 0:b.y)!==null&&o!==void 0?o:0,L.width=h,L.height=(s=b==null?void 0:b.height)!==null&&s!==void 0?s:T==null?void 0:T.height,L.isPivotMode=!0,L.spreadsheet=p,L.cornerType=CornerNodeType.Series,x.push(L)}if(p.isHierarchyTreeType()){var M=this.getTreeCornerText(e),D=new Node$1({id:M,field:"",value:M});D.x=c.x+h,D.y=(l=b==null?void 0:b.y)!==null&&l!==void 0?l:0,D.width=d-h,D.height=(u=b==null?void 0:b.height)!==null&&u!==void 0?u:T==null?void 0:T.height,D.seriesNumberWidth=h,D.isPivotMode=!0,D.spreadsheet=p,D.cornerType=CornerNodeType.Row,x.push(D)}else{var N=v.sampleNodesForAllLevels||[],F=p.isCustomRowFields();N.forEach(function(G){var z,$,W=F?G.field:S[G.level],V=p.dataSet.getFieldName(W),X=new Node$1({id:W,field:W,value:V});X.x=G.x+h,X.y=(z=b==null?void 0:b.y)!==null&&z!==void 0?z:0,X.width=G.width,X.height=($=b==null?void 0:b.height)!==null&&$!==void 0?$:T==null?void 0:T.height,X.isPivotMode=!0,X.cornerType=CornerNodeType.Row,X.spreadsheet=p,x.push(X)})}var k=g.sampleNodesForAllLevels||[],H=p.isCustomColumnFields();return k.forEach(function(G){if(G.level<g.maxLevel){var z=H?G.field:R[G.level],$=p.dataSet.getFieldName(z),W=new Node$1({id:z,field:z,value:$});W.x=c.x,W.y=G.y,W.width=d,W.height=G.height,W.isPivotMode=!0,W.cornerType=CornerNodeType.Col,W.spreadsheet=p,x.push(W)}}),x},r.prototype.onCorScroll=function(e,n){this.headerConfig.scrollX=e,this.render(n)},r.prototype.destroy=function(){t.prototype.destroy.call(this)},r.prototype.layout=function(){this.renderCells()},r.prototype.renderCells=function(){var e=this,n,a=this.getHeaderConfig(),o=a.nodes,s=a.spreadsheet,l=(n=s.options)===null||n===void 0?void 0:n.cornerHeader;if(l){l(this,s,this.headerConfig);return}o.forEach(function(u){var c=e.getCellInstance(u);e.appendChild(c),s.emit(S2Event.CORNER_CELL_RENDER,c),s.emit(S2Event.LAYOUT_CELL_RENDER,c)})},r.prototype.offset=function(){var e=this.getHeaderConfig().scrollX,n=e===void 0?0:e;translateGroupX(this,-n)},r.prototype.clip=function(){var e=this.getHeaderConfig(),n=e.width,a=e.height;this.style.clipPath=new Rect({style:{x:0,y:0,width:n,height:a}})},r.prototype.getNodes=function(){return this.headerConfig.nodes||[]},r}(BaseHeader);function floor(t,r){return r===void 0&&(r=2),floor$2(t,r)}var Frame=function(t){__extends(r,t);function r(e){var n=t.call(this)||this;return n.cfg=e,n.render(),n}return r.prototype.layout=function(){this.addCornerBottomBorder(),this.addCornerRightBorder(),this.addSplitLineShadow()},r.prototype.render=function(){this.removeChildren(),this.layout()},r.getHorizontalBorderWidth=function(e){var n,a=((n=e.theme)===null||n===void 0?void 0:n.splitLine).horizontalBorderWidth;return a},r.getVerticalBorderWidth=function(e){var n,a=e.theme,o=a.splitLine,s=a.cornerCell,l=a.colCell,u=a.dataCell;return e.isPivotMode()?o==null?void 0:o.verticalBorderWidth:Math.max(u.cell.verticalBorderWidth,!((n=e.options.seriesNumber)===null||n===void 0)&&n.enable?s.cell.verticalBorderWidth:l.cell.verticalBorderWidth)},r.prototype.onBorderScroll=function(e){this.cfg.scrollX=e;var n=this.cfg.position;translateGroup(this,n.x-e,0),this.render()},r.prototype.onChangeShadowVisibility=function(e,n){this.cfg.showViewportLeftShadow=e>0,this.cfg.showViewportRightShadow=floor(e)<floor(n),this.render()},r.prototype.addCornerRightBorder=function(){var e,n,a=this.cfg,o=a.cornerWidth,s=a.cornerHeight,l=a.viewportHeight,u=a.position,c=a.spreadsheet,d=(e=c.theme)===null||e===void 0?void 0:e.splitLine,f=d.verticalBorderColor,h=d.verticalBorderColorOpacity,p=d.horizontalBorderWidth,v=r.getVerticalBorderWidth(c),g=u.x+o+v/2;if(c.isPivotMode()){var y=u.y+s+p+l;renderLine(this,{x1:g,y1:u.y,x2:g,y2:y,stroke:f,lineWidth:v,opacity:h});return}var m=!((n=c.options.seriesNumber)===null||n===void 0)&&n.enable?c.theme.cornerCell.cell:c.theme.colCell.cell,S=m.verticalBorderColor,w=m.verticalBorderColorOpacity;renderLine(this,{x1:g,y1:u.y,x2:g,y2:u.y+s,stroke:S,lineWidth:v,opacity:w});var R=c.theme.dataCell.cell,T=R.verticalBorderColor,x=R.verticalBorderColorOpacity;renderLine(this,{x1:g,y1:u.y+s+p,x2:g,y2:u.y+s+p+l,stroke:T,lineWidth:v,opacity:x})},r.prototype.addCornerBottomBorder=function(){var e,n=this.cfg,a=n.cornerWidth,o=n.cornerHeight,s=n.viewportWidth,l=n.position,u=n.scrollX,c=u===void 0?0:u,d=n.spreadsheet,f=(e=d.theme)===null||e===void 0?void 0:e.splitLine,h=f.horizontalBorderColor,p=f.horizontalBorderWidth,v=f.horizontalBorderColorOpacity,g=l.x,y=g+a+r.getVerticalBorderWidth(d)+s+(d.isFrozenRowHeader()?0:c),m=l.y+o+p/2;renderLine(this,{x1:g,y1:m,x2:y,y2:m,stroke:h,lineWidth:p,opacity:v})},r.prototype.addSplitLineShadow=function(){var e,n=this.cfg,a=n.spreadsheet,o=(e=a.theme)===null||e===void 0?void 0:e.splitLine;!a.isPivotMode()||!(o!=null&&o.showShadow)||!a.isFrozenRowHeader()||(this.addSplitLineLeftShadow(),this.addSplitLineRightShadow())},r.prototype.addSplitLineLeftShadow=function(){var e;if(this.cfg.showViewportLeftShadow){var n=this.cfg,a=n.cornerWidth,o=n.cornerHeight,s=n.viewportHeight,l=n.position,u=n.spreadsheet,c=(e=u.theme)===null||e===void 0?void 0:e.splitLine,d=c.shadowColors,f=c.shadowWidth,h=c.horizontalBorderWidth,p=l.x+a+r.getVerticalBorderWidth(u),v=l.y;this.appendChild(new Rect({style:{x:p,y:v,width:f,height:o+h+s,fill:"l (0) 0:".concat(d==null?void 0:d.left," 1:").concat(d==null?void 0:d.right)}}))}},r.prototype.addSplitLineRightShadow=function(){var e;if(this.cfg.showViewportRightShadow){var n=this.cfg,a=n.cornerWidth,o=n.cornerHeight,s=n.viewportHeight,l=n.viewportWidth,u=n.position,c=n.spreadsheet,d=(e=c.theme)===null||e===void 0?void 0:e.splitLine,f=d.shadowColors,h=d.shadowWidth,p=d.horizontalBorderWidth,v=u.x+a+r.getVerticalBorderWidth(c)+l-h,g=u.y;this.appendChild(new Rect({style:{x:v,y:g,width:h,height:o+p+s,fill:"l (0) 0:".concat(f==null?void 0:f.right," 1:").concat(f==null?void 0:f.left)}}))}},r}(Group),RowHeader=function(t){__extends(r,t);function r(e){var n=t.call(this,e)||this;return n.initGroups(),n}return r.prototype.initGroups=function(){this.scrollGroup=this.appendChild(new Group({name:KEY_GROUP_ROW_SCROLL,style:{zIndex:FRONT_GROUND_GROUP_SCROLL_Z_INDEX}})),this.frozenRowGroup=this.appendChild(new Group({name:KEY_GROUP_ROW_HEADER_FROZEN,style:{zIndex:FRONT_GROUND_GROUP_FROZEN_Z_INDEX}}))},r.prototype.getCellInstance=function(e){var n=this.getHeaderConfig(),a=n.spreadsheet,o=a.options.rowCell;return(o==null?void 0:o(e,a,n))||new RowCell(e,a,n)},r.prototype.isRowCellInRect=function(e){var n=this.getHeaderConfig(),a=n.width,o=n.viewportHeight,s=n.position,l=n.scrollY,u=l===void 0?0:l,c=n.scrollX,d=c===void 0?0:c;return this.isFrozenRow(e)?!0:o+u>e.y&&u<e.y+e.height&&a-s.x+d>e.x&&d-s.x<e.x+e.width},r.prototype.isFrozenRow=function(e){var n=this.headerConfig.spreadsheet,a=n.facet,o=getFrozenRowCfgPivot(n.options,a.getRowNodes()).rowCount,s=o===void 0?0:o;return s>0&&e.rowIndex>=0&&e.rowIndex<s},r.prototype.getCellGroup=function(e){return this.isFrozenRow(e)?this.frozenRowGroup:this.scrollGroup},r.prototype.layout=function(){var e=this,n=this.getHeaderConfig(),a=n.nodes,o=n.spreadsheet;forEach(a,function(s){if(e.isRowCellInRect(s)&&s.height!==0){var l=e.getCellGroup(s);s.isFrozen=l!==e.scrollGroup;var u=e.getCellInstance(s);s.belongsCell=u,l.appendChild(u),o.emit(S2Event.ROW_CELL_RENDER,u),o.emit(S2Event.LAYOUT_CELL_RENDER,u)}})},r.prototype.offset=function(){var e=this.getHeaderConfig(),n=e.scrollX,a=n===void 0?0:n,o=e.scrollY,s=o===void 0?0:o,l=e.position,u=l.x-a;translateGroup(this.scrollGroup,u,l.y-s),translateGroup(this.frozenRowGroup,u,l.y)},r.prototype.clip=function(){var e=this.getHeaderConfig(),n=e.width,a=e.viewportHeight,o=e.position,s=e.spreadsheet,l=s.facet.frozenGroupInfo[FrozenGroupType.FROZEN_ROW].height;this.scrollGroup.style.clipPath=new Rect({style:{x:s.facet.cornerBBox.x,y:o.y+l,width:n,height:a}}),this.frozenRowGroup.style.clipPath=new Rect({style:{x:s.facet.cornerBBox.x,y:o.y,width:n,height:l}})},r.prototype.clear=function(){var e,n;(e=this.scrollGroup)===null||e===void 0||e.removeChildren(),(n=this.frozenRowGroup)===null||n===void 0||n.removeChildren()},r}(BaseHeader),SeriesNumberCell=function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return Object.defineProperty(r.prototype,"cellType",{get:function(){return CellType.ROW_CELL},enumerable:!1,configurable:!0}),r.prototype.getBorderPositions=function(){return[CellBorderPosition.LEFT,CellBorderPosition.BOTTOM]},r.prototype.initCell=function(){this.drawBackgroundShape(),this.drawInteractiveBgShape(),this.drawInteractiveBorderShape(),this.drawBorders(),this.drawTextShape(),this.update()},r.prototype.getBackgroundColor=function(){var e=this.getCrossBackgroundColor(this.meta.rowIndex),n=e.backgroundColor,a=e.backgroundColorOpacity;return{backgroundColor:n,backgroundColorOpacity:a,intelligentReverseTextColor:!1}},r.prototype.getTextStyle=function(){var e,n=this.getCellTextWordWrapStyle(CellType.SERIES_NUMBER_CELL),a=(e=this.getStyle())===null||e===void 0?void 0:e.seriesText;return __assign(__assign({},n),a)},r.prototype.getFormattedFieldValue=function(){var e=this.meta.value;return{value:e,formattedValue:e}},r.prototype.getMaxTextWidth=function(){var e=this.getBBoxByType(CellClipBox.CONTENT_BOX).width;return e},r.prototype.getTextPosition=function(){var e,n,a=this.headerConfig,o=a.scrollY,s=a.viewportHeight,l=this.getTextStyle(),u=this.getStyle().cell,c={start:o,size:s},d=this.getBBoxByType(CellClipBox.CONTENT_BOX),f=adjustTextIconPositionWhileScrolling(c,{start:d.y,size:d.height},{align:normalizeTextAlign(l.textBaseline),size:{textSize:l.fontSize},padding:{start:(e=u==null?void 0:u.padding)===null||e===void 0?void 0:e.top,end:(n=u==null?void 0:u.padding)===null||n===void 0?void 0:n.bottom}}).textStart,h=getHorizontalTextIconPosition({bbox:d,textAlign:l.textAlign,textWidth:this.getActualTextWidth(),iconStyle:this.getIconStyle(),groupedIcons:this.groupedIcons}).textX;return{x:h,y:f}},r.prototype.isBolderText=function(){return!1},r.prototype.findFieldCondition=function(){},r.prototype.mappingValue=function(){},r.prototype.getIconPosition=function(){return{x:0,y:0}},r}(HeaderCell),getSeriesNumberNodes=function(t,r,e){var n=e.isHierarchyTreeType(),a=t.getNodes(0);return a.map(function(o,s){var l="".concat(s+1),u=new Node$1({id:l,field:"",rowIndex:s,value:l});return u.x=o.x,u.y=o.y,u.width=r,u.height=n?o.getTotalHeightForTreeHierarchy():o.height,u.isLeaf=!0,u.spreadsheet=e,u})},SeriesNumberHeader=function(t){__extends(r,t);function r(e){return t.call(this,e)||this}return r.prototype.getCellInstance=function(e){var n=this.getHeaderConfig(),a=n.spreadsheet,o=a.options.seriesNumberCell;return(o==null?void 0:o(e,a,n))||new SeriesNumberCell(e,a,n)},r.getSeriesNumberHeader=function(e){var n,a,o=e.panelBBox,s=e.seriesNumberWidth,l=e.rowsHierarchy,u=e.spreadsheet,c=e.cornerWidth,d=o.height,f=o.viewportHeight,h=(a=(n=u.options)===null||n===void 0?void 0:n.layoutSeriesNumberNodes)!==null&&a!==void 0?a:getSeriesNumberNodes;return new r({width:c,height:d,viewportWidth:c,viewportHeight:f,position:{x:0,y:o.y},nodes:h(l,s,u),spreadsheet:u})},r.prototype.clip=function(){var e=this.getHeaderConfig(),n=e.width,a=e.height,o=e.viewportHeight,s=e.position,l=e.spreadsheet;this.style.clipPath=new Rect({style:{x:l.facet.cornerBBox.x,y:s.y,width:n,height:a+o}})},r.prototype.layout=function(){var e=this,n=this.getHeaderConfig(),a=n.nodes,o=n.scrollY,s=o===void 0?0:o,l=n.viewportHeight,u=n.spreadsheet;forEach(a,function(c){var d=c.y,f=c.height,h=e.isHeaderCellInViewport({cellPosition:d,cellSize:f,viewportPosition:s,viewportSize:l});if(h){var p=e.getCellInstance(c);c.belongsCell=p,e.appendChild(p),u.emit(S2Event.SERIES_NUMBER_CELL_RENDER,p),u.emit(S2Event.LAYOUT_CELL_RENDER,p)}})},r.prototype.offset=function(){var e=this.getHeaderConfig(),n=e.scrollY,a=n===void 0?0:n,o=e.scrollX,s=o===void 0?0:o,l=e.position;translateGroup(this,l.x-s,l.y-a)},r.prototype.getNodes=function(){var e=this.getHeaderConfig().nodes;return e||[]},r}(BaseHeader),getHiddenColumnFieldKey=function(t){var r=t.includes(NODE_ID_SEPARATOR)?"id":"field";return r},getHiddenColumnNodes=function(t,r){r===void 0&&(r=[]);var e=t.facet.getInitColLeafNodes();return compact(r.map(function(n){var a=getHiddenColumnFieldKey(n);return e.find(function(o){return o[a]===n})}))},getHiddenColumnDisplaySiblingNode=function(t,r){if(r===void 0&&(r=[]),isEmpty(r))return{prev:null,next:null};var e=t.facet.getInitColLeafNodes(),n=getHiddenColumnNodes(t,r).map(function(u){return u==null?void 0:u.colIndex}),a=Math.max.apply(Math,__spreadArray([],__read(n),!1)),o=Math.min.apply(Math,__spreadArray([],__read(n),!1)),s=e.find(function(u){return u.colIndex===a+1}),l=e.find(function(u){return u.colIndex===o-1});return{prev:l||null,next:s||null}},getHiddenColumnsThunkGroup=function(t,r){if(isEmpty(r))return[];var e=Number.NEGATIVE_INFINITY;return t.reduce(function(n,a,o){if(!r.includes(a))return n;if(o===e+1){var s=last(n);s==null||s.push(a)}else{var l=[a];n.push(l)}return e=o,n},[])},hideColumns=function(t,r,e){return r===void 0&&(r=[]),e===void 0&&(e=!1),__awaiter(void 0,void 0,void 0,function(){var n,a,o,s,l,u,c,d,f;return __generator(this,function(h){switch(h.label){case 0:return n=function(p,v){return p===void 0&&(p=[]),v===void 0&&(v=[]),__awaiter(void 0,void 0,void 0,function(){return __generator(this,function(g){switch(g.label){case 0:return t.setOptions({interaction:{hiddenColumnFields:p}}),t.interaction.reset(),t.store.set("hiddenColumnsDetail",v),[4,t.render({reloadData:!1,reBuildHiddenColumnsDetail:!1})];case 1:return g.sent(),[2]}})})},isEmpty(r)&&e?[4,n()]:[3,2];case 1:return h.sent(),[2];case 2:return a=t.store.get("hiddenColumnsDetail",[]),o=t.options.interaction.hiddenColumnFields,s=o===void 0?[]:o,isEqual(r,s)&&!e?[2]:(l=uniq(__spreadArray(__spreadArray([],__read(r),!1),__read(s),!1)),u=getHiddenColumnNodes(t,l).every(function(p,v,g){var y=g[v+1];return!y||Math.abs(p.colIndex-y.colIndex)===1}),c=getHiddenColumnDisplaySiblingNode(t,u?l:r),d={hideColumnNodes:getHiddenColumnNodes(t,r),displaySiblingNode:c},f=__spreadArray(__spreadArray([],__read(a),!1),[d],!1),t.emit(S2Event.COL_CELL_HIDDEN,d,f),[4,n(l,f)]);case 3:return h.sent(),[2]}})})},getColumns=function(t){var r=t.dataCfg.fields.columns,e=r===void 0?[]:r;return t.isTableMode()&&!t.isCustomColumnFields()?e:t.facet.getInitColLeafNodes().map(function(n){var a=n.id;return a})},hideColumnsByThunkGroup=function(t,r,e){return r===void 0&&(r=[]),e===void 0&&(e=!1),__awaiter(void 0,void 0,void 0,function(){var n,a,o;return __generator(this,function(s){switch(s.label){case 0:return isEmpty(r)&&e?[4,hideColumns(t,r,!0)]:[3,2];case 1:s.sent(),s.label=2;case 2:return n=getColumns(t),a=getLeafColumnsWithKey(n),o=getHiddenColumnsThunkGroup(a,r),[4,Promise.all(o.map(function(l){return __awaiter(void 0,void 0,void 0,function(){return __generator(this,function(u){switch(u.label){case 0:return[4,hideColumns(t,l,e)];case 1:return u.sent(),[2]}})})}))];case 3:return s.sent(),[2]}})})},isLastColumnAfterHidden=function(t,r){var e=t.facet.getColNodes(),n=t.facet.getInitColLeafNodes(),a=getHiddenColumnFieldKey(r);return get(last(e),a)===r&&get(last(n),a)!==r},getValidDisplaySiblingNode=function(t){return(t==null?void 0:t.next)||(t==null?void 0:t.prev)},getValidDisplaySiblingNodeId=function(t){var r=getValidDisplaySiblingNode(t);return r==null?void 0:r.id},isEqualDisplaySiblingNodeId=function(t,r){return getValidDisplaySiblingNodeId(t)===r},ColCell=function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return Object.defineProperty(r.prototype,"cellType",{get:function(){return CellType.COL_CELL},enumerable:!1,configurable:!0}),r.prototype.getBorderPositions=function(){return[CellBorderPosition.TOP,CellBorderPosition.RIGHT]},r.prototype.initCell=function(){t.prototype.initCell.call(this),this.drawBackgroundShape(),this.drawInteractiveBgShape(),this.drawInteractiveBorderShape(),this.drawTextShape(),this.drawActionAndConditionIcons(),this.drawBorders(),this.drawResizeArea(),this.addExpandColumnIconShapes(),this.update()},r.prototype.getFormattedFieldValue=function(){var e,n=this.meta,a=n.extra,o=n.value,s=n.field,l=this.spreadsheet.dataSet.fields,u=(a==null?void 0:a.isCustomNode)&&((e=l==null?void 0:l.values)===null||e===void 0?void 0:e.includes(s));return u?{formattedValue:o,value:o}:t.prototype.getFormattedFieldValue.call(this)},r.prototype.getMaxTextWidth=function(){var e=this.getBBoxByType(CellClipBox.CONTENT_BOX).width;return e-this.getActionAndConditionIconWidth()},r.prototype.isBolderText=function(){var e=this.meta,n=e.isLeaf,a=e.isTotals;return!!(a||!n)},r.prototype.handleViewport=function(){var e=this.getHeaderConfig(),n=e.width,a=e.cornerWidth,o=a===void 0?0:a,s=e.scrollX,l=s===void 0?0:s,u=!this.spreadsheet.isFrozenRowHeader(),c={start:l-(u?o:0),size:n+(u?o:0)};return c},r.prototype.getTextPosition=function(){var e,n,a,o=this.meta.isLeaf,s=this.getTextStyle(),l=this.getBBoxByType(CellClipBox.CONTENT_BOX),u=this.getIconStyle(),c=getVerticalTextPosition(l,s.textBaseline),d=getVerticalIconPosition(u.size,c,s.fontSize,s.textBaseline);if(o){var f=getHorizontalTextIconPosition({bbox:l,textWidth:this.getActualTextWidth(),textAlign:s.textAlign,groupedIcons:this.groupedIcons,iconStyle:u}),h=f.textX,p=f.leftIconX,v=f.rightIconX;return this.leftIconPosition={x:p,y:d},this.rightIconPosition={x:v,y:d},{x:h,y:c}}var g=this.handleViewport(),y=this.getStyle(),m=y.cell,S=y.icon,w=this.getTextStyle(),R=w.textAlign,T=w.textBaseline,x=adjustTextIconPositionWhileScrolling(g,{start:l.x,size:l.width},{align:normalizeTextAlign(R),size:{textSize:this.getActualTextWidth(),iconStartSize:this.getActionAndConditionIconWidth("left"),iconEndSize:this.getActionAndConditionIconWidth("right")},padding:{start:(e=m==null?void 0:m.padding)===null||e===void 0?void 0:e.left,end:(n=m==null?void 0:m.padding)===null||n===void 0?void 0:n.right,betweenTextAndEndIcon:(a=S==null?void 0:S.margin)===null||a===void 0?void 0:a.left}}),b=x.textStart,L=x.iconStart,M=x.iconEnd,D=getVerticalTextPosition(l,T);return this.leftIconPosition={x:L,y:d},this.rightIconPosition={x:M,y:d},{x:b,y:D}},r.prototype.getColResizeArea=function(){return getOrCreateResizeAreaGroupById(this.spreadsheet,KEY_GROUP_COL_RESIZE_AREA)},r.prototype.getHorizontalResizeAreaName=function(){return"".concat(HORIZONTAL_RESIZE_AREA_KEY_PRE).concat(this.meta.field)},r.prototype.isCrossColumnLeafNode=function(){var e,n=this.spreadsheet.facet.getLayoutResult().colsHierarchy,a=this.meta,o=a.level,s=a.isLeaf;return((e=n==null?void 0:n.sampleNodeForLastLevel)===null||e===void 0?void 0:e.level)!==o&&s},r.prototype.drawHorizontalResizeArea=function(){var e,n,a=((n=(e=this.spreadsheet.options.style)===null||e===void 0?void 0:e.colCell)===null||n===void 0?void 0:n.height)===0;if(!(a||!this.shouldDrawResizeAreaByType("colCellVertical",this))){var o=this.meta,s=o.y,l=o.height,u=this.getResizeAreaStyle(),c=this.getColResizeArea();if(!(!c||this.isCrossColumnLeafNode())){var d=this.getHorizontalResizeAreaName(),f=c==null?void 0:c.find(function(v){return v.name===d});if(!f){var h=this.getResizeAreaWidth(),p=getResizeAreaAttrs({theme:u,type:ResizeDirectionType.Vertical,effect:ResizeAreaEffect.Field,offsetX:0,offsetY:s,width:h,height:l,meta:this.meta});c.appendChild(new CustomRect({name:d,style:__assign(__assign({},p.style),{x:0,y:s+l-u.size,width:h})},p.appendInfo))}}}},r.prototype.getResizeAreaWidth=function(){var e=this.getHeaderConfig(),n=e.cornerWidth,a=n===void 0?0:n,o=e.viewportWidth;return Frame.getVerticalBorderWidth(this.spreadsheet)+a+o},r.prototype.shouldAddVerticalResizeArea=function(){var e=this.meta,n=e.x,a=e.y,o=e.width,s=e.height,l=this.getHeaderConfig(),u=l.scrollX,c=l.scrollY,d=l.cornerWidth,f=d===void 0?0:d,h=l.height,p=l.width,v=!this.spreadsheet.isFrozenRowHeader(),g=this.getResizeAreaStyle(),y={x:n+o-g.size,y:a,width:g.size,height:s},m={x:v?-f:0,y:0,width:v?f+p:p,height:h};return shouldAddResizeArea(y,m,{scrollX:u,scrollY:c})},r.prototype.getVerticalResizeAreaOffset=function(){var e=this.meta,n=e.x,a=e.y,o=this.getHeaderConfig(),s=o.scrollX,l=s===void 0?0:s,u=o.position;return{x:(u==null?void 0:u.x)+n-l,y:(u==null?void 0:u.y)+a}},r.prototype.drawVerticalResizeArea=function(){if(!(!this.meta.isLeaf||!this.shouldDrawResizeAreaByType("colCellHorizontal",this))){var e=this.meta,n=e.width,a=e.height,o=this.getResizeAreaStyle(),s=this.getColResizeArea();if(!(!s||!this.shouldAddVerticalResizeArea())){var l=this.getVerticalResizeAreaOffset(),u=l.x,c=l.y,d=getResizeAreaAttrs({theme:o,type:ResizeDirectionType.Horizontal,effect:ResizeAreaEffect.Cell,offsetX:u,offsetY:c,width:n,height:a,meta:this.meta});s.appendChild(new CustomRect({style:__assign(__assign({},d.style),{x:u+n-o.size,y:c,height:a})},d.appendInfo))}}},r.prototype.drawResizeArea=function(){this.drawHorizontalResizeArea(),this.drawVerticalResizeArea()},r.prototype.hasHiddenColumnCell=function(){var e=this,n,a=this.spreadsheet.options,o=a.interaction,s=a.tooltip,l=this.spreadsheet.store.get("hiddenColumnsDetail",[]);return isEmpty(l)||isEmpty(o==null?void 0:o.hiddenColumnFields)||!(!((n=s==null?void 0:s.operation)===null||n===void 0)&&n.hiddenColumns)?!1:!!l.find(function(u){return isEqualDisplaySiblingNodeId(u==null?void 0:u.displaySiblingNode,e.meta.id)})},r.prototype.getExpandIconTheme=function(){var e=this.getStyle();return e.icon},r.prototype.addExpandColumnSplitLine=function(){var e=this.getBBoxByType(),n=e.x,a=e.y,o=e.width,s=e.height,l=this.theme.splitLine,u=l.horizontalBorderColor,c=l.horizontalBorderColorOpacity,d=this.isLastColumn()?n+o:n;renderLine(this,{x1:d,y1:a,x2:d,y2:a+s,stroke:u,lineWidth:SPLIT_LINE_WIDTH,strokeOpacity:c})},r.prototype.addExpandColumnIconShapes=function(){this.hasHiddenColumnCell()&&(this.addExpandColumnSplitLine(),this.addExpandColumnIcons())},r.prototype.addExpandColumnIcons=function(){var e=this.isLastColumn();this.addExpandColumnIcon(e),this.isAllDisplaySiblingNodeHidden()&&e&&this.addExpandColumnIcon(!1)},r.prototype.addExpandColumnIcon=function(e){var n=this,a=this.getExpandColumnIconConfig(e),o=renderIcon(this,__assign(__assign({},a),{name:"ExpandColIcon",cursor:"pointer"}));o.addEventListener("click",function(){n.spreadsheet.emit(S2Event.COL_CELL_EXPANDED,n.meta)})},r.prototype.getExpandColumnIconConfig=function(e){var n=this.getExpandIconTheme().size,a=n===void 0?0:n,o=this.getBBoxByType(),s=o.x,l=o.y,u=o.width,c=o.height,d=s-a,f=e?d+u:d,h=l+c/2-a/2;return{x:f,y:h,width:a*2,height:a}},r.prototype.isLastColumn=function(){return isLastColumnAfterHidden(this.spreadsheet,this.meta.id)},r.prototype.isAllDisplaySiblingNodeHidden=function(){var e=this.meta.id,n=this.spreadsheet.store.get("hiddenColumnsDetail",[]),a=n.find(function(s){var l,u=s.displaySiblingNode;return((l=u==null?void 0:u.next)===null||l===void 0?void 0:l.id)===e}),o=n.find(function(s){var l,u=s.displaySiblingNode;return((l=u==null?void 0:u.prev)===null||l===void 0?void 0:l.id)===e});return o&&a},r}(HeaderCell),TableColCell=function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.handleRestOptions=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var a=__read(e,1),o=a[0];this.headerConfig=__assign({},o);var s=this.meta.field,l=this.spreadsheet.dataCfg.sortParams,u=find(l,function(d){return(d==null?void 0:d.sortFieldId)===s}),c=getSortTypeIcon(u,!0);this.headerConfig.sortParam=__assign(__assign(__assign({},this.headerConfig.sortParam),u||{}),{type:c})},r.prototype.getFormattedFieldValue=function(){return formattedFieldValue(this.meta,this.spreadsheet.dataSet.getFieldName(this.meta.field))},r.prototype.shouldAddVerticalResizeArea=function(){if(this.getMeta().isFrozen)return!0;var e=this.getHeaderConfig(),n=e.scrollX,a=e.scrollY,o=e.width,s=e.height,l=e.spreadsheet,u=this.getBBoxByType(),c=u.x,d=u.y,f=u.width,h=u.height,p=this.getResizeAreaStyle(),v={x:c+f-p.size,y:d,width:p.size,height:h},g=l.facet.frozenGroupInfo,y=g[FrozenGroupType.FROZEN_COL].width,m=g[FrozenGroupType.FROZEN_TRAILING_COL].width,S={x:y,y:0,width:o-y-m,height:s};return shouldAddResizeArea(v,S,{scrollX:n,scrollY:a})},r.prototype.getVerticalResizeAreaOffset=function(){var e=this.meta,n=e.x,a=e.y,o=this.getHeaderConfig(),s=o.scrollX,l=s===void 0?0:s,u=o.position;return this.getMeta().isFrozen?{x:(u==null?void 0:u.x)+n,y:(u==null?void 0:u.y)+a}:{x:(u==null?void 0:u.x)+n-l,y:(u==null?void 0:u.y)+a}},r.prototype.getColResizeArea=function(){return this.getMeta().isFrozen?getOrCreateResizeAreaGroupById(this.spreadsheet,KEY_GROUP_FROZEN_COL_RESIZE_AREA):t.prototype.getColResizeArea.call(this)},r.prototype.isSortCell=function(){return!0},r.prototype.showSortIcon=function(){return this.spreadsheet.options.showDefaultHeaderActionIcon},r.prototype.getTextStyle=function(){var e,n=this.getCellTextWordWrapStyle(),a=(e=this.getStyle())===null||e===void 0?void 0:e.bolderText;return __assign(__assign({},n),a)},r.prototype.getHorizontalResizeAreaName=function(){return"".concat(HORIZONTAL_RESIZE_AREA_KEY_PRE).concat(this.meta.id)},r.prototype.drawBackgroundShape=function(){var e=this.getStyle().cell||{},n=e.backgroundColor,a=e.backgroundColorOpacity;this.backgroundShape=renderRect(this,__assign(__assign({},this.getBBoxByType()),{fill:n,fillOpacity:a}))},r.prototype.handleViewport=function(){var e=t.prototype.handleViewport.call(this);return this.getMeta().isFrozen&&(e.start=0),e},r}(ColCell),TableCornerCell=function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.getStyle=function(e){var n;return e?get(this.theme,e):(n=this.theme)===null||n===void 0?void 0:n.cornerCell},r.prototype.showSortIcon=function(){return!1},r}(TableColCell),TableDataCell=function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.getLinkFieldStyle=function(){return this.theme.rowCell.text.linkTextFill},r.prototype.drawBorders=function(){this.meta.isFrozenCorner&&BaseCell.prototype.drawBorders.call(this)},r.prototype.shouldDrawResizeArea=function(){var e="".concat(this.meta.rowIndex),n=getOrCreateResizeAreaGroupById(this.spreadsheet,KEY_GROUP_ROW_RESIZE_AREA),a=getOrCreateResizeAreaGroupById(this.spreadsheet,KEY_GROUP_FROZEN_ROW_RESIZE_AREA);return!(n!=null&&n.getElementById(e))&&!(a!=null&&a.getElementById(e))},r.prototype.drawResizeArea=function(){if(this.shouldDrawResizeArea()){var e=this.getBBoxByType(),n=e.y,a=e.height,o=this.meta.rowIndex,s=this.getResizeAreaStyle(),l=this.spreadsheet.options.frozen,u=l.rowCount,c=u===void 0?0:u,d=l.trailingRowCount,f=d===void 0?0:d,h=this.spreadsheet.facet.getCellRange(),p=isFrozenRow(o,h.start,c),v=isFrozenTrailingRow(o,h.end,f),g=p||v,y=g?KEY_GROUP_FROZEN_ROW_RESIZE_AREA:KEY_GROUP_ROW_RESIZE_AREA,m=getOrCreateResizeAreaGroupById(this.spreadsheet,y);if(m){var S=this.spreadsheet.facet.columnHeader.getHeaderConfig(),w=S.height,R=S.viewportWidth,T=this.spreadsheet.facet.getScrollOffset().scrollY,x=this.spreadsheet.facet.getPaginationScrollY(),b=n+w+Frame.getHorizontalBorderWidth(this.spreadsheet),L=this.spreadsheet.facet.frozenGroupInfo,M=L[FrozenGroupType.FROZEN_ROW].height,D=L[FrozenGroupType.FROZEN_TRAILING_ROW].height,N={x:0,y:n+a-s.size,width:R,height:s.size},F={x:0,y:M,width:R,height:this.spreadsheet.facet.panelBBox.height-M-D};if(!(!g&&!shouldAddResizeArea(N,F,{scrollX:0,scrollY:T}))){g||(b-=T+x);var k=R+Frame.getVerticalBorderWidth(this.spreadsheet),H=getResizeAreaAttrs({theme:s,type:ResizeDirectionType.Vertical,effect:ResizeAreaEffect.Cell,offsetX:0,offsetY:b,width:k,height:a,meta:this.meta});m.appendChild(new CustomRect({style:__assign(__assign({},H.style),{x:0,y:b+a-s.size,width:k})},H.appendInfo))}}}},r.prototype.isDisableHover=function(e){return(e==null?void 0:e.type)===CellType.COL_CELL},r}(DataCell),TableSeriesNumberCell=function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return Object.defineProperty(r.prototype,"cellType",{get:function(){return CellType.DATA_CELL},enumerable:!1,configurable:!0}),r.prototype.getTextStyle=function(){var e=this.getCellTextWordWrapStyle(CellType.SERIES_NUMBER_CELL),n=this.theme.rowCell.seriesText;return __assign(__assign({},e),n)},r}(TableDataCell),getAllChildrenNodeHeight=function(t){var r=0,e=t.children;return e==null||e.forEach(function(n){r+=n.height||0}),r},RowCell=function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return Object.defineProperty(r.prototype,"cellType",{get:function(){return CellType.ROW_CELL},enumerable:!1,configurable:!0}),r.prototype.getBorderPositions=function(){return[CellBorderPosition.BOTTOM,CellBorderPosition.LEFT]},r.prototype.initCell=function(){t.prototype.initCell.call(this),this.drawBackgroundShape(),this.drawInteractiveBgShape(),this.drawInteractiveBorderShape(),this.drawTextShape(),this.drawActionAndConditionIcons(),this.drawTreeIcon(),this.drawTreeLeafNodeAlignDot(),this.drawBorders(),this.drawResizeAreaInLeaf(),this.update()},r.prototype.getBackgroundColor=function(){var e=this.getCrossBackgroundColor(this.meta.rowIndex),n=e.backgroundColor,a=e.backgroundColorOpacity;return merge({backgroundColor:n,backgroundColorOpacity:a},this.getBackgroundConditionFill())},r.prototype.showTreeIcon=function(){return this.spreadsheet.isHierarchyTreeType()&&!this.meta.isLeaf},r.prototype.showTreeLeafNodeAlignDot=function(){var e,n;return((n=(e=this.spreadsheet.options.style)===null||e===void 0?void 0:e.rowCell)===null||n===void 0?void 0:n.showTreeLeafNodeAlignDot)&&this.spreadsheet.isHierarchyTreeType()},r.prototype.getParentTreeIconCfg=function(){var e;if(!(!this.showTreeLeafNodeAlignDot()||!this.spreadsheet.isHierarchyTreeType()||!this.meta.isLeaf)){var n=((e=this.meta.parent)===null||e===void 0?void 0:e.belongsCell).getTreeIcon();return n==null?void 0:n.style}},r.prototype.onTreeIconClick=function(){var e=this.meta,n=e.isCollapsed,a=e.hierarchy;if(!isMobile()){if(!n){var o=this.spreadsheet.facet.getScrollOffset().scrollY,s=this.spreadsheet.facet.panelBBox.viewportHeight||0,l=getAllChildrenNodeHeight(this.meta),u=a.height-l;if(o>0&&o+s>u){var c=u-s;this.spreadsheet.facet.setScrollOffset({scrollY:c>0?c:0})}}this.emitCollapseEvent()}},r.prototype.emitCollapseEvent=function(){this.spreadsheet.emit(S2Event.ROW_CELL_COLLAPSED__PRIVATE,{isCollapsed:!this.meta.isCollapsed,node:this.meta})},r.prototype.drawTreeIcon=function(){var e=this;if(this.showTreeIcon()){var n=this.meta.isCollapsed,a=this.getBBoxByType(CellClipBox.CONTENT_BOX).x,o=this.getTextStyle().fill,s=this.getStyle().icon.size,l=this.getContentIndent(),u=a+l,c=this.getIconPosition().y;this.treeIcon=renderTreeIcon({group:this,iconCfg:{x:u,y:c,width:s,height:s,fill:o},isCollapsed:n,onClick:function(){e.onTreeIconClick()}}),isMobile()&&this.addEventListener("click",function(){e.emitCollapseEvent()})}},r.prototype.drawTreeLeafNodeAlignDot=function(){var e=this.getParentTreeIconCfg();if(e){var n=this.getStyle().icon,a=n.size,o=n.margin,s=e.x+a+o.right,l=this.getTextPosition().y,u=this.getTextStyle(),c=u.fill,d=u.fontSize,f=a/5;this.treeLeafNodeAlignDot=renderCircle(this,{cx:s+a/2,cy:l+(d-f)/2,r:f,fill:c,fillOpacity:.3})}},r.prototype.isBolderText=function(){var e=this.meta,n=e.isLeaf,a=e.isTotals,o=e.level;return!n&&o===0||a},r.prototype.drawTextShape=function(){t.prototype.drawTextShape.call(this),this.isShallowRender()||this.drawLinkField(this.meta)},r.prototype.drawResizeAreaInLeaf=function(){var e;if(!(!this.meta.isLeaf||!this.shouldDrawResizeAreaByType("rowCellVertical",this))){var n=this.getBBoxByType(),a=n.x,o=n.y,s=n.width,l=n.height,u=this.getResizeAreaStyle(),c=getOrCreateResizeAreaGroupById(this.spreadsheet,KEY_GROUP_ROW_RESIZE_AREA);if(c){var d=this.getHeaderConfig(),f=d.position,h=d.width,p=d.viewportHeight,v=d.scrollX,g=v===void 0?0:v,y=d.scrollY,m=y===void 0?0:y,S=d.spreadsheet,w={x:a,y:o+l-u.size,width:s,height:u.size},R=this.getMeta().isFrozen,T=(e=S.facet.frozenGroupInfo[FrozenGroupType.FROZEN_ROW])===null||e===void 0?void 0:e.height,x={x:0,y:T,width:h,height:p};if(!(!R&&!shouldAddResizeArea(w,x,{scrollX:g,scrollY:m}))){var b=f.x+a-g,L=f.y+o-(R?0:m),M=this.spreadsheet.isFrozenRowHeader()?h-f.x-(a-g):s,D=getResizeAreaAttrs({theme:u,type:ResizeDirectionType.Vertical,effect:ResizeAreaEffect.Cell,offsetX:b,offsetY:L,width:s,height:l,meta:this.meta});c.appendChild(new CustomRect({style:__assign(__assign({},D.style),{x:b,y:L+l-u.size,width:M})},D.appendInfo))}}}},r.prototype.getContentIndent=function(){if(!this.spreadsheet.isHierarchyTreeType())return 0;for(var e=this.getStyle(),n=e.icon,a=e.cell,o=n.size+n.margin.right,s=this.meta.parent,l=0;s;)s.height!==0&&(l+=o),s=s.parent;return this.showTreeLeafNodeAlignDot()&&(l+=this.isTreeLevel()?0:a.padding.right+n.margin.right),l},r.prototype.getTextIndent=function(){var e=this.getStyle().icon,n=e.size,a=e.margin,o=this.getContentIndent(),s=this.showTreeIcon()||this.isTreeLevel()&&this.showTreeLeafNodeAlignDot()?n+a.right:0;return o+s},r.prototype.isTreeLevel=function(){return find(get(this.meta,"parent.children"),function(e){return!e.isLeaf})},r.prototype.getMaxTextWidth=function(){var e=this.getBBoxByType(CellClipBox.CONTENT_BOX).width;return e-this.getTextIndent()-this.getActionAndConditionIconWidth()},r.prototype.getTextArea=function(){var e=this.getBBoxByType(CellClipBox.CONTENT_BOX),n=this.getTextIndent();return __assign(__assign({},e),{x:e.x+n,width:e.width-n})},r.prototype.handleViewport=function(){var e=this.getHeaderConfig(),n=e.scrollY,a=e.viewportHeight,o=e.spreadsheet,s=o.facet.frozenGroupInfo[FrozenGroupType.FROZEN_ROW].height,l={start:this.getMeta().isFrozen?0:n+s,size:a-s};return l},r.prototype.getTextPosition=function(){var e=this.getTextArea(),n=this.getTextStyle(),a=this.getStyle(),o=a.cell,s=a.icon,l=this.handleViewport(),u=adjustTextIconPositionWhileScrolling(l,{start:e.y,size:e.height},{align:normalizeTextAlign(n.textBaseline),size:{textSize:n.fontSize},padding:{start:o.padding.top,end:o.padding.bottom}}).textStart,c=getHorizontalTextIconPosition({bbox:e,textWidth:this.getActualTextWidth(),textAlign:n.textAlign,groupedIcons:this.groupedIcons,iconStyle:s}),d=c.textX,f=c.leftIconX,h=c.rightIconX,p=getVerticalIconPosition(s==null?void 0:s.size,u,n.fontSize,n.textBaseline);return this.leftIconPosition={x:f,y:p},this.rightIconPosition={x:h,y:p},{x:d,y:u}},r}(HeaderCell),isMultiSelectionKey=function(t){return[InteractionKeyboardKey.META,InteractionKeyboardKey.CONTROL].includes(t.key)},isMouseEventWithMeta=function(t){return t.ctrlKey||t.metaKey},getCellMeta=function(t){var r=t.getMeta(),e=r||{},n=e.id,a=e.colIndex,o=e.rowIndex,s=e.rowQuery;return{id:n,colIndex:a,rowIndex:o,rowQuery:s,type:t instanceof TableSeriesNumberCell?CellType.ROW_CELL:t.cellType}},selectCells=function(t,r){var e=t.interaction;e.changeState({stateName:InteractionStateName.SELECTED,cells:r}),t.emit(S2Event.GLOBAL_SELECTED,e.getActiveCells())};function getRangeIndex(t,r){var e=Math.min(t.rowIndex,r.rowIndex),n=Math.max(t.rowIndex,r.rowIndex),a=Math.min(t.colIndex,r.colIndex),o=Math.max(t.colIndex,r.colIndex);return{start:{rowIndex:e,colIndex:a},end:{rowIndex:n,colIndex:o}}}function getRowCellForSelectedCell(t,r){var e,n=r.facet,a=r.options;if(r.isTableMode()){if(!(!((e=a.seriesNumber)===null||e===void 0)&&e.enable))return[];var o=n.getColLeafNodes()[0].id,s=getDataCellId(String(t.rowIndex),o),l=[],u=n.getCellById(s);return u&&u instanceof TableSeriesNumberCell&&l.push(u),l}return getActiveHoverHeaderCells(t.rowId,n.getRowCells(),r.isHierarchyTreeType())}var afterSelectDataCells=function(t,r){var e=t.spreadsheet.facet,n=t.getSelectedCellHighlight(),a=n.colHeader,o=n.rowHeader;a&&t.updateCells(e.getColCells()),o&&t.updateCells(e.getRowCells()),r()},clearState=function(t){var r,e=t.store.get("visibleActionIcons"),n=t.interaction.getInteractedCells(),a=t.interaction.getState().cells;if(isEmpty(n)&&isEmpty(a)&&isEmpty(e))return!1;if(forEach(e,function(s){s.setAttribute("visibility","hidden")}),t.store.set("visibleActionIcons",[]),forEach(n,function(s){s.hideInteractionShape()}),t.interaction.resetState(),!((r=t.options.interaction)===null||r===void 0)&&r.selectedCellsSpotlight){var o=t.interaction.getUnSelectedDataCells()||[];forEach(o,function(s){s.clearUnselectedState()})}return!0},setState=function(t,r){var e=r==null?void 0:r.stateName;t.interaction.isEqualStateName(e)||(clearState(t),t.hideTooltip(),t.store.set(INTERACTION_STATE_INFO_KEY,r))},getScrollOffsetForCol=function(t,r,e){var n,a,o=e.facet,s=o.panelBBox.width,l=o==null?void 0:o.frozenGroupInfo,u=(n=l==null?void 0:l.frozenCol.width)!==null&&n!==void 0?n:0,c=(a=l==null?void 0:l.frozenTrailingCol.width)!==null&&a!==void 0?a:0,d=o.getColLeafNodes()[t];return r===ScrollDirection.SCROLL_UP?d.x-u:d.x+d.width-(s-c)},getScrollOffsetForRow=function(t,r,e){var n,a,o=e.facet,s=o.viewCellHeights.getCellOffsetY,l=o.panelBBox.height,u=s(t+1);if(isNil(u))return 0;var c=o==null?void 0:o.frozenGroupInfo,d=(n=c==null?void 0:c.frozenRow.height)!==null&&n!==void 0?n:0,f=(a=c==null?void 0:c.frozenTrailingRow.height)!==null&&a!==void 0?a:0;return r===ScrollDirection.SCROLL_UP?s(t)-d:u-(l-f)},customMerge=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var e=function(a,o){if(isArray(a)&&isArray(o))return o},n=__spreadArray(__spreadArray([],__read(t),!1),[e],!1);return mergeWith.apply(void 0,__spreadArray([{}],__read(n),!1))},uniqueFields=function(t){var r=["rows","columns","values"],e=r.reduce(function(n,a){var o=t[a],s=uniq(o);return isEqual(s,o)||console.warn("fields.".concat(a,":[").concat(o,"] should be unique")),n[a]=s,n},{});return __assign(__assign({},t),e)},setupDataConfig=function(){for(var t,r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var n=customMerge.apply(void 0,__spreadArray([DEFAULT_DATA_CONFIG],__read(r),!1));n.fields=uniqueFields(n.fields);var a=(t=n.fields.rows)===null||t===void 0?void 0:t.some(function(s){return!isString(s)}),o=isEmpty(n.fields.values);return(a||o)&&(n.fields.valueInCols=!1),n},setupOptions=function(t){var r,e,n=customMerge(DEFAULT_OPTIONS,t);return((r=n.style)===null||r===void 0?void 0:r.layoutWidthType)===LayoutWidthType.Compact&&((e=n.style)===null||e===void 0?void 0:e.dataCell.maxLines)<=1&&(n.style.dataCell.wordWrap=!1),n},getAutoAdjustPosition=function(t){var r=t.spreadsheet,e=t.position,n=t.tooltipContainer,a=t.autoAdjustBoundary,o=r.getCanvasElement(),s=e.x+TOOLTIP_POSITION_OFFSET.x,l=e.y+TOOLTIP_POSITION_OFFSET.y;if(!a||!o)return{x:s,y:l};var u=a==="body",c=r.facet.panelBBox,d=c.maxX,f=c.maxY,h=r.options,p=h.width,v=h.height,g=o.getBoundingClientRect(),y=g.top,m=g.left,S=n.getBoundingClientRect(),w=S.width,R=S.height,T=document.body.getBoundingClientRect(),x=T.width,b=T.height,L=u?x:Math.min(p,d)+m,M=u?b:Math.min(v,f)+y;return s+w>=L&&(s=L-w),l+R>=M&&(l=M-R),{x:s,y:l}},getMergedQuery=function(t){return __assign(__assign({},t==null?void 0:t.colQuery),t==null?void 0:t.rowQuery)},setTooltipContainerStyle=function(t,r){var e;if(t){var n=r.style,a=r.className,o=a===void 0?[]:a,s=r.visible;if(n&&Object.assign(t.style,n),o.length){var l=o.filter(Boolean);(e=t.classList).add.apply(e,__spreadArray([],__read(l),!1))}t.classList.toggle(TOOLTIP_CONTAINER_SHOW_CLS,s),t.classList.toggle(TOOLTIP_CONTAINER_HIDE_CLS,!s)}},getFriendlyVal=function(t){var r=isNumber(t)&&Number.isNaN(t),e=t==="";return isNil(t)||r||e?"-":t},getFieldFormatter=function(t,r){var e,n=(e=t==null?void 0:t.dataSet)===null||e===void 0?void 0:e.getFieldFormatter(r);return function(a,o){return getFriendlyVal(n(a,o))}},getListItem=function(t,r){var e,n=r.data,a=r.field,o=r.valueField,s=r.useCompleteDataForFormatter,l=s===void 0?!0:s,u=r.targetCell,c=(t==null?void 0:t.dataSet.getCustomRowFieldName(u))||((e=t==null?void 0:t.dataSet)===null||e===void 0?void 0:e.getFieldName(a)),d=getFieldFormatter(t,a),f=CellData.getFieldValue(n,a),h=isObject(f)?null:f,p=d(o||h,l?n:void 0);return{name:c,value:p}},getFieldList=function(t,r,e){var n=filter(concat([],r),function(a){return a!==EXTRA_FIELD&&CellData.getFieldValue(e,a)});return map(n,function(a){return getListItem(t,{data:e,field:a,useCompleteDataForFormatter:!1})})},getHeadInfo=function(t,r,e){var n,a,o,s,l=(e||{}).isTotals,u=[],c=[];if(r){var d=(a=(n=t==null?void 0:t.dataSet)===null||n===void 0?void 0:n.fields)===null||a===void 0?void 0:a.columns,f=(s=(o=t==null?void 0:t.dataSet)===null||o===void 0?void 0:o.fields)===null||s===void 0?void 0:s.rows;u=getFieldList(t,getLeafColumnsWithKey(d||[]),r),c=getFieldList(t,f,r)}return isEmpty(u)&&isEmpty(c)&&l&&(u=[{value:i18n("总计")}]),{cols:u,rows:c}},getTooltipDetailList=function(t,r,e,n){if(!r)return[];var a=e.isTotals,o=r[EXTRA_FIELD],s=[];return a?s.push(getListItem(t,{data:r,field:o,targetCell:n,valueField:r[VALUE_FIELD]})):s.push(getListItem(t,{data:r,field:o,targetCell:n})),s},getSummaryName=function(t,r,e){var n;if(e)return i18n("总计");var a=(n=t==null?void 0:t.dataSet)===null||n===void 0?void 0:n.getFieldName(r);return a&&a!=="undefined"?a:""},getRowOrColSelectedIndexes=function(t,r,e){e===void 0&&(e=!0);var n=[];return forEach(r,function(a,o){forEach(t,function(s){!e&&s.colIndex!==-1?n.push([o,s.colIndex]):e&&s.rowIndex!==-1&&n.push([s.rowIndex,o])})}),n},getSelectedCellIndexes=function(t){var r,e=t.facet.getRowLeafNodes(),n=t.facet.getColLeafNodes(),a=t.interaction.getState(),o=a.nodes,s=o===void 0?[]:o,l=a.cells,u=l===void 0?[]:l,c=(r=u==null?void 0:u[0])===null||r===void 0?void 0:r.type,d=t.isHierarchyTreeType()?s:s.filter(function(f){return f==null?void 0:f.isLeaf});return c===CellType.COL_CELL?getRowOrColSelectedIndexes(d,e,!1):c===CellType.ROW_CELL?getRowOrColSelectedIndexes(d,n):[]},getSelectedCellsData=function(t,r,e){var n=t.facet,a=function(l){if(!l)return!1;var u=r==null?void 0:r.getMeta(),c=u==null?void 0:u.isTotals,d=(r==null?void 0:r.cellType)===CellType.COL_CELL,f=(r==null?void 0:r.cellType)===CellType.ROW_CELL;if(!d&&!f)return!1;var h=n.getColNodeByIndex(l.colIndex),p=n.getRowNodeByIndex(l.rowIndex),v=d?p==null?void 0:p.isTotals:h==null?void 0:h.isTotals;return!c&&(l==null?void 0:l.isTotals)||c&&v};if(e){var o=getSelectedCellIndexes(t);return compact(map(o,function(l){var u=__read(l,2),c=u[0],d=u[1],f=n.getCellMeta(c,d);if(!a(f))return(f==null?void 0:f.data)||getMergedQuery(f)}))}var s=t.interaction.getCells();return s.filter(function(l){var u=n.getCellMeta(l.rowIndex,l.colIndex);return!a(u)}).map(function(l){var u=n.getCellMeta(l.rowIndex,l.colIndex);return(u==null?void 0:u.data)||getMergedQuery(u)})},getCustomFieldsSummaries=function(t){var r=groupBy(t,"name");return Object.keys(r).map(function(e){var n=r[e],a=flatMap(n,function(l){return l.selectedData}),o=n.filter(function(l){return isNumber(l.value)}),s=isEmpty(o)?null:sumBy(o,"value");return{name:e,selectedData:a,value:s}})},getSummaries=function(t){var r=t.spreadsheet,e=t.targetCell,n=t.options,a=n===void 0?{}:n,o=[],s={},l=r.isTableMode();if(l&&(a!=null&&a.onlyShowCellText)){var u=e==null?void 0:e.getMeta(),c=u!=null&&u.field?r.dataSet.getCellMultiData({query:{field:u.field}}):[r.dataSet.getRowData(u)];return[{selectedData:c,name:"",value:""}]}var d=getSelectedCellsData(r,e,a.onlyShowCellText);return forEach(d,function(f){var h,p=f==null?void 0:f[EXTRA_FIELD];s[p]?(h=s[p])===null||h===void 0||h.push(f):s[p]=[f]}),mapKeys(s,function(f,h){var p,v=r.isCustomHeaderFields()?r==null?void 0:r.dataSet.getCustomRowFieldName(e):getSummaryName(r,h,a==null?void 0:a.isTotals),g="",y="";if(every(f,function(T){return isNotNumber(get(T,VALUE_FIELD))})){var m=r.options.placeholder,S=getEmptyPlaceholder(s,m);g=S,y=S}else{var w=getFieldFormatter(r,h),R=getDataSumByField(f,VALUE_FIELD);y=R,g=(p=w==null?void 0:w(R,f))!==null&&p!==void 0?p:parseFloat(R.toPrecision(PRECISION))}o.push({selectedData:f,name:v||"",value:g,originValue:y})}),r.isCustomHeaderFields()?getCustomFieldsSummaries(o):o},getTooltipData=function(t){var r=t.spreadsheet,e=t.cellInfos,n=e===void 0?[]:e,a=t.options,o=a===void 0?{}:a,s=t.targetCell,l=null,u=[],c=null,d=null,f=r.dataSet.getCustomFieldDescription(s),h=n[0]||{};if(!(o!=null&&o.hideSummary))u=getSummaries({spreadsheet:r,options:o,targetCell:s});else if(o.onlyShowCellText){var p=CellData.getFieldValue(h,"value"),v=CellData.getFieldValue(h,"valueField"),g=getFieldFormatter(r,v),y=g(p),m=o.enableFormat?r.dataSet.getFieldName(p)||y:r.dataSet.getFieldName(v);l=m||""}else c=getHeadInfo(r,h,o),d=getTooltipDetailList(r,h,o,s);var S=h||{},w=S.interpretation,R=S.infos,T=S.tips;return{name:l,summaries:u,interpretation:w,infos:R,tips:T,headInfo:c,details:d,description:f}},mergeCellInfo=function(t){return map(t,function(r){var e=r.getMeta();return assign({},e.query||{},pick(e,["colIndex","rowIndex"]))})},getCellsTooltipData=function(t){if(!t.interaction.isSelectedState())return[];var r=t.dataCfg.fields.valueInCols;return t.interaction.getCells().reduce(function(e,n){var a=t.facet.getCellMeta(n==null?void 0:n.rowIndex,n==null?void 0:n.colIndex),o=getMergedQuery(a);if(isEmpty(a)||isEmpty(o))return[];var s=__assign(__assign({},o),{colIndex:r?a==null?void 0:a.colIndex:null,rowIndex:r?null:a==null?void 0:a.rowIndex}),l=e.find(function(u){return isEqual(s,u)});return l||e.push(s),e},[])},getTooltipOptionsByCellType=function(t,r){t===void 0&&(t={});var e=function(l){return customMerge(t,l)},n=t.colCell,a=t.rowCell,o=t.dataCell,s=t.cornerCell;return r===CellType.COL_CELL?e(n):r===CellType.ROW_CELL?e(a):r===CellType.DATA_CELL?e(o):r===CellType.CORNER_CELL?e(s):__assign({},t)},getTooltipOptions=function(t,r){var e;if(!r||!t)return null;var n=t.options,a=t.interaction,o=(e=t.getCellType)===null||e===void 0?void 0:e.call(t,r==null?void 0:r.target),s=a.getInteractedCells()[0];return getTooltipOptionsByCellType(n.tooltip,o||(s==null?void 0:s.cellType))},getTooltipVisibleOperator=function(t,r){var e,n=r.defaultMenus,a=n===void 0?[]:n,o=r.cell,s=function(u){return u===void 0&&(u=[]),u.filter(function(c){var d;return isFunction(c.visible)?c.visible(o):(d=c.visible)!==null&&d!==void 0?d:!0}).map(function(c){return c.children&&(c.children=s(c.children)),c})},l=s((e=t==null?void 0:t.menu)===null||e===void 0?void 0:e.items);return{menu:__assign(__assign({},t==null?void 0:t.menu),{items:compact(__spreadArray(__spreadArray([],__read(a),!1),__read(l),!1))})}},verifyTheElementInTooltip=function(t,r){for(var e=!1,n=r;n&&n!==document.body;){if(t===n){e=!0;break}n=n.parentElement}return e},clearValueRangeState=function(t){t.store.set(VALUE_RANGES_KEY,DEFAULT_VALUE_RANGES)},setValueRangeState=function(t,r){var e=t.store.get(VALUE_RANGES_KEY,DEFAULT_VALUE_RANGES);t.store.set(VALUE_RANGES_KEY,__assign(__assign({},e),r))},getValueRangeState=function(t,r){var e=t.store.get(VALUE_RANGES_KEY,DEFAULT_VALUE_RANGES);return e[r]},BaseDataSet=function(){function t(r){var e=this;this.displayFormattedValueMap=new Map,this.getField=function(n){var a=isString(n)?n:n==null?void 0:n.field;return a||n},this.getFieldMeta=memoize(function(n,a){var o=e.getField(n);return find(e.meta||a,{field:o})}),this.getCustomFieldDescription=function(n){var a,o;if(n){var s=(a=n.getMeta)===null||a===void 0?void 0:a.call(n);if(!(s!=null&&s.isTotals)){if(n.cellType===CellType.DATA_CELL){var l=find(s==null?void 0:s.spreadsheet.dataCfg.meta,{field:(s==null?void 0:s.field)||(s==null?void 0:s.value)||(s==null?void 0:s.valueField)});return e.getFieldDescription(l==null?void 0:l.field)}return((o=s==null?void 0:s.extra)===null||o===void 0?void 0:o.description)||e.getFieldDescription(s==null?void 0:s.field)}}},this.spreadsheet=r}return t.prototype.getFieldName=function(r,e){var n,a,o=this.getField(r),s=(a=(n=this.spreadsheet)===null||n===void 0?void 0:n.facet)===null||a===void 0?void 0:a.getHeaderNodes().find(function(u){var c;return u.field===o&&((c=u==null?void 0:u.extra)===null||c===void 0?void 0:c.isCustomNode)}),l=(s==null?void 0:s.value)||(isString(r)?r:r==null?void 0:r.title)||r;return get(this.getFieldMeta(o,this.meta),"name",e??l)},t.prototype.getCustomRowFieldName=function(r){var e;if(r){var n=(e=r.getMeta)===null||e===void 0?void 0:e.call(r);if(r.cellType===CellType.DATA_CELL){var a=this.spreadsheet.facet.getRowNodeByIndex(n==null?void 0:n.rowIndex);return(a==null?void 0:a.value)||this.getFieldName(a==null?void 0:a.field)}return(n==null?void 0:n.value)||this.getFieldName(n==null?void 0:n.field)}},t.prototype.getFieldFormatter=function(r){var e=this.getField(r);return get(this.getFieldMeta(e,this.meta),"formatter",identity)},t.prototype.getFieldDescription=function(r){var e=this.getField(r);return get(this.getFieldMeta(e,this.meta),"description")},t.prototype.setDataCfg=function(r){var e,n,a;(a=(n=(e=this.getFieldMeta)===null||e===void 0?void 0:e.cache)===null||n===void 0?void 0:n.clear)===null||a===void 0||a.call(n);var o=this.processDataCfg(r),s=o.fields,l=o.meta,u=o.data,c=o.sortParams,d=o.filterParams;this.fields=s,this.meta=l,this.originData=u,this.sortParams=c,this.filterParams=d,this.displayData=this.originData,this.indexesData={}},t.prototype.processMeta=function(r,e){var n,a;r===void 0&&(r=[]);var o=__spreadArray(__spreadArray([],__read(r),!1),[generateExtraFieldMeta(r,(a=(n=this.spreadsheet)===null||n===void 0?void 0:n.options)===null||a===void 0?void 0:a.cornerExtraFieldText,e)],!1);return o},t.prototype.getDisplayDataSet=function(){return this.displayData||[]},t.prototype.isEmpty=function(){return isEmpty(this.getDisplayDataSet())},t.prototype.getEmptyViewIndexes=function(){return[]},t.prototype.getValueRangeByField=function(r){var e,n=getValueRangeState(this.spreadsheet,r);if(n)return n;var a=compact(map(this.originData,function(s){var l=s[r];return isNil(l)?null:Number.parseFloat(l)})),o={maxValue:max$1(a),minValue:min$1(a)};return setValueRangeState(this.spreadsheet,(e={},e[r]=o,e)),o},t.prototype.moreThanOneValue=function(){var r,e;return((e=(r=this.fields)===null||r===void 0?void 0:r.values)===null||e===void 0?void 0:e.length)>1},t}(),PivotDataSet=function(t){__extends(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.handleDimensionValuesSort=function(){forEach(e.sortParams,function(n){var a=n.sortFieldId,o=n.sortByMeasure;if(a){var s=__spreadArray([],__read(e.sortedDimensionValues[a]||[]),!1),l=handleSortAction({dataSet:e,sortParam:n,originValues:s,isSortByMeasure:!isEmpty(o)});e.sortedDimensionValues[a]=l,e.handlePivotMetaSort(a,l)}})},e.getTotalStatus=function(n){var a=e.fields,o=a.columns,s=a.rows,l=function(u,c){if(c){var d=find(u,function(f){return!has(n,f)});return!!(d&&d!==head(u))}return every(u,function(f){return!has(n,f)})};return{isRowGrandTotal:l(filterExtraDimension(s)),isRowSubTotal:l(s,!0),isColGrandTotal:l(filterExtraDimension(o)),isColSubTotal:l(o,!0)}},e}return r.prototype.getExistValuesByDataItem=function(e,n){return getExistValues(e,n)},r.prototype.setDataCfg=function(e){t.prototype.setDataCfg.call(this,e);var n=this.fields.rows;this.sortedDimensionValues={},this.rowPivotMeta=new Map,this.colPivotMeta=new Map,this.dimensionValuesCache=new Map,this.transformIndexesData(this.originData,n),this.handleDimensionValuesSort()},r.prototype.transformIndexesData=function(e,n){var a=this,o=this.fields,s=o.columns,l=o.values,u=o.valueInCols,c;return DebuggerUtil.getInstance().debugCallback(DEBUG_TRANSFORM_DATA,function(){c=transformIndexesData({rows:n,columns:s,values:l,valueInCols:u,data:e,indexesData:a.indexesData,sortedDimensionValues:a.sortedDimensionValues,rowPivotMeta:a.rowPivotMeta,colPivotMeta:a.colPivotMeta,getExistValuesByDataItem:a.getExistValuesByDataItem}),a.indexesData=c.indexesData,a.rowPivotMeta=c.rowPivotMeta,a.colPivotMeta=c.colPivotMeta,a.sortedDimensionValues=c.sortedDimensionValues}),c},r.prototype.transformDrillDownData=function(e,n,a){var o=this,s,l=Node$1.getFieldPath(a,!0),u=__spreadArray(__spreadArray([],__read(l),!1),[e],!1),c=this.spreadsheet.store,d=a==null?void 0:a.id,f=(s=c.get("drillDownIdPathMap"))!==null&&s!==void 0?s:new Map;f.has(d)&&(forEach(f.get(d),function(p){unset(o.indexesData,p)}),deleteMetaById(this.rowPivotMeta,d));var h=this.transformIndexesData(n,u).paths;f.set(d,h),c.set("drillDownIdPathMap",f)},r.prototype.clearDrillDownData=function(e){var n=this,a=this.spreadsheet.store,o=a.get("drillDownIdPathMap");if(!o)return!1;var s=a.get("drillDownDataCache",[]);if(e){var l=o.get(e);l&&forEach(l,function(p){unset(n.indexesData,p)}),deleteMetaById(this.rowPivotMeta,e),o.delete(e);var u=filter(s,function(p){return o.has(p==null?void 0:p.rowId)});a.set("drillDownDataCache",u);var c=u.map(function(p){return p==null?void 0:p.drillLevel}),d=a.get("drillDownFieldInLevel",[]),f=d.filter(function(p){return includes(c,p==null?void 0:p.drillLevel)});a.set("drillDownFieldInLevel",f)}else{o.clear();var h=this.spreadsheet.store.get("originalDataCfg");isEmpty(h)||this.spreadsheet.setDataCfg(h),this.spreadsheet.store.set("drillItemsNum",-1),this.spreadsheet.store.set("drillDownDataCache",[]),this.spreadsheet.store.set("drillDownFieldInLevel",[])}return a.set("drillDownIdPathMap",o),!0},r.prototype.handlePivotMetaSort=function(e,n){var a=this.fields,o=a.rows,s=a.columns;includes(o,e)?this.rowPivotMeta=getSortedPivotMeta({pivotMeta:this.rowPivotMeta,dimensions:o,sortFieldId:e,sortedDimensionValues:n}):includes(s,e)&&(this.colPivotMeta=getSortedPivotMeta({pivotMeta:this.colPivotMeta,dimensions:s,sortFieldId:e,sortedDimensionValues:n}))},r.prototype.processDataCfg=function(e){var n=e.data,a=e.meta,o=a===void 0?[]:a,s=e.fields,l=e.sortParams,u=l===void 0?[]:l,c=s.columns,d=c===void 0?[]:c,f=s.rows,h=f===void 0?[]:f,p=s.values,v=s.valueInCols,g=s.customValueOrder,y=d,m=h;v?y=this.isCustomMeasuresPosition(g)?this.handleCustomMeasuresOrder(g,y):uniq(__spreadArray(__spreadArray([],__read(d),!1),[EXTRA_FIELD],!1)):m=this.isCustomMeasuresPosition(g)?this.handleCustomMeasuresOrder(g,m):uniq(__spreadArray(__spreadArray([],__read(h),!1),[EXTRA_FIELD],!1));var S=this.processMeta(o,i18n("数值"));return{data:n,meta:S,fields:__assign(__assign({},s),{rows:m,columns:y,values:p}),sortParams:u}},r.prototype.getFieldsAndPivotMetaByField=function(e){var n=this.fields||{},a=n.rows,o=a===void 0?[]:a,s=n.columns,l=s===void 0?[]:s;return o.includes(e)?{dimensions:o,pivotMeta:this.rowPivotMeta}:l.includes(e)?{dimensions:l,pivotMeta:this.colPivotMeta}:{}},r.prototype.getDimensionValues=function(e,n){var a;n===void 0&&(n={});var o=this.getFieldsAndPivotMetaByField(e),s=o.pivotMeta,l=o.dimensions;if(!s||!l)return[];var u=isEmpty(n);if(this.dimensionValuesCache.has(e)&&u)return(a=this.dimensionValuesCache.get(e))!==null&&a!==void 0?a:[];var c=transformDimensionsValues(n,l,MULTI_VALUE),d=getSatisfiedPivotMetaValues({pivotMeta:s,dimensionValues:c,fields:l,fieldIdx:indexOf(l,e),queryType:QueryDataType.DetailOnly,sortedDimensionValues:this.sortedDimensionValues}),f=uniq(d.map(function(h){return h.value}));return u&&this.dimensionValuesCache.set(e,f),f},r.prototype.getTotalValue=function(e,n){var a,o,s=some(n),l=s?n:this.getTotalStatus(e),u=getAggregationAndCalcFuncByQuery(l,(o=this.spreadsheet.options)===null||o===void 0?void 0:o.totals)||{},c=u.aggregation,d=u.calcFunc,f=calcActionByType[c];if(f||d){var h=this.getCellMultiData({query:e,queryType:QueryDataType.DetailOnly}),p=null;return d?p=d(e,h):f&&(p=f(h,VALUE_FIELD)),CellData.getCellData(__assign(__assign({},omit(e,[EXTRA_FIELD])),(a={},a[e[EXTRA_FIELD]]=p,a)),e[EXTRA_FIELD])}},r.prototype.getCellData=function(e){var n,a,o,s=e||{},l=s.query,u=l===void 0?{}:l,c=s.rowNode,d=s.isTotals,f=d===void 0?!1:d,h=s.totalStatus,p=this.fields,v=p.rows,g=p.columns,y=v,m=(n=this.spreadsheet)===null||n===void 0?void 0:n.store.get("drillDownIdPathMap"),S=Array.from((a=m==null?void 0:m.keys())!==null&&a!==void 0?a:[]).some(function(b){return c==null?void 0:c.id.startsWith(b)});c&&S&&(y=(o=Node$1.getFieldPath(c,S))!==null&&o!==void 0?o:v);var w=transformDimensionsValues(u,y),R=transformDimensionsValues(u,g),T=getDataPath({rowDimensionValues:w,colDimensionValues:R,rowPivotMeta:this.rowPivotMeta,colPivotMeta:this.colPivotMeta,rowFields:y,colFields:g,prefix:getDataPathPrefix(y,g)}),x=get(this.indexesData,T);if(x)return CellData.getCellData(x,u[EXTRA_FIELD]);if(f)return this.getTotalValue(u,h)},r.prototype.getQueryExtraFields=function(e){var n=this.fields.values,a=n===void 0?[]:n,o=e[EXTRA_FIELD];return o?includes(a,o)?[o]:[]:a},r.prototype.getCellMultiData=function(e){var n,a,o,s,l=e||{},u=l.query,c=u===void 0?{}:u,d=l.queryType,f=d===void 0?QueryDataType.All:d,h=l.drillDownFields,p=h===void 0?[]:h;isEmpty(c)&&console.warn("query: ".concat(c,` shouldn't be empty, you can get all data from dataCfg if you're intended.
 you should use { EXTRA_FIELD: xxx} as least if you want query all specific value data`));var v=this.fields,g=v.rows,y=v.columns,m=isEmpty(p)?g:g.concat(p),S=transformDimensionsValues(c,m,MULTI_VALUE),w=transformDimensionsValues(c,y,MULTI_VALUE),R=getFlattenDimensionValues({rowDimensionValues:S,colDimensionValues:w,rowPivotMeta:this.rowPivotMeta,colPivotMeta:this.colPivotMeta,rowFields:m,colFields:y,sortedDimensionValues:this.sortedDimensionValues,queryType:f}),T=R.rowQueries,x=R.colQueries,b=getDataPathPrefix(m,y),L=[];try{for(var M=__values(T),D=M.next();!D.done;D=M.next()){var N=D.value;try{for(var F=(o=void 0,__values(x)),k=F.next();!k.done;k=F.next()){for(var H=k.value,G=getDataPath({rowDimensionValues:N,colDimensionValues:H,rowPivotMeta:this.rowPivotMeta,colPivotMeta:this.colPivotMeta,rowFields:m,colFields:y,prefix:b}),z=!1,$=this.indexesData,W=function(j){var ne=G[j];z?isMultiValue(ne)?$=flattenIndexesData($,f):$=compact(map($,function(Q){return Q==null?void 0:Q[ne]})):isMultiValue(ne)?(z=!0,$=compact([$]),j--):$=$==null?void 0:$[ne],V=j},V,X=0;X<G.length;X++)W(X),X=V;isArray($)?L.push.apply(L,__spreadArray([],__read($),!1)):$&&L.push($)}}catch(j){o={error:j}}finally{try{k&&!k.done&&(s=F.return)&&s.call(F)}finally{if(o)throw o.error}}}}catch(j){n={error:j}}finally{try{D&&!D.done&&(a=M.return)&&a.call(M)}finally{if(n)throw n.error}}var J=this.getQueryExtraFields(c);return flatMap(uniq(L),function(j){return j?CellData.getCellDataList(j,J):[]})},r.prototype.getFieldFormatter=function(e,n){return e===TOTAL_VALUE?this.getFieldFormatterForTotalValue(n):t.prototype.getFieldFormatter.call(this,e)},r.prototype.getFieldFormatterForTotalValue=function(e){var n="";return!this.spreadsheet.isValueInCols()&&e&&(n=get(e.rowQuery,EXTRA_FIELD)),n=n??get(this.fields.values,0),t.prototype.getFieldFormatter.call(this,n)},r.prototype.handleCustomMeasuresOrder=function(e,n){var a=uniq(__spreadArray([],__read(n),!1));return n.length>=e?(a.splice(e,0,EXTRA_FIELD),a):__spreadArray(__spreadArray([],__read(a),!1),[EXTRA_FIELD],!1)},r.prototype.isCustomMeasuresPosition=function(e){return isNumber(e)},r.prototype.getRowData=function(e){return this.getCellMultiData({query:e.rowQuery})},r}(BaseDataSet),CustomTreePivotDataSet=function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.getCellData=function(e){var n=(e||{}).query,a=n===void 0?{}:n,o=this.fields,s=o.columns,l=o.rows,u=transformDimensionsValues(a,l),c=transformDimensionsValues(a,s),d=getDataPath({rowDimensionValues:u,colDimensionValues:c,rowPivotMeta:this.rowPivotMeta,colPivotMeta:this.colPivotMeta,rowFields:l,colFields:s,prefix:getDataPathPrefix(l,s)}),f=get(this.indexesData,d);if(f)return CellData.getCellData(f,a[EXTRA_FIELD])},r.prototype.processDataCfg=function(e){var n=t.prototype.processDataCfg.call(this,e),a=this.processMeta(e.meta,i18n("指标"));return __assign(__assign({},n),{meta:a,fields:__assign(__assign({},n.fields),{rows:[EXTRA_FIELD],valueInCols:!1})})},r}(PivotDataSet),CustomGridPivotDataSet=function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.processDataCfg=function(e){var n=!this.spreadsheet.isCustomRowFields(),a=e.fields.rows||[],o=n?__spreadArray([],__read(a),!1):__spreadArray(__spreadArray([],__read(a),!1),[EXTRA_FIELD],!1),s=this.processMeta(e.meta,i18n("数值"));return __assign(__assign({},e),{meta:s,fields:__assign(__assign({},e.fields),{rows:o,valueInCols:n})})},r}(CustomTreePivotDataSet),TableDataSet=function(t){__extends(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.handleDimensionValueFilter=function(){forEach(e.filterParams,function(n){var a=n.filterKey,o=n.filteredValues,s=n.customFilter,l=new Set(o),u=function(d){return!l.has(d[a])},c=filter(e.displayData,function(d){return s?s(d)&&u(d):u(d)});e.displayData=e.getDisplayData(c)})},e.handleDimensionValuesSort=function(){forEach(e.sortParams,function(n){var a=n.sortFieldId,o=n.sortBy,s=n.sortFunc,l=n.sortMethod,u=n.query;if(a){var c=e.displayData,d=[];if(u){var f=[];c.forEach(function(g){for(var y=Object.keys(u),m=!0,S=0;S<y.length;S++){var w=y[S];if(g[w]!==u[w]){m=!1,d.push(g);break}}m&&f.push(g)}),c=f}var h=c;if(s)h=s(__assign(__assign({},n),{data:c}));else if(o&&!isFunction(o)){var p=__spreadArray([],__read(o),!1).reverse();h=c.sort(function(g,y){var m=p.indexOf(g[a]),S=p.indexOf(y[a]);return S-m})}else if(isAscSort(l)||isDescSort(l)){var v=isFunction(o)?o:null;h=orderBy(c,[v||a],[l==null?void 0:l.toLocaleLowerCase()])}d.length&&(h=__spreadArray(__spreadArray([],__read(h),!1),__read(d),!1)),e.displayData=e.getDisplayData(h)}})},e}return r.prototype.processDataCfg=function(e){return e},r.prototype.setDataCfg=function(e){t.prototype.setDataCfg.call(this,e),this.handleDimensionValueFilter(),this.handleDimensionValuesSort()},r.prototype.getStartFrozenRows=function(e){var n=(this.spreadsheet.options.frozen||{}).rowCount;return n?e.slice(0,n):[]},r.prototype.getEndFrozenRows=function(e){var n=(this.spreadsheet.options.frozen||{}).trailingRowCount;return n?e.slice(-n):[]},r.prototype.getDisplayData=function(e){var n=this.getStartFrozenRows(e),a=this.getEndFrozenRows(e),o=e.slice(n.length||0,-a.length||void 0);return __spreadArray(__spreadArray(__spreadArray([],__read(n),!1),__read(o),!1),__read(a),!1)},r.prototype.getDimensionValues=function(){return[]},r.prototype.getCellData=function(e){var n=e===void 0?{}:e,a=n.query,o=a===void 0?{}:a;if(!(this.displayData.length===0&&o.rowIndex===0)){var s=this.displayData[o.rowIndex];return!hasIn(o,"field")||!isObject(s)?s:s[o.field]}},r.prototype.getCellMultiData=function(e){var n=e===void 0?{}:e,a=n.query,o=a===void 0?{}:a;if(!o)return this.displayData;var s=this.displayData[o.rowIndex]?[this.displayData[o.rowIndex]]:this.displayData;return hasIn(o,"field")?s.map(function(l){return l[o.field]}):s},r.prototype.getRowData=function(e){return this.getCellData({query:{rowIndex:e.rowIndex}})},r}(BaseDataSet);function constant(t){return function(){return t}}function linear(t,r){return function(e){return t+e*r}}function exponential(t,r,e){return t=Math.pow(t,e),r=Math.pow(r,e)-t,e=1/e,function(n){return Math.pow(t+n*r,e)}}function gamma(t){return(t=+t)==1?nogamma:function(r,e){return e-r?exponential(r,e,t):constant(isNaN(r)?e:r)}}function nogamma(t,r){var e=r-t;return e?linear(t,e):constant(isNaN(t)?r:t)}var rgb=function t(r){var e=gamma(r);function n(a,o){var s=e((a=rgb$1(a)).r,(o=rgb$1(o)).r),l=e(a.g,o.g),u=e(a.b,o.b),c=nogamma(a.opacity,o.opacity);return function(d){return a.r=s(d),a.g=l(d),a.b=u(d),a.opacity=c(d),a+""}}return n.gamma=t,n}(1);function numberArray(t,r){r||(r=[]);var e=t?Math.min(r.length,t.length):0,n=r.slice(),a;return function(o){for(a=0;a<e;++a)n[a]=t[a]*(1-o)+r[a]*o;return n}}function isNumberArray(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function interpolateArray(t,r){return(isNumberArray(r)?numberArray:genericArray)(t,r)}function genericArray(t,r){var e=r?r.length:0,n=t?Math.min(e,t.length):0,a=new Array(n),o=new Array(e),s;for(s=0;s<n;++s)a[s]=value(t[s],r[s]);for(;s<e;++s)o[s]=r[s];return function(l){for(s=0;s<n;++s)o[s]=a[s](l);return o}}function date(t,r){var e=new Date;return t=+t,r=+r,function(n){return e.setTime(t*(1-n)+r*n),e}}function number(t,r){return t=+t,r=+r,function(e){return t*(1-e)+r*e}}function object(t,r){var e={},n={},a;(t===null||typeof t!="object")&&(t={}),(r===null||typeof r!="object")&&(r={});for(a in r)a in t?e[a]=value(t[a],r[a]):n[a]=r[a];return function(o){for(a in e)n[a]=e[a](o);return n}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero(t){return function(){return t}}function one(t){return function(r){return t(r)+""}}function string(t,r){var e=reA.lastIndex=reB.lastIndex=0,n,a,o,s=-1,l=[],u=[];for(t=t+"",r=r+"";(n=reA.exec(t))&&(a=reB.exec(r));)(o=a.index)>e&&(o=r.slice(e,o),l[s]?l[s]+=o:l[++s]=o),(n=n[0])===(a=a[0])?l[s]?l[s]+=a:l[++s]=a:(l[++s]=null,u.push({i:s,x:number(n,a)})),e=reB.lastIndex;return e<r.length&&(o=r.slice(e),l[s]?l[s]+=o:l[++s]=o),l.length<2?u[0]?one(u[0].x):zero(r):(r=u.length,function(c){for(var d=0,f;d<r;++d)l[(f=u[d]).i]=f.x(c);return l.join("")})}function value(t,r){var e=typeof r,n;return r==null||e==="boolean"?constant(r):(e==="number"?number:e==="string"?(n=color(r))?(r=n,rgb):string:r instanceof color?rgb:r instanceof Date?date:isNumberArray(r)?numberArray:Array.isArray(r)?genericArray:typeof r.valueOf!="function"&&typeof r.toString!="function"||isNaN(r)?object:number)(t,r)}var frame=0,timeout=0,interval=0,pokeDelay=1e3,taskHead,taskTail,clockLast=0,clockNow=0,clockSkew=0,clock=typeof performance=="object"&&performance.now?performance:Date,setFrame=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function now$1(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}Timer.prototype=timer.prototype={constructor:Timer,restart:function(t,r,e){if(typeof t!="function")throw new TypeError("callback is not a function");e=(e==null?now$1():+e)+(r==null?0:+r),!this._next&&taskTail!==this&&(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=t,this._time=e,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};function timer(t,r,e){var n=new Timer;return n.restart(t,r,e),n}function timerFlush(){now$1(),++frame;for(var t=taskHead,r;t;)(r=clockNow-t._time)>=0&&t._call.call(null,r),t=t._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout=0;try{timerFlush()}finally{frame=0,nap(),clockNow=0}}function poke(){var t=clock.now(),r=t-clockLast;r>pokeDelay&&(clockSkew-=r,clockLast=t)}function nap(){for(var t,r=taskHead,e,n=1/0;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:taskHead=e);taskTail=t,sleep(n)}function sleep(t){if(!frame){timeout&&(timeout=clearTimeout(timeout));var r=t-clockNow;r>24?(t<1/0&&(timeout=setTimeout(wake,t-clock.now()-clockSkew)),interval&&(interval=clearInterval(interval))):(interval||(clockLast=clock.now(),interval=setInterval(poke,pokeDelay)),frame=1,setFrame(wake))}}var GridGroup=function(t){__extends(r,t);function r(e){var n=this,a=e.name,o=e.s2,s=__rest(e,["name","s2"]);return n=t.call(this,{name:a,style:s})||this,n.gridInfo={cols:[],rows:[]},n.updateGrid=function(l,u){var c,d;u===void 0&&(u=KEY_GROUP_GRID_GROUP),!n.gridGroup||!n.getElementById(u)?n.gridGroup=n.appendChild(new Group({id:u,style:{zIndex:PANEL_GRID_GROUP_Z_INDEX}})):n.gridGroup.removeChildren();var f=(c=last(l.cols))!==null&&c!==void 0?c:0,h=(d=last(l.rows))!==null&&d!==void 0?d:0,p=n.s2.theme,v=p.dataCell.cell,g=v==null?void 0:v.verticalBorderWidth;n.gridInfo=l;var y=g/2;n.gridInfo.cols.forEach(function(w){renderLine(n.gridGroup,{x1:w-y,x2:w-y,y1:0,y2:h,stroke:v.verticalBorderColor,strokeOpacity:v.verticalBorderColorOpacity,lineWidth:g})});var m=v==null?void 0:v.horizontalBorderWidth,S=m/2;n.gridInfo.rows.forEach(function(w){renderLine(n.gridGroup,{x1:0,x2:f,y1:w-S,y2:w-S,stroke:v.horizontalBorderColor,strokeOpacity:v.horizontalBorderColorOpacity,lineWidth:m})})},n.s2=o,n}return r}(Group),PanelScrollGroup=function(t){__extends(r,t);function r(e){var n=t.call(this,e)||this;return n.initMergedCellsGroup(),n}return r.prototype.getMergedCellsGroup=function(){return this.mergedCellsGroup},r.prototype.initMergedCellsGroup=function(){this.mergedCellsGroup&&this.getElementById(KEY_GROUP_MERGED_CELLS)||(this.mergedCellsGroup=this.appendChild(new Group({id:KEY_GROUP_MERGED_CELLS,style:{zIndex:PANEL_MERGE_GROUP_Z_INDEX}})))},r.prototype.updateMergedCells=function(){this.initMergedCellsGroup(),updateMergedCells(this.s2,this.mergedCellsGroup)},r.prototype.addMergeCell=function(e){var n;(n=this.mergedCellsGroup)===null||n===void 0||n.appendChild(e),this.s2.emit(S2Event.MERGED_CELLS_RENDER,e),this.s2.emit(S2Event.LAYOUT_CELL_RENDER,e)},r.prototype.update=function(e){this.updateGrid(e),this.updateMergedCells()},r}(GridGroup),ScrollType;(function(t){t.ScrollChange="scroll-change",t.ScrollEnd="scroll-end"})(ScrollType||(ScrollType={}));var ScrollBar=function(t){__extends(r,t);function r(e){var n=t.call(this)||this;n.eventHandlers=[],n.scrollFrameId=null,n.getCoordinatesName=function(){var p=n.isHorizontal?"x1":"y1",v=n.isHorizontal?"x2":"y2";return{from:p,to:v}},n.getCoordinatesWithBBoxExtraPadding=function(){var p=n.theme,v=p.lineCap,g=v===void 0?"butt":v,y=p.size,m=y===void 0?0:y;if(g==="butt")return{start:n.thumbOffset,end:n.thumbOffset+n.thumbLen};var S=n.isHorizontal?0:m/2,w=n.isHorizontal?m:m/2;return{start:n.thumbOffset+S,end:n.thumbOffset+n.thumbLen-w}},n.current=function(){var p=n.thumbLen/n.trackLen,v=n.thumbOffset/n.trackLen;return v/(1-p)},n.updateThumbLen=function(p){if(n.thumbLen!==p){n.thumbLen=p;var v=n.getCoordinatesName();n.thumbShape.attr(v.to,n.thumbOffset+p),n.emitScrollChange(n.thumbOffset/(n.trackLen-n.thumbLen)*n.scrollTargetMaxOffset,!1)}},n.updateThumbOffset=function(p,v){var g;v===void 0&&(v=!0);var y=n.validateRange(p),m=n.thumbOffset===y&&y!==0;if(!m){n.thumbOffset=y;var S=n.getCoordinatesName(),w=S.from,R=S.to,T=n.getCoordinatesWithBBoxExtraPadding(),x=T.start,b=T.end;n.thumbShape.attr((g={},g[w]=x,g[R]=b,g)),v&&n.emitScrollChange(y/(n.trackLen-n.thumbLen)*n.scrollTargetMaxOffset,!1)}},n.onlyUpdateThumbOffset=function(p){n.updateThumbOffset(p,!1)},n.emitScrollChange=function(p,v){v===void 0&&(v=!0),cancelAnimationFrame(n.scrollFrameId),n.scrollFrameId=requestAnimationFrame(function(){n.dispatchEvent(new CustomEvent(ScrollType.ScrollChange,{offset:p,updateThumbOffset:v}))})},n.bindEventListener=function(p,v,g){return p==null||p.addEventListener(v,g,!1),{remove:function(){p==null||p.removeEventListener(v,g,!1)}}},n.addEvent=function(p,v,g){p.addEventListener(v,g),n.eventHandlers.push({target:p,type:v,handler:g})},n.initScrollBar=function(){n.scrollBarGroup=n.createScrollBarGroup(),n.scrollBarGroup.setPosition(n.position.x,n.position.y),n.bindEvents()},n.createScrollBarGroup=function(){var p=n.appendChild(new Group({className:n.isHorizontal?"horizontalBar":"verticalBar"}));return n.trackShape=n.createTrackShape(p),n.thumbShape=n.createThumbShape(p),p},n.createTrackShape=function(p){var v=n.theme,g=v.lineCap,y=g===void 0?"round":g,m=v.trackColor,S=v.size,w=S===void 0?0:S,R={lineWidth:w,stroke:m,lineCap:y};return n.isHorizontal?p.appendChild(new Line({style:__assign(__assign({},R),{x1:0,y1:w/2,x2:n.trackLen,y2:w/2})})):p.appendChild(new Line({style:__assign(__assign({},R),{x1:w/2,y1:0,x2:w/2,y2:n.trackLen})}))},n.createThumbShape=function(p){var v=n.theme,g=v.size,y=g===void 0?0:g,m=v.lineCap,S=m===void 0?"round":m,w=v.thumbColor,R={lineWidth:y,stroke:w,lineCap:S,cursor:"default"},T=n.getCoordinatesWithBBoxExtraPadding(),x=T.start,b=T.end;return n.isHorizontal?p.appendChild(new Line({style:__assign(__assign({},R),{x1:x,y1:y/2,x2:b,y2:y/2})})):p.appendChild(new Line({style:__assign(__assign({},R),{x1:y/2,y1:x,x2:y/2,y2:b})}))},n.bindEvents=function(){n.addEventListener(OriginEventType.POINTER_DOWN,n.onStartEvent),n.addEventListener(OriginEventType.POINTER_UP,n.onPointerUp),n.trackShape.addEventListener("click",n.onTrackClick),n.thumbShape.addEventListener(OriginEventType.POINTER_OVER,n.onTrackPointerOver),n.thumbShape.addEventListener(OriginEventType.POINTER_OUT,n.onTrackPointerOut)},n.onStartEvent=function(p){p.preventDefault();var v=p.clientX,g=p.clientY;n.startPos=n.isHorizontal?v:g,n.bindLaterEvent()},n.bindLaterEvent=function(){var p=n.ownerDocument.defaultView,v=document.body,g=[n.bindEventListener(v,OriginEventType.POINTER_MOVE,n.onPointerMove),n.bindEventListener(v,OriginEventType.POINTER_UP,n.onPointerUp),n.bindEventListener(v,OriginEventType.POINTER_LEAVE,n.onPointerUp)];n.addEvent(p,OriginEventType.POINTER_UP,n.onPointerUp),n.clearEvents=function(){g.forEach(function(y){y==null||y.remove()}),forEach(n.eventHandlers,function(y){var m;(m=y.target)===null||m===void 0||m.removeEventListener(y.type,y.handler)}),n.eventHandlers.length=0}},n.onTrackClick=function(p){var v=n.isHorizontal?p.x-n.position.x-n.thumbLen/2:p.y-n.position.y-n.thumbLen/2,g=n.validateRange(v);n.updateThumbOffset(g)},n.onPointerMove=function(p){p.preventDefault();var v=p.clientX,g=p.clientY,y=n.isHorizontal?v:g,m=y-n.startPos;n.startPos=y,n.updateThumbOffset(n.thumbOffset+m)},n.onPointerUp=function(p){var v;n.dispatchEvent(new CustomEvent(ScrollType.ScrollEnd,{})),p.preventDefault(),(v=n.clearEvents)===null||v===void 0||v.call(n)},n.onTrackPointerOver=function(){var p=n.theme,v=p.thumbHoverColor,g=p.hoverSize;n.thumbShape.attr("stroke",v),n.thumbShape.attr("lineWidth",g)},n.onTrackPointerOut=function(){var p=n.theme,v=p.thumbColor,g=p.size;n.thumbShape.attr("stroke",v),n.thumbShape.attr("lineWidth",g)},n.validateRange=function(p){var v=p;return p+n.thumbLen>n.trackLen?v=n.trackLen-n.thumbLen:p+n.thumbLen<n.thumbLen&&(v=0),v};var a=e.isHorizontal,o=a===void 0?!1:a,s=e.trackLen,l=e.thumbLen,u=e.position,c=e.thumbOffset,d=c===void 0?0:c,f=e.theme,h=e.scrollTargetMaxOffset;return n.isHorizontal=o,n.thumbOffset=d,n.trackLen=s,n.thumbLen=l,n.position=u,n.theme=f,n.scrollTargetMaxOffset=h,n.initScrollBar(),n}return r}(Group),getIndexRangeWithOffsets=function(t,r,e){if(e<=0)return{start:0,end:0};var n=findIndex(t,function(o,s){var l=r;return l>=o&&l<t[s+1]},0);n=Math.max(n,0);var a=e===r?n:findIndex(t,function(o,s){var l=e;return l>o&&l<=t[s+1]},n);return a=Math.min(a===-1?1/0:a,t.length-2),{start:n,end:a}},getAdjustedRowScrollX=function(t,r){var e=r.width,n=r.originalWidth,a=Math.min(n-e,t);return a<0?0:a},getAdjustedScrollOffset=function(t,r,e){var n=Math.min(r-e,t);return n<0?0:n},getAllChildCells=function(t,r){if(t===void 0&&(t=[]),isEmpty(t))return[];var e=[];return t.forEach(function(n){if(n instanceof r&&e.push(n),n instanceof Group){var a=n.children;a.forEach(function(o){o instanceof r&&e.push(o)})}}),e},getColsForGrid=function(t,r,e){return e.slice(t,r+1).map(function(n){return n.x+n.width})},getRowsForGrid=function(t,r,e){for(var n=[],a=t;a<r+1;a++)n.push(e.getCellOffsetY(a+1));return n},getFrozenRowsForGrid=function(t,r,e,n){var a=getRowsForGrid(t,r,n),o=n.getCellOffsetY(t);return a.map(function(s){return s-o+e})},isXYInRange=function(t,r,e){var n=__read(e,4),a=n[0],o=n[1],s=n[2],l=n[3];return t>=a&&t<=o&&r>=s&&r<=l},allIndexes=function(t){for(var r=__read(t,4),e=r[0],n=r[1],a=r[2],o=r[3],s=[],l=e;l<=n;l+=1)for(var u=a;u<=o;u+=1)s.push([l,u]);return s},diffIndexes=function(t,r){var e=[],n=[];if(isEmpty(t))return isEmpty(r)?{add:e,remove:n}:{add:allIndexes(r),remove:n};if(isEmpty(r))return{add:e,remove:allIndexes(t)};for(var a=__read(t,4),o=a[0],s=a[1],l=a[2],u=a[3],c=__read(r,4),d=c[0],f=c[1],h=c[2],p=c[3],v=o;v<=s;v++)for(var g=l;g<=u;g++)isXYInRange(v,g,r)||n.push([v,g]);for(var v=d;v<=f;v+=1)for(var g=h;g<=p;g+=1)isXYInRange(v,g,t)||e.push([v,g]);return{add:e,remove:n}},diffPanelIndexes=function(t,r){var e=[],n=[];return Object.keys(r).forEach(function(a){var o=diffIndexes((t==null?void 0:t[a])||[],r[a]),s=o.add,l=o.remove;e.push.apply(e,__spreadArray([],__read(s),!1)),n.push.apply(n,__spreadArray([],__read(l),!1))}),{add:e,remove:n}},BaseBBox=function(){function t(r,e){e===void 0&&(e=!1),this.x=0,this.y=0,this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.width=0,this.height=0,this.originalWidth=0,this.originalHeight=0,this.viewportHeight=0,this.viewportWidth=0,this.facet=r,this.spreadsheet=r.spreadsheet,this.layoutResult=r.getLayoutResult(),e&&this.calculateBBox()}return t}(),CornerBBox=function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.calculateBBox=function(){var e=this.getCornerBBoxWidth(),n=this.getCornerBBoxHeight();this.width=e,this.height=n,this.maxX=e,this.maxY=n},r.prototype.getCornerBBoxOriginalHeight=function(){var e=this.layoutResult.colsHierarchy,n=this.spreadsheet.options.style.colCell;return e.sampleNodeForLastLevel?floor(e.height):n==null?void 0:n.height},r.prototype.getCornerBBoxHeight=function(){return this.originalHeight=this.getCornerBBoxOriginalHeight(),this.originalHeight},r.prototype.getCornerBBoxWidth=function(){var e=this.layoutResult.rowsHierarchy;return this.originalWidth=floor(e.width+this.facet.getSeriesNumberWidth()),this.spreadsheet.isFrozenRowHeader()?this.adjustCornerBBoxWidth():this.originalWidth},r.prototype.adjustCornerBBoxWidth=function(){var e=this.layoutResult.colsHierarchy,n=this.spreadsheet.options,a=n.width,o=n.frozen,s=o==null?void 0:o.rowHeader,l=isBoolean(s)?DEFAULT_CORNER_MAX_WIDTH_RATIO:clamp$1(s,0,1),u=a*l,c=e==null?void 0:e.width,d=a-this.originalWidth;if(this.originalWidth<=u||c<=d)return this.originalWidth;var f=0,h=a-u;return c<=h?f=this.originalWidth-(c-d):f=u,floor(f)},r}(BaseBBox),PanelBBox=function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.calculateBBox=function(){this.originalWidth=this.facet.getRealWidth(),this.originalHeight=this.facet.getRealHeight();var e=this.facet.cornerBBox,n={x:floor(e.maxX),y:floor(e.maxY)};this.x=n.x+Frame.getVerticalBorderWidth(this.spreadsheet),this.y=n.y+Frame.getHorizontalBorderWidth(this.spreadsheet),this.minX=this.x,this.minY=this.y;var a=this.spreadsheet.theme.scrollBar.size,o=this.spreadsheet.options,s=o.width,l=o.height,u=Math.max(0,s-this.x),c=Math.max(0,l-this.y-a);if(this.width=u,this.height=c,this.viewportHeight=Math.abs(floor(Math.min(c,this.originalHeight))),this.viewportWidth=Math.abs(floor(Math.min(u,this.originalWidth))),this.maxX=this.x+this.viewportWidth,this.maxY=this.y+this.viewportHeight,!!this.spreadsheet.enableFrozenHeaders()){var d=this.spreadsheet.options.frozen,f=d.trailingColCount,h=f===void 0?0:f,p=d.trailingRowCount,v=p===void 0?0:p;h>0&&(this.viewportWidth=this.width,this.maxX=this.x+this.width),v>0&&(this.viewportHeight=this.height,this.maxY=this.y+this.height)}},r}(BaseBBox),WILDCARD="*",EventEmitter=function(){function t(){this._events={}}return t.prototype.on=function(r,e,n){return this._events[r]||(this._events[r]=[]),this._events[r].push({callback:e,once:!!n}),this},t.prototype.once=function(r,e){return this.on(r,e,!0)},t.prototype.emit=function(r){for(var e=this,n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o=this._events[r]||[],s=this._events[WILDCARD]||[],l=function(u){for(var c=u.length,d=0;d<c;d++)if(u[d]){var f=u[d],h=f.callback,p=f.once;p&&(u.splice(d,1),u.length===0&&delete e._events[r],c--,d--),h.apply(e,n)}};l(o),l(s)},t.prototype.off=function(r,e){if(!r)this._events={};else if(!e)delete this._events[r];else{for(var n=this._events[r]||[],a=n.length,o=0;o<a;o++)n[o].callback===e&&(n.splice(o,1),a--,o--);n.length===0&&delete this._events[r]}return this},t.prototype.getEvents=function(){return this._events},t}();function cubicIn(t){return t*t*t}var now=function(){var t;return(t=performance==null?void 0:performance.now())!==null&&t!==void 0?t:Date.now()},TOTAL_MS=800,SWIPE_TIME_GAP=100,WheelEvent=function(t){__extends(r,t);function r(e){var n=t.call(this)||this;return n.bindPointerDown=function(a){window.cancelAnimationFrame(n.raf),n.panning=!0,n.preX=a.x,n.preY=a.y,n.speedX=0,n.speedY=0,n.lastMoveMS=now()},n.bindPointerMove=function(a){if(n.panning){var o=now(),s=o-n.lastMoveMS,l=n.preX-a.x,u=n.preY-a.y;n.speedX=l/s,n.speedY=u/s,n.preX=a.x,n.preY=a.y,n.lastMoveMS=o,n.emit("wheel",__assign(__assign({},a.clone()),{x:a.x,y:a.y,deltaX:l,deltaY:u}))}},n.bindPointerUp=function(a){n.panning=!1;var o=now();if(!(!n.speedX||!n.speedY||o-n.lastMoveMS>=SWIPE_TIME_GAP)){var s=function(){var l=now();n.raf=window.requestAnimationFrame(function(){var u=now(),c=(u-o)/TOTAL_MS;if(c<1){var d=cubicIn(1-c),f=u-l;n.emit("wheel",__assign(__assign({},a.clone()),{x:a.x,y:a.y,deltaX:n.speedX*d*f,deltaY:n.speedY*d*f})),s()}})};s()}},n.canvas=e,n.panning=!1,n.init(),n}return r.prototype.init=function(){this.canvas.addEventListener(OriginEventType.POINTER_DOWN,this.bindPointerDown),this.canvas.addEventListener(OriginEventType.POINTER_MOVE,this.bindPointerMove),this.canvas.addEventListener(OriginEventType.POINTER_UP,this.bindPointerUp)},r.prototype.destroy=function(){this.canvas.removeEventListener(OriginEventType.POINTER_DOWN,this.bindPointerDown),this.canvas.removeEventListener(OriginEventType.POINTER_MOVE,this.bindPointerMove),this.canvas.removeEventListener(OriginEventType.POINTER_UP,this.bindPointerUp)},r}(EventEmitter),BaseFacet=function(){function t(r){var e=this;this.scrollFrameId=null,this.getLayoutResult=function(){return __assign(__assign({},e.layoutResult),{cornerNodes:e.getCornerNodes(),seriesNumberNodes:e.getSeriesNumberNodes()})},this.hideScrollBar=function(){var n,a,o;(n=e.hRowScrollBar)===null||n===void 0||n.setAttribute("visibility","hidden"),(a=e.hScrollBar)===null||a===void 0||a.setAttribute("visibility","hidden"),(o=e.vScrollBar)===null||o===void 0||o.setAttribute("visibility","hidden")},this.delayHideScrollBar=debounce(this.hideScrollBar,1e3),this.delayHideScrollbarOnMobile=function(){isMobile()&&e.delayHideScrollBar()},this.showVerticalScrollBar=function(){var n;(n=e.vScrollBar)===null||n===void 0||n.setAttribute("visibility","visible")},this.showHorizontalScrollBar=function(){var n,a;(n=e.hRowScrollBar)===null||n===void 0||n.setAttribute("visibility","visible"),(a=e.hScrollBar)===null||a===void 0||a.setAttribute("visibility","visible")},this.onContainerWheelForMobileCompatibility=function(){var n=e.spreadsheet.getCanvasElement(),a,o;n.addEventListener("touchstart",function(s){a=s.touches[0].clientY}),n.addEventListener("touchend",function(s){o=s.changedTouches[0].clientY,o<a?e.scrollDirection=ScrollDirection.SCROLL_UP:o>a&&(e.scrollDirection=ScrollDirection.SCROLL_DOWN)})},this.onContainerWheel=function(){isMobile()?e.onContainerWheelForMobile():e.onContainerWheelForPc()},this.getMobileWheelDeltaY=function(n){return e.scrollDirection===ScrollDirection.SCROLL_UP?Math.max(0,n):e.scrollDirection===ScrollDirection.SCROLL_DOWN?Math.min(0,n):n},this.onContainerWheelForPc=function(){var n=e.spreadsheet.getCanvasElement();n==null||n.addEventListener("wheel",e.onWheel)},this.onContainerWheelForMobile=function(){e.mobileWheel=new WheelEvent(e.spreadsheet.container),e.mobileWheel.on("wheel",function(n){e.spreadsheet.hideTooltip();var a=n.originalEvent,o=n.deltaX,s=n.deltaY,l=n.x,u=n.y,c=e.getMobileWheelDeltaY(s);e.onWheel(__assign(__assign({},a),{deltaX:o,deltaY:c,offsetX:l,offsetY:u}))}),e.onContainerWheelForMobileCompatibility()},this.bindEvents=function(){e.onContainerWheel(),e.emitPaginationEvent()},this.setScrollOffset=function(n){Object.keys(n).forEach(function(a){var o=get(n,a);isUndefined(o)||e.spreadsheet.store.set(a,floor(o))})},this.getScrollOffset=function(){var n=e.spreadsheet.store;return{scrollX:n.get("scrollX",0),scrollY:n.get("scrollY",0),rowHeaderScrollX:n.get("rowHeaderScrollX",0)}},this.resetScrollX=function(){e.setScrollOffset({scrollX:0})},this.resetRowScrollX=function(){e.setScrollOffset({rowHeaderScrollX:0})},this.resetScrollY=function(){e.setScrollOffset({scrollY:0})},this.resetScrollOffset=function(){e.setScrollOffset({scrollX:0,scrollY:0,rowHeaderScrollX:0})},this.emitPaginationEvent=function(){var n=e.spreadsheet.options.pagination;if(n){var a=n.current,o=a===void 0?DEFAULT_PAGE_INDEX:a,s=n.pageSize,l=e.viewCellHeights.getTotalLength(),u=floor((l-1)/s)+1;e.spreadsheet.emit(S2Event.LAYOUT_PAGINATION,{pageSize:s,pageCount:u,total:l,current:o})}},this.unbindEvents=function(){var n,a=e.spreadsheet.getCanvasElement();a==null||a.removeEventListener("wheel",e.onWheel),(n=e.mobileWheel)===null||n===void 0||n.destroy()},this.calculateCellWidthHeight=function(){var n=e.layoutResult.colLeafNodes,a=reduce(n,function(o,s){var l=last(o)||0;return o.push(l+s.width),o},[0]);e.viewCellWidths=a,e.viewCellHeights=e.getViewCellHeights()},this.getRealScrollX=function(n,a){return a===void 0&&(a=0),e.spreadsheet.isFrozenRowHeader()?a:n},this.calculatePanelBBox=function(){e.panelBBox=new PanelBBox(e,!0)},this.getRealWidth=function(){return last(e.viewCellWidths)||0},this.getRealHeight=function(){var n=e.spreadsheet.options.pagination,a=e.viewCellHeights;if(n){var o=e.getCellRange(),s=o.start,l=o.end;return a.getCellOffsetY(l+1)-a.getCellOffsetY(s)}return a.getTotalHeight()},this.scrollWithAnimation=function(n,a,o){var s,l,u,c;n===void 0&&(n={}),a===void 0&&(a=200);var d=e.getAdjustedScrollOffset({scrollX:((s=n.offsetX)===null||s===void 0?void 0:s.value)||0,scrollY:((l=n.offsetY)===null||l===void 0?void 0:l.value)||0,rowHeaderScrollX:((u=n.rowHeaderOffsetX)===null||u===void 0?void 0:u.value)||0}),f=d.scrollX,h=d.scrollY,p=d.rowHeaderScrollX;(c=e.timer)===null||c===void 0||c.stop();var v=e.getScrollOffset(),g=[f??v.scrollX,h??v.scrollY,p??v.rowHeaderScrollX],y=interpolateArray(Object.values(v),g);e.timer=timer(function(m){try{var S=Math.min(m/a,1),w=__read(y(S),3),R=w[0],T=w[1],x=w[2];e.setScrollOffset({rowHeaderScrollX:x,scrollX:R,scrollY:T}),e.startScroll(),m>a&&(e.timer.stop(),o==null||o())}catch(b){console.error(b),e.timer.stop()}})},this.scrollImmediately=function(n){var a,o,s;n===void 0&&(n={});var l=e.getAdjustedScrollOffset({scrollX:((a=n.offsetX)===null||a===void 0?void 0:a.value)||0,scrollY:((o=n.offsetY)===null||o===void 0?void 0:o.value)||0,rowHeaderScrollX:((s=n.rowHeaderOffsetX)===null||s===void 0?void 0:s.value)||0}),u=l.scrollX,c=l.scrollY,d=l.rowHeaderScrollX;e.setScrollOffset({scrollX:u,scrollY:c,rowHeaderScrollX:d}),e.startScroll()},this.startScroll=function(n){var a,o,s;n===void 0&&(n=!1);var l=e.getScrollOffset(),u=l.rowHeaderScrollX,c=l.scrollX,d=l.scrollY;(a=e.hRowScrollBar)===null||a===void 0||a.onlyUpdateThumbOffset(e.getScrollBarOffset(u,e.hRowScrollBar)),(o=e.hScrollBar)===null||o===void 0||o.onlyUpdateThumbOffset(e.getScrollBarOffset(c,e.hScrollBar)),(s=e.vScrollBar)===null||s===void 0||s.onlyUpdateThumbOffset(e.getScrollBarOffset(d,e.vScrollBar)),e.dynamicRenderCell(n)},this.getRendererHeight=function(){var n=e.getCellRange(),a=n.start,o=n.end;return e.viewCellHeights.getCellOffsetY(o+1)-e.viewCellHeights.getCellOffsetY(a)},this.getAdjustedScrollOffset=function(n){var a=n.scrollX,o=n.scrollY,s=n.rowHeaderScrollX;return{scrollX:getAdjustedScrollOffset(a,e.layoutResult.colsHierarchy.width,e.panelBBox.width),scrollY:getAdjustedScrollOffset(o,e.getRendererHeight(),e.panelBBox.height),rowHeaderScrollX:getAdjustedRowScrollX(s,e.cornerBBox)}},this.renderRowScrollBar=function(n){if(e.spreadsheet.isFrozenRowHeader()&&e.cornerBBox.width<e.cornerBBox.originalWidth){var a=e.cornerBBox.originalWidth-e.cornerBBox.width,o=e.getScrollbarPosition().maxY,s=e.spreadsheet.theme,l=s.splitLine,u=s.scrollBar,c=Math.max(e.cornerBBox.width*e.cornerBBox.width/e.cornerBBox.originalWidth,u==null?void 0:u.thumbHorizontalMinSize),d=c-(l==null?void 0:l.verticalBorderWidth);e.hRowScrollBar=new ScrollBar({isHorizontal:!0,trackLen:e.cornerBBox.width,thumbLen:d,position:{x:e.cornerBBox.minX+e.scrollBarSize/2,y:o},thumbOffset:n*(e.cornerBBox.width-c)/a,theme:e.scrollBarTheme,scrollTargetMaxOffset:a}),e.hRowScrollBar.addEventListener(ScrollType.ScrollChange,function(f){var h,p,v=f.offset,g=e.getValidScrollBarOffset(v,a),y=floor(g);e.setScrollOffset({rowHeaderScrollX:y}),(h=e.rowHeader)===null||h===void 0||h.onRowScrollX(y,KEY_GROUP_ROW_RESIZE_AREA),(p=e.seriesNumberHeader)===null||p===void 0||p.onRowScrollX(y,KEY_GROUP_ROW_INDEX_RESIZE_AREA),e.cornerHeader.onRowScrollX(y,KEY_GROUP_CORNER_RESIZE_AREA);var m=e.getScrollBarOffset(y,e.hRowScrollBar),S=e.getScrollOffset(),w=S.scrollX,R=S.scrollY,T={scrollX:w,scrollY:R,rowHeaderScrollX:m};e.hRowScrollBar.updateThumbOffset(m,!1),e.spreadsheet.emit(S2Event.ROW_CELL_SCROLL,T),e.spreadsheet.emit(S2Event.GLOBAL_SCROLL,T)}),e.foregroundGroup.appendChild(e.hRowScrollBar)}},this.getValidScrollBarOffset=function(n,a){return clamp$1(n,0,a)},this.renderHScrollBar=function(n,a,o){if(floor(n)<floor(a)){var s=e.scrollBarSize/2,l=e.getScrollbarPosition().maxY,u=!e.spreadsheet.isFrozenRowHeader(),c=n+(u?Math.min(e.cornerBBox.width,e.getCanvasSize().width):0),d={x:e.panelBBox.minX+(u?-e.cornerBBox.width+s:s),y:l},f=a+(u?e.cornerBBox.width:0),h=e.spreadsheet.theme.scrollBar,p=f-c,v=Math.max(c/f*c,h==null?void 0:h.thumbHorizontalMinSize);e.hScrollBar=new ScrollBar({isHorizontal:!0,trackLen:c,thumbLen:v,position:d,thumbOffset:o*(c-v)/p,theme:e.scrollBarTheme,scrollTargetMaxOffset:p}),e.hScrollBar.addEventListener(ScrollType.ScrollChange,function(g){var y=g.offset,m=g.updateThumbOffset,S=e.getValidScrollBarOffset(y,p);m&&e.hScrollBar.updateThumbOffset(e.getScrollBarOffset(S,e.hScrollBar),!1),e.setScrollOffset({scrollX:S}),e.dynamicRenderCell()}),e.foregroundGroup.appendChild(e.hScrollBar)}},this.getScrollbarPosition=function(){var n=e.panelBBox,a=n.maxX,o=n.maxY,s=e.getCanvasSize(),l=s.width,u=s.height,c=e.spreadsheet.options.interaction.scrollbarPosition===ScrollbarPositionType.CONTENT;return{maxX:(c?a:l)-e.scrollBarSize,maxY:c?o:u-e.scrollBarSize}},this.renderVScrollBar=function(n,a,o){if(n<a){var s=e.spreadsheet.theme.scrollBar,l=Math.max(n/a*n,s==null?void 0:s.thumbVerticalMinSize),u=a-n,c=e.getScrollbarPosition().maxX;e.vScrollBar=new ScrollBar({isHorizontal:!1,trackLen:n,thumbLen:l,thumbOffset:o*(n-l)/u,position:{x:c,y:e.panelBBox.minY},theme:e.scrollBarTheme,scrollTargetMaxOffset:u}),e.vScrollBar.addEventListener(ScrollType.ScrollChange,function(d){var f=d.offset,h=d.updateThumbOffset,p=e.getValidScrollBarOffset(f,u);h&&e.vScrollBar.updateThumbOffset(e.getScrollBarOffset(p,e.vScrollBar),!1),e.setScrollOffset({scrollY:p}),e.dynamicRenderCell()}),e.foregroundGroup.appendChild(e.vScrollBar)}},this.getScrollBarOffset=function(n,a){var o=a.trackLen,s=a.thumbLen,l=a.scrollTargetMaxOffset;return n*(o-s)/l},this.isScrollOverThePanelArea=function(n){var a=n.offsetX,o=n.offsetY;return a>e.panelBBox.minX&&a<e.panelBBox.maxX&&o>e.panelBBox.minY&&o<e.panelBBox.maxY},this.isScrollOverTheCornerArea=function(n){var a=n.offsetX,o=n.offsetY;return a>e.cornerBBox.minX&&a<e.cornerBBox.maxX&&o>e.cornerBBox.minY&&o<e.cornerBBox.maxY+e.panelBBox.height},this.updateHorizontalRowScrollOffset=function(n){var a,o=n.offset,s=n.offsetX,l=n.offsetY;e.isScrollOverTheCornerArea({offsetX:s,offsetY:l})&&((a=e.hRowScrollBar)===null||a===void 0||a.emitScrollChange(o))},this.updateHorizontalScrollOffset=function(n){var a,o=n.offset,s=n.offsetX,l=n.offsetY;(!e.hRowScrollBar||e.isScrollOverThePanelArea({offsetX:s,offsetY:l}))&&((a=e.hScrollBar)===null||a===void 0||a.emitScrollChange(o))},this.isScrollToLeft=function(n){var a=n.deltaX,o=n.offsetX,s=n.offsetY;if(!e.hScrollBar&&!e.hRowScrollBar)return!0;var l=!e.hRowScrollBar||e.isScrollOverThePanelArea({offsetY:s,offsetX:o})||e.hRowScrollBar.thumbOffset<=0,u=!e.hScrollBar||e.hScrollBar.thumbOffset<=0;return a<=0&&u&&l},this.isScrollToRight=function(n){var a,o,s,l,u,c,d=n.deltaX,f=n.offsetX,h=n.offsetY;if(!e.hScrollBar&&!e.hRowScrollBar)return!0;var p=e.spreadsheet.isFrozenRowHeader()?(a=e.panelBBox)===null||a===void 0?void 0:a.width:(o=e.panelBBox)===null||o===void 0?void 0:o.maxX,v=!e.hRowScrollBar||e.isScrollOverThePanelArea({offsetY:h,offsetX:f})||((s=e.hRowScrollBar)===null||s===void 0?void 0:s.thumbOffset)+((l=e.hRowScrollBar)===null||l===void 0?void 0:l.thumbLen)>=e.cornerBBox.width,g=e.hRowScrollBar&&e.isScrollOverTheCornerArea({offsetX:f,offsetY:h})||((u=e.hScrollBar)===null||u===void 0?void 0:u.thumbOffset)+((c=e.hScrollBar)===null||c===void 0?void 0:c.thumbLen)>=p;return d>=0&&g&&v},this.isScrollToTop=function(n){var a;return e.vScrollBar?n<=0&&((a=e.vScrollBar)===null||a===void 0?void 0:a.thumbOffset)<=0:!0},this.isScrollToBottom=function(n){var a,o,s;return e.vScrollBar?n>=0&&((a=e.vScrollBar)===null||a===void 0?void 0:a.thumbOffset)+((o=e.vScrollBar)===null||o===void 0?void 0:o.thumbLen)>=((s=e.panelBBox)===null||s===void 0?void 0:s.height):!0},this.isVerticalScrollOverTheViewport=function(n){return!e.isScrollToTop(n)&&!e.isScrollToBottom(n)},this.isHorizontalScrollOverTheViewport=function(n){return!e.isScrollToLeft(n)&&!e.isScrollToRight(n)},this.isScrollOverTheViewport=function(n){var a=n.deltaY,o=n.deltaX,s=n.offsetY,l=s<=e.cornerBBox.maxY;return l?!1:a!==0?e.isVerticalScrollOverTheViewport(a):o!==0?e.isHorizontalScrollOverTheViewport(n):!1},this.cancelScrollFrame=function(){return isMobile()&&e.scrollFrameId?!1:(cancelAnimationFrame(e.scrollFrameId),!0)},this.clearScrollFrameIdOnMobile=function(){isMobile()&&(e.scrollFrameId=null)},this.stopScrollChainingIfNeeded=function(n){var a=e.spreadsheet.options.interaction;(a==null?void 0:a.overscrollBehavior)!=="auto"&&(e.cancelScrollFrame(),e.stopScrollChaining(n))},this.stopScrollChaining=function(n){var a,o;n!=null&&n.cancelable&&((a=n==null?void 0:n.preventDefault)===null||a===void 0||a.call(n));var s=n==null?void 0:n.originalEvent;s!=null&&s.cancelable&&((o=s==null?void 0:s.preventDefault)===null||o===void 0||o.call(s))},this.onWheel=function(n){var a=e.spreadsheet.options.interaction,o=n.deltaX,s=n.deltaY,l=n.offsetX,u=n.offsetY,c=n.shiftKey;c&&isWindows()&&(l=l-o+s,o=s,u-=s,s=0);var d=__read(optimizeScrollXY(o,s,a==null?void 0:a.scrollSpeedRatio),2),f=d[0],h=d[1];if(e.spreadsheet.hideTooltip(),e.spreadsheet.interaction.clearHoverTimer(),!e.isScrollOverTheViewport({deltaX:f,deltaY:h,offsetX:l,offsetY:u})){e.stopScrollChainingIfNeeded(n);return}e.stopScrollChaining(n),e.spreadsheet.interaction.addIntercepts([InterceptType.HOVER]),e.cancelScrollFrame()&&(e.scrollFrameId=requestAnimationFrame(function(){var p,v=e.getScrollOffset(),g=v.scrollX,y=v.scrollY,m=v.rowHeaderScrollX;f!==0&&(e.showHorizontalScrollBar(),e.updateHorizontalRowScrollOffset({offsetX:l,offsetY:u,offset:f+m}),e.updateHorizontalScrollOffset({offsetX:l,offsetY:u,offset:f+g})),h!==0&&(e.showVerticalScrollBar(),(p=e.vScrollBar)===null||p===void 0||p.emitScrollChange(h+y)),e.delayHideScrollbarOnMobile(),e.clearScrollFrameIdOnMobile()}))},this.realDataCellRender=function(n,a){var o=e.calculateXYIndexes(n,a);DebuggerUtil.getInstance().logger("realDataCellRender:",e.preCellIndexes,o);var s=diffPanelIndexes(e.preCellIndexes,o),l=s.add,u=s.remove;DebuggerUtil.getInstance().debugCallback(DEBUG_VIEW_RENDER,function(){forEach(l,function(d){var f,h,p=__read(d,2),v=p[0],g=p[1],y=e.getCellMeta(g,v);if(y){var m=(h=(f=e.spreadsheet.options).dataCell)===null||h===void 0?void 0:h.call(f,y);if(!m)return;m.position=[g,v],m.name="".concat(v,"-").concat(g),e.addDataCell(m)}});var c=getAllChildCells(e.panelGroup.children,DataCell);forEach(u,function(d){var f=__read(d,2),h=f[0],p=f[1],v=find(c,function(g){return g.name==="".concat(h,"-").concat(p)});v==null||v.remove()}),DebuggerUtil.getInstance().logger("Render Cell Panel: ".concat(c==null?void 0:c.length,", Add: ").concat(l==null?void 0:l.length,", Remove: ").concat(u==null?void 0:u.length))}),e.preCellIndexes=o,e.spreadsheet.emit(S2Event.LAYOUT_AFTER_REAL_DATA_CELL_RENDER,{add:l,remove:u,spreadsheet:e.spreadsheet})},this.getGridInfo=function(){var n=__read(e.preCellIndexes.center,4),a=n[0],o=n[1],s=n[2],l=n[3],u=getColsForGrid(a,o,e.layoutResult.colLeafNodes),c=getRowsForGrid(s,l,e.viewCellHeights);return{cols:u,rows:c}},this.onAfterScroll=debounce(function(){var n=e.spreadsheet,a=n.interaction,o=n.container;if(!a.isSelectedState()&&(a.removeIntercepts([InterceptType.HOVER]),a.getHoverAfterScroll())){var s=a.eventController.canvasMousemoveEvent;if(s){var l=s.x,u=s.y,c=o.document.elementFromPointSync(l,u);c&&o.emit(OriginEventType.POINTER_MOVE,__assign(__assign({},s),{shape:c,target:c,timestamp:performance.now()}))}}},300),this.getCellChildrenNodes=function(n){var a,o=(a=n==null?void 0:n.getMeta)===null||a===void 0?void 0:a.call(n),s=(n==null?void 0:n.cellType)===CellType.ROW_CELL,l=e.spreadsheet.isHierarchyTreeType();return l&&s?Node$1.getAllLeaveNodes(o).filter(function(u){return u.rowIndex===o.rowIndex}):Node$1.getAllChildrenNodes(o)},this.spreadsheet=r,this.init()}return Object.defineProperty(t.prototype,"scrollBarTheme",{get:function(){return this.spreadsheet.theme.scrollBar},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scrollBarSize",{get:function(){var r;return(r=this.scrollBarTheme)===null||r===void 0?void 0:r.size},enumerable:!1,configurable:!0}),t.prototype.initGroups=function(){var r=this.spreadsheet.container;this.backgroundGroup=r.appendChild(new Group({name:KEY_GROUP_BACK_GROUND,style:{zIndex:BACK_GROUND_GROUP_CONTAINER_Z_INDEX}})),this.initPanelGroups(),this.foregroundGroup=r.appendChild(new Group({name:KEY_GROUP_FORE_GROUND,style:{zIndex:FRONT_GROUND_GROUP_CONTAINER_Z_INDEX}}))},t.prototype.initPanelGroups=function(){var r=this.spreadsheet.container;this.panelGroup=r.appendChild(new Group({name:KEY_GROUP_PANEL_GROUND,style:{zIndex:PANEL_GROUP_GROUP_CONTAINER_Z_INDEX}})),this.panelScrollGroup=new PanelScrollGroup({name:KEY_GROUP_PANEL_SCROLL,zIndex:PANEL_GROUP_SCROLL_GROUP_Z_INDEX,s2:this.spreadsheet}),this.panelGroup.appendChild(this.panelScrollGroup)},t.prototype.getCellCustomSize=function(r,e){return isFunction(e)?e==null?void 0:e(r):e},t.prototype.getRowCellDraggedWidth=function(r){var e,n,a,o=this.spreadsheet.options.style.rowCell;return(n=(e=o==null?void 0:o.widthByField)===null||e===void 0?void 0:e[r==null?void 0:r.id])!==null&&n!==void 0?n:(a=o==null?void 0:o.widthByField)===null||a===void 0?void 0:a[r==null?void 0:r.field]},t.prototype.getRowCellDraggedHeight=function(r){var e,n,a,o=this.spreadsheet.options.style.rowCell;return(n=(e=o==null?void 0:o.heightByField)===null||e===void 0?void 0:e[r==null?void 0:r.id])!==null&&n!==void 0?n:(a=o==null?void 0:o.heightByField)===null||a===void 0?void 0:a[r==null?void 0:r.field]},t.prototype.getRowCellHeight=function(r){var e,n,a,o=this.spreadsheet.options.style,s=o.rowCell,l=o.dataCell;return(a=(n=(e=this.getRowCellDraggedHeight(r))!==null&&e!==void 0?e:this.getCellCustomSize(r,s==null?void 0:s.height))!==null&&n!==void 0?n:l==null?void 0:l.height)!==null&&a!==void 0?a:0},t.prototype.getColCellDraggedWidth=function(r){var e,n,a,o=this.spreadsheet.options.style.colCell;return(n=(e=o==null?void 0:o.widthByField)===null||e===void 0?void 0:e[r==null?void 0:r.id])!==null&&n!==void 0?n:(a=o==null?void 0:o.widthByField)===null||a===void 0?void 0:a[r==null?void 0:r.field]},t.prototype.getColCellDraggedHeight=function(r){var e,n,a,o=this.spreadsheet.options.style.colCell;return(n=(e=o==null?void 0:o.heightByField)===null||e===void 0?void 0:e[r==null?void 0:r.id])!==null&&n!==void 0?n:(a=o==null?void 0:o.heightByField)===null||a===void 0?void 0:a[r==null?void 0:r.field]},t.prototype.getColNodeHeight=function(r,e){var n,a;if(!r)return 0;var o=this.spreadsheet.options.style.colCell,s=(n=this.getColCellDraggedHeight(r))!==null&&n!==void 0?n:this.getCellCustomSize(r,o==null?void 0:o.height);if(isNumber(s)&&s!==((a=DEFAULT_STYLE.colCell)===null||a===void 0?void 0:a.height))return s;var l=this.spreadsheet.isTableMode()?TableColCell:ColCell,u=new l(r,this.spreadsheet,{shallowRender:!0}),c=this.getDefaultColNodeHeight(r,e);return this.getCellAdaptiveHeight(u,c)},t.prototype.getDefaultColNodeHeight=function(r,e){var n,a,o,s;if(!r)return 0;var l=this.spreadsheet.options.style.colCell,u=((a=(n=e==null?void 0:e.sampleNodesForAllLevels)===null||n===void 0?void 0:n.find(function(d){return d.level===r.level}))===null||a===void 0?void 0:a.height)||0,c=(s=(o=this.getColCellDraggedHeight(r))!==null&&o!==void 0?o:this.getCellCustomSize(r,l==null?void 0:l.height))!==null&&s!==void 0?s:0;return Math.max(c,u)},t.prototype.getCellAdaptiveHeight=function(r,e){if(!r)return e;var n=r.getStyle().cell.padding;r.drawTextShape();var a=r.getTextShape().parsedStyle,o=r.getActualTextHeight(),s=o+n.top+n.bottom;return(a==null?void 0:a.maxLines)>1&&o>=e?s:e},t.prototype.updateColsHierarchySampleMaxHeightNodes=function(r){var e=this,n=r.sampleNodesForAllLevels.map(function(a){var o=maxBy(r.getNodes(a.level).filter(function(s){return!s.isTotals}),function(s){return e.getColNodeHeight(s,r)});return o});r.sampleNodesForAllLevels=compact(n),r.sampleNodesForAllLevels.forEach(function(a){var o;if(a.height=e.getColNodeHeight(a,r),a.level===0)a.y=0;else{var s=(o=r.sampleNodesForAllLevels[a.level-1])!==null&&o!==void 0?o:{y:0,height:0};a.y=s.y+s.height}r.height+=a.height})},t.prototype.render=function(){areAllFieldsEmpty(this.spreadsheet.dataCfg.fields)||(this.adjustScrollOffset(),this.renderHeaders(),this.renderScrollBars(),this.renderBackground(),this.dynamicRenderCell())},t.prototype.adjustScrollOffset=function(){var r=this.getAdjustedScrollOffset(this.getScrollOffset());this.setScrollOffset(r)},t.prototype.getSeriesNumberWidth=function(){var r,e,n=this.spreadsheet.options.seriesNumber;return n!=null&&n.enable&&(e=(r=this.spreadsheet.theme.rowCell)===null||r===void 0?void 0:r.seriesNumberWidth)!==null&&e!==void 0?e:0},t.prototype.getCanvasSize=function(){var r=this.spreadsheet.options,e=r.width,n=e===void 0?0:e,a=r.height,o=a===void 0?0:a;return{width:n,height:o}},t.prototype.getContentHeight=function(){var r=this.layoutResult,e=r.rowsHierarchy,n=r.colsHierarchy;return e.height+n.height},t.prototype.updateScrollOffset=function(r){var e,n,a,o,s,l;if(((e=r.rowHeaderOffsetX)===null||e===void 0?void 0:e.value)!==void 0){!((n=r.rowHeaderOffsetX)===null||n===void 0)&&n.animate?this.scrollWithAnimation(r):this.scrollImmediately(r);return}if(((a=r.offsetX)===null||a===void 0?void 0:a.value)!==void 0){!((o=r.offsetX)===null||o===void 0)&&o.animate?this.scrollWithAnimation(r):this.scrollImmediately(r);return}((s=r.offsetY)===null||s===void 0?void 0:s.value)!==void 0&&(!((l=r.offsetY)===null||l===void 0)&&l.animate?this.scrollWithAnimation(r):this.scrollImmediately(r))},t.prototype.getPaginationScrollY=function(){var r=this.spreadsheet.options.pagination;if(r){var e=r.current,n=e===void 0?DEFAULT_PAGE_INDEX:e,a=r.pageSize,o=this.viewCellHeights,s=Math.max((n-1)*a,0);return o.getCellOffsetY(s)}return 0},t.prototype.destroy=function(){this.unbindEvents(),this.clearAllGroup(),this.preCellIndexes=null,cancelAnimationFrame(this.scrollFrameId)},t.prototype.calculateCornerBBox=function(){this.cornerBBox=new CornerBBox(this,!0)},t.prototype.getCellRange=function(){var r=this.spreadsheet.options.pagination;return getCellRange(this.viewCellHeights,r)},t.prototype.clearAllGroup=function(){for(var r=this.panelGroup.children,e=r===void 0?[]:r,n=e.length-1;n>=0;n--){var a=e[n];a instanceof Group?a.removeChildren():e[n].remove()}this.foregroundGroup.removeChildren(),this.backgroundGroup.removeChildren()},t.prototype.translateRelatedGroups=function(r,e,n){var a,o,s,l,u,c;translateGroup(this.panelScrollGroup,this.panelBBox.x-r,this.panelBBox.y-e),(a=this.rowHeader)===null||a===void 0||a.onScrollXY(this.getRealScrollX(r,n),e,KEY_GROUP_ROW_RESIZE_AREA),(o=this.seriesNumberHeader)===null||o===void 0||o.onScrollXY(this.getRealScrollX(r,n),e,KEY_GROUP_ROW_INDEX_RESIZE_AREA),(s=this.cornerHeader)===null||s===void 0||s.onCorScroll(this.getRealScrollX(r,n),KEY_GROUP_CORNER_RESIZE_AREA),(l=this.centerFrame)===null||l===void 0||l.onChangeShadowVisibility(r,this.getRealWidth()-this.panelBBox.width),(u=this.centerFrame)===null||u===void 0||u.onBorderScroll(this.getCenterFrameScrollX(r)),(c=this.columnHeader)===null||c===void 0||c.onColScroll(r,KEY_GROUP_COL_RESIZE_AREA)},t.prototype.getCenterFrameScrollX=function(r){return this.getRealScrollX(r)},t.prototype.init=function(){var r=this;this.initGroups(),DebuggerUtil.getInstance().debugCallback(DEBUG_HEADER_LAYOUT,function(){r.layoutResult=r.doLayout(),r.saveInitColumnLeafNodes(r.layoutResult.colLeafNodes),r.spreadsheet.emit(S2Event.LAYOUT_AFTER_HEADER_LAYOUT,r.layoutResult)}),this.calculateCellWidthHeight(),this.calculateCornerBBox(),this.calculatePanelBBox(),this.bindEvents()},t.prototype.renderBackground=function(){var r=this.getCanvasSize(),e=r.width,n=r.height,a=this.spreadsheet.theme.background,o=a.color,s=a.opacity;this.backgroundGroup.appendChild(new Rect({style:{fill:o,opacity:s,x:0,y:0,width:e,height:n}}))},t.prototype.renderScrollBars=function(){var r=this.getScrollOffset(),e=r.scrollX,n=r.scrollY,a=r.rowHeaderScrollX,o=this.panelBBox,s=o.width,l=o.height,u=this.layoutResult.colsHierarchy.width,c=this.getRealHeight();this.renderRowScrollBar(a),this.renderHScrollBar(s,u,e),this.renderVScrollBar(l,c,n)},t.prototype.renderHeaders=function(){var r=this.getSeriesNumberWidth();this.rowHeader=this.getRowHeader(),this.columnHeader=this.getColHeader(),r>0&&!this.seriesNumberHeader&&(this.seriesNumberHeader=this.getSeriesNumberHeader()),this.cornerHeader=this.getCornerHeader(),this.centerFrame=this.getCenterFrame(),this.seriesNumberHeader&&this.foregroundGroup.appendChild(this.seriesNumberHeader),this.rowHeader&&this.foregroundGroup.appendChild(this.rowHeader),this.foregroundGroup.appendChild(this.columnHeader),this.foregroundGroup.appendChild(this.cornerHeader),this.foregroundGroup.appendChild(this.centerFrame)},t.prototype.getRowHeaderCfg=function(){var r=this.panelBBox,e=r.y,n=r.viewportHeight,a=r.viewportWidth,o=r.height,s=this.getSeriesNumberWidth();return{width:this.cornerBBox.width,height:o,viewportWidth:a,viewportHeight:n,position:{x:s,y:e},nodes:this.layoutResult.rowNodes,spreadsheet:this.spreadsheet}},t.prototype.getRowHeader=function(){return this.rowHeader?this.rowHeader:new RowHeader(this.getRowHeaderCfg())},t.prototype.getColHeader=function(){if(!this.columnHeader){var r=this.panelBBox,e=r.x,n=r.width,a=r.viewportHeight,o=r.viewportWidth;return new ColHeader({width:n,cornerWidth:this.cornerBBox.width,height:this.cornerBBox.height,viewportWidth:o,viewportHeight:a,position:{x:e,y:0},nodes:this.layoutResult.colNodes,sortParam:this.spreadsheet.store.get("sortParam"),spreadsheet:this.spreadsheet})}return this.columnHeader},t.prototype.getCornerHeader=function(){return this.cornerHeader||CornerHeader.getCornerHeader({panelBBox:this.panelBBox,cornerBBox:this.cornerBBox,seriesNumberWidth:this.getSeriesNumberWidth(),layoutResult:this.layoutResult,spreadsheet:this.spreadsheet})},t.prototype.getSeriesNumberHeader=function(){return this.seriesNumberHeader||SeriesNumberHeader.getSeriesNumberHeader({spreadsheet:this.spreadsheet,panelBBox:this.panelBBox,cornerWidth:this.cornerBBox.width,seriesNumberWidth:this.getSeriesNumberWidth(),rowsHierarchy:this.layoutResult.rowsHierarchy})},t.prototype.getCenterFrame=function(){var r;if(!this.centerFrame){var e=this.panelBBox,n=e.viewportWidth,a=e.viewportHeight,o=this.cornerBBox.width,s=this.cornerBBox.height,l=(r=this.spreadsheet.options)===null||r===void 0?void 0:r.frame,u={position:{x:this.cornerBBox.x,y:this.cornerBBox.y},cornerWidth:o,cornerHeight:s,viewportWidth:n,viewportHeight:a,showViewportLeftShadow:!1,showViewportRightShadow:!1,spreadsheet:this.spreadsheet};return l?l(u):new Frame(u)}return this.centerFrame},t.prototype.updatePanelScrollGroup=function(){this.gridInfo=this.getGridInfo(),this.panelScrollGroup.update(this.gridInfo)},t.prototype.dynamicRenderCell=function(r){var e=this.getScrollOffset(),n=e.scrollX,a=e.scrollY,o=e.rowHeaderScrollX,s=a+this.getPaginationScrollY();this.spreadsheet.hideTooltip(),this.spreadsheet.interaction.clearHoverTimer(),this.realDataCellRender(n,s),this.updatePanelScrollGroup(),this.translateRelatedGroups(n,s,o),this.clip(n,s),r||this.emitScrollEvent({scrollX:n,scrollY:s,rowHeaderScrollX:o}),this.onAfterScroll()},t.prototype.emitScrollEvent=function(r){this.spreadsheet.emit(S2Event.GLOBAL_SCROLL,r)},t.prototype.saveInitColumnLeafNodes=function(r){r===void 0&&(r=[]);var e=this.spreadsheet,n=e.store,a=e.options,o=a.interaction.hiddenColumnFields,s=o===void 0?[]:o,l=r.length+s.length,u=this.getInitColLeafNodes();l!==(u==null?void 0:u.length)&&n.set("initColLeafNodes",r)},t.prototype.getHiddenColumnsInfo=function(r){var e=this.spreadsheet.store.get("hiddenColumnsDetail",[]);if(!isEmpty(e))return e.find(function(n){var a;return(a=n==null?void 0:n.hideColumnNodes)===null||a===void 0?void 0:a.some(function(o){return o.id===r.id})})},t.prototype.updateCustomFieldsSampleNodes=function(r){if(this.spreadsheet.isCustomColumnFields()){var e=r.getNodes().filter(function(n){var a;return(a=r.sampleNodeForLastLevel)===null||a===void 0?void 0:a.id.includes(n.id)});r.sampleNodesForAllLevels=e,r.height=sumBy(e,"height")}},t.prototype.adjustRowLeafNodesWidth=function(r){this.spreadsheet.isCustomRowFields()&&this.adjustLeafNodesSize("width")(r)},t.prototype.adjustColLeafNodesHeight=function(r){this.spreadsheet.isCustomColumnFields()&&this.adjustLeafNodesSize("height")(r)},t.prototype.adjustLeafNodesSize=function(r){return function(e){var n=e.leafNodes,a=e.hierarchy,o=a.sampleNodeForLastLevel,s=a.sampleNodesForAllLevels;n.forEach(function(l){if(!(l.level>(o==null?void 0:o.level))){var u=sumBy(s,function(c){return c.level<l.level?0:c[r]});l[r]=u}})}},t.prototype.getHeaderNodes=function(r){var e=concat(this.getCornerNodes(),this.getSeriesNumberNodes(),this.getRowNodes(),this.getColNodes());return r?e.filter(function(n){return r.includes(n.id)}):e},t.prototype.getCornerNodes=function(){var r;return((r=this.cornerHeader)===null||r===void 0?void 0:r.getNodes())||[]},t.prototype.getSeriesNumberNodes=function(){var r;return((r=this.seriesNumberHeader)===null||r===void 0?void 0:r.getNodes())||[]},t.prototype.getColNodes=function(r){var e=this.layoutResult.colNodes,n=e===void 0?[]:e;return isNil(r)?n:n.filter(function(a){return a.level===r})},t.prototype.getTopLevelColNodes=function(){return this.getColNodes(0)},t.prototype.getColNodeById=function(r){return this.getColNodes().find(function(e){return e.id===r})},t.prototype.getColNodeByIndex=function(r){return this.getColNodes().find(function(e){return e.colIndex===r})},t.prototype.getColLeafNodeByIndex=function(r){return this.getColLeafNodes().find(function(e){return e.colIndex===r})},t.prototype.getColNodesByField=function(r){return this.getColNodes().filter(function(e){return e.field===r})},t.prototype.getColLeafNodes=function(){var r;return((r=this.layoutResult)===null||r===void 0?void 0:r.colLeafNodes)||[]},t.prototype.getColTotalsNodes=function(r){return this.getColNodes(r).filter(function(e){return e.isTotals})},t.prototype.getColSubTotalsNodes=function(r){return this.getColTotalsNodes(r).filter(function(e){return e.isSubTotals})},t.prototype.getColGrandTotalsNodes=function(r){return this.getColTotalsNodes(r).filter(function(e){return e.isGrandTotals})},t.prototype.getRowNodes=function(r){var e=this.layoutResult.rowNodes,n=e===void 0?[]:e;return isNil(r)?n:n.filter(function(a){return a.level===r})},t.prototype.getRowNodeById=function(r){return this.getRowNodes().find(function(e){return e.id===r})},t.prototype.getRowNodeByIndex=function(r){return this.getRowNodes().find(function(e){return e.rowIndex===r})},t.prototype.getRowLeafNodeByIndex=function(r){return this.getRowLeafNodes().find(function(e){return e.rowIndex===r})},t.prototype.getRowNodesByField=function(r){return this.getRowNodes().filter(function(e){return e.field===r})},t.prototype.getRowLeafNodes=function(){var r;return((r=this.layoutResult)===null||r===void 0?void 0:r.rowLeafNodes)||[]},t.prototype.getRowTotalsNodes=function(r){return this.getRowNodes(r).filter(function(e){return e.isTotals})},t.prototype.getRowSubTotalsNodes=function(r){return this.getRowTotalsNodes(r).filter(function(e){return e.isSubTotals})},t.prototype.getRowGrandTotalsNodes=function(r){return this.getRowTotalsNodes(r).filter(function(e){return e.isGrandTotals})},t.prototype.getDataCells=function(){var r;return getAllChildCells((r=this.panelGroup)===null||r===void 0?void 0:r.children,DataCell)},t.prototype.getRowCells=function(){var r,e=((r=this.getRowHeader())===null||r===void 0?void 0:r.children)||[];return getAllChildCells(e,RowCell).filter(function(n){return n.cellType===CellType.ROW_CELL})},t.prototype.getRowLeafCells=function(){return this.getRowCells().filter(function(r){return r.getMeta().isLeaf})},t.prototype.getColCells=function(){var r,e=((r=this.getColHeader())===null||r===void 0?void 0:r.children)||[];return getAllChildCells(e,ColCell).filter(function(n){return n.cellType===CellType.COL_CELL})},t.prototype.getColLeafCells=function(){return this.getColCells().filter(function(r){return r.getMeta().isLeaf})},t.prototype.getMergedCells=function(){return filter(this.panelScrollGroup.getMergedCellsGroup().children,function(r){return r instanceof MergedCell})},t.prototype.getCornerCells=function(){return filter(this.getCornerHeader().children,function(r){return r instanceof CornerCell})},t.prototype.getHeaderCells=function(r){var e=concat(this.getCornerCells(),this.getSeriesNumberCells(),this.getRowCells(),this.getColCells());return r?e.filter(function(n){return r.includes(n.getMeta().id)}):e},t.prototype.getCellById=function(r){return this.getCells().find(function(e){return e.getMeta().id===r})},t.prototype.getCellsByField=function(r){return this.getCells().filter(function(e){return e.getMeta().field===r})},t.prototype.getCells=function(r){var e=concat(this.getHeaderCells(),this.getDataCells());return r?e.filter(function(n){return r.includes(n.getMeta().id)}):e},t.prototype.getInitColLeafNodes=function(){return this.spreadsheet.store.get("initColLeafNodes",[])},t.prototype.clearInitColLeafNodes=function(){this.spreadsheet.store.set("initColLeafNodes",void 0)},t}(),FrozenGroup=function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r}(GridGroup),FrozenFacet=function(t){__extends(r,t);function r(){var e,n=t!==null&&t.apply(this,arguments)||this;return n.frozenGroupInfo=(e={},e[FrozenGroupType.FROZEN_COL]={width:0,x:0,range:[]},e[FrozenGroupType.FROZEN_TRAILING_COL]={width:0,x:0,range:[]},e[FrozenGroupType.FROZEN_ROW]={height:0,y:0,range:[]},e[FrozenGroupType.FROZEN_TRAILING_ROW]={height:0,y:0,range:[]},e),n.panelScrollGroupIndexes=[0,0,0,0],n.addDataCell=function(a){var o=n.getFrozenOptions(),s=o.rowCount,l=s===void 0?0:s,u=o.colCount,c=u===void 0?0:u,d=o.trailingRowCount,f=d===void 0?0:d,h=o.trailingColCount,p=h===void 0?0:h,v=n.getColNodes().length,g=n.getCellRange(),y=n.getRealFrozenColumns(c,p),m=y.colCount,S=y.trailingColCount,w=getFrozenDataCellType(a.getMeta(),{rowCount:l,trailingRowCount:f,colCount:m,trailingColCount:S},v,g),R=FrozenCellGroupMap[w];if(R){var T=n[R];T.appendChild(a)}setTimeout(function(){n.spreadsheet.emit(S2Event.DATA_CELL_RENDER,a),n.spreadsheet.emit(S2Event.LAYOUT_CELL_RENDER,a)},100)},n.addFrozenCell=function(a,o,s){var l,u,c=n.getCellMeta(o,a);if(c){c.isFrozenCorner=!0;var d=(u=(l=n.spreadsheet.options).dataCell)===null||u===void 0?void 0:u.call(l,c);s.appendChild(d)}},n.translateFrozenGroups=function(){var a=n.getScrollOffset(),o=a.scrollY,s=a.scrollX,l=n.getPaginationScrollY(),u=n.panelBBox,c=u.x,d=u.y;translateGroup(n.frozenTopGroup,c,d-l),translateGroup(n.frozenBottomGroup,c,d),translateGroup(n.frozenRowGroup,c-s,d-l),translateGroup(n.frozenTrailingRowGroup,c-s,d),translateGroup(n.frozenColGroup,c,d-o-l),translateGroup(n.frozenTrailingColGroup,c,d-o-l)},n.renderFrozenGroupSplitLine=function(a,o){var s,l=n.panelBBox,u=l.width,c=l.height,d=l.viewportWidth,f=l.viewportHeight,h=l.x,p=l.y,v=n.getTopLevelColNodes(),g=n.getCellRange(),y=n.getFrozenOptions(),m=y.rowCount,S=m===void 0?0:m,w=y.colCount,R=w===void 0?0:w,T=y.trailingColCount,x=T===void 0?0:T,b=y.trailingRowCount,L=b===void 0?0:b,M=Math.floor(o-n.getPaginationScrollY()),D=Math.max(0,last(n.viewCellWidths)-d),N=Math.max(0,n.viewCellHeights.getCellOffsetY(g.end+1)-n.viewCellHeights.getCellOffsetY(g.start)-f);(s=n.foregroundGroup.getElementById(KEY_GROUP_FROZEN_SPLIT_LINE))===null||s===void 0||s.remove();var F=n.spreadsheet.theme.splitLine,k=n.foregroundGroup.appendChild(new Group({id:KEY_GROUP_FROZEN_SPLIT_LINE,style:{zIndex:FRONT_GROUND_GROUP_FROZEN_Z_INDEX}})),H={lineWidth:SPLIT_LINE_WIDTH,stroke:F==null?void 0:F.verticalBorderColor,opacity:F==null?void 0:F.verticalBorderColorOpacity},G={lineWidth:SPLIT_LINE_WIDTH,stroke:F==null?void 0:F.horizontalBorderColor,opacity:F==null?void 0:F.horizontalBorderColorOpacity},z=Frame.getVerticalBorderWidth(n.spreadsheet);if(R>0){var $=v.reduce(function(J,j,ne){return ne<R?J+j.width:J},0),W=(L>0?c:f)+p;renderLine(k,__assign(__assign({},H),{x1:$+h,x2:$+h,y1:0,y2:W})),F!=null&&F.showShadow&&a>0&&k.appendChild(new Rect({style:{x:$+h,y:0,width:F==null?void 0:F.shadowWidth,height:W,fill:n.getShadowFill(0)}}))}if(S>0){var V=p+n.getTotalHeightForRange(g.start,g.start+S-1),X=x>0?u:d;renderLine(k,__assign(__assign({},G),{x1:0,x2:X+z,y1:V,y2:V})),F!=null&&F.showShadow&&M>0&&k.appendChild(new Rect({style:{x:0,y:V,width:X+z,height:F==null?void 0:F.shadowWidth,fill:n.getShadowFill(90)}}))}if(x>0){var $=v[v.length-x].x,W=(L?c:f)+p;renderLine(k,__assign(__assign({},H),{x1:$+h,x2:$+h,y1:0,y2:W})),F!=null&&F.showShadow&&floor(a)<floor(D)&&k.appendChild(new Rect({style:{x:$+h-F.shadowWidth,y:0,width:F.shadowWidth,height:W,fill:n.getShadowFill(180)}}))}if(L>0){var V=n.panelBBox.maxY-n.getTotalHeightForRange(g.end-L+1,g.end),X=x>0?u:d;renderLine(k,__assign(__assign({},G),{x1:0,x2:X+z,y1:V,y2:V})),F!=null&&F.showShadow&&M<floor(N)&&k.appendChild(new Rect({style:{x:0,y:V-F.shadowWidth,width:X+z,height:F.shadowWidth,fill:n.getShadowFill(270)}}))}},n.renderFrozenPanelCornerGroup=function(){var a=n.getTopLevelColNodes(),o=n.getCellRange(),s=n.getFrozenOptions(),l=s.rowCount,u=l===void 0?0:l,c=s.colCount,d=c===void 0?0:c,f=s.trailingRowCount,h=f===void 0?0:f,p=s.trailingColCount,v=p===void 0?0:p,g=getFrozenLeafNodesCount(a,d,v),y=g.colCount,m=g.trailingColCount,S=calculateFrozenCornerCells({rowCount:u,colCount:y,trailingRowCount:h,trailingColCount:m},n.getColLeafNodes().length,o);Object.keys(S).forEach(function(w){var R=S[w],T=n[FrozenCellGroupMap[w]];T&&R.forEach(function(x){n.addFrozenCell(x.x,x.y,T)})})},n.getRealFrozenColumns=function(a,o){if(a||o){var s=n.getTopLevelColNodes();return getFrozenLeafNodesCount(s,a,o)}return{colCount:a,trailingColCount:o}},n.getTotalHeightForRange=function(a,o){if(a<0||o<0)return 0;if(n.rowOffsets)return n.rowOffsets[o+1]-n.rowOffsets[a];for(var s=0,l=a;l<o+1;l++){var u=n.getDefaultCellHeight();s+=u}return s},n.getShadowFill=function(a){var o,s,l=n.spreadsheet.theme.splitLine;return"l (".concat(a,") 0:").concat((o=l==null?void 0:l.shadowColors)===null||o===void 0?void 0:o.left," 1:").concat((s=l==null?void 0:l.shadowColors)===null||s===void 0?void 0:s.right)},n}return r.prototype.initPanelGroups=function(){var e,n=this;t.prototype.initPanelGroups.call(this),e=__read([KEY_GROUP_PANEL_FROZEN_ROW,KEY_GROUP_PANEL_FROZEN_COL,KEY_GROUP_PANEL_FROZEN_TRAILING_ROW,KEY_GROUP_PANEL_FROZEN_TRAILING_COL,KEY_GROUP_PANEL_FROZEN_TOP,KEY_GROUP_PANEL_FROZEN_BOTTOM].map(function(a){var o=new FrozenGroup({name:a,zIndex:PANEL_GROUP_FROZEN_GROUP_Z_INDEX,s2:n.spreadsheet});return n.panelGroup.appendChild(o),o}),6),this.frozenRowGroup=e[0],this.frozenColGroup=e[1],this.frozenTrailingRowGroup=e[2],this.frozenTrailingColGroup=e[3],this.frozenTopGroup=e[4],this.frozenBottomGroup=e[5]},r.prototype.getFrozenOptions=function(){var e=this.getColLeafNodes().length,n=this.getCellRange();return getValidFrozenOptions(this.spreadsheet.options.frozen,e,n.end-n.start+1)},r.prototype.calculateFrozenGroupInfo=function(){var e=this.getFrozenOptions(),n=e.colCount,a=n===void 0?0:n,o=e.rowCount,s=o===void 0?0:o,l=e.trailingColCount,u=l===void 0?0:l,c=e.trailingRowCount,d=c===void 0?0:c,f=this.getTopLevelColNodes(),h=this.viewCellHeights,p=this.getCellRange(),v=this.frozenGroupInfo,g=v.frozenCol,y=v.frozenTrailingCol,m=v.frozenRow,S=v.frozenTrailingRow;a>0&&(g.width=f[a-1].x+f[a-1].width,g.x=0,g.range=[0,a-1]),s>0&&(m.height=h.getCellOffsetY(p.start+s)-h.getCellOffsetY(p.start),m.y=0,m.range=[p.start,p.start+s-1]),u>0&&(y.width=f[f.length-1].x-f[f.length-u].x+f[f.length-1].width,y.x=this.panelBBox.width-y.width,y.range=[f.length-u,f.length-1]),d>0&&(S.height=h.getCellOffsetY(p.end+1)-h.getCellOffsetY(p.end+1-d),S.y=this.panelBBox.height-S.height,S.range=[p.end-d+1,p.end])},r.prototype.getFinalViewport=function(){var e=this.panelBBox,n=e.viewportHeight,a=e.viewportWidth,o=this.getFrozenOptions(),s=o.colCount,l=s===void 0?0:s,u=o.rowCount,c=u===void 0?0:u,d=o.trailingColCount,f=d===void 0?0:d,h=o.trailingRowCount,p=h===void 0?0:h,v={width:a,height:n,x:0,y:0};if(l>0||f>0){var g=this.frozenGroupInfo,y=g.frozenTrailingCol,m=g.frozenCol;v.width-=y.width+m.width,v.x+=m.width}if(c>0||p>0){var S=this.frozenGroupInfo,w=S.frozenRow,R=S.frozenTrailingRow;v.height<w.height+R.height?(v.height=0,v.y=0):(v.height-=w.height+R.height,v.y+=w.height)}return v},r.prototype.calculateXYIndexes=function(e,n){var a,o,s=this.getColLeafNodes().length,l=this.getCellRange(),u=this.getFrozenOptions(),c=u.colCount,d=c===void 0?0:c,f=u.rowCount,h=f===void 0?0:f,p=u.trailingColCount,v=p===void 0?0:p,g=u.trailingRowCount,y=g===void 0?0:g,m=this.getFinalViewport(),S=this.spreadsheet.isTableMode()&&(!((o=(a=this.spreadsheet.dataSet)===null||a===void 0?void 0:a.isEmpty)===null||o===void 0)&&o.call(a))?this.spreadsheet.dataSet.getEmptyViewIndexes():calculateInViewIndexes({scrollX:e,scrollY:n,widths:this.viewCellWidths,heights:this.viewCellHeights,viewport:m,rowRemainWidth:this.getRealScrollX(this.cornerBBox.width)});this.panelScrollGroupIndexes=S;var w=this.getRealFrozenColumns(d,v),R=w.colCount,T=w.trailingColCount;return splitInViewIndexesWithFrozen(S,{colCount:R,trailingColCount:T,rowCount:h,trailingRowCount:y},s,l)},r.prototype.updateFrozenGroupGrid=function(){var e=this;[FrozenGroupType.FROZEN_COL,FrozenGroupType.FROZEN_ROW,FrozenGroupType.FROZEN_TRAILING_COL,FrozenGroupType.FROZEN_TRAILING_ROW].forEach(function(n){if(e.frozenGroupInfo[n].range){var a=[],o=[];if(n.toLowerCase().includes("row")){var s=__read(e.frozenGroupInfo[n].range||[],2),l=s[0],u=s[1];if(a=e.gridInfo.cols,o=getRowsForGrid(l,u,e.viewCellHeights),n===FrozenGroupType.FROZEN_TRAILING_ROW){var c=e.frozenGroupInfo[FrozenGroupType.FROZEN_TRAILING_ROW].y;o=getFrozenRowsForGrid(l,u,c,e.viewCellHeights)}}else{var d=__read(e.frozenGroupInfo[n].range||[],2),f=d[0],h=d[1],p=e.getTopLevelColNodes();a=getColsForGrid(f,h,p),o=e.gridInfo.rows}e["".concat(n,"Group")].updateGrid({cols:a,rows:o},"".concat(n,"Group"))}})},r.prototype.updatePanelScrollGroup=function(){t.prototype.updatePanelScrollGroup.call(this),this.updateFrozenGroupGrid()},r.prototype.translateRelatedGroups=function(e,n,a){t.prototype.translateRelatedGroups.call(this,e,n,a),this.translateFrozenGroups(),this.updateRowResizeArea(),this.renderFrozenGroupSplitLine(e,n)},r.prototype.updateRowResizeArea=function(){},r.prototype.render=function(){this.calculateFrozenGroupInfo(),this.renderFrozenPanelCornerGroup(),t.prototype.render.call(this)},r.prototype.getCenterFrameScrollX=function(e){return this.getFrozenOptions().colCount>0?0:t.prototype.getCenterFrameScrollX.call(this,e)},r.prototype.getDefaultCellHeight=function(){return this.getRowCellHeight(null)},r.prototype.clip=function(){var e=this,n=e.frozenGroupInfo,a=e.spreadsheet,o=a.isFrozenRowHeader(),s=n[FrozenGroupType.FROZEN_COL].width,l=n[FrozenGroupType.FROZEN_TRAILING_COL].width,u=n[FrozenGroupType.FROZEN_ROW].height,c=n[FrozenGroupType.FROZEN_TRAILING_ROW].height,d=(o?this.panelBBox.x:0)+s,f=this.panelBBox.y+u,h=this.panelBBox.width-s-l+(o?0:this.panelBBox.x),p=this.panelBBox.height-u-c;this.panelScrollGroup.style.clipPath=new Rect({style:{x:d,y:f,width:h,height:p}}),this.frozenColGroup.style.clipPath=new Rect({style:{x:this.panelBBox.x,y:f,width:s,height:p}}),this.frozenTrailingColGroup.style.clipPath=new Rect({style:{x:this.panelBBox.x+this.panelBBox.width-l,y:f,width:l,height:p}}),this.frozenRowGroup.style.clipPath=new Rect({style:{x:d,y:this.panelBBox.y,width:h,height:u}}),this.frozenTrailingRowGroup.style.clipPath=new Rect({style:{x:d,y:this.panelBBox.y+this.panelBBox.height-c,width:h,height:c}})},r}(BaseFacet),buildCustomTreeHierarchy=function(t){var r,e=t.tree,n=e===void 0?[]:e,a=t.level,o=t.parentNode,s=t.hierarchy,l=t.spreadsheet,u=t.isRowHeader,c=(r=l.options.style)===null||r===void 0?void 0:r.rowCell,d=c.collapseFields,f=c.collapseAll,h=l.store.get("hiddenColumnsDetail")||[];n.forEach(function(p){var v,g,y=p.field,m=p.title,S=p.collapsed,w=p.children,R=__rest(p,["field","title","collapsed","children"]),T=h.some(function(G){var z=G.hideColumnNodes;return z.find(function($){return $.field===y})});if(!T){var x=(v={},v[EXTRA_FIELD]=y,v),b=generateId(o.id,y),L=S??!1,M=(g=d==null?void 0:d[b])!==null&&g!==void 0?g:d==null?void 0:d[y],D=M??(f||L),N=l.isHierarchyTreeType()&&u&&D,F=isEmpty(w),k=new Node$1({id:b,field:y,value:m,level:a,parent:o,isTotals:!1,isCollapsed:N,hierarchy:s,query:x,spreadsheet:l,isLeaf:F,extra:__assign(__assign({},R),{isCustomNode:!0})});a>s.maxLevel&&!k.isSeriesNumberNode()&&(s.maxLevel=a,s.sampleNodesForAllLevels.push(k),s.sampleNodeForLastLevel=k,s.maxLevel=a);var H=layoutHierarchy(l,o,k,s);!isEmpty(w)&&!N&&H&&buildCustomTreeHierarchy({spreadsheet:l,parentNode:k,level:a+1,hierarchy:s,tree:w||[],isRowHeader:u})}})},addTotals=function(t,r,e){var n=t.getTotalsConfig(r);if(n!=null&&n.showGrandTotals){var a=n.reverseGrandTotalsLayout?"unshift":"push";e[a](new TotalClass({label:n.grandTotalsLabel,isGrandTotals:!0,isSubTotals:!1,isTotalRoot:!1}))}},buildRowTreeHierarchy=function(t){var r,e,n,a,o,s,l,u,c,d,f=t.spreadsheet,h=t.parentNode,p=t.currentField,v=t.level,g=t.hierarchy,y=t.pivotMeta,m=h.query,S=h.id,w=((s=(o=(a=f.dataCfg)===null||a===void 0?void 0:a.fields)===null||o===void 0?void 0:o.rows)===null||s===void 0?void 0:s.length)<=v,R=filterOutDetail(Array.from(y.keys())),T=layoutArrange(f,R,h,p),x=f.store.get("drillItemsNum");w&&x>0&&(T=T.slice(0,x)),v===0&&addTotals(f,p,T);try{for(var b=__values(T),L=b.next();!L.done;L=b.next()){var M=L.value,D=M instanceof TotalClass,N=D?null:y.get(M),F=void 0,k=m,H=!1,G=!1;if(D){var z=M;H=z.isGrandTotals,G=z.isSubTotals,F=i18n(M.label),k=m}else F=M,k=__assign(__assign({},m),(n={},n[p]=F,n));var $=generateId(S,F),W=(l=f.options.style)===null||l===void 0?void 0:l.rowCell,V=W.collapseFields,X=W.collapseAll,J=W.expandDepth,j=(u=V==null?void 0:V[$])!==null&&u!==void 0?u:V==null?void 0:V[p],ne=isNumber(J)?v>J:null,Q=(c=j??ne)!==null&&c!==void 0?c:X,ie=new Node$1({id:$,value:F,level:v,parent:h,field:p,isTotals:D,isGrandTotals:H,isSubTotals:G,isCollapsed:Q,hierarchy:g,query:k,spreadsheet:f});v>g.maxLevel&&(g.maxLevel=v);var te=!(!((d=N==null?void 0:N.children)===null||d===void 0)&&d.size);(te||D)&&(ie.isLeaf=!0),te||(ie.isTotals=!0);var oe=layoutHierarchy(f,h,ie,g);!te&&!Q&&!D&&oe&&buildRowTreeHierarchy({level:v+1,currentField:N.childField,pivotMeta:N.children,parentNode:ie,hierarchy:g,spreadsheet:f})}}catch(ae){r={error:ae}}finally{try{L&&!L.done&&(e=b.return)&&e.call(b)}finally{if(r)throw r.error}}},handleCustomTreeHierarchy=function(t){var r=t.rootNode,e=t.hierarchy,n=t.fields,a=t.spreadsheet,o=t.isRowHeader,s=filter(n,function(l){return l!==EXTRA_FIELD});buildCustomTreeHierarchy({spreadsheet:a,tree:s,level:0,parentNode:r,hierarchy:e,isRowHeader:o})},handleGridRowColHierarchy=function(t){var r=t.isValueInCols,e=t.moreThanOneValue,n=t.rootNode,a=t.hierarchy,o=t.fields,s=t.isRowHeader,l=t.isCustomTreeFields,u=t.spreadsheet,c,d;s?(c=!r&&e,d=!r&&!e):(c=r&&e,d=r&&!e),l?handleCustomTreeHierarchy(t):buildGridHierarchy({spreadsheet:u,addTotalMeasureInTotal:c,addMeasureInTotalQuery:d,parentNode:n,currentField:o[0],fields:o,hierarchy:a})},handleTreeRowHierarchy=function(t){var r=t.spreadsheet,e=t.rootNode,n=t.hierarchy,a=t.isCustomTreeFields,o=r.dataSet.fields.rows;r.isHierarchyTreeType()&&!a?buildRowTreeHierarchy({level:0,currentField:o==null?void 0:o[0],pivotMeta:r.dataSet.rowPivotMeta,parentNode:e,hierarchy:n,spreadsheet:r}):handleCustomTreeHierarchy(t)},handleRowHeaderHierarchy=function(t){var r=t.spreadsheet;r.isHierarchyTreeType()?handleTreeRowHierarchy(t):handleGridRowColHierarchy(t)},handleTableHierarchy=function(t){var r,e=t.isCustomTreeFields,n=t.spreadsheet,a=(r=n.options.seriesNumber)!==null&&r!==void 0?r:{},o=a.enable,s=a.text;if(e){var l={field:SERIES_NUMBER_FIELD,title:getDefaultSeriesNumberText(s)},u=o?__spreadArray([l],__read(t.fields),!1):t.fields.filter(function(c){return(c==null?void 0:c.field)!==SERIES_NUMBER_FIELD});handleCustomTreeHierarchy(__assign(__assign({},t),{fields:u}));return}buildTableHierarchy(t)},handleColHeaderHierarchy=function(t){var r=t.spreadsheet,e=r.isPivotMode();e?handleGridRowColHierarchy(t):handleTableHierarchy(t)},buildHeaderHierarchy=function(t){var r=t.isRowHeader,e=t.spreadsheet,n=e.dataSet.fields,a=n.rows,o=a===void 0?[]:a,s=n.columns,l=s===void 0?[]:s,u=e.isValueInCols(),c=e.dataSet.moreThanOneValue(),d=Node$1.rootNode(),f=new Hierarchy,h=r?o:l,p=e.isCustomHeaderFields(r?"rows":"columns"),v={isValueInCols:u,moreThanOneValue:c,rootNode:d,hierarchy:f,spreadsheet:e,fields:h,isRowHeader:r,isCustomTreeFields:p};r?handleRowHeaderHierarchy(v):handleColHeaderHierarchy(v);var g=function(){return r&&e.isHierarchyTreeType()?f.getNodes():f.getLeaves()};return{hierarchy:f,leafNodes:g()}},PivotFacet=function(t){__extends(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.renderFrozenGroupSplitLine=function(n,a){var o;if((o=e.foregroundGroup.getElementById(KEY_GROUP_FROZEN_SPLIT_LINE))===null||o===void 0||o.remove(),e.enableFrozenFirstRow()){var s=floor(a-e.getPaginationScrollY()),l=e.foregroundGroup.appendChild(new Group({id:KEY_GROUP_FROZEN_SPLIT_LINE,style:{zIndex:FRONT_GROUND_GROUP_FROZEN_Z_INDEX}})),u=e.spreadsheet.theme.splitLine,c={lineWidth:SPLIT_LINE_WIDTH,stroke:u==null?void 0:u.horizontalBorderColor,opacity:u==null?void 0:u.horizontalBorderColorOpacity},d=e.getCellRange(),f=e.panelBBox.y+e.getTotalHeightForRange(d.start,d.start),h=e.cornerBBox.width+Frame.getVerticalBorderWidth(e.spreadsheet)+e.panelBBox.viewportWidth;renderLine(l,__assign(__assign({},c),{x1:0,x2:h,y1:f,y2:f})),u.showShadow&&s>0&&l.appendChild(new Rect({style:{x:0,y:f,width:h,height:u==null?void 0:u.shadowWidth,fill:e.getShadowFill(90)}}))}},e}return Object.defineProperty(r.prototype,"rowCellTheme",{get:function(){return this.spreadsheet.theme.rowCell.cell},enumerable:!1,configurable:!0}),r.prototype.doLayout=function(){var e=this.buildAllHeaderHierarchy(),n=e.rowLeafNodes,a=e.colLeafNodes,o=e.rowsHierarchy,s=e.colsHierarchy;return this.calculateHeaderNodesCoordinate({rowLeafNodes:n,rowsHierarchy:o,colLeafNodes:a,colsHierarchy:s}),{colNodes:s.getNodes(),colsHierarchy:s,rowNodes:o.getNodes(),rowsHierarchy:o,rowLeafNodes:n,colLeafNodes:a}},r.prototype.buildAllHeaderHierarchy=function(){var e=buildHeaderHierarchy({isRowHeader:!0,spreadsheet:this.spreadsheet}),n=e.leafNodes,a=e.hierarchy,o=buildHeaderHierarchy({isRowHeader:!1,spreadsheet:this.spreadsheet}),s=o.leafNodes,l=o.hierarchy;return{rowLeafNodes:n,colLeafNodes:s,rowsHierarchy:a,colsHierarchy:l}},r.prototype.getCellMeta=function(e,n){var a,o,s,l,u,c,d;e===void 0&&(e=0),n===void 0&&(n=0);var f=this.spreadsheet,h=f.options,p=f.dataSet,v=this.getLayoutResult(),g=v.rowLeafNodes,y=v.colLeafNodes,m=g[e],S=y[n];if(!m||!S)return null;var w=m.query,R=S.query,T=m.isTotals||m.isTotalMeasure||S.isTotals||S.isTotalMeasure,x=getHeaderTotalStatus(m,S),b=(l=(s=(o=h.style)===null||o===void 0?void 0:o.colCell)===null||s===void 0?void 0:s.hideValue)!==null&&l!==void 0?l:!1,L=b?(a={},a[EXTRA_FIELD]=(u=p.fields.values)===null||u===void 0?void 0:u[0],a):{},M=merge({},w,R,L),D=p.getCellData({query:M,rowNode:m,isTotals:T,totalStatus:x}),N=M[EXTRA_FIELD],F=get(D,VALUE_FIELD,null),k={spreadsheet:this.spreadsheet,x:S.x,y:m.y,width:S.width,height:m.height,data:D,rowIndex:e,colIndex:n,isTotals:T,valueField:N,fieldValue:F,rowQuery:w,colQuery:R,rowId:m.id,colId:S.id,id:getDataCellId(m.id,S.id)};return(d=(c=h.layoutCellMeta)===null||c===void 0?void 0:c.call(h,k))!==null&&d!==void 0?d:k},r.prototype.getPreLevelSampleNode=function(e,n){return n.getNodes(e.level-1).find(function(a){return!a.isTotals})},r.prototype.calculateHeaderNodesCoordinate=function(e){this.calculateRowNodesCoordinate(e),this.calculateColNodesCoordinate(e)},r.prototype.calculateColNodesCoordinate=function(e){var n=this,a,o=e.rowLeafNodes,s=e.colLeafNodes,l=e.rowsHierarchy,u=e.colsHierarchy;this.updateColsHierarchySampleMaxHeightNodes(u);var c=Node$1.blankNode(),d=0,f=u.getNodes();f.forEach(function(h){var p;if(h.isLeaf&&(h.colIndex=d,d+=1,h.x=c.x+c.width,h.width=n.calculateColLeafNodesWidth(h,s,o,l.width),u.width+=h.width,c=h),h.level===0)h.y=0;else{var v=n.getPreLevelSampleNode(h,u);h.y=(p=(v==null?void 0:v.y)+(v==null?void 0:v.height))!==null&&p!==void 0?p:0}var g=n.getColNodeHeight(h,u);h.height=h.isGrandTotals&&!h.isTotalMeasure&&h.isLeaf?u.height:g,layoutCoordinate(n.spreadsheet,null,h)}),this.updateCustomFieldsSampleNodes(u),this.adjustColLeafNodesHeight({leafNodes:s,hierarchy:u}),this.autoCalculateColNodeWidthAndX(s),isEmpty((a=this.spreadsheet.options.totals)===null||a===void 0?void 0:a.col)||(this.adjustTotalNodesCoordinate({hierarchy:u,isRowHeader:!1,isSubTotal:!0}),this.adjustTotalNodesCoordinate({hierarchy:u,isRowHeader:!1,isSubTotal:!1}))},r.prototype.getMultipleMap=function(e,n,a){for(var o=e.maxLevel,s=this.spreadsheet.dataSet,l=this.spreadsheet.options.totals,u=s.moreThanOneValue(),c=s.fields,d=c.rows,f=c.columns,h=n?d:f,p=n?l.row:l.col,v=a?(p==null?void 0:p.subTotalsGroupDimensions)||[]:(p==null?void 0:p.grandTotalsGroupDimensions)||[],g=Array.from({length:o+1},function(){return 1}),y=o;y>0;y--){var m=h[y],S=m===EXTRA_FIELD&&u;v.includes(m)||S||(g[y-1]+=g[y],g[y]=0)}return g},r.prototype.adjustTotalNodesCoordinate=function(e){var n=e.hierarchy,a=e.isRowHeader,o=e.isSubTotal,s=this.getMultipleMap(n,a,o),l=filter(n.getNodes(),function(c){return o?c.isSubTotals:c.isGrandTotals}),u=a?"width":"height";forEach(l,function(c){var d,f=s[c.level];if(!f&&o)for(var h=1;f<1;)f=s[c.level-h]-h,h++;for(var p=0,v=function(y){p+=get((d=n.sampleNodesForAllLevels)===null||d===void 0?void 0:d.find(function(m){return m.level===c.level+y}),[u],0)},g=0;g<f;g++)v(g);c[u]=p})},r.prototype.autoCalculateColNodeWidthAndX=function(e){for(var n,a,o=null,s=0,l=e.slice(0);s<l.length;){var u=l[s++],c=u==null?void 0:u.parent;if(o!==c&&c){l.push(c);var d=(n=c.children)===null||n===void 0?void 0:n.find(function(p){return p.width}),f=(a=d==null?void 0:d.x)!==null&&a!==void 0?a:0,h=sumBy(c.children,"width");c.x=f,c.width=h,o=c}}},r.prototype.calculateColLeafNodesWidth=function(e,n,a,o){var s=this.spreadsheet.options.style.colCell,l=this.getColCellDraggedWidth(e);if(isNumber(l))return l;var u=this.getCellCustomSize(e,s==null?void 0:s.width);return isNumber(u)?u:this.spreadsheet.getLayoutWidthType()===LayoutWidthType.Compact?this.getCompactGridColNodeWidth(e,a):this.spreadsheet.isHierarchyTreeType()?this.getAdaptTreeColWidth(e,n,a):this.getAdaptGridColWidth(n,o)},r.prototype.getRowNodeHeight=function(e){if(!e)return 0;var n=new RowCell(e,this.spreadsheet,{shallowRender:!0}),a=this.getRowCellHeight(e);return this.getCellAdaptiveHeight(n,a)},r.prototype.getExpectedCellIconWidth=function(e,n,a){var o,s,l,u=0;if(n)u=1;else{var c=map(this.spreadsheet.options.headerActionIcons,function(f){return __assign(__assign({},f),{displayCondition:function(){return!0}})}),d=getActionIconConfig(c,null,e);u=(o=d==null?void 0:d.icons.length)!==null&&o!==void 0?o:0}return u?u*(a.size+((s=a.margin)===null||s===void 0?void 0:s.left))+((l=a.margin)===null||l===void 0?void 0:l.right):0},r.prototype.calculateRowNodesCoordinate=function(e){var n=this,a,o,s,l,u=e.rowsHierarchy,c=e.rowLeafNodes,d=e.colLeafNodes,f=this.spreadsheet.isHierarchyTreeType(),h=u.sampleNodesForAllLevels||[];f?u.width=this.getTreeRowHeaderWidth():h.forEach(function(b){var L;b.width=n.calculateGridRowNodesWidth(b,d),u.width+=b.width;var M=(L=h[b.level-1])!==null&&L!==void 0?L:{x:0,width:0};b.x=(M==null?void 0:M.x)+(M==null?void 0:M.width)});for(var p=Node$1.blankNode(),v=u.getNodes(),g=0;g<v.length;g++){var y=v[g],m=f||!f&&y.isLeaf;if(m){var S=((a=p==null?void 0:p.rowIndex)!==null&&a!==void 0?a:-1)+1,w=Node$1.getBranchNodes(y).map(function(b){return n.getRowNodeHeight(b)}),R=max$1(w)||this.getRowNodeHeight(y);(o=y.rowIndex)!==null&&o!==void 0||(y.rowIndex=S),(s=y.colIndex)!==null&&s!==void 0||(y.colIndex=g),y.y=p.y+p.height,y.height=R,p=y,u.height+=y.height}if(f||y.level===0)y.x=0;else{var T=h[y.level-1];y.x=(T==null?void 0:T.x)+(T==null?void 0:T.width)}if(f)y.width=this.getTreeRowHeaderWidth();else{var x=h[y.level];y.width=x==null?void 0:x.width}layoutCoordinate(this.spreadsheet,y,null)}f||(this.adjustRowLeafNodesWidth({leafNodes:c,hierarchy:u}),this.autoCalculateRowNodeHeightAndY(c),isEmpty((l=this.spreadsheet.options.totals)===null||l===void 0?void 0:l.row)||(this.adjustTotalNodesCoordinate({hierarchy:u,isRowHeader:!0,isSubTotal:!1}),this.adjustTotalNodesCoordinate({hierarchy:u,isRowHeader:!0,isSubTotal:!0})))},r.prototype.autoCalculateRowNodeHeightAndY=function(e){for(var n=null,a=0,o=e.slice(0);a<o.length;){var s=o[a++],l=s==null?void 0:s.parent;n!==l&&l&&(o.push(l),l.y=l.children[0].y,l.height=sumBy(l.children,"height"),n=l)}},r.prototype.calculateGridRowNodesWidth=function(e,n){var a=this.spreadsheet.options.style.rowCell,o=this.getRowCellDraggedWidth(e);if(isNumber(o))return o;var s=this.getCellCustomSize(e,a==null?void 0:a.width);return isNumber(s)?s:this.spreadsheet.getLayoutWidthType()!==LayoutWidthType.Adaptive?this.getCompactGridRowNodeWidth(e):this.getAdaptGridColWidth(n)},r.prototype.getAdaptTreeColWidth=function(e,n,a){var o=this.getCanvasSize().width,s=o-this.getSeriesNumberWidth()-Frame.getVerticalBorderWidth(this.spreadsheet),l=Math.min(s/2,this.getTreeRowHeaderWidth()),u=Math.max(1,n.length),c=this.spreadsheet.options.style.dataCell;return Math.max(getCellWidth(c,this.getColLabelLength(e,a)),floor((s-l)/u))},r.prototype.getColLabelLength=function(e,n){var a=safeJsonParse(e==null?void 0:e.value);if(isArray(a))return a.length;for(var o=1,s=0;s<LAYOUT_SAMPLE_COUNT;s++){var l=n[s];if(!l)return o;for(var u=this.spreadsheet.dataSet.getCellData({query:__assign(__assign({},e.query),l.query),rowNode:l,isTotals:e.isTotals||e.isTotalMeasure||l.isTotals||l.isTotalMeasure}),c=keys(u),d=0;d<c.length;d++){var f=get(u,c[d]),h=size(get(f==null?void 0:f.values,"0"));h>o&&(o=h)}}return o},r.prototype.getAdaptGridColWidth=function(e,n){var a=this.spreadsheet.dataSet.fields.rows,o=a===void 0?[]:a,s=this.spreadsheet.options.style.dataCell,l=o.length,u=e.length,c=this.getCanvasSize().width,d=c-this.getSeriesNumberWidth()-Frame.getVerticalBorderWidth(this.spreadsheet),f=Math.max(1,l+u);return n?Math.max(getCellWidth(s),floor((d-n)/u)):Math.max(getCellWidth(s),floor(d/f))},r.prototype.getTreeRowHeaderWidth=function(){var e=this,n,a,o,s,l=this.spreadsheet.options.style.rowCell,u=this.spreadsheet.dataSet.fields.rows,c=u===void 0?[]:u,d=this.getCellCustomSize(null,l==null?void 0:l.width);if(isNumber(d))return d;var f=c.map(function(m){return e.spreadsheet.dataSet.getFieldName(m)}).join("/"),h=this.spreadsheet.theme.cornerCell,p=h.bolderText,v=h.icon,g=this.spreadsheet.measureTextWidth(f,p)+v.size*2+((n=v.margin)===null||n===void 0?void 0:n.left)+((a=v.margin)===null||a===void 0?void 0:a.right)+((o=this.rowCellTheme.padding)===null||o===void 0?void 0:o.left)+((s=this.rowCellTheme.padding)===null||s===void 0?void 0:s.right)+1,y=Math.max(d??DEFAULT_TREE_ROW_CELL_WIDTH,g);return Number.isNaN(y)?DEFAULT_TREE_ROW_CELL_WIDTH:y},r.prototype.getCompactGridRowNodeWidth=function(e){var n=this,a,o=this.spreadsheet.theme.rowCell,s=o.bolderText,l=o.icon,u=o.cell,c=this.spreadsheet.theme.cornerCell,d=c.bolderText,f=c.icon,h=c.cell,p=e.field,v=e.isLeaf,g=this.getExpectedCellIconWidth(CellType.ROW_CELL,!this.spreadsheet.isValueInCols()&&v&&this.spreadsheet.options.showDefaultHeaderActionIcon,l),y=(a=this.spreadsheet.dataSet.getDimensionValues(p))===null||a===void 0?void 0:a.slice(0,LAYOUT_SAMPLE_COUNT).map(function(x){var b,L;return(L=(b=n.spreadsheet.dataSet.getFieldFormatter(p))===null||b===void 0?void 0:b(x))!==null&&L!==void 0?L:x}),m=maxBy(y,function(x){return"".concat(x).length}),S=this.spreadsheet.measureTextWidth(m,s)+g+u.padding.left+u.padding.right+u.verticalBorderWidth,w=this.spreadsheet.dataSet.getFieldName(p),R=this.getExpectedCellIconWidth(CellType.CORNER_CELL,!1,f),T=this.spreadsheet.measureTextWidth(w,d)+R+h.padding.left+h.padding.right;return DebuggerUtil.getInstance().logger("Max Label In Row:",p,S>T?m:w),Math.max(S,T)},r.prototype.getCompactGridColNodeWidth=function(e,n){for(var a,o,s,l=this.spreadsheet.theme.colCell,u=l.bolderText,c=l.cell,d=l.icon,f=this.spreadsheet.theme.dataCell.text,h=this.spreadsheet.dataSet.getFieldFormatter(e.field),p=(a=h==null?void 0:h(e.value))!==null&&a!==void 0?a:e.value,v=this.getExpectedCellIconWidth(CellType.COL_CELL,this.spreadsheet.isValueInCols()&&this.spreadsheet.options.showDefaultHeaderActionIcon,d),g=this.spreadsheet.measureTextWidthRoughly(p)+v,y="",m=0,S=0;S<LAYOUT_SAMPLE_COUNT;S++){var w=n[S];if(w){var R=this.spreadsheet.dataSet.getCellData({query:__assign(__assign({},e.query),w.query),rowNode:w,isTotals:e.isTotals||e.isTotalMeasure||w.isTotals||w.isTotalMeasure});if(R){var T=R==null?void 0:R[VALUE_FIELD],x=(s=(o=this.spreadsheet.dataSet.getFieldFormatter(R[EXTRA_FIELD]))===null||o===void 0?void 0:o(T))!==null&&s!==void 0?s:T,b="".concat(x),L=this.spreadsheet.measureTextWidthRoughly(b,f);L>m&&(y=b,m=L)}}}var M=g>m,D=M?p:y,N=M?v:0;DebuggerUtil.getInstance().logger("Max Label In Col:",e.field,D,m);var F=this.spreadsheet.measureTextWidth(D,__assign(__assign({},u),{fontSize:Math.max(f.fontSize,u.fontSize)}));return F+c.padding.left+c.padding.right+c.verticalBorderWidth*2+N},r.prototype.getViewCellHeights=function(){var e=this.getRowLeafNodes(),n=reduce(e,function(a,o){var s=last(a)||0;return a.push(s+o.height),a},[0]);return{getTotalHeight:function(){return last(n)||0},getCellOffsetY:function(a){return n[a]||0},getTotalLength:function(){return n.length-1},getIndexRange:function(a,o){return getIndexRangeWithOffsets(n,a,o)}}},r.prototype.getSeriesNumberCells=function(){var e;return filter((e=this.getSeriesNumberHeader())===null||e===void 0?void 0:e.children,function(n){return n instanceof SeriesNumberCell})},r.prototype.updateFrozenGroupGrid=function(){var e=this;[FrozenGroupType.FROZEN_ROW].forEach(function(n){if(e.frozenGroupInfo[n].range){var a=[],o=[];if(n.toLowerCase().includes("row")){var s=__read(e.frozenGroupInfo[n].range||[],2),l=s[0],u=s[1];a=e.gridInfo.cols,o=getRowsForGrid(l,u,e.viewCellHeights)}e["".concat(n,"Group")].updateGrid({cols:a,rows:o},"".concat(n,"Group"))}})},r.prototype.getFrozenOptions=function(){return getFrozenRowCfgPivot(this.spreadsheet.options,this.layoutResult.rowNodes)},r.prototype.enableFrozenFirstRow=function(){return!!this.getFrozenOptions().rowCount},r}(FrozenFacet),getTableColIconsWidth=function(t,r,e,n){var a,o,s=n==null?void 0:n.size,l=n==null?void 0:n.margin,u=0;return t.options.showDefaultHeaderActionIcon?u=1:u=(o=(a=getActionIconConfig(t.options.headerActionIcons,r,e))===null||a===void 0?void 0:a.icons.length)!==null&&o!==void 0?o:0,u*(s+l.left)+(u>0?l.right:0)},getExtraPaddingForExpandIcon=function(t,r,e){var n,a,o,s,l=((a=(n=e.icon)===null||n===void 0?void 0:n.margin)===null||a===void 0?void 0:a.left)||0,u=((s=(o=e.icon)===null||o===void 0?void 0:o.margin)===null||s===void 0?void 0:s.right)||0,c=t.store.get("hiddenColumnsDetail",[]),d=!1,f=!1;c.forEach(function(p){var v,g,y,m;((g=(v=p==null?void 0:p.displaySiblingNode)===null||v===void 0?void 0:v.prev)===null||g===void 0?void 0:g.field)===r&&(d=!0),((m=(y=p==null?void 0:p.displaySiblingNode)===null||y===void 0?void 0:y.next)===null||m===void 0?void 0:m.field)===r&&(f=!0)});var h=get(e,"icon.size");return{left:f?h+u:0,right:d?h+l:0}},getOccupiedWidthForTableCol=function(t,r,e){var n,a,o=get(e,"cell.padding"),s=(a=(n=e==null?void 0:e.cell)===null||n===void 0?void 0:n.horizontalBorderWidth)!==null&&a!==void 0?a:1,l=getExtraPaddingForExpandIcon(t,r.field,e),u=getTableColIconsWidth(t,r,CellType.COL_CELL,e==null?void 0:e.icon);return o.left+o.right+u+l.left+l.right+s},TableColHeader=function(t){__extends(r,t);function r(e){var n=t.call(this,e)||this;return n.getScrollGroupClipBBox=function(){var a=n.getHeaderConfig(),o=a.width,s=a.height,l=a.spreadsheet,u=a.position,c=l.facet.frozenGroupInfo,d=c[FrozenGroupType.FROZEN_COL].width,f=c[FrozenGroupType.FROZEN_TRAILING_COL].width,h=o-d-f;return{x:u.x+d,y:u.y,width:h,height:s}},n.initFrozenColGroups(),n}return r.prototype.getCellInstance=function(e){var n=this.getHeaderConfig(),a=n.spreadsheet,o=a.options,s=o.seriesNumberCell,l=o.colCell,u=[e,a,n];return e.field===SERIES_NUMBER_FIELD?(s==null?void 0:s.apply(void 0,__spreadArray([],__read(u),!1)))||new(TableCornerCell.bind.apply(TableCornerCell,__spreadArray([void 0],__read(u),!1))):(l==null?void 0:l.apply(void 0,__spreadArray([],__read(u),!1)))||new(TableColCell.bind.apply(TableColCell,__spreadArray([void 0],__read(u),!1)))},r.prototype.initFrozenColGroups=function(){var e=this.getHeaderConfig(),n=e.spreadsheet.options.frozen,a=n.colCount,o=n.trailingColCount,s=e.spreadsheet.facet.getColNodes(0),l=getFrozenLeafNodesCount(s,a,o),u=l.colCount,c=l.trailingColCount;this.finalColCount=u,this.finalTrailingColCount=c,this.topLevelColNodeLength=s.length,u&&(this.frozenColGroup=this.appendChild(new Group({name:KEY_GROUP_COL_FROZEN,style:{zIndex:FRONT_GROUND_GROUP_FROZEN_Z_INDEX}}))),c&&(this.frozenTrailingColGroup=this.appendChild(new Group({name:KEY_GROUP_COL_FROZEN_TRAILING,style:{zIndex:FRONT_GROUND_GROUP_FROZEN_Z_INDEX}})))},r.prototype.clear=function(){var e,n,a;t.prototype.clear.call(this),(e=this.frozenTrailingColGroup)===null||e===void 0||e.removeChildren(),(n=this.frozenColGroup)===null||n===void 0||n.removeChildren();var o=this.getHeaderConfig().spreadsheet,s=(a=o.facet)===null||a===void 0?void 0:a.foregroundGroup.getElementById(KEY_GROUP_FROZEN_COL_RESIZE_AREA);s==null||s.removeChildren()},r.prototype.getColFrozenOptionsByNode=function(e){var n=getLeftLeafNode(e);return{colLength:this.topLevelColNodeLength,leftLeafNodeColIndex:n.colIndex,colCount:this.finalColCount,trailingColCount:this.finalTrailingColCount}},r.prototype.getCellGroup=function(e){var n=this.getColFrozenOptionsByNode(e),a=n.colLength,o=n.leftLeafNodeColIndex,s=n.colCount,l=n.trailingColCount;return isFrozenCol(o,s)?this.frozenColGroup:isFrozenTrailingCol(o,l,a)?this.frozenTrailingColGroup:this.scrollGroup},r.prototype.isColCellInRect=function(e){var n=this.getColFrozenOptionsByNode(e),a=n.leftLeafNodeColIndex,o=n.colLength,s=n.colCount,l=n.trailingColCount;return isFrozenCol(a,s)||isFrozenTrailingCol(a,l,o)?!0:t.prototype.isColCellInRect.call(this,e)},r.prototype.offset=function(){t.prototype.offset.call(this);var e=this.getHeaderConfig().position;translateGroupX(this.frozenColGroup,e.x),translateGroupX(this.frozenTrailingColGroup,e.x)},r.prototype.clip=function(){this.scrollGroup.style.clipPath=new Rect({style:this.getScrollGroupClipBBox()})},r}(ColHeader),TableFacet=function(t){__extends(r,t);function r(e){var n=t.call(this,e)||this;return n.onSortHandler=function(a){var o=n.spreadsheet,s=a;Array.isArray(a)||(s=[a]);var l=o.dataCfg.sortParams||[];s=s.map(function(c){var d,f,h=__assign(__assign({},c),{sortFieldId:(d=c.sortKey)!==null&&d!==void 0?d:c.sortFieldId}),p=(f=l.find(function(v){return v.sortFieldId===h.sortFieldId}))!==null&&f!==void 0?f:{};return __assign(__assign({},p),h)});var u=l.filter(function(c){var d=s.find(function(f){return f.sortFieldId===c.sortFieldId});return!d});set(o.dataCfg,"sortParams",__spreadArray(__spreadArray([],__read(u),!1),__read(s),!1)),o.setDataCfg(o.dataCfg),o.render(!0),o.emit(S2Event.RANGE_SORTED,o.dataSet.getDisplayDataSet())},n.onFilterHandler=function(a){return __awaiter(n,void 0,void 0,function(){var o,s,l,u;return __generator(this,function(c){switch(c.label){case 0:return o=this.spreadsheet,s=!a.filteredValues||a.filteredValues.length===0,l=o.dataCfg.filterParams||[],u=l.findIndex(function(d){return d.filterKey===a.filterKey}),u!==-1?s?l.splice(u,1):l[u]=a:l.push(a),set(o.dataCfg,"filterParams",l),[4,o.render(!0)];case 1:return c.sent(),o.emit(S2Event.RANGE_FILTERED,o.dataSet.getDisplayDataSet()),[2]}})})},n.spreadsheet.on(S2Event.RANGE_SORT,n.onSortHandler),n.spreadsheet.on(S2Event.RANGE_FILTER,n.onFilterHandler),n}return r.prototype.init=function(){t.prototype.init.call(this),this.initRowOffsets()},r.prototype.getDataCellAdaptiveHeight=function(e){var n,a,o,s,l=this.spreadsheet.options.style,u=l.rowCell,c=l.dataCell,d={id:String(e==null?void 0:e.rowIndex)},f=(a=(n=this.getRowCellDraggedHeight(d))!==null&&n!==void 0?n:this.getCellCustomSize(d,u==null?void 0:u.height))!==null&&a!==void 0?a:c==null?void 0:c.height;if(isNumber(f)&&f!==((o=DEFAULT_STYLE.rowCell)===null||o===void 0?void 0:o.height)&&f!==((s=DEFAULT_STYLE.dataCell)===null||s===void 0?void 0:s.height))return f;var h=new TableDataCell(e,this.spreadsheet,{shallowRender:!0}),p=this.getCellHeightByRowIndex(e==null?void 0:e.rowIndex);return this.getCellAdaptiveHeight(h,p)},r.prototype.getCellHeightByRowIndex=function(e){return this.rowOffsets?this.getRowCellHeight({id:String(e)}):this.getDefaultCellHeight()},r.prototype.presetRowCellHeightIfNeeded=function(e){var n,a=this,o,s=this.spreadsheet.options.style,l=this.getColLeafNodes();if(!(isEmpty(l)||((o=s==null?void 0:s.dataCell)===null||o===void 0?void 0:o.maxLines)<=1)){var u=max$1(l.map(function(c){var d=a.getCellMeta(e,c.colIndex);return a.getDataCellAdaptiveHeight(d)}));this.spreadsheet.setOptions({style:{rowCell:{heightByField:(n={},n[e]=u||this.getDefaultCellHeight(),n)}}})}},r.prototype.initRowOffsets=function(){var e=this,n,a,o=this.spreadsheet.options.style,s=(n=o==null?void 0:o.rowCell)===null||n===void 0?void 0:n.heightByField;if(keys(s).length||((a=o==null?void 0:o.dataCell)===null||a===void 0?void 0:a.maxLines)>1){var l=this.spreadsheet.dataSet.getDisplayDataSet();this.rowOffsets=[0];var u=0;l.forEach(function(c,d){e.presetRowCellHeightIfNeeded(d);var f=e.getCellHeightByRowIndex(d),h=u+f;e.rowOffsets.push(h),u=h})}},r.prototype.destroy=function(){t.prototype.destroy.call(this),this.spreadsheet.off(S2Event.RANGE_SORT,this.onSortHandler),this.spreadsheet.off(S2Event.RANGE_FILTER,this.onFilterHandler)},r.prototype.calculateCornerBBox=function(){var e=this.getLayoutResult().colsHierarchy,n=floor(e.height);this.cornerBBox=new CornerBBox(this),this.cornerBBox.height=n,this.cornerBBox.maxY=n},r.prototype.doLayout=function(){var e=new Hierarchy,n=this.buildColHeaderHierarchy(),a=n.colLeafNodes,o=n.colsHierarchy;return this.calculateColNodesCoordinate(a,o),{colNodes:o.getNodes(),colLeafNodes:a,colsHierarchy:o,rowNodes:[],rowsHierarchy:e,rowLeafNodes:[],cornerNodes:[]}},r.prototype.buildColHeaderHierarchy=function(){var e=buildHeaderHierarchy({isRowHeader:!1,spreadsheet:this.spreadsheet});return{colLeafNodes:e.leafNodes,colsHierarchy:e.hierarchy}},r.prototype.getCellMeta=function(e,n){var a,o,s,l;e===void 0&&(e=0),n===void 0&&(n=0);var u=this.spreadsheet,c=u.options,d=u.dataSet,f=this.getColLeafNodes(),h=f[n];if(!h)return null;var p=this.getCellHeightByRowIndex(e),v=this.getCellRange(),g=getValidFrozenOptions(this.spreadsheet.options.frozen,f.length,v.end-v.start+1).trailingRowCount,y=g===void 0?0:g,m,S=h.x,w=this.viewCellHeights.getCellOffsetY(e);isFrozenTrailingRow(e,v.end,y)&&(w=this.panelBBox.height-this.getTotalHeightForRange(e,v.end)),!((o=c.seriesNumber)===null||o===void 0)&&o.enable&&h.field===SERIES_NUMBER_FIELD?m=e+1:m=d.getCellData({query:{field:h.field,rowIndex:e}});var R={spreadsheet:this.spreadsheet,x:S,y:w,width:h.width,height:p,data:(a={},a[h.field]=m,a),rowIndex:e,colIndex:n,isTotals:!1,colId:h.id,rowId:String(e),valueField:h.field,fieldValue:m,id:getDataCellId(String(e),h.id)};return(l=(s=c.layoutCellMeta)===null||s===void 0?void 0:s.call(c,R))!==null&&l!==void 0?l:R},r.prototype.getAdaptiveColWidth=function(e){var n,a=this.spreadsheet.options.style.dataCell,o=this.spreadsheet.options.seriesNumber;if(this.spreadsheet.getLayoutWidthType()!==LayoutWidthType.Compact){var s=this.getSeriesNumberWidth(),l=e.length-(o!=null&&o.enable?1:0),u=this.getCanvasSize().width-s-Frame.getVerticalBorderWidth(this.spreadsheet);return Math.max(a==null?void 0:a.width,floor(u/Math.max(1,l)))}return(n=a==null?void 0:a.width)!==null&&n!==void 0?n:0},r.prototype.getContentHeight=function(){var e=this.getViewCellHeights().getTotalHeight,n=this.layoutResult.colsHierarchy;return e()+n.height},r.prototype.calculateColNodesCoordinate=function(e,n){var a,o,s;this.updateColsHierarchySampleMaxHeightNodes(n);for(var l=Node$1.blankNode(),u=0,c=n.getNodes(),d=this.getAdaptiveColWidth(e),f=0;f<c.length;f++){var h=c[f];h.isLeaf&&(h.colIndex=u,u+=1,h.x=l.x+l.width,h.width=this.calculateColLeafNodesWidth(h,d),layoutCoordinate(this.spreadsheet,null,h),n.width+=h.width,l=h),h.level===0?h.y=0:h.y=(s=((a=h==null?void 0:h.parent)===null||a===void 0?void 0:a.y)+((o=h==null?void 0:h.parent)===null||o===void 0?void 0:o.height))!==null&&s!==void 0?s:0,h.height=this.getColNodeHeight(h,n)}var p=n.getNodes(0),v=getValidFrozenOptions(this.spreadsheet.options.frozen,p.length).trailingColCount,g=v===void 0?0:v;l=Node$1.blankNode();var y=this.getCanvasSize().width-Frame.getVerticalBorderWidth(this.spreadsheet);if(g>0)for(var m=getFrozenLeafNodesCount(p,0,g).trailingColCount,S=c.filter(function(w){return w.isLeaf}),f=1;f<=m;f++){var h=S[S.length-f];f===1?h.x=y-h.width:h.x=l.x-h.width,l=h}this.updateCustomFieldsSampleNodes(n),this.adjustColLeafNodesHeight({leafNodes:e,hierarchy:n}),this.autoCalculateColNodeWidthAndX(e)},r.prototype.autoCalculateColNodeWidthAndX=function(e){for(var n=null,a=e.slice(0);a.length;){var o=a.shift(),s=o==null?void 0:o.parent;n!==s&&s&&(a.push(s),s.x=s.children[0].x,s.width=s.children.map(function(l){return l.width}).reduce(function(l,u){return l+u},0),n=s)}},r.prototype.calculateColLeafNodesWidth=function(e,n){var a=this.spreadsheet,o=a.dataSet,s=a.options.style.colCell,l=a.getLayoutWidthType(),u=this.getColCellDraggedWidth(e);if(isNumber(u))return u;var c=this.getCellCustomSize(e,s==null?void 0:s.width);if(isNumber(c))return c;var d;if(l===LayoutWidthType.Compact){var f=o.getDisplayDataSet(),h=o.getFieldFormatter(e.field),p=maxBy(f==null?void 0:f.slice(0,50).map(function(T){var x;return"".concat((x=h==null?void 0:h(T[e.field]))!==null&&x!==void 0?x:T[e.field])}),function(T){return a.measureTextWidthRoughly(T)});DebuggerUtil.getInstance().logger("Max Label In Col:",e.field,p);var v=a.theme.colCell.bolderText,g=a.theme.dataCell,y=g.text,m=g.cell,S=1,w=a.measureTextWidth(p,y)+m.padding.left+m.padding.right+S,R=a.measureTextWidth(e.value,v)+getOccupiedWidthForTableCol(this.spreadsheet,e,a.theme.colCell);d=Math.max(R,w)}else d=n;return e.field===SERIES_NUMBER_FIELD&&(d=this.getSeriesNumberWidth()),d},r.prototype.getViewCellHeights=function(){var e=this,n=this.getDefaultCellHeight();return{getTotalHeight:function(){return e.rowOffsets?last(e.rowOffsets)||0:n*e.spreadsheet.dataSet.getDisplayDataSet().length},getCellOffsetY:function(a){return a<=0?0:e.rowOffsets?e.rowOffsets[a]:a*n},getTotalLength:function(){return e.spreadsheet.dataSet.getDisplayDataSet().length},getIndexRange:function(a,o){if(e.rowOffsets)return getIndexRangeWithOffsets(e.rowOffsets,a,o);var s=floor(a/n,0),l=o%n===0?o/n-1:floor(o/n,0);return{start:Math.max(0,s),end:Math.max(0,l)}}}},r.prototype.updateRowResizeArea=function(){var e=this.spreadsheet.options.interaction.resize,n=isBoolean(e)?e:e==null?void 0:e.rowCellVertical;if(n){var a=this.foregroundGroup.getElementById(KEY_GROUP_ROW_RESIZE_AREA),o=this.foregroundGroup.getElementById(KEY_GROUP_FROZEN_ROW_RESIZE_AREA);a&&a.removeChildren(),o&&o.removeChildren();var s=getAllChildCells(this.panelGroup.children,TableDataCell);s.forEach(function(l){l.drawResizeArea()})}},r.prototype.getRowHeader=function(){return null},r.prototype.getColHeader=function(){if(!this.columnHeader){var e=this.panelBBox,n=e.x,a=e.width,o=e.viewportHeight,s=e.viewportWidth;return new TableColHeader({width:a,height:this.cornerBBox.height,viewportWidth:s,viewportHeight:o,cornerWidth:this.cornerBBox.width,position:{x:n,y:0},nodes:this.getColNodes(),sortParam:this.spreadsheet.store.get("sortParam"),spreadsheet:this.spreadsheet})}return this.columnHeader},r.prototype.getSeriesNumberHeader=function(){return null},r.prototype.getSeriesNumberCells=function(){return this.getDataCells().filter(function(e){return e.getMeta().valueField===SERIES_NUMBER_FIELD})},r}(FrozenFacet);function generatePath$6(t,r){var e=r.r;t.arc(e,e,e,0,Math.PI*2,!1)}function generatePath$5(t,r){var e=r.rx,n=r.ry,a=e,o=n;if(t.ellipse)t.ellipse(a,o,a,o,0,0,Math.PI*2,!1);else{var s=a>o?a:o,l=a>o?1:a/o,u=a>o?o/a:1;t.save(),t.scale(l,u),t.arc(s,s,s,0,Math.PI*2)}}function generatePath$4(t,r){var e=r.x1,n=r.y1,a=r.x2,o=r.y2,s=r.defX,l=s===void 0?0:s,u=r.defY,c=u===void 0?0:u,d=r.markerStart,f=r.markerEnd,h=r.markerStartOffset,p=r.markerEndOffset,v=0,g=0,y=0,m=0,S=0,w,R;d&&isDisplayObject(d)&&h&&(w=a-e,R=o-n,S=Math.atan2(R,w),v=Math.cos(S)*(h||0),g=Math.sin(S)*(h||0)),f&&isDisplayObject(f)&&p&&(w=e-a,R=n-o,S=Math.atan2(R,w),y=Math.cos(S)*(p||0),m=Math.sin(S)*(p||0)),t.moveTo(e-l+v,n-c+g),t.lineTo(a-l+y,o-c+m)}function generatePath$3(t,r){var e=r.defX,n=e===void 0?0:e,a=r.defY,o=a===void 0?0:a,s=r.markerStart,l=r.markerEnd,u=r.markerStartOffset,c=r.markerEndOffset,d=r.path,f=d.absolutePath,h=d.segments,p=0,v=0,g=0,y=0,m=0,S,w;if(s&&isDisplayObject(s)&&u){var R=__read(s.parentNode.getStartTangent(),2),T=R[0],x=R[1];S=T[0]-x[0],w=T[1]-x[1],m=Math.atan2(w,S),p=Math.cos(m)*(u||0),v=Math.sin(m)*(u||0)}if(l&&isDisplayObject(l)&&c){var b=__read(l.parentNode.getEndTangent(),2),T=b[0],x=b[1];S=T[0]-x[0],w=T[1]-x[1],m=Math.atan2(w,S),g=Math.cos(m)*(c||0),y=Math.sin(m)*(c||0)}for(var L=0;L<f.length;L++){var M=f[L],D=M[0],N=f[L+1],F=L===0&&(p!==0||v!==0),k=(L===f.length-1||N&&(N[0]==="M"||N[0]==="Z"))&&g!==0&&y!==0;switch(D){case"M":F?(t.moveTo(M[1]-n+p,M[2]-o+v),t.lineTo(M[1]-n,M[2]-o)):t.moveTo(M[1]-n,M[2]-o);break;case"L":k?t.lineTo(M[1]-n+g,M[2]-o+y):t.lineTo(M[1]-n,M[2]-o);break;case"Q":t.quadraticCurveTo(M[1]-n,M[2]-o,M[3]-n,M[4]-o),k&&t.lineTo(M[3]-n+g,M[4]-o+y);break;case"C":t.bezierCurveTo(M[1]-n,M[2]-o,M[3]-n,M[4]-o,M[5]-n,M[6]-o),k&&t.lineTo(M[5]-n+g,M[6]-o+y);break;case"A":{var H=h[L].arcParams,G=H.cx,z=H.cy,$=H.rx,W=H.ry,V=H.startAngle,X=H.endAngle,J=H.xRotation,j=H.sweepFlag;if(t.ellipse)t.ellipse(G-n,z-o,$,W,J,V,X,!!(1-j));else{var ne=$>W?$:W,Q=$>W?1:$/W,ie=$>W?W/$:1;t.translate(G-n,z-o),t.rotate(J),t.scale(Q,ie),t.arc(0,0,ne,V,X,!!(1-j)),t.scale(1/Q,1/ie),t.rotate(-J),t.translate(-(G-n),-(z-o))}k&&t.lineTo(M[6]-n+g,M[7]-o+y);break}case"Z":t.closePath();break}}}function generatePath$2(t,r){var e=r.defX,n=e===void 0?0:e,a=r.defY,o=a===void 0?0:a,s=r.markerStart,l=r.markerEnd,u=r.markerStartOffset,c=r.markerEndOffset,d=r.points.points,f=d.length,h=d[0][0]-n,p=d[0][1]-o,v=d[f-1][0]-n,g=d[f-1][1]-o,y=0,m=0,S=0,w=0,R=0,T,x;s&&isDisplayObject(s)&&u&&(T=d[1][0]-d[0][0],x=d[1][1]-d[0][1],R=Math.atan2(x,T),y=Math.cos(R)*(u||0),m=Math.sin(R)*(u||0)),l&&isDisplayObject(l)&&c&&(T=d[f-1][0]-d[0][0],x=d[f-1][1]-d[0][1],R=Math.atan2(x,T),S=Math.cos(R)*(c||0),w=Math.sin(R)*(c||0)),t.moveTo(h+(y||S),p+(m||w));for(var b=1;b<f-1;b++){var L=d[b];t.lineTo(L[0]-n,L[1]-o)}t.lineTo(v,g)}function generatePath$1(t,r){var e=r.defX,n=e===void 0?0:e,a=r.defY,o=a===void 0?0:a,s=r.markerStart,l=r.markerEnd,u=r.markerStartOffset,c=r.markerEndOffset,d=r.points.points,f=d.length,h=d[0][0]-n,p=d[0][1]-o,v=d[f-1][0]-n,g=d[f-1][1]-o,y=0,m=0,S=0,w=0,R=0,T,x;s&&isDisplayObject(s)&&u&&(T=d[1][0]-d[0][0],x=d[1][1]-d[0][1],R=Math.atan2(x,T),y=Math.cos(R)*(u||0),m=Math.sin(R)*(u||0)),l&&isDisplayObject(l)&&c&&(T=d[f-2][0]-d[f-1][0],x=d[f-2][1]-d[f-1][1],R=Math.atan2(x,T),S=Math.cos(R)*(c||0),w=Math.sin(R)*(c||0)),t.moveTo(h+y,p+m);for(var b=1;b<f-1;b++){var L=d[b];t.lineTo(L[0]-n,L[1]-o)}t.lineTo(v+S,g+w)}function generatePath(t,r){var e=r.radius,n=r.width,a=r.height,o=n,s=a,l=e&&e.some(function(y){return y!==0});if(!l)t.rect(0,0,o,s);else{var u=n>0?1:-1,c=a>0?1:-1,d=u+c===0,f=__read(e.map(function(y){return clamp$2(y,0,Math.min(Math.abs(o)/2,Math.abs(s)/2))}),4),h=f[0],p=f[1],v=f[2],g=f[3];t.moveTo(u*h,0),t.lineTo(o-u*p,0),p!==0&&t.arc(o-u*p,c*p,p,-c*Math.PI/2,u>0?0:Math.PI,d),t.lineTo(o,s-c*v),v!==0&&t.arc(o-u*v,s-c*v,v,u>0?0:Math.PI,c>0?Math.PI/2:1.5*Math.PI,d),t.lineTo(u*g,s),g!==0&&t.arc(u*g,s-c*g,g,c>0?Math.PI/2:-Math.PI/2,u>0?Math.PI:0,d),t.lineTo(0,c*h),h!==0&&t.arc(u*h,c*h,h,u>0?Math.PI:0,c>0?Math.PI*1.5:Math.PI/2,d)}}var Plugin$5=function(t){__extends(r,t);function r(){var e=t.apply(this,__spreadArray([],__read(arguments),!1))||this;return e.name="canvas-path-generator",e}return r.prototype.init=function(){var e,n=(e={},e[Shape.CIRCLE]=generatePath$6,e[Shape.ELLIPSE]=generatePath$5,e[Shape.RECT]=generatePath,e[Shape.LINE]=generatePath$4,e[Shape.POLYLINE]=generatePath$1,e[Shape.POLYGON]=generatePath$2,e[Shape.PATH]=generatePath$3,e[Shape.TEXT]=void 0,e[Shape.GROUP]=void 0,e[Shape.IMAGE]=void 0,e[Shape.HTML]=void 0,e[Shape.MESH]=void 0,e);this.context.pathGeneratorFactory=n},r.prototype.destroy=function(){delete this.context.pathGeneratorFactory},r}(AbstractRendererPlugin),tmpVec3a=create$3(),tmpVec3b=create$3(),tmpVec3c=create$3(),tmpMat4=create$4(),CanvasPickerPlugin=function(){function t(){var r=this;this.isHit=function(e,n,a,o){var s=r.context.pointInPathPickerFactory[e.nodeName];if(s){var l=invert$1(tmpMat4,a),u=transformMat4$1(tmpVec3b,set$1(tmpVec3c,n[0],n[1],0),l),c=e.getGeometryBounds().halfExtents,d=e.parsedStyle.anchor;if(u[0]+=(d&&d[0]||0)*c[0]*2,u[1]+=(d&&d[1]||0)*c[1]*2,s(e,new Point(u[0],u[1]),o,r.isPointInPath,r.context,r.runtime))return!0}return!1},this.isPointInPath=function(e,n){var a=r.runtime.offscreenCanvasCreator.getOrCreateContext(r.context.config.offscreenCanvas),o=r.context.pathGeneratorFactory[e.nodeName];return o&&(a.beginPath(),o(a,e.parsedStyle),a.closePath()),a.isPointInPath(n.x,n.y)}}return t.prototype.apply=function(r,e){var n=this,a,o=r.renderingService,s=r.renderingContext;this.context=r,this.runtime=e;var l=(a=s.root)===null||a===void 0?void 0:a.ownerDocument;o.hooks.pick.tapPromise(t.tag,function(u){return __awaiter(n,void 0,void 0,function(){return __generator(this,function(c){return[2,this.pick(l,u)]})})}),o.hooks.pickSync.tap(t.tag,function(u){return n.pick(l,u)})},t.prototype.pick=function(r,e){var n,a,o=e.topmost,s=e.position,l=s.x,u=s.y,c=set$1(tmpVec3a,l,u,0),d=r.elementsFromBBox(c[0],c[1],c[0],c[1]),f=[];try{for(var h=__values(d),p=h.next();!p.done;p=h.next()){var v=p.value,g=v.getWorldTransform(),y=this.isHit(v,c,g,!1);if(y){var m=findClosestClipPathTarget(v);if(m){var S=m.parsedStyle.clipPath,w=this.isHit(S,c,S.getWorldTransform(),!0);if(w){if(o)return e.picked=[v],e;f.push(v)}}else{if(o)return e.picked=[v],e;f.push(v)}}}}catch(R){n={error:R}}finally{try{p&&!p.done&&(a=h.return)&&a.call(h)}finally{if(n)throw n.error}}return e.picked=f,e},t.tag="CanvasPicker",t}();function isPointInPath$7(t,r,e){var n=t.parsedStyle,a=n.r,o=n.fill,s=n.stroke,l=n.lineWidth,u=n.increasedLineWidthForHitTesting,c=n.pointerEvents,d=((l||0)+(u||0))/2,f=distance(a,a,r.x,r.y),h=__read(isFillOrStrokeAffected(c,o,s),2),p=h[0],v=h[1];return p&&v||e?f<=a+d:p?f<=a:v?f>=a-d&&f<=a+d:!1}function ellipseDistance(t,r,e,n){return t/(e*e)+r/(n*n)}function isPointInPath$6(t,r,e){var n=t.parsedStyle,a=n.rx,o=n.ry,s=n.fill,l=n.stroke,u=n.lineWidth,c=n.increasedLineWidthForHitTesting,d=n.pointerEvents,f=r.x,h=r.y,p=__read(isFillOrStrokeAffected(d,s,l),2),v=p[0],g=p[1],y=((u||0)+(c||0))/2,m=(f-a)*(f-a),S=(h-o)*(h-o);return v&&g||e?ellipseDistance(m,S,a+y,o+y)<=1:v?ellipseDistance(m,S,a,o)<=1:g?ellipseDistance(m,S,a-y,o-y)>=1&&ellipseDistance(m,S,a+y,o+y)<=1:!1}function inBox(t,r,e,n,a,o){return a>=t&&a<=t+e&&o>=r&&o<=r+n}function inRect(t,r,e,n,a,o,s){var l=a/2;return inBox(t-l,r-l,e,a,o,s)||inBox(t+e-l,r-l,a,n,o,s)||inBox(t+l,r+n-l,e,a,o,s)||inBox(t-l,r+l,a,n,o,s)}function inArc(t,r,e,n,a,o,s,l){var u=(Math.atan2(l-r,s-t)+Math.PI*2)%(Math.PI*2),c={x:t+e*Math.cos(u),y:r+e*Math.sin(u)};return distance(c.x,c.y,s,l)<=o/2}function inLine(t,r,e,n,a,o,s){var l=Math.min(t,e),u=Math.max(t,e),c=Math.min(r,n),d=Math.max(r,n),f=a/2;return o>=l-f&&o<=u+f&&s>=c-f&&s<=d+f?pointToLine(t,r,e,n,o,s)<=a/2:!1}function inPolyline(t,r,e,n,a){var o=t.length;if(o<2)return!1;for(var s=0;s<o-1;s++){var l=t[s][0],u=t[s][1],c=t[s+1][0],d=t[s+1][1];if(inLine(l,u,c,d,r,e,n))return!0}if(a){var f=t[0],h=t[o-1];if(inLine(f[0],f[1],h[0],h[1],r,e,n))return!0}return!1}var tolerance=1e-6;function dcmp(t){return Math.abs(t)<tolerance?0:t<0?-1:1}function onSegment(t,r,e){return(e[0]-t[0])*(r[1]-t[1])===(r[0]-t[0])*(e[1]-t[1])&&Math.min(t[0],r[0])<=e[0]&&e[0]<=Math.max(t[0],r[0])&&Math.min(t[1],r[1])<=e[1]&&e[1]<=Math.max(t[1],r[1])}function inPolygon(t,r,e){var n=!1,a=t.length;if(a<=2)return!1;for(var o=0;o<a;o++){var s=t[o],l=t[(o+1)%a];if(onSegment(s,l,[r,e]))return!0;dcmp(s[1]-e)>0!=dcmp(l[1]-e)>0&&dcmp(r-(e-s[1])*(s[0]-l[0])/(s[1]-l[1])-s[0])<0&&(n=!n)}return n}function inPolygons(t,r,e){for(var n=!1,a=0;a<t.length;a++){var o=t[a];if(n=inPolygon(o,r,e),n)break}return n}function isPointInPath$5(t,r,e){var n=t.parsedStyle,a=n.x1,o=n.y1,s=n.x2,l=n.y2,u=n.lineWidth,c=n.increasedLineWidthForHitTesting,d=n.defX,f=d===void 0?0:d,h=n.defY,p=h===void 0?0:h,v=n.pointerEvents,g=n.fill,y=n.stroke,m=__read(isFillOrStrokeAffected(v,g,y),2),S=m[1];return!S&&!e||!u?!1:inLine(a,o,s,l,(u||0)+(c||0),r.x+f,r.y+p)}function isPointInStroke(t,r,e,n,a){for(var o=!1,s=r/2,l=0;l<t.length;l++){var u=t[l],c=u.currentPoint,d=u.params,f=u.prePoint,h=u.box;if(!(h&&!inBox(h.x-s,h.y-s,h.width+r,h.height+r,e,n)))switch(u.command){case"L":case"Z":if(o=inLine(f[0],f[1],c[0],c[1],r,e,n),o)return!0;break;case"Q":var p=pointDistance(f[0],f[1],d[1],d[2],d[3],d[4],e,n);if(o=p<=r/2,o)return!0;break;case"C":var v=pointDistance$3(f[0],f[1],d[1],d[2],d[3],d[4],d[5],d[6],e,n,a);if(o=v<=r/2,o)return!0;break;case"A":u.cubicParams||(u.cubicParams=arcToCubic(f[0],f[1],d[1],d[2],d[3],d[4],d[5],d[6],d[7],void 0));for(var g=u.cubicParams,y=f,m=0;m<g.length;m+=6){var S=pointDistance$3(y[0],y[1],g[m],g[m+1],g[m+2],g[m+3],g[m+4],g[m+5],e,n,a);if(y=[g[m+4],g[m+5]],o=S<=r/2,o)return!0}break}}return o}function isPointInPath$4(t,r,e,n,a,o){var s=t.parsedStyle,l=s.lineWidth,u=s.increasedLineWidthForHitTesting,c=s.stroke,d=s.fill,f=s.defX,h=f===void 0?0:f,p=s.defY,v=p===void 0?0:p,g=s.path,y=s.pointerEvents,m=g.segments,S=g.hasArc,w=g.polylines,R=g.polygons,T=__read(isFillOrStrokeAffected(y,(R==null?void 0:R.length)&&d,c),2),x=T[0],b=T[1],L=getOrCalculatePathTotalLength(t),M=!1;return x||e?(S?M=n(t,r):M=inPolygons(R,r.x+h,r.y+v)||inPolygons(w,r.x+h,r.y+v),M):((b||e)&&(M=isPointInStroke(m,(l||0)+(u||0),r.x+h,r.y+v,L)),M)}function isPointInPath$3(t,r,e){var n=t.parsedStyle,a=n.stroke,o=n.fill,s=n.lineWidth,l=n.increasedLineWidthForHitTesting,u=n.points,c=n.defX,d=c===void 0?0:c,f=n.defY,h=f===void 0?0:f,p=n.pointerEvents,v=__read(isFillOrStrokeAffected(p,o,a),2),g=v[0],y=v[1],m=!1;return(y||e)&&(m=inPolyline(u.points,(s||0)+(l||0),r.x+d,r.y+h,!0)),!m&&(g||e)&&(m=inPolygon(u.points,r.x+d,r.y+h)),m}function isPointInPath$2(t,r,e){var n=t.parsedStyle,a=n.lineWidth,o=n.increasedLineWidthForHitTesting,s=n.points,l=n.defX,u=l===void 0?0:l,c=n.defY,d=c===void 0?0:c,f=n.pointerEvents,h=n.fill,p=n.stroke,v=__read(isFillOrStrokeAffected(f,h,p),2),g=v[1];return!g&&!e||!a?!1:inPolyline(s.points,(a||0)+(o||0),r.x+u,r.y+d,!1)}function isPointInPath$1(t,r,e,n,a){var o=t.parsedStyle,s=o.radius,l=o.fill,u=o.stroke,c=o.lineWidth,d=o.increasedLineWidthForHitTesting,f=o.width,h=o.height,p=o.pointerEvents,v=__read(isFillOrStrokeAffected(p,l,u),2),g=v[0],y=v[1],m=s&&s.some(function(T){return T!==0}),S=(c||0)+(d||0);if(m){var R=!1;return(y||e)&&(R=inRectWithRadius(0,0,f,h,s.map(function(T){return clamp$2(T,0,Math.min(Math.abs(f)/2,Math.abs(h)/2))}),S,r.x,r.y)),!R&&(g||e)&&(R=n(t,r)),R}else{var w=S/2;if(g&&y||e)return inBox(0-w,0-w,f+w,h+w,r.x,r.y);if(g)return inBox(0,0,f,h,r.x,r.y);if(y)return inRect(0,0,f,h,S,r.x,r.y)}return!1}function inRectWithRadius(t,r,e,n,a,o,s,l){var u=__read(a,4),c=u[0],d=u[1],f=u[2],h=u[3];return inLine(t+c,r,t+e-d,r,o,s,l)||inLine(t+e,r+d,t+e,r+n-f,o,s,l)||inLine(t+e-f,r+n,t+h,r+n,o,s,l)||inLine(t,r+n-h,t,r+c,o,s,l)||inArc(t+e-d,r+d,d,1.5*Math.PI,2*Math.PI,o,s,l)||inArc(t+e-f,r+n-f,f,0,.5*Math.PI,o,s,l)||inArc(t+h,r+n-h,h,.5*Math.PI,Math.PI,o,s,l)||inArc(t+c,r+c,c,Math.PI,1.5*Math.PI,o,s,l)}function isPointInPath(t,r,e,n,a,o){var s=t.parsedStyle,l=s.pointerEvents,u=s.width,c=s.height;if(l==="non-transparent-pixel"){var d=a.config.offscreenCanvas,f=o.offscreenCanvasCreator.getOrCreateCanvas(d),h=o.offscreenCanvasCreator.getOrCreateContext(d,{willReadFrequently:!0});f.width=u,f.height=c,a.defaultStyleRendererFactory[Shape.IMAGE].render(h,t.parsedStyle,t,void 0,void 0,void 0);var p=h.getImageData(r.x,r.y,1,1).data;return p.every(function(v){return v!==0})}return!0}var Plugin$4=function(t){__extends(r,t);function r(){var e=t.apply(this,__spreadArray([],__read(arguments),!1))||this;return e.name="canvas-picker",e}return r.prototype.init=function(){var e,n=function(){return!0},a=(e={},e[Shape.CIRCLE]=isPointInPath$7,e[Shape.ELLIPSE]=isPointInPath$6,e[Shape.RECT]=isPointInPath$1,e[Shape.LINE]=isPointInPath$5,e[Shape.POLYLINE]=isPointInPath$2,e[Shape.POLYGON]=isPointInPath$3,e[Shape.PATH]=isPointInPath$4,e[Shape.TEXT]=n,e[Shape.GROUP]=null,e[Shape.IMAGE]=isPointInPath,e[Shape.HTML]=null,e[Shape.MESH]=null,e);this.context.pointInPathPickerFactory=a,this.addRenderingPlugin(new CanvasPickerPlugin)},r.prototype.destroy=function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()},r}(AbstractRendererPlugin),CanvasRendererPlugin=function(){function t(r){this.canvasRendererPluginOptions=r,this.removedRBushNodeAABBs=[],this.renderQueue=[],this.restoreStack=[],this.clearFullScreen=!1,this.vpMatrix=create$4(),this.dprMatrix=create$4(),this.tmpMat4=create$4(),this.vec3a=create$3(),this.vec3b=create$3(),this.vec3c=create$3(),this.vec3d=create$3()}return t.prototype.apply=function(r,e){var n=this;this.context=r;var a=r.config,o=r.camera,s=r.renderingService,l=r.renderingContext,u=r.rBushRoot,c=r.pathGeneratorFactory;this.rBush=u,this.pathGeneratorFactory=c;var d=r.contextService,f=l.root.ownerDocument.defaultView,h=function(g){var y=g.target,m=y.rBushNode;m.aabb&&n.removedRBushNodeAABBs.push(m.aabb)},p=function(g){var y=g.target,m=y.rBushNode;m.aabb&&n.removedRBushNodeAABBs.push(m.aabb)};s.hooks.init.tap(t.tag,function(){f.addEventListener(ElementEvent.UNMOUNTED,h),f.addEventListener(ElementEvent.CULLED,p);var g=d.getDPR(),y=a.width,m=a.height,S=d.getContext();n.clearRect(S,0,0,y*g,m*g,a.background)}),s.hooks.destroy.tap(t.tag,function(){f.removeEventListener(ElementEvent.UNMOUNTED,h),f.removeEventListener(ElementEvent.CULLED,p),n.renderQueue=[],n.removedRBushNodeAABBs=[],n.restoreStack=[]}),s.hooks.beginFrame.tap(t.tag,function(){var g=d.getContext(),y=d.getDPR(),m=a.width,S=a.height,w=n.canvasRendererPluginOptions,R=w.dirtyObjectNumThreshold,T=w.dirtyObjectRatioThreshold,x=s.getStats(),b=x.total,L=x.rendered,M=L/b;n.clearFullScreen=s.disableDirtyRectangleRendering()||L>R&&M>T,g&&(g.resetTransform?g.resetTransform():g.setTransform(1,0,0,1,0,0),n.clearFullScreen&&n.clearRect(g,0,0,m*y,S*y,a.background))});var v=function(g,y){g.isVisible()&&!g.isCulled()&&(n.renderDisplayObject(g,y,n.context,n.restoreStack,e),n.saveDirtyAABB(g));var m=g.sortable.sorted||g.childNodes;m.forEach(function(S){v(S,y)})};s.hooks.endFrame.tap(t.tag,function(){var g=d.getContext(),y=d.getDPR();if(fromScaling(n.dprMatrix,[y,y,1]),multiply$2(n.vpMatrix,n.dprMatrix,o.getOrthoMatrix()),n.clearFullScreen)v(l.root,g);else{var m=n.safeMergeAABB.apply(n,__spreadArray([n.mergeDirtyAABBs(n.renderQueue)],__read(n.removedRBushNodeAABBs.map(function(J){var j=J.minX,ne=J.minY,Q=J.maxX,ie=J.maxY,te=new AABB;return te.setMinMax([j,ne,0],[Q,ie,0]),te})),!1));if(n.removedRBushNodeAABBs=[],AABB.isEmpty(m)){n.renderQueue=[];return}var S=n.convertAABB2Rect(m),w=S.x,R=S.y,T=S.width,x=S.height,b=transformMat4$1(n.vec3a,[w,R,0],n.vpMatrix),L=transformMat4$1(n.vec3b,[w+T,R,0],n.vpMatrix),M=transformMat4$1(n.vec3c,[w,R+x,0],n.vpMatrix),D=transformMat4$1(n.vec3d,[w+T,R+x,0],n.vpMatrix),N=Math.min(b[0],L[0],D[0],M[0]),F=Math.min(b[1],L[1],D[1],M[1]),k=Math.max(b[0],L[0],D[0],M[0]),H=Math.max(b[1],L[1],D[1],M[1]),G=Math.floor(N),z=Math.floor(F),$=Math.ceil(k-N),W=Math.ceil(H-F);g.save(),n.clearRect(g,G,z,$,W,a.background),g.beginPath(),g.rect(G,z,$,W),g.clip(),g.setTransform(n.vpMatrix[0],n.vpMatrix[1],n.vpMatrix[4],n.vpMatrix[5],n.vpMatrix[12],n.vpMatrix[13]);var V=a.renderer.getConfig().enableDirtyRectangleRenderingDebug;V&&f.dispatchEvent(new CustomEvent(CanvasEvent.DIRTY_RECTANGLE,{dirtyRect:{x:G,y:z,width:$,height:W}}));var X=n.searchDirtyObjects(m);X.sort(function(J,j){return J.sortable.renderOrder-j.sortable.renderOrder}).forEach(function(J){J&&J.isVisible()&&!J.isCulled()&&n.renderDisplayObject(J,g,n.context,n.restoreStack,e)}),g.restore(),n.renderQueue.forEach(function(J){n.saveDirtyAABB(J)}),n.renderQueue=[]}n.restoreStack.forEach(function(){g.restore()}),n.restoreStack=[]}),s.hooks.render.tap(t.tag,function(g){n.clearFullScreen||n.renderQueue.push(g)})},t.prototype.clearRect=function(r,e,n,a,o,s){r.clearRect(e,n,a,o),s&&(r.fillStyle=s,r.fillRect(e,n,a,o))},t.prototype.renderDisplayObject=function(r,e,n,a,o){var s=r.nodeName,l=a[a.length-1];l&&!(r.compareDocumentPosition(l)&Node$2.DOCUMENT_POSITION_CONTAINS)&&(e.restore(),a.pop());var u=this.context.styleRendererFactory[s],c=this.pathGeneratorFactory[s],d=r.parsedStyle.clipPath;if(d){this.applyWorldTransform(e,d);var f=this.pathGeneratorFactory[d.nodeName];f&&(e.save(),a.push(r),e.beginPath(),f(e,d.parsedStyle),e.closePath(),e.clip())}u&&(this.applyWorldTransform(e,r),e.save(),this.applyAttributesToContext(e,r)),c&&(e.beginPath(),c(e,r.parsedStyle),r.nodeName!==Shape.LINE&&r.nodeName!==Shape.PATH&&r.nodeName!==Shape.POLYLINE&&e.closePath()),u&&(u.render(e,r.parsedStyle,r,n,this,o),e.restore()),r.renderable.dirty=!1},t.prototype.convertAABB2Rect=function(r){var e=r.getMin(),n=r.getMax(),a=Math.floor(e[0]),o=Math.floor(e[1]),s=Math.ceil(n[0]),l=Math.ceil(n[1]),u=s-a,c=l-o;return{x:a,y:o,width:u,height:c}},t.prototype.mergeDirtyAABBs=function(r){var e=new AABB;return r.forEach(function(n){var a=n.getRenderBounds();e.add(a);var o=n.renderable.dirtyRenderBounds;o&&e.add(o)}),e},t.prototype.searchDirtyObjects=function(r){var e=__read(r.getMin(),2),n=e[0],a=e[1],o=__read(r.getMax(),2),s=o[0],l=o[1],u=this.rBush.search({minX:n,minY:a,maxX:s,maxY:l});return u.map(function(c){var d=c.displayObject;return d})},t.prototype.saveDirtyAABB=function(r){var e=r.renderable;e.dirtyRenderBounds||(e.dirtyRenderBounds=new AABB);var n=r.getRenderBounds();n&&e.dirtyRenderBounds.update(n.center,n.halfExtents)},t.prototype.applyAttributesToContext=function(r,e){var n=e.parsedStyle,a=n.stroke,o=n.fill,s=n.opacity,l=n.lineDash,u=n.lineDashOffset;l&&r.setLineDash(l),isNil$1(u)||(r.lineDashOffset=u),isNil$1(s)||(r.globalAlpha*=s),!isNil$1(a)&&!Array.isArray(a)&&!a.isNone&&(r.strokeStyle=e.attributes.stroke),!isNil$1(o)&&!Array.isArray(o)&&!o.isNone&&(r.fillStyle=e.attributes.fill)},t.prototype.applyWorldTransform=function(r,e,n){var a=0,o=0,s=(e.parsedStyle||{}).anchor,l=s&&s[0]||0,u=s&&s[1]||0;if(l!==0||u!==0){var c=e.geometry.contentBounds,d=c&&c.halfExtents[0]*2||0,f=c&&c.halfExtents[1]*2||0;a=-(l*d),o=-(u*f)}n?(copy$4(this.tmpMat4,e.getLocalTransform()),this.vec3a[0]=a,this.vec3a[1]=o,this.vec3a[2]=0,translate(this.tmpMat4,this.tmpMat4,this.vec3a),multiply$2(this.tmpMat4,n,this.tmpMat4),multiply$2(this.tmpMat4,this.vpMatrix,this.tmpMat4)):(copy$4(this.tmpMat4,e.getWorldTransform()),this.vec3a[0]=a,this.vec3a[1]=o,this.vec3a[2]=0,translate(this.tmpMat4,this.tmpMat4,this.vec3a),multiply$2(this.tmpMat4,this.vpMatrix,this.tmpMat4)),r.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])},t.prototype.safeMergeAABB=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var n=new AABB;return r.forEach(function(a){n.add(a)}),n},t.tag="CanvasRenderer",t}(),DefaultRenderer=function(){function t(r){this.imagePool=r}return t.prototype.render=function(r,e,n,a,o,s){var l=e.fill,u=e.fillRule,c=e.opacity,d=e.fillOpacity,f=e.stroke,h=e.strokeOpacity,p=e.lineWidth,v=e.lineCap,g=e.lineJoin,y=e.shadowType,m=e.shadowColor,S=e.shadowBlur,w=e.filter,R=e.miterLimit,T=!isNil$1(l)&&!l.isNone,x=!isNil$1(f)&&!f.isNone&&p>0,b=l.alpha===0,L=!!(w&&w.length),M=!isNil$1(m)&&S>0,D=n.nodeName,N=y==="inner",F=x&&M&&(D===Shape.PATH||D===Shape.LINE||D===Shape.POLYLINE||b||N);T&&(r.globalAlpha=c*d,F||setShadowAndFilter(n,r,M),this.fill(r,n,l,u,a,o,s),F||this.clearShadowAndFilter(r,L,M)),x&&(r.globalAlpha=c*h,r.lineWidth=p,isNil$1(R)||(r.miterLimit=R),isNil$1(v)||(r.lineCap=v),isNil$1(g)||(r.lineJoin=g),F&&(N&&(r.globalCompositeOperation="source-atop"),setShadowAndFilter(n,r,!0),N&&(this.stroke(r,n,f,a,o,s),r.globalCompositeOperation="source-over",this.clearShadowAndFilter(r,L,!0))),this.stroke(r,n,f,a,o,s))},t.prototype.clearShadowAndFilter=function(r,e,n){if(n&&(r.shadowColor="transparent",r.shadowBlur=0),e){var a=r.filter;!isNil$1(a)&&a.indexOf("drop-shadow")>-1&&(r.filter=a.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")}},t.prototype.fill=function(r,e,n,a,o,s,l){var u=this;Array.isArray(n)?n.forEach(function(c){r.fillStyle=u.getColor(c,e,r),a?r.fill(a):r.fill()}):(isPattern(n)&&(r.fillStyle=this.getPattern(n,e,r,o,s,l)),a?r.fill(a):r.fill())},t.prototype.stroke=function(r,e,n,a,o,s){var l=this;Array.isArray(n)?n.forEach(function(u){r.strokeStyle=l.getColor(u,e,r),r.stroke()}):(isPattern(n)&&(r.strokeStyle=this.getPattern(n,e,r,a,o,s)),r.stroke())},t.prototype.getPattern=function(r,e,n,a,o,s){var l,u;if(r.image.nodeName==="rect"){var c=r.image.parsedStyle,d=c.width,f=c.height;u=a.contextService.getDPR();var h=a.config.offscreenCanvas;l=s.offscreenCanvasCreator.getOrCreateCanvas(h),l.width=d*u,l.height=f*u;var p=s.offscreenCanvasCreator.getOrCreateContext(h),v=[];r.image.forEach(function(y){o.renderDisplayObject(y,p,a,v,s)}),v.forEach(function(){p.restore()})}var g=this.imagePool.getOrCreatePatternSync(r,n,l,u,function(){e.renderable.dirty=!0,a.renderingService.dirtify()});return g},t.prototype.getColor=function(r,e,n){var a;if(r.type===GradientType.LinearGradient||r.type===GradientType.RadialGradient){var o=e.getGeometryBounds(),s=o&&o.halfExtents[0]*2||1,l=o&&o.halfExtents[1]*2||1;a=this.imagePool.getOrCreateGradient(__assign(__assign({type:r.type},r.value),{width:s,height:l}),n)}return a},t}();function setShadowAndFilter(t,r,e){var n=t.parsedStyle,a=n.filter,o=n.shadowColor,s=n.shadowBlur,l=n.shadowOffsetX,u=n.shadowOffsetY;a&&a.length&&(r.filter=t.style.filter),e&&(r.shadowColor=o.toString(),r.shadowBlur=s||0,r.shadowOffsetX=l||0,r.shadowOffsetY=u||0)}var ImageRenderer=function(){function t(r){this.imagePool=r}return t.prototype.render=function(r,e,n){var a=e.width,o=e.height,s=e.img,l=e.shadowColor,u=e.shadowBlur,c,d=a,f=o;if(isString$1(s)?c=this.imagePool.getImageSync(s):(d||(d=s.width),f||(f=s.height),c=s),c){var h=!isNil$1(l)&&u>0;setShadowAndFilter(n,r,h);try{r.drawImage(c,0,0,d,f)}catch{}}},t}(),TextRenderer=function(){function t(){}return t.prototype.render=function(r,e,n,a,o,s){var l=e,u=l.lineWidth,c=l.textAlign,d=l.textBaseline,f=l.lineJoin,h=l.miterLimit,p=l.letterSpacing,v=l.stroke,g=l.fill,y=l.fillOpacity,m=l.strokeOpacity,S=l.opacity,w=l.metrics,R=l.dx,T=l.dy,x=l.shadowColor,b=l.shadowBlur,L=w.font,M=w.lines,D=w.height,N=w.lineHeight,F=w.lineMetrics;r.font=L,r.lineWidth=u,r.textAlign=c==="middle"?"center":c;var k=d;!s.enableCSSParsing&&k==="alphabetic"&&(k="bottom"),r.lineJoin=f,isNil$1(h)||(r.miterLimit=h);var H=0;d==="middle"?H=-D/2-N/2:d==="bottom"||d==="alphabetic"||d==="ideographic"?H=-D:(d==="top"||d==="hanging")&&(H=-N);var G=R||0;H+=T||0,M.length===1&&(k==="bottom"?(k="middle",H-=.5*D):k==="top"&&(k="middle",H+=.5*D)),r.textBaseline=k;var z=!isNil$1(x)&&b>0;setShadowAndFilter(n,r,z);for(var $=0;$<M.length;$++){var W=u/2+G;H+=N,!isNil$1(v)&&!v.isNone&&u&&this.drawLetterSpacing(r,M[$],F[$],c,W,H,p,y,m,S,!0),isNil$1(g)||this.drawLetterSpacing(r,M[$],F[$],c,W,H,p,y,m,S)}},t.prototype.drawLetterSpacing=function(r,e,n,a,o,s,l,u,c,d,f){if(f===void 0&&(f=!1),l===0){f?this.strokeText(r,e,o,s,c):this.fillText(r,e,o,s,u,d);return}var h=r.textAlign;r.textAlign="left";var p=o;a==="center"||a==="middle"?p=o-n.width/2:(a==="right"||a==="end")&&(p=o-n.width);for(var v=Array.from(e),g=r.measureText(e).width,y=0,m=0;m<v.length;++m){var S=v[m];f?this.strokeText(r,S,p,s,c):this.fillText(r,S,p,s,u,d),y=r.measureText(e.substring(m+1)).width,p+=g-y+l,g=y}r.textAlign=h},t.prototype.fillText=function(r,e,n,a,o,s){var l,u=!isNil$1(o)&&o!==1;u&&(l=r.globalAlpha,r.globalAlpha=o*s),r.fillText(e,n,a),u&&(r.globalAlpha=l)},t.prototype.strokeText=function(r,e,n,a,o){var s,l=!isNil$1(o)&&o!==1;l&&(s=r.globalAlpha,r.globalAlpha=o),r.strokeText(e,n,a),l&&(r.globalAlpha=s)},t}();(function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r})(DefaultRenderer);(function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r})(DefaultRenderer);(function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r})(DefaultRenderer);(function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r})(DefaultRenderer);(function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r})(DefaultRenderer);(function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r})(DefaultRenderer);(function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r})(DefaultRenderer);var Plugin$3=function(t){__extends(r,t);function r(e){e===void 0&&(e={});var n=t.call(this)||this;return n.options=e,n.name="canvas-renderer",n}return r.prototype.init=function(){var e,n=__assign({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),a=this.context.imagePool,o=new DefaultRenderer(a),s=(e={},e[Shape.CIRCLE]=o,e[Shape.ELLIPSE]=o,e[Shape.RECT]=o,e[Shape.IMAGE]=new ImageRenderer(a),e[Shape.TEXT]=new TextRenderer,e[Shape.LINE]=o,e[Shape.POLYLINE]=o,e[Shape.POLYGON]=o,e[Shape.PATH]=o,e[Shape.GROUP]=void 0,e[Shape.HTML]=void 0,e[Shape.MESH]=void 0,e);this.context.defaultStyleRendererFactory=s,this.context.styleRendererFactory=s,this.addRenderingPlugin(new CanvasRendererPlugin(n))},r.prototype.destroy=function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory},r}(AbstractRendererPlugin),DOMInteractionPlugin=function(){function t(){}return t.prototype.apply=function(r,e){var n=this,a=r.renderingService,o=r.renderingContext,s=r.config;this.context=r;var l=o.root.ownerDocument.defaultView,u=function(x){a.hooks.pointerMove.call(x)},c=function(x){a.hooks.pointerUp.call(x)},d=function(x){a.hooks.pointerDown.call(x)},f=function(x){a.hooks.pointerOver.call(x)},h=function(x){a.hooks.pointerOut.call(x)},p=function(x){a.hooks.pointerCancel.call(x)},v=function(x){a.hooks.pointerWheel.call(x)},g=function(x){a.hooks.click.call(x)},y=function(x){e.globalThis.document.addEventListener("pointermove",u,!0),x.addEventListener("pointerdown",d,!0),x.addEventListener("pointerleave",h,!0),x.addEventListener("pointerover",f,!0),e.globalThis.addEventListener("pointerup",c,!0),e.globalThis.addEventListener("pointercancel",p,!0)},m=function(x){x.addEventListener("touchstart",d,!0),x.addEventListener("touchend",c,!0),x.addEventListener("touchmove",u,!0),x.addEventListener("touchcancel",p,!0)},S=function(x){e.globalThis.document.addEventListener("mousemove",u,!0),x.addEventListener("mousedown",d,!0),x.addEventListener("mouseout",h,!0),x.addEventListener("mouseover",f,!0),e.globalThis.addEventListener("mouseup",c,!0)},w=function(x){e.globalThis.document.removeEventListener("pointermove",u,!0),x.removeEventListener("pointerdown",d,!0),x.removeEventListener("pointerleave",h,!0),x.removeEventListener("pointerover",f,!0),e.globalThis.removeEventListener("pointerup",c,!0)},R=function(x){x.removeEventListener("touchstart",d,!0),x.removeEventListener("touchend",c,!0),x.removeEventListener("touchmove",u,!0),x.removeEventListener("touchcancel",p,!0)},T=function(x){e.globalThis.document.removeEventListener("mousemove",u,!0),x.removeEventListener("mousedown",d,!0),x.removeEventListener("mouseout",h,!0),x.removeEventListener("mouseover",f,!0),e.globalThis.removeEventListener("mouseup",c,!0)};a.hooks.init.tap(t.tag,function(){var x=n.context.contextService.getDomElement();e.globalThis.navigator.msPointerEnabled?(x.style.msContentZooming="none",x.style.msTouchAction="none"):l.supportsPointerEvents&&(x.style.touchAction="none"),l.supportsPointerEvents?y(x):S(x),l.supportsTouchEvents&&m(x),s.useNativeClickEvent&&x.addEventListener("click",g,!0),x.addEventListener("wheel",v,{passive:!0,capture:!0})}),a.hooks.destroy.tap(t.tag,function(){var x=n.context.contextService.getDomElement();e.globalThis.navigator.msPointerEnabled?(x.style.msContentZooming="",x.style.msTouchAction=""):l.supportsPointerEvents&&(x.style.touchAction=""),l.supportsPointerEvents?w(x):T(x),l.supportsTouchEvents&&R(x),s.useNativeClickEvent&&x.removeEventListener("click",g,!0),x.removeEventListener("wheel",v,!0)})},t.tag="DOMInteraction",t}(),Plugin$2=function(t){__extends(r,t);function r(){var e=t.apply(this,__spreadArray([],__read(arguments),!1))||this;return e.name="dom-interaction",e}return r.prototype.init=function(){this.addRenderingPlugin(new DOMInteractionPlugin)},r.prototype.destroy=function(){this.removeAllRenderingPlugins()},r}(AbstractRendererPlugin),CANVAS_CAMERA_ID="g-canvas-camera",HTMLRenderingPlugin=function(){function t(){this.displayObjectHTMLElementMap=new WeakMap}return t.prototype.joinTransformMatrix=function(r){return"matrix(".concat([r[0],r[1],r[4],r[5],r[12],r[13]].join(","),")")},t.prototype.apply=function(r,e){var n=this,a=r.camera,o=r.renderingContext,s=r.renderingService;this.context=r;var l=o.root.ownerDocument.defaultView,u=l.context.eventService.nativeHTMLMap,c=function(g,y){y.style.transform=n.joinTransformMatrix(g.getWorldTransform())},d=function(g){var y=g.target;if(y.nodeName===Shape.HTML){n.$camera||(n.$camera=n.createCamera(a));var m=n.getOrCreateEl(y);if(n.$camera.appendChild(m),e.enableCSSParsing){var S=y.ownerDocument.documentElement.attributes;Object.keys(S).forEach(function(w){m.style[w]=S[w]})}Object.keys(y.attributes).forEach(function(w){n.updateAttribute(w,y)}),c(y,m),u.set(m,y)}},f=function(g){var y=g.target;if(y.nodeName===Shape.HTML&&n.$camera){var m=n.getOrCreateEl(y);m&&(m.remove(),u.delete(m))}},h=function(g){var y=g.target;if(y.nodeName===Shape.HTML){var m=g.attrName;n.updateAttribute(m,y)}},p=function(g){var y=g.target;if(y.nodeName===Shape.HTML){var m=n.getOrCreateEl(y);c(y,m)}},v=function(){if(n.$camera){var g=n.context.config,y=g.width,m=g.height;n.$camera.style.width="".concat(y||0,"px"),n.$camera.style.height="".concat(m||0,"px")}};s.hooks.init.tap(t.tag,function(){l.addEventListener(CanvasEvent.RESIZE,v),l.addEventListener(ElementEvent.MOUNTED,d),l.addEventListener(ElementEvent.UNMOUNTED,f),l.addEventListener(ElementEvent.ATTR_MODIFIED,h),l.addEventListener(ElementEvent.BOUNDS_CHANGED,p)}),s.hooks.endFrame.tap(t.tag,function(){n.$camera&&o.renderReasons.has(RenderReason.CAMERA_CHANGED)&&(n.$camera.style.transform=n.joinTransformMatrix(a.getOrthoMatrix()))}),s.hooks.destroy.tap(t.tag,function(){n.$camera&&n.$camera.remove(),l.removeEventListener(CanvasEvent.RESIZE,v),l.removeEventListener(ElementEvent.MOUNTED,d),l.removeEventListener(ElementEvent.UNMOUNTED,f),l.removeEventListener(ElementEvent.ATTR_MODIFIED,h),l.removeEventListener(ElementEvent.BOUNDS_CHANGED,p)})},t.prototype.createCamera=function(r){var e=this.context.config,n=e.document,a=e.width,o=e.height,s=this.context.contextService.getDomElement(),l=s.parentNode;if(l){var u=CANVAS_CAMERA_ID,c=l.querySelector("#"+u);if(!c){var d=(n||document).createElement("div");c=d,d.id=u,d.style.position="absolute",d.style.left="".concat(s.offsetLeft||0,"px"),d.style.top="".concat(s.offsetTop||0,"px"),d.style.transformOrigin="left top",d.style.transform=this.joinTransformMatrix(r.getOrthoMatrix()),d.style.overflow="hidden",d.style.pointerEvents="none",d.style.width="".concat(a||0,"px"),d.style.height="".concat(o||0,"px"),l.appendChild(d)}return c}return null},t.prototype.getOrCreateEl=function(r){var e=this.context.config.document,n=this.displayObjectHTMLElementMap.get(r);return n||(n=(e||document).createElement("div"),r.parsedStyle.$el=n,this.displayObjectHTMLElementMap.set(r,n),r.id&&(n.id=r.id),r.name&&n.setAttribute("name",r.name),r.className&&(n.className=r.className),n.style.position="absolute",n.style.left="0px",n.style.top="0px",n.style["will-change"]="transform",n.style.transform=this.joinTransformMatrix(r.getWorldTransform())),n},t.prototype.updateAttribute=function(r,e){var n=this.getOrCreateEl(e);switch(r){case"innerHTML":var a=e.parsedStyle.innerHTML;isString$1(a)?n.innerHTML=a:(n.innerHTML="",n.appendChild(a));break;case"transformOrigin":var o=e.parsedStyle.transformOrigin;n.style["transform-origin"]="".concat(o[0].value," ").concat(o[1].value);break;case"width":if(this.context.enableCSSParsing){var s=e.computedStyleMap().get("width");n.style.width=s.toString()}else{var s=e.parsedStyle.width;n.style.width=isNumber$1(s)?"".concat(s,"px"):s.toString()}break;case"height":if(this.context.enableCSSParsing){var l=e.computedStyleMap().get("height");n.style.height=l.toString()}else{var l=e.parsedStyle.height;n.style.height=isNumber$1(l)?"".concat(l,"px"):l.toString()}break;case"zIndex":var u=e.parsedStyle.zIndex;n.style["z-index"]="".concat(u);break;case"visibility":var c=e.parsedStyle.visibility;n.style.visibility=c;break;case"pointerEvents":var d=e.parsedStyle.pointerEvents;n.style.pointerEvents=d;break;case"opacity":var f=e.parsedStyle.opacity;n.style.opacity="".concat(f);break;case"fill":var h=e.parsedStyle.fill,p="";isCSSRGB(h)?h.isNone?p="transparent":p=e.getAttribute("fill"):Array.isArray(h)?p=e.getAttribute("fill"):isPattern(h),n.style.background=p;break;case"stroke":var v=e.parsedStyle.stroke,g="";isCSSRGB(v)?v.isNone?g="transparent":g=e.getAttribute("stroke"):Array.isArray(v)?g=e.getAttribute("stroke"):isPattern(v),n.style["border-color"]=g,n.style["border-style"]="solid";break;case"lineWidth":var y=e.parsedStyle.lineWidth;n.style["border-width"]="".concat(y||0,"px");break;case"lineDash":n.style["border-style"]="dashed";break;case"filter":var m=e.style.filter;n.style.filter=m;break;default:r!=="x"&&r!=="y"&&!isNil$1(e.style[r])&&e.style[r]!==""&&(n.style[r]=e.style[r])}},t.tag="HTMLRendering",t}(),Plugin$1=function(t){__extends(r,t);function r(){var e=t.apply(this,__spreadArray([],__read(arguments),!1))||this;return e.name="html-renderer",e}return r.prototype.init=function(){this.addRenderingPlugin(new HTMLRenderingPlugin)},r.prototype.destroy=function(){this.removeAllRenderingPlugins()},r}(AbstractRendererPlugin),ImagePool=function(){function t(r){this.canvasConfig=r,this.imageCache={},this.gradientCache={},this.patternCache={}}return t.prototype.getImageSync=function(r,e){return this.imageCache[r]?e&&e(this.imageCache[r]):this.getOrCreateImage(r).then(function(n){e&&e(n)}),this.imageCache[r]},t.prototype.getOrCreateImage=function(r){var e=this;if(this.imageCache[r])return Promise.resolve(this.imageCache[r]);var n=this.canvasConfig.createImage;return new Promise(function(a,o){var s;n?s=n(r):isBrowser&&(s=new window.Image),s&&(s.onload=function(){e.imageCache[r]=s,a(s)},s.onerror=function(l){o(l)},s.crossOrigin="Anonymous",s.src=r)})},t.prototype.getOrCreatePatternSync=function(r,e,n,a,o){var s=this.generatePatternKey(r);if(s&&this.patternCache[s])return this.patternCache[s];var l=r.image,u=r.repetition,c=r.transform,d,f=!1;isString$1(l)?d=this.getImageSync(l,o):n?(d=n,f=!0):d=l;var h=d&&e.createPattern(d,u);if(h){var p=void 0;c?p=parsedTransformToMat4(parseTransform(c),new DisplayObject({})):p=identity$1(create$4()),f&&scale$2(p,p,[1/a,1/a,1]),h.setTransform({a:p[0],b:p[1],c:p[4],d:p[5],e:p[12],f:p[13]})}return s&&h&&(this.patternCache[s]=h),h},t.prototype.getOrCreateGradient=function(r,e){var n=this.generateGradientKey(r),a=r.type,o=r.steps,s=r.width,l=r.height,u=r.angle,c=r.cx,d=r.cy,f=r.size;if(this.gradientCache[n])return this.gradientCache[n];var h=null;if(a===GradientType.LinearGradient){var p=computeLinearGradient(s,l,u),v=p.x1,g=p.y1,y=p.x2,m=p.y2;h=e.createLinearGradient(v,g,y,m)}else if(a===GradientType.RadialGradient){var S=computeRadialGradient(s,l,c,d,f),w=S.x,R=S.y,T=S.r;h=e.createRadialGradient(w,R,0,w,R,T)}return h&&(o.forEach(function(x){var b=x.offset,L=x.color;b.unit===UnitType.kPercentage&&(h==null||h.addColorStop(b.value/100,L.toString()))}),this.gradientCache[n]=h),this.gradientCache[n]},t.prototype.generateGradientKey=function(r){var e=r.type,n=r.width,a=r.height,o=r.steps,s=r.angle,l=r.cx,u=r.cy,c=r.size;return"gradient-".concat(e,"-").concat((s==null?void 0:s.toString())||0,"-").concat((l==null?void 0:l.toString())||0,"-").concat((u==null?void 0:u.toString())||0,"-").concat((c==null?void 0:c.toString())||0,"-").concat(n,"-").concat(a,"-").concat(o.map(function(d){var f=d.offset,h=d.color;return"".concat(f).concat(h)}).join("-"))},t.prototype.generatePatternKey=function(r){var e=r.image,n=r.repetition;if(isString$1(e))return"pattern-".concat(e,"-").concat(n);if(e.nodeName==="rect")return"pattern-".concat(e.entity,"-").concat(n)},t}(),LoadImagePlugin=function(){function t(){}return t.prototype.apply=function(r){var e=r.renderingService,n=r.renderingContext,a=r.imagePool,o=n.root.ownerDocument.defaultView,s=function(c,d,f){var h=c.parsedStyle,p=h.width,v=h.height;p&&!v?c.setAttribute("height",f/d*p):!p&&v&&c.setAttribute("width",d/f*v)},l=function(c){var d=c.target,f=d.nodeName,h=d.attributes;if(f===Shape.IMAGE){var p=h.img,v=h.keepAspectRatio;isString$1(p)&&a.getImageSync(p,function(g){var y=g.width,m=g.height;v&&s(d,y,m),d.renderable.dirty=!0,e.dirtify()})}},u=function(c){var d=c.target,f=c.attrName,h=c.newValue;d.nodeName===Shape.IMAGE&&f==="img"&&isString$1(h)&&a.getOrCreateImage(h).then(function(p){var v=p.width,g=p.height;d.attributes.keepAspectRatio&&s(d,v,g),d.renderable.dirty=!0,e.dirtify()})};e.hooks.init.tap(t.tag,function(){o.addEventListener(ElementEvent.MOUNTED,l),o.addEventListener(ElementEvent.ATTR_MODIFIED,u)}),e.hooks.destroy.tap(t.tag,function(){o.removeEventListener(ElementEvent.MOUNTED,l),o.removeEventListener(ElementEvent.ATTR_MODIFIED,u)})},t.tag="LoadImage",t}(),Plugin=function(t){__extends(r,t);function r(){var e=t.apply(this,__spreadArray([],__read(arguments),!1))||this;return e.name="image-loader",e}return r.prototype.init=function(){this.context.imagePool=new ImagePool(this.context.config),this.addRenderingPlugin(new LoadImagePlugin)},r.prototype.destroy=function(){this.removeAllRenderingPlugins()},r}(AbstractRendererPlugin),Canvas2DContextService=function(){function t(r){this.renderingContext=r.renderingContext,this.canvasConfig=r.config}return t.prototype.init=function(){var r=this.canvasConfig,e=r.container,n=r.canvas;if(n)this.$canvas=n,e&&n.parentElement!==e&&e.appendChild(n),this.$container=n.parentElement,this.canvasConfig.container=this.$container;else if(e&&(this.$container=isString$1(e)?document.getElementById(e):e,this.$container)){var a=document.createElement("canvas");this.$container.appendChild(a),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=a}this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height)},t.prototype.getContext=function(){return this.context},t.prototype.getDomElement=function(){return this.$canvas},t.prototype.getDPR=function(){return this.dpr},t.prototype.getBoundingClientRect=function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()},t.prototype.destroy=function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)},t.prototype.resize=function(r,e){var n=this.canvasConfig.devicePixelRatio,a=n||isBrowser&&window.devicePixelRatio||1;a=a>=1?Math.ceil(a):1,this.dpr=a,this.$canvas&&(this.$canvas.width=this.dpr*r,this.$canvas.height=this.dpr*e,setDOMSize(this.$canvas,r,e)),this.renderingContext.renderReasons.add(RenderReason.CAMERA_CHANGED)},t.prototype.applyCursorStyle=function(r){this.$container&&this.$container.style&&(this.$container.style.cursor=r)},t.prototype.toDataURL=function(r){return r===void 0&&(r={}),__awaiter(this,void 0,void 0,function(){var e,n;return __generator(this,function(a){return e=r.type,n=r.encoderOptions,[2,this.context.canvas.toDataURL(e,n)]})})},t}(),ContextRegisterPlugin=function(t){__extends(r,t);function r(){var e=t.apply(this,__spreadArray([],__read(arguments),!1))||this;return e.name="canvas-context-register",e}return r.prototype.init=function(){this.context.ContextService=Canvas2DContextService},r.prototype.destroy=function(){delete this.context.ContextService},r}(AbstractRendererPlugin),Renderer=function(t){__extends(r,t);function r(e){var n=t.call(this,e)||this;return n.registerPlugin(new ContextRegisterPlugin),n.registerPlugin(new Plugin),n.registerPlugin(new Plugin$5),n.registerPlugin(new Plugin$3),n.registerPlugin(new Plugin$2),n.registerPlugin(new Plugin$4),n.registerPlugin(new Plugin$1),n}return r}(AbstractRenderer),BaseEvent=function(){function t(r){var e=this;this.isLinkFieldText=function(n){var a=e.getCellAppendInfo(n);return a==null?void 0:a.isLinkFieldText},this.spreadsheet=r,this.bindEvents()}return t.prototype.getCellAppendInfo=function(r){return getAppendInfo(r)},t.prototype.reset=function(){},t}(),DataCellClick=function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.bindEvents=function(){this.bindDataCellClick()},r.prototype.bindDataCellClick=function(){var e=this;this.spreadsheet.on(S2Event.DATA_CELL_CLICK,function(n){var a;n.stopPropagation();var o=e.spreadsheet.interaction;if(o.clearHoverTimer(),!o.hasIntercepts([InterceptType.CLICK])){if(e.isLinkFieldText(n.target)){e.emitLinkFieldClickEvent(n);return}var s=e.spreadsheet.getCell(n.target),l=s.getMeta();if(l){if(o.addIntercepts([InterceptType.HOVER]),o.isSelectedCell(s)){((a=n.originalEvent)===null||a===void 0?void 0:a.detail)===1&&(o.reset(),e.spreadsheet.emit(S2Event.GLOBAL_SELECTED,o.getActiveCells()));return}o.changeState({cells:[getCellMeta(s)],stateName:InteractionStateName.SELECTED,onUpdateCells:afterSelectDataCells}),e.spreadsheet.emit(S2Event.GLOBAL_SELECTED,[s]),e.showTooltip(n,l),o.updateDataCellRelevantHeaderCells(InteractionStateName.SELECTED,l)}}})},r.prototype.getTooltipOperator=function(e){var n=this.spreadsheet.getCell(e.target),a=getTooltipOptions(this.spreadsheet,e).operation;return getTooltipVisibleOperator(a,{defaultMenus:[],cell:n})},r.prototype.showTooltip=function(e,n){var a=n.data,o=n.isTotals,s=o===void 0?!1:o,l=n.value,u=n.fieldValue,c=n.field,d=n.valueField,f=a,h=this.spreadsheet.isTableMode(),p=h?__assign(__assign({},f),{value:l||u,valueField:c||d}):f,v=[p||__assign(__assign({},n.rowQuery),n.colQuery)],g=this.getTooltipOperator(e);this.spreadsheet.showTooltipWithInfo(e,v,{isTotals:s,operator:g,hideSummary:!0,onlyShowCellText:h})},r.prototype.emitLinkFieldClickEvent=function(e){var n=this.getCellAppendInfo(e.target).cellData,a=n,o=a.valueField,s=a.data;this.spreadsheet.emit(S2Event.GLOBAL_LINK_FIELD_JUMP,{cellData:n,field:o,record:Object.assign({rowIndex:n==null?void 0:n.rowIndex},s)})},r}(BaseEvent),MergedCellClick=function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.bindEvents=function(){this.bindDataCellClick()},r.prototype.bindDataCellClick=function(){var e=this;this.spreadsheet.on(S2Event.MERGED_CELLS_CLICK,function(n){n.stopPropagation();var a=e.spreadsheet.interaction;a.hasIntercepts([InterceptType.CLICK])||a.addIntercepts([InterceptType.HOVER])})},r}(BaseEvent),RowColumnClick=function(t){__extends(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.isMultiSelection=!1,e.handleRowColClick=function(n){if(n.stopPropagation(),!e.isLinkFieldText(n.target)){var a=e.spreadsheet,o=a.interaction,s=a.options,l=e.spreadsheet.getCell(n.target);if(!(l instanceof SeriesNumberCell)){var u=s.interaction.multiSelection,c=!!(u&&e.isMultiSelection),d=o.selectHeaderCell({cell:l,isMultiSelection:c});d&&e.showTooltip(n)}}},e.getHideColumnField=function(n){var a;return!((a=n.extra)===null||a===void 0)&&a.isCustomNode?n.id:e.spreadsheet.isTableMode()?n.field:n.id},e}return r.prototype.bindEvents=function(){this.bindKeyboardDown(),this.bindKeyboardUp(),this.bindColCellClick(),this.bindRowCellClick(),this.bindTableColExpand(),this.bindMouseMove()},r.prototype.reset=function(){this.isMultiSelection=!1,this.spreadsheet.interaction.removeIntercepts([InterceptType.CLICK])},r.prototype.bindKeyboardDown=function(){var e=this;this.spreadsheet.on(S2Event.GLOBAL_KEYBOARD_DOWN,function(n){isMultiSelectionKey(n)&&(e.isMultiSelection=!0)})},r.prototype.bindKeyboardUp=function(){var e=this;this.spreadsheet.on(S2Event.GLOBAL_KEYBOARD_UP,function(n){isMultiSelectionKey(n)&&e.reset()})},r.prototype.bindMouseMove=function(){var e=this;this.spreadsheet.on(S2Event.GLOBAL_MOUSE_MOVE,function(n){e.isMultiSelection&&!isMouseEventWithMeta(n)&&e.reset()})},r.prototype.bindRowCellClick=function(){var e=this;this.spreadsheet.on(S2Event.ROW_CELL_CLICK,function(n){e.handleRowColClick(n)})},r.prototype.bindColCellClick=function(){var e=this;this.spreadsheet.on(S2Event.COL_CELL_CLICK,function(n){e.handleRowColClick(n)})},r.prototype.showTooltip=function(e){var n=getTooltipOptions(this.spreadsheet,e),a=n.operation,o=n.enable;if(o){var s=this.spreadsheet.interaction,l=s.isSelectedState()?mergeCellInfo(s.getActiveCells()):[],u=this.getTooltipOperator(e,a);this.spreadsheet.showTooltipWithInfo(e,l,{onlyShowCellText:!0,operator:u})}},r.prototype.getTooltipOperator=function(e,n){var a=this,o=this.spreadsheet.getCell(e.target),s=o.getMeta(),l=o.cellType===CellType.COL_CELL,u=this.spreadsheet.facet.getColLeafNodes().length===1,c=getTooltipOperatorHiddenColumnsMenu(),d=l&&!u&&s.isLeaf&&n.hiddenColumns,f=__assign(__assign({},c),{onClick:function(){a.hideSelectedColumns()}}),h=d?[f]:[];return getTooltipVisibleOperator(n,{defaultMenus:h,cell:o})},r.prototype.bindTableColExpand=function(){var e=this;this.spreadsheet.on(S2Event.COL_CELL_EXPANDED,function(n){e.handleExpandIconClick(n)})},r.prototype.hideSelectedColumns=function(){return __awaiter(this,void 0,void 0,function(){var e,n,a;return __generator(this,function(o){switch(o.label){case 0:return e=this.spreadsheet.interaction,n=e.getActiveCells().map(function(s){return s.getMeta()}),a=n.map(this.getHideColumnField),[4,hideColumnsByThunkGroup(this.spreadsheet,a,!0)];case 1:return o.sent(),[2]}})})},r.prototype.handleExpandIconClick=function(e){var n=this.spreadsheet.store.get("hiddenColumnsDetail",[]),a=(findLast(n,function(d){var f=d.displaySiblingNode;return isEqualDisplaySiblingNodeId(f,e.id)})||{}).hideColumnNodes,o=a===void 0?[]:a,s=this.spreadsheet.options.interaction.hiddenColumnFields,l=o.map(this.getHideColumnField),u=difference(s,l),c=n.filter(function(d){var f=d.displaySiblingNode;return!isEqualDisplaySiblingNodeId(f,e.id)});this.spreadsheet.setOptions({interaction:{hiddenColumnFields:u}}),this.spreadsheet.store.set("hiddenColumnsDetail",c),this.spreadsheet.interaction.reset(),this.spreadsheet.render(!1)},r}(BaseEvent),RowTextClick=function(t){__extends(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.getRowData=function(n){var a,o=n.getHeadLeafChild(),s=e.spreadsheet.dataSet.getCellMultiData({query:o==null?void 0:o.query})[0],l=CellData.getFieldValue(s);return __assign(__assign({},l),{rowIndex:(a=n.rowIndex)!==null&&a!==void 0?a:o==null?void 0:o.rowIndex})},e}return r.prototype.bindEvents=function(){this.bindRowCellClick()},r.prototype.bindRowCellClick=function(){var e=this;this.spreadsheet.on(S2Event.ROW_CELL_CLICK,function(n){if(!e.spreadsheet.interaction.hasIntercepts([InterceptType.CLICK])&&e.isLinkFieldText(n.target)){var a=e.getCellAppendInfo(n.target).cellData,o=a.field,s=e.getRowData(a);e.spreadsheet.emit(S2Event.GLOBAL_LINK_FIELD_JUMP,{field:o,cellData:a,record:s})}})},r}(BaseEvent),CornerCellClick=function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.bindEvents=function(){this.bindCornerCellClick()},r.prototype.bindCornerCellClick=function(){var e=this;this.spreadsheet.on(S2Event.CORNER_CELL_CLICK,function(n){var a=e.spreadsheet.getCell(n.target);if(a){var o=a.getMeta();switch(o==null?void 0:o.cornerType){case CornerNodeType.Row:e.onRowCornerClick(o==null?void 0:o.field,n);break;case CornerNodeType.Col:e.onColCornerClick(o==null?void 0:o.field,n);break;case CornerNodeType.Series:e.onSeriesCornerClick(o==null?void 0:o.field,n);break}}})},r.prototype.onRowCornerClick=function(e,n){var a=this.getSelectedRowNodes(e);this.selectCells(a,n)},r.prototype.onColCornerClick=function(e,n){var a=this.getSelectedColNodes(e);this.selectCells(a,n)},r.prototype.onSeriesCornerClick=function(e,n){var a=this.spreadsheet.facet.getSeriesNumberNodes();this.selectCells(a,n)},r.prototype.getSelectedRowNodes=function(e){var n=this.spreadsheet.facet;if(this.spreadsheet.isHierarchyTreeType())return n.getRowNodes();if(!this.spreadsheet.isCustomRowFields())return n.getRowNodesByField(e);var a=n.getRowNodesByField(e)[0];return n.getRowNodes(a==null?void 0:a.level)},r.prototype.getSelectedColNodes=function(e){var n=this.spreadsheet.facet;if(!this.spreadsheet.isCustomColumnFields())return n.getColNodesByField(e);var a=n.getColNodesByField(e)[0];return n.getColNodes(a==null?void 0:a.level)},r.prototype.getCellMetas=function(e,n){return e.map(function(a){return{id:a.id,colIndex:-1,rowIndex:-1,type:n}})},r.prototype.selectCells=function(e,n){var a,o=this.spreadsheet.interaction,s=(a=e[0])===null||a===void 0?void 0:a.belongsCell,l=this.getCellMetas(e,s==null?void 0:s.cellType);if(s&&o.isSelectedCell(s)){o.reset(),this.spreadsheet.emit(S2Event.GLOBAL_SELECTED,o.getActiveCells());return}isEmpty(e)||isEmpty(l)||(o.addIntercepts([InterceptType.HOVER]),o.changeState({cells:l,stateName:InteractionStateName.SELECTED}),o.highlightNodes(e),this.showTooltip(n),this.spreadsheet.emit(S2Event.GLOBAL_SELECTED,o.getActiveCells()))},r.prototype.showTooltip=function(e){var n=this.spreadsheet.interaction.getActiveCells();this.spreadsheet.showTooltipWithInfo(e,[],{data:{summaries:[{selectedData:n,name:"",value:null}]}})},r}(BaseEvent),HoverEvent=function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.bindEvents=function(){this.bindDataCellHover(),this.bindHeaderCellHover()},r.prototype.changeStateToHoverFocus=function(e,n){var a=this,o;if(e){var s=e.getMeta(),l=this.spreadsheet.interaction,u=this.spreadsheet.options.interaction,c=u.hoverFocus;l.clearHoverTimer();var d=function(){if(!l.hasIntercepts([InterceptType.HOVER])){l.changeState({cells:[getCellMeta(e)],stateName:InteractionStateName.HOVER_FOCUS});var p=a.spreadsheet.isTableMode(),v={isTotals:s.isTotals,hideSummary:!0,onlyShowCellText:p};u!=null&&u.hoverHighlight&&l.updateDataCellRelevantHeaderCells(InteractionStateName.HOVER,s);var g=a.getCellData(s,p);a.spreadsheet.showTooltipWithInfo(n,g,v)}},f=isBoolean(c)?HOVER_FOCUS_DURATION:(o=c==null?void 0:c.duration)!==null&&o!==void 0?o:HOVER_FOCUS_DURATION;if(f===0)d();else{var h=window.setTimeout(function(){return d()},f);l.setHoverTimer(h)}}},r.prototype.handleHeaderHover=function(e){var n=this.spreadsheet.getCell(e.target);if(!isEmpty(n)){var a=this.spreadsheet.interaction;a.clearHoverTimer(),!a.isActiveCell(n)&&(a.changeState({cells:[getCellMeta(n)],stateName:InteractionStateName.HOVER}),n.update(),this.showEllipsisTooltip(e,n))}},r.prototype.showEllipsisTooltip=function(e,n){if(!n||!n.isTextOverflowing()){this.spreadsheet.hideTooltip();return}var a=n.getMeta(),o={isTotals:a.isTotals,hideSummary:!0,onlyShowCellText:!0,enableFormat:!0},s=this.getCellData(a,o.onlyShowCellText);this.spreadsheet.showTooltipWithInfo(e,s,o)},r.prototype.getCellData=function(e,n){e===void 0&&(e={});var a=e.data,o=e.query,s=e.value,l=e.field,u=e.fieldValue,c=e.valueField,d=e.rowQuery,f=e.colQuery,h=a,p=n?[__assign(__assign({},o),{value:s||u,valueField:l||c})]:[h||__assign(__assign({},d),f)];return p},r.prototype.bindDataCellHover=function(){var e=this;this.spreadsheet.on(S2Event.DATA_CELL_HOVER,function(n){var a=e.spreadsheet.getCell(n.target);if(!isEmpty(a)){var o=e.spreadsheet,s=o.interaction,l=o.options,u=l.interaction,c=a==null?void 0:a.getMeta();s.isActiveCell(a)||(s.changeState({cells:[getCellMeta(a)],stateName:InteractionStateName.HOVER}),u!=null&&u.hoverHighlight&&s.updateDataCellRelevantHeaderCells(InteractionStateName.HOVER,c),u!=null&&u.hoverFocus&&e.changeStateToHoverFocus(a,n))}})},r.prototype.bindHeaderCellHover=function(){var e=this;[S2Event.ROW_CELL_HOVER,S2Event.COL_CELL_HOVER,S2Event.CORNER_CELL_HOVER].forEach(function(n){e.spreadsheet.on(n,function(a){e.handleHeaderHover(a)})})},r}(BaseEvent),BaseBrushSelection=function(t){__extends(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.displayedCells=[],e.brushRangeCells=[],e.brushSelectionStage=InteractionBrushSelectionStage.UN_DRAGGED,e.brushSelectionMinimumMoveDistance=5,e.scrollAnimationComplete=!0,e.mouseMoveDistanceFromCanvas=0,e.setMoveDistanceFromCanvas=function(n,a,o){var s=0;if(a&&(s=n.x),o){var l=n.y;a?s=Math.max(l,s):s=l}e.mouseMoveDistanceFromCanvas=Math.abs(s)},e.formatBrushPointForScroll=function(n,a){var o,s,l,u;a===void 0&&(a=!1);var c=n.x,d=n.y,f=e.spreadsheet.facet,h=a?f.cornerBBox:f.panelBBox,p=h.minX,v=h.maxX,g=f.panelBBox,y=g.minY,m=g.maxY,S=((o=e.endBrushPoint)===null||o===void 0?void 0:o.x)+c,w=((s=e.endBrushPoint)===null||s===void 0?void 0:s.y)+d,R=!0,T=!0,x=(u=(l=f.vScrollBar)===null||l===void 0?void 0:l.getBBox())===null||u===void 0?void 0:u.width,b=2;return S>v?S=v-x-b:S<p?S=p+b:R=!1,w>m?w=m-b:w<=y?w=y+b:T=!1,{x:{value:S,needScroll:R},y:{value:w,needScroll:T}}},e.autoScrollIntervalId=null,e.rectanglesIntersect=function(n,a){return n.maxX>a.minX&&n.minX<a.maxX&&n.minY<a.maxY&&n.maxY>a.minY},e.autoScrollConfig=cloneDeep(BRUSH_AUTO_SCROLL_INITIAL_CONFIG),e.validateYIndex=function(n){var a,o,s=e.spreadsheet.facet,l=s.frozenGroupInfo,u=0,c=(a=l==null?void 0:l.frozenRow)===null||a===void 0?void 0:a.range;if(c!=null&&c[1]&&(u=c[1]+1),n<u)return null;var d=s.getCellRange().end,f=(o=l==null?void 0:l.frozenTrailingRow)===null||o===void 0?void 0:o.range;return f!=null&&f[0]&&(d=f[0]-1),n>d?null:n},e.validateXIndex=function(n){var a,o,s=e.spreadsheet.facet,l=s.frozenGroupInfo,u=0,c=(a=l==null?void 0:l.frozenCol)===null||a===void 0?void 0:a.range;if(c!=null&&c[1]&&(u=c[1]+1),n<u)return null;var d=s.getColLeafNodes().length-1,f=(o=l==null?void 0:l.frozenTrailingCol)===null||o===void 0?void 0:o.range;return f!=null&&f[0]&&(d=f[0]-1),n>d?null:n},e.adjustNextColIndexWithFrozen=function(n,a){var o=e.spreadsheet,s=o.facet,l=o.dataSet,u=o.options,c=l.getDisplayDataSet().length,d=s.getColLeafNodes().length,f=getValidFrozenOptions(u.frozen,d,c),h=f.trailingColCount,p=f.colCount,v=s.panelScrollGroupIndexes;return h>0&&a===ScrollDirection.SCROLL_DOWN&&isFrozenTrailingCol(n,h,d)?v[1]:p>0&&a===ScrollDirection.SCROLL_UP&&isFrozenCol(n,p)?v[0]:n},e.adjustNextRowIndexWithFrozen=function(n,a){var o=e.spreadsheet,s=o.facet,l=o.dataSet,u=o.options,c=l.getDisplayDataSet().length,d=s.getColLeafNodes().length,f=s.getCellRange(),h=getValidFrozenOptions(u.frozen,d,c),p=h.trailingRowCount,v=h.rowCount,g=s.panelScrollGroupIndexes;return p>0&&a===ScrollDirection.SCROLL_DOWN&&isFrozenTrailingRow(n,f.end,p)?g[3]:v>0&&a===ScrollDirection.SCROLL_UP&&isFrozenRow(n,f.start,v)?g[2]:n},e.getWillScrollRowIndexDiff=function(n){return n===ScrollDirection.SCROLL_DOWN?ScrollDirectionRowIndexDiff.SCROLL_DOWN:ScrollDirectionRowIndexDiff.SCROLL_UP},e.getDefaultWillScrollToRowIndex=function(n){var a=e.adjustNextRowIndexWithFrozen(e.endBrushPoint.rowIndex,n),o=a+e.getWillScrollRowIndexDiff(n);return e.validateYIndex(o)},e.getWillScrollToRowIndex=function(n){return e.getDefaultWillScrollToRowIndex(n)},e.getNextScrollDelta=function(n){var a=e.spreadsheet.facet.getScrollOffset(),o=a.scrollX,s=o===void 0?0:o,l=a.scrollY,u=l===void 0?0:l,c=0,d=0;if(n.y.scroll){var f=n.y.value>0?ScrollDirection.SCROLL_DOWN:ScrollDirection.SCROLL_UP,h=e.getWillScrollToRowIndex(f);if(isNil(h))d=0;else{var p=getScrollOffsetForRow(h,f,e.spreadsheet)-u,v=isNil(p)||Number.isNaN(p);d=v?0:p}}if(n.x.scroll){var f=n.x.value>0?ScrollDirection.SCROLL_DOWN:ScrollDirection.SCROLL_UP,g=e.adjustNextColIndexWithFrozen(e.endBrushPoint.colIndex,f),y=e.validateXIndex(g+(n.x.value>0?1:-1));c=isNil(y)?0:getScrollOffsetForCol(y,f,e.spreadsheet)-s}return{x:c,y:d}},e.onScrollAnimationComplete=function(){e.scrollAnimationComplete=!0,e.brushSelectionStage!==InteractionBrushSelectionStage.UN_DRAGGED&&e.renderPrepareSelected(e.endBrushPoint)},e.autoScroll=function(n){if(n===void 0&&(n=!1),!(e.brushSelectionStage===InteractionBrushSelectionStage.UN_DRAGGED||!e.scrollAnimationComplete)){var a=e.autoScrollConfig,o=e.spreadsheet.facet.getScrollOffset(),s=n?"rowHeaderOffsetX":"offsetX",l={rowHeaderOffsetX:{value:o.rowHeaderScrollX,animate:!0},offsetX:{value:o.scrollX,animate:!0},offsetY:{value:o.scrollY,animate:!0}},u=e.getNextScrollDelta(a),c=u.x,d=u.y;if(d===0&&c===0){e.clearAutoScroll();return}if(a.y.scroll&&(l.offsetY.value+=d),a.x.scroll){var f=l[s];f.value+=c,f.value<0&&(f.value=0)}e.scrollAnimationComplete=!1;var h=a.x.scroll?1:3,p=Math.max(16,300-e.mouseMoveDistanceFromCanvas*h);e.spreadsheet.facet.scrollWithAnimation(l,p,e.onScrollAnimationComplete)}},e.handleScroll=throttle(function(n,a,o){if(o===void 0&&(o=!1),e.brushSelectionStage!==InteractionBrushSelectionStage.UN_DRAGGED){var s=e.formatBrushPointForScroll({x:n,y:a},o),l=s.x,u=l.value,c=l.needScroll,d=s.y,f=d.value,h=d.needScroll,p=e.autoScrollConfig;h&&(p.y.value=a,p.y.scroll=!0),c&&(p.x.value=n,p.x.scroll=!0),e.setMoveDistanceFromCanvas({x:n,y:a},c,h),e.renderPrepareSelected({x:u,y:f}),(h||c)&&(e.clearAutoScroll(),e.autoScroll(o),e.autoScrollIntervalId=setInterval(function(){e.autoScroll(o)},16))}},30),e.clearAutoScroll=function(){e.autoScrollIntervalId&&(clearInterval(e.autoScrollIntervalId),e.autoScrollIntervalId=null,e.resetScrollDelta())},e.onUpdateCells=function(n,a){return a()},e.showPrepareSelectedCells=function(){e.brushRangeCells=e.getBrushRangeCells(),e.spreadsheet.interaction.changeState({cells:map(e.brushRangeCells,function(n){return getCellMeta(n)}),stateName:InteractionStateName.PREPARE_SELECT,force:!0,onUpdateCells:e.onUpdateCells})},e.renderPrepareSelected=function(n){var a=n.x,o=n.y,s=e.spreadsheet.container.document.elementsFromPointSync(a,o),l=s.map(function(p){return e.spreadsheet.getCell(p)}).find(Boolean),u=l instanceof DataCell||l instanceof RowCell||l instanceof ColCell;if(!(!l||!u)){var c=l.getMeta(),d=c.rowIndex,f=c.colIndex;e.endBrushPoint={x:a,y:o,rowIndex:d,colIndex:f};var h=e.spreadsheet.interaction;h.addIntercepts([InterceptType.HOVER]),h.clearStyleIndependent(),e.isValidBrushSelection()&&(e.showPrepareSelectedCells(),e.updatePrepareSelectMask())}},e}return r.prototype.bindEvents=function(){this.bindMouseDown(),this.bindMouseMove(),this.bindMouseUp()},r.prototype.getPrepareSelectMaskTheme=function(){var e;return(e=this.spreadsheet.theme)===null||e===void 0?void 0:e.prepareSelectMask},r.prototype.initPrepareSelectMaskShape=function(){var e,n=this.spreadsheet.facet.foregroundGroup;if(n){(e=this.prepareSelectMaskShape)===null||e===void 0||e.remove();var a=this.getPrepareSelectMaskTheme();this.prepareSelectMaskShape=n.appendChild(new Rect({style:{width:0,height:0,x:0,y:0,fill:a==null?void 0:a.backgroundColor,fillOpacity:a==null?void 0:a.backgroundOpacity,zIndex:FRONT_GROUND_GROUP_BRUSH_SELECTION_Z_INDEX,visibility:"hidden",pointerEvents:"none"}}))}},r.prototype.setBrushSelectionStage=function(e){this.brushSelectionStage=e},r.prototype.isPointInCanvas=function(e){var n=this.spreadsheet.facet.getCanvasSize(),a=n.height,o=n.width,s=this.spreadsheet.facet.panelBBox,l=s.minX,u=s.minY;return(e==null?void 0:e.x)>l&&(e==null?void 0:e.x)<o&&(e==null?void 0:e.y)>u&&(e==null?void 0:e.y)<a},r.prototype.resetDrag=function(){this.hidePrepareSelectMaskShape(),this.setBrushSelectionStage(InteractionBrushSelectionStage.UN_DRAGGED)},r.prototype.isValidBrushSelection=function(){var e=this.getBrushRange(),n=e.start,a=e.end,o=a.x-n.x>this.brushSelectionMinimumMoveDistance||a.y-n.y>this.brushSelectionMinimumMoveDistance;return o},r.prototype.setDisplayedCells=function(){this.displayedCells=this.spreadsheet.facet.getDataCells()},r.prototype.updatePrepareSelectMask=function(){var e=this.getBrushRange(),n=this.getPrepareSelectMaskPosition(e),a=n.x,o=n.y;this.prepareSelectMaskShape.attr({x:a,y:o,width:e.width,height:e.height}),this.prepareSelectMaskShape.setAttribute("visibility","visible")},r.prototype.hidePrepareSelectMaskShape=function(){var e;(e=this.prepareSelectMaskShape)===null||e===void 0||e.setAttribute("visibility","hidden")},r.prototype.resetScrollDelta=function(){this.autoScrollConfig=cloneDeep(BRUSH_AUTO_SCROLL_INITIAL_CONFIG)},r.prototype.getBrushPoint=function(e){var n=this.spreadsheet.facet.getScrollOffset(),a=n.scrollY,o=n.scrollX,s={x:e==null?void 0:e.x,y:e==null?void 0:e.y},l=this.spreadsheet.getCell(e.target),u=l.getMeta(),c=u.colIndex,d=u.rowIndex;return __assign(__assign({},s),{rowIndex:d,colIndex:c,scrollY:a,scrollX:o})},r.prototype.getBrushRange=function(){var e,n,a,o,s,l,u,c,d=this.spreadsheet.facet.getScrollOffset(),f=d.scrollX,h=f===void 0?0:f,p=d.scrollY,v=p===void 0?0:p,g=Math.min(this.startBrushPoint.rowIndex,(e=this.endBrushPoint)===null||e===void 0?void 0:e.rowIndex),y=Math.max(this.startBrushPoint.rowIndex,(n=this.endBrushPoint)===null||n===void 0?void 0:n.rowIndex),m=Math.min(this.startBrushPoint.colIndex,(a=this.endBrushPoint)===null||a===void 0?void 0:a.colIndex),S=Math.max(this.startBrushPoint.colIndex,(o=this.endBrushPoint)===null||o===void 0?void 0:o.colIndex),w=this.startBrushPoint.x+this.startBrushPoint.scrollX-h,R=this.startBrushPoint.y+this.startBrushPoint.scrollY-v,T=Math.min(w,(s=this.endBrushPoint)===null||s===void 0?void 0:s.x),x=Math.max(w,(l=this.endBrushPoint)===null||l===void 0?void 0:l.x),b=Math.min(R,(u=this.endBrushPoint)===null||u===void 0?void 0:u.y),L=Math.max(R,(c=this.endBrushPoint)===null||c===void 0?void 0:c.y);return{start:{rowIndex:g,colIndex:m,x:T,y:b},end:{rowIndex:y,colIndex:S,x,y:L},width:x-T,height:L-b}},r.prototype.getBrushRangeCells=function(){var e=this;return this.setDisplayedCells(),this.displayedCells.filter(function(n){var a=n.getMeta();return e.isInBrushRange(a)})},r.prototype.mouseDown=function(e){this.spreadsheet.interaction.hasIntercepts([InterceptType.CLICK])||(this.setBrushSelectionStage(InteractionBrushSelectionStage.CLICK),this.initPrepareSelectMaskShape(),this.setDisplayedCells(),this.startBrushPoint=this.getBrushPoint(e))},r.prototype.addBrushIntercepts=function(){this.spreadsheet.interaction.addIntercepts([InterceptType.DATA_CELL_BRUSH_SELECTION])},r.prototype.bindMouseUp=function(e){var n=this;e===void 0&&(e=!1),this.spreadsheet.on(S2Event.GLOBAL_MOUSE_UP,function(a){if(n.brushSelectionStage!==InteractionBrushSelectionStage.DRAGGED){n.resetDrag();return}if(e&&n.clearAutoScroll(),n.isValidBrushSelection()){n.addBrushIntercepts(),n.updateSelectedCells();var o=getCellsTooltipData(n.spreadsheet);n.spreadsheet.showTooltipWithInfo(a,o)}n.spreadsheet.interaction.getCurrentStateName()===InteractionStateName.PREPARE_SELECT&&n.spreadsheet.interaction.reset(),n.resetDrag()}),this.spreadsheet.on(S2Event.GLOBAL_CONTEXT_MENU,function(){n.brushSelectionStage!==InteractionBrushSelectionStage.UN_DRAGGED&&(n.spreadsheet.interaction.removeIntercepts([InterceptType.HOVER]),n.resetDrag())})},r.prototype.autoBrushScroll=function(e,n){var a,o;if(n===void 0&&(n=!1),this.clearAutoScroll(),!this.isPointInCanvas(e)){var s=(e==null?void 0:e.x)-((a=this.endBrushPoint)===null||a===void 0?void 0:a.x),l=(e==null?void 0:e.y)-((o=this.endBrushPoint)===null||o===void 0?void 0:o.y);return this.handleScroll(s,l,n),!0}return!1},r.prototype.emitBrushSelectionEvent=function(e,n){this.spreadsheet.emit(e,n),this.spreadsheet.emit(S2Event.GLOBAL_SELECTED,n),isEmpty(n)&&this.spreadsheet.interaction.removeIntercepts([InterceptType.HOVER])},r.prototype.getVisibleBrushRangeCells=function(e){return this.brushRangeCells.find(function(n){var a=n.getMeta();return(a==null?void 0:a.id)===e})},r.prototype.isInBrushRange=function(e){return!1},r.prototype.bindMouseDown=function(){},r.prototype.bindMouseMove=function(){},r.prototype.updateSelectedCells=function(){},r.prototype.getPrepareSelectMaskPosition=function(e){return{x:e.start.x,y:e.start.y}},r}(BaseEvent),ColCellBrushSelection=function(t){__extends(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.displayedCells=[],e.brushRangeCells=[],e.onUpdateCells=function(n){return n.updateCells(e.spreadsheet.facet.getColCells())},e}return r.prototype.bindEvents=function(){this.bindMouseDown(),this.bindMouseMove(),this.bindMouseUp()},r.prototype.bindMouseDown=function(){var e=this;this.spreadsheet.on(S2Event.COL_CELL_MOUSE_DOWN,function(n){e.spreadsheet.interaction.getBrushSelection().colCell&&t.prototype.mouseDown.call(e,n)})},r.prototype.isPointInCanvas=function(e){var n=this.spreadsheet.facet.getCanvasSize().width,a=this.spreadsheet.facet.cornerBBox,o=a.width,s=a.minY,l=a.maxY;return e.x>=o&&e.x<=n&&e.y>=s&&e.y<=l},r.prototype.bindMouseMove=function(){var e=this;this.spreadsheet.on(S2Event.COL_CELL_MOUSE_MOVE,function(n){var a;if(e.brushSelectionStage!==InteractionBrushSelectionStage.UN_DRAGGED){e.setBrushSelectionStage(InteractionBrushSelectionStage.DRAGGED);var o=(a=e.spreadsheet.interaction.eventController)===null||a===void 0?void 0:a.getViewportPoint(n);e.isPointInCanvas(o)&&e.renderPrepareSelected(o)}})},r.prototype.setDisplayedCells=function(){this.displayedCells=this.spreadsheet.facet.getColCells()},r.prototype.isInBrushRange=function(e){var n=this.getBrushRange(),a=n.start,o=n.end,s=this.spreadsheet.facet.getScrollOffset().scrollX,l=s===void 0?0:s,u=this.spreadsheet.facet.cornerBBox,c=e.x,d=c===void 0?0:c,f=e.y,h=f===void 0?0:f,p=e.width,v=p===void 0?0:p,g=e.height,y=g===void 0?0:g;return this.rectanglesIntersect({minX:a.x-u.width+l,minY:a.y,maxX:o.x-u.width+l,maxY:o.y},{minX:d,maxX:d+v,minY:h,maxY:h+y})},r.prototype.updateSelectedCells=function(){var e=this.spreadsheet,n=e.interaction,a=e.facet;n.changeState({cells:map(this.brushRangeCells,getCellMeta),onUpdateCells:function(o){o.updateCells(a.getColCells())},stateName:InteractionStateName.COL_CELL_BRUSH_SELECTED}),this.spreadsheet.emit(S2Event.COL_CELL_BRUSH_SELECTION,this.brushRangeCells),this.spreadsheet.emit(S2Event.GLOBAL_SELECTED,this.brushRangeCells),isEmpty(this.brushRangeCells)&&n.removeIntercepts([InterceptType.HOVER])},r.prototype.addBrushIntercepts=function(){this.spreadsheet.interaction.addIntercepts([InterceptType.COL_CELL_BRUSH_SELECTION])},r}(BaseBrushSelection),DataCellBrushSelection=function(t){__extends(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.displayedCells=[],e.brushRangeCells=[],e.getSelectedCellMetas=function(n){var a=e.spreadsheet.facet,o=[],s=a.getRowLeafNodes(),l=a.getColLeafNodes(),u=range(n.start.rowIndex,n.end.rowIndex+1),c=range(n.start.colIndex,n.end.colIndex+1);return u.forEach(function(d){c.forEach(function(f){var h=String(l[f].id),p=isEmpty(s)?String(d):String(s[d].id);o.push({colIndex:f,rowIndex:d,id:"".concat(p,"-").concat(h),type:CellType.DATA_CELL,rowId:p,colId:h,spreadsheet:e.spreadsheet})})}),o},e}return r.prototype.bindMouseDown=function(){var e=this;this.spreadsheet.on(S2Event.DATA_CELL_MOUSE_DOWN,function(n){e.spreadsheet.interaction.getBrushSelection().dataCell&&(t.prototype.mouseDown.call(e,n),e.resetScrollDelta())})},r.prototype.bindMouseMove=function(){var e=this;this.spreadsheet.on(S2Event.GLOBAL_MOUSE_MOVE,function(n){if(e.brushSelectionStage!==InteractionBrushSelectionStage.UN_DRAGGED){e.setBrushSelectionStage(InteractionBrushSelectionStage.DRAGGED);var a=e.spreadsheet.interaction.eventController.getViewportPoint(n);e.autoBrushScroll(a)||e.renderPrepareSelected(a)}})},r.prototype.isInBrushRange=function(e){var n=this.getBrushRange(),a=n.start,o=n.end,s=e.rowIndex,l=e.colIndex;return s>=a.rowIndex&&s<=o.rowIndex&&l>=a.colIndex&&l<=o.colIndex},r.prototype.updateSelectedCells=function(){var e=this.getBrushRange(),n=this.getSelectedCellMetas(e);this.spreadsheet.interaction.changeState({cells:n,stateName:InteractionStateName.DATA_CELL_BRUSH_SELECTED,onUpdateCells:afterSelectDataCells});var a=this.getScrollBrushRangeCells(n);this.emitBrushSelectionEvent(S2Event.DATA_CELL_BRUSH_SELECTION,a)},r.prototype.getScrollBrushRangeCells=function(e){var n=this;return e.map(function(a){var o=n.getVisibleBrushRangeCells(a.id);if(o)return o;var s=n.spreadsheet.facet.getCellMeta(a.rowIndex,a.colIndex);return n.spreadsheet.options.dataCell(s)})},r.prototype.bindMouseUp=function(){t.prototype.bindMouseUp.call(this,!0)},r.prototype.getPrepareSelectMaskPosition=function(e){var n=this.spreadsheet.facet.panelBBox,a=n.minX,o=n.minY,s=Math.max(e.start.x,a),l=Math.max(e.start.y,o);return{x:s,y:l}},r}(BaseBrushSelection),RowCellBrushSelection=function(t){__extends(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.displayedCells=[],e.brushRangeCells=[],e.isInBrushRange=function(n){var a=e.getBrushRange(),o=a.start,s=a.end,l=e.spreadsheet.facet.getScrollOffset(),u=l.scrollY,c=l.rowHeaderScrollX,d=e.spreadsheet.facet.cornerBBox,f=n.x,h=f===void 0?0:f,p=n.y,v=p===void 0?0:p,g=n.width,y=g===void 0?0:g,m=n.height,S=m===void 0?0:m;return e.rectanglesIntersect({minX:o.x+c,minY:o.y-d.height+u,maxX:s.x+c,maxY:s.y-d.height+u},{minX:h,maxX:h+y,minY:v,maxY:v+S})},e.onUpdateCells=function(n){return n.updateCells(e.spreadsheet.facet.getRowCells())},e.getSelectedRowNodes=function(){return e.spreadsheet.facet.getRowNodes().filter(e.isInBrushRange)},e.getVisibleRowLeafCellByScrollDirection=function(n){var a=e.spreadsheet.facet.getRowCells();return n===ScrollDirection.SCROLL_DOWN?last(a):a.find(function(o){var s=o.getMeta();return s.isLeaf})},e.getWillScrollToRowIndex=function(n){var a,o;if(!isNil(e.endBrushPoint.rowIndex))return e.getDefaultWillScrollToRowIndex(n);var s=e.getVisibleRowLeafCellByScrollDirection(n),l=(o=(a=s==null?void 0:s.getMeta())===null||a===void 0?void 0:a.rowIndex)!==null&&o!==void 0?o:0,u=l+e.getWillScrollRowIndexDiff(n);return e.validateYIndex(u)},e}return r.prototype.bindMouseDown=function(){var e=this;this.spreadsheet.on(S2Event.ROW_CELL_MOUSE_DOWN,function(n){e.spreadsheet.interaction.getBrushSelection().rowCell&&t.prototype.mouseDown.call(e,n)})},r.prototype.isPointInCanvas=function(e){var n=this.spreadsheet.facet.getCanvasSize().height,a=this.spreadsheet.facet.cornerBBox,o=a.minX,s=a.height,l=a.maxX;return e.x>=o&&e.x<=l&&e.y>=s&&e.y<=n},r.prototype.bindMouseMove=function(){var e=this;this.spreadsheet.on(S2Event.GLOBAL_MOUSE_MOVE,function(n){if(e.brushSelectionStage!==InteractionBrushSelectionStage.UN_DRAGGED){e.setBrushSelectionStage(InteractionBrushSelectionStage.DRAGGED);var a=e.spreadsheet.interaction.eventController.getViewportPoint(n);e.autoBrushScroll(a,!0)||e.renderPrepareSelected(a)}})},r.prototype.setDisplayedCells=function(){this.displayedCells=this.spreadsheet.facet.getRowCells()},r.prototype.updateSelectedCells=function(){var e=this.getSelectedRowNodes(),n=this.getScrollBrushRangeCells(e),a=map(n,getCellMeta);this.spreadsheet.interaction.changeState({cells:a,stateName:InteractionStateName.ROW_CELL_BRUSH_SELECTED,onUpdateCells:this.onUpdateCells}),this.emitBrushSelectionEvent(S2Event.ROW_CELL_BRUSH_SELECTION,n)},r.prototype.addBrushIntercepts=function(){this.spreadsheet.interaction.addIntercepts([InterceptType.ROW_CELL_BRUSH_SELECTION])},r.prototype.getScrollBrushRangeCells=function(e){var n=this;return e.map(function(a){var o=n.getVisibleBrushRangeCells(a.id);return o||n.spreadsheet.facet.rowHeader.getCellInstance(a)})},r.prototype.getPrepareSelectMaskPosition=function(e){var n=this.spreadsheet.facet.panelBBox.minY,a=e.start.x,o=Math.max(e.start.y,n);return{x:a,y:o}},r}(BaseBrushSelection),DataCellMultiSelection=function(t){__extends(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.isMultiSelection=!1,e}return r.prototype.bindEvents=function(){this.bindKeyboardDown(),this.bindDataCellClick(),this.bindKeyboardUp(),this.bindMouseMove()},r.prototype.reset=function(){this.isMultiSelection=!1,this.spreadsheet.interaction.removeIntercepts([InterceptType.CLICK])},r.prototype.bindKeyboardDown=function(){var e=this;this.spreadsheet.on(S2Event.GLOBAL_KEYBOARD_DOWN,function(n){isMultiSelectionKey(n)&&(e.isMultiSelection=!0,e.spreadsheet.interaction.addIntercepts([InterceptType.CLICK]))})},r.prototype.bindKeyboardUp=function(){var e=this;this.spreadsheet.on(S2Event.GLOBAL_KEYBOARD_UP,function(n){isMultiSelectionKey(n)&&e.reset()})},r.prototype.bindMouseMove=function(){var e=this;this.spreadsheet.on(S2Event.GLOBAL_MOUSE_MOVE,function(n){e.isMultiSelection&&!isMouseEventWithMeta(n)&&e.reset()})},r.prototype.getSelectedCells=function(e){var n=e.getMeta().id,a=this.spreadsheet.interaction,o=a.getCells([CellType.DATA_CELL]),s=[];return a.getCurrentStateName()!==InteractionStateName.SELECTED&&(o=[]),o.find(function(l){return l.id===n})?s=o.filter(function(l){return l.id!==n}):s=__spreadArray(__spreadArray([],__read(o),!1),[getCellMeta(e)],!1),s},r.prototype.bindDataCellClick=function(){var e=this;this.spreadsheet.on(S2Event.DATA_CELL_CLICK,function(n){n.stopPropagation();var a=e.spreadsheet.getCell(n.target),o=a.getMeta(),s=e.spreadsheet.interaction;if(e.isMultiSelection&&o){var l=e.getSelectedCells(a);if(isEmpty(l)){s.clearState(),e.spreadsheet.hideTooltip(),e.spreadsheet.emit(S2Event.GLOBAL_SELECTED,s.getActiveCells());return}s.addIntercepts([InterceptType.CLICK,InterceptType.HOVER]),e.spreadsheet.hideTooltip(),s.changeState({cells:l,stateName:InteractionStateName.SELECTED,onUpdateCells:afterSelectDataCells}),e.spreadsheet.emit(S2Event.GLOBAL_SELECTED,s.getActiveCells()),e.spreadsheet.showTooltipWithInfo(n,getCellsTooltipData(e.spreadsheet))}})},r}(BaseEvent),EventController=function(){function t(r){var e=this;this.canvasEventHandlers=[],this.s2EventHandlers=[],this.domEventListeners=[],this.isCanvasEffect=!1,this.isGuiIconShape=function(n){return n instanceof CustomImage&&n.imgType===GuiIcon.type},this.isConditionIconShape=function(n,a){return a.getConditionIconShapes().some(function(o){var s;return(o==null?void 0:o.name)===((s=n==null?void 0:n.attributes)===null||s===void 0?void 0:s.name)})},this.onCanvasMousedown=function(n){if(e.target=n.target,e.spreadsheet.interaction.clearHoverTimer(),e.isResizeArea(n)){e.spreadsheet.emit(S2Event.LAYOUT_RESIZE_MOUSE_DOWN,n);var a=function(s){if(!e.spreadsheet.getCanvasElement())return!1;e.spreadsheet.getCanvasElement()!==s.target&&e.spreadsheet.emit(S2Event.LAYOUT_RESIZE_MOUSE_MOVE,s)};window.addEventListener(OriginEventType.POINTER_MOVE,a),window.addEventListener(OriginEventType.POINTER_UP,function(){window.removeEventListener(OriginEventType.POINTER_MOVE,a)},{once:!0});return}var o=e.spreadsheet.getCellType(n.target);switch(o){case CellType.DATA_CELL:e.spreadsheet.emit(S2Event.DATA_CELL_MOUSE_DOWN,n);break;case CellType.ROW_CELL:e.spreadsheet.emit(S2Event.ROW_CELL_MOUSE_DOWN,n);break;case CellType.COL_CELL:e.spreadsheet.emit(S2Event.COL_CELL_MOUSE_DOWN,n);break;case CellType.CORNER_CELL:e.spreadsheet.emit(S2Event.CORNER_CELL_MOUSE_DOWN,n);break;case CellType.MERGED_CELL:e.spreadsheet.emit(S2Event.MERGED_CELLS_MOUSE_DOWN,n);break}},this.onCanvasMousemove=function(n){if(e.canvasMousemoveEvent=n,e.isResizeArea(n)){e.activeResizeArea(n),e.spreadsheet.emit(S2Event.LAYOUT_RESIZE_MOUSE_MOVE,n.nativeEvent);return}e.resetResizeArea();var a=e.spreadsheet.getCell(n.target);if(a){var o=a.cellType;switch(o){case CellType.DATA_CELL:e.spreadsheet.emit(S2Event.DATA_CELL_MOUSE_MOVE,n);break;case CellType.ROW_CELL:e.spreadsheet.emit(S2Event.ROW_CELL_MOUSE_MOVE,n);break;case CellType.COL_CELL:e.spreadsheet.emit(S2Event.COL_CELL_MOUSE_MOVE,n);break;case CellType.CORNER_CELL:e.spreadsheet.emit(S2Event.CORNER_CELL_MOUSE_MOVE,n);break;case CellType.MERGED_CELL:e.spreadsheet.emit(S2Event.MERGED_CELLS_MOUSE_MOVE,n);break}if(!e.hasBrushSelectionIntercepts())switch(e.spreadsheet.emit(S2Event.GLOBAL_HOVER,n),o){case CellType.DATA_CELL:e.spreadsheet.emit(S2Event.DATA_CELL_HOVER,n);break;case CellType.ROW_CELL:e.spreadsheet.emit(S2Event.ROW_CELL_HOVER,n);break;case CellType.COL_CELL:e.spreadsheet.emit(S2Event.COL_CELL_HOVER,n);break;case CellType.CORNER_CELL:e.spreadsheet.emit(S2Event.CORNER_CELL_HOVER,n);break;case CellType.MERGED_CELL:e.spreadsheet.emit(S2Event.MERGED_CELLS_HOVER,n);break}}},this.onCanvasMouseup=function(n){if(e.isResizeArea(n)){e.spreadsheet.emit(S2Event.LAYOUT_RESIZE_MOUSE_UP,n);return}var a=e.spreadsheet.getCell(n.target);if(a){var o=a.cellType;if(e.target===n.target){if(e.isGuiIconShape(n.target)&&!e.isConditionIconShape(n.target,a))return;switch(o){case CellType.DATA_CELL:e.spreadsheet.emit(S2Event.DATA_CELL_CLICK,n);break;case CellType.ROW_CELL:e.spreadsheet.emit(S2Event.ROW_CELL_CLICK,n);break;case CellType.COL_CELL:e.spreadsheet.emit(S2Event.COL_CELL_CLICK,n);break;case CellType.CORNER_CELL:e.spreadsheet.emit(S2Event.CORNER_CELL_CLICK,n);break;case CellType.MERGED_CELL:e.spreadsheet.emit(S2Event.MERGED_CELLS_CLICK,n);break}}switch(o){case CellType.DATA_CELL:e.spreadsheet.emit(S2Event.DATA_CELL_MOUSE_UP,n);break;case CellType.ROW_CELL:e.spreadsheet.emit(S2Event.ROW_CELL_MOUSE_UP,n);break;case CellType.COL_CELL:e.spreadsheet.emit(S2Event.COL_CELL_MOUSE_UP,n);break;case CellType.CORNER_CELL:e.spreadsheet.emit(S2Event.CORNER_CELL_MOUSE_UP,n);break;case CellType.MERGED_CELL:e.spreadsheet.emit(S2Event.MERGED_CELLS_MOUSE_UP,n);break}}},this.onCanvasClick=function(n){e.spreadsheet.emit(S2Event.GLOBAL_CLICK,n),isMobile()&&e.onCanvasMouseup(n),n.detail===2&&e.onCanvasDoubleClick(n)},this.onCanvasDoubleClick=function(n){var a=e.spreadsheet;if(e.isResizeArea(n)){a.emit(S2Event.LAYOUT_RESIZE_MOUSE_UP,n);return}a.emit(S2Event.GLOBAL_DOUBLE_CLICK,n);var o=a.getCell(n.target);if(o){var s=o.cellType;if(e.target===n.target)switch(s){case CellType.DATA_CELL:a.emit(S2Event.DATA_CELL_DOUBLE_CLICK,n);break;case CellType.ROW_CELL:a.emit(S2Event.ROW_CELL_DOUBLE_CLICK,n);break;case CellType.COL_CELL:a.emit(S2Event.COL_CELL_DOUBLE_CLICK,n);break;case CellType.CORNER_CELL:a.emit(S2Event.CORNER_CELL_DOUBLE_CLICK,n);break;case CellType.MERGED_CELL:a.emit(S2Event.MERGED_CELLS_DOUBLE_CLICK,n);break}}},this.onCanvasMouseout=function(n){if(!(!e.isAutoResetSheetStyle||e.isMouseOnTheCanvasContainer(n))){var a=e.spreadsheet.interaction;!a.isSelectedState()&&!(a.intercepts.size>0)&&a.reset()}},this.onCanvasContextMenu=function(n){var a=e.spreadsheet;if(e.isResizeArea(n)){a.emit(S2Event.LAYOUT_RESIZE_MOUSE_UP,n);return}a.emit(S2Event.GLOBAL_CONTEXT_MENU,n);var o=e.spreadsheet.getCellType(n.target);switch(o){case CellType.DATA_CELL:e.spreadsheet.emit(S2Event.DATA_CELL_CONTEXT_MENU,n);break;case CellType.ROW_CELL:e.spreadsheet.emit(S2Event.ROW_CELL_CONTEXT_MENU,n);break;case CellType.COL_CELL:e.spreadsheet.emit(S2Event.COL_CELL_CONTEXT_MENU,n);break;case CellType.CORNER_CELL:e.spreadsheet.emit(S2Event.CORNER_CELL_CONTEXT_MENU,n);break;case CellType.MERGED_CELL:e.spreadsheet.emit(S2Event.MERGED_CELLS_CONTEXT_MENU,n);break}},this.spreadsheet=r,this.bindEvents()}return Object.defineProperty(t.prototype,"canvasContainer",{get:function(){return this.spreadsheet.container},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAutoResetSheetStyle",{get:function(){var r;return(r=this.spreadsheet.options.interaction)===null||r===void 0?void 0:r.autoResetSheetStyle},enumerable:!1,configurable:!0}),t.prototype.bindEvents=function(){var r=this;this.clearAllEvents(),this.addCanvasEvent(OriginEventType.CLICK,this.onCanvasClick),this.addCanvasEvent(OriginEventType.MOUSE_DOWN,this.onCanvasMousedown),this.addCanvasEvent(OriginEventType.TOUCH_START,function(e){r.target=e.target}),this.addCanvasEvent(OriginEventType.POINTER_MOVE,this.onCanvasMousemove),this.addCanvasEvent(OriginEventType.MOUSE_OUT,this.onCanvasMouseout),this.addCanvasEvent(OriginEventType.POINTER_UP,this.onCanvasMouseup),this.addCanvasEvent(GEventType.RIGHT_MOUSE_UP,this.onCanvasContextMenu),this.addS2Event(S2Event.GLOBAL_ACTION_ICON_CLICK,function(){r.spreadsheet.interaction.addIntercepts([InterceptType.HOVER]),r.spreadsheet.interaction.clearState()}),this.addDomEventListener(window,OriginEventType.CLICK,function(e){r.resetSheetStyle(e),r.isCanvasEffect=r.isMouseOnTheCanvasContainer(e)}),this.addDomEventListener(window,OriginEventType.KEY_DOWN,function(e){r.onKeyboardCopy(e),r.onKeyboardEsc(e),r.spreadsheet.emit(S2Event.GLOBAL_KEYBOARD_DOWN,e)}),this.addDomEventListener(window,OriginEventType.KEY_UP,function(e){r.spreadsheet.emit(S2Event.GLOBAL_KEYBOARD_UP,e)}),this.addDomEventListener(window,OriginEventType.POINTER_UP,function(e){r.spreadsheet.emit(S2Event.GLOBAL_MOUSE_UP,e)}),this.addDomEventListener(window,OriginEventType.POINTER_MOVE,function(e){r.spreadsheet.emit(S2Event.GLOBAL_MOUSE_MOVE,e)})},t.prototype.onKeyboardCopy=function(r){var e=this.spreadsheet.options.interaction.copy;if(this.isCanvasEffect&&(e!=null&&e.enable)&&keyEqualTo(r.key,InteractionKeyboardKey.COPY)&&(r.metaKey||r.ctrlKey)){var n=getSelectedData(this.spreadsheet);isNil(n)||this.spreadsheet.emit(S2Event.GLOBAL_COPIED,n)}},t.prototype.onKeyboardEsc=function(r){this.isCanvasEffect&&keyEqualTo(r.key,InteractionKeyboardKey.ESC)&&this.resetSheetStyle(r)},t.prototype.resetSheetStyle=function(r){var e,n;if(!(!this.isAutoResetSheetStyle||!this.spreadsheet)){var a=this.spreadsheet.interaction;if(!((e=a==null?void 0:a.hasIntercepts)===null||e===void 0)&&e.call(a,[InterceptType.DATA_CELL_BRUSH_SELECTION,InterceptType.COL_CELL_BRUSH_SELECTION,InterceptType.ROW_CELL_BRUSH_SELECTION])){(n=a==null?void 0:a.removeIntercepts)===null||n===void 0||n.call(a,[InterceptType.DATA_CELL_BRUSH_SELECTION,InterceptType.ROW_CELL_BRUSH_SELECTION,InterceptType.COL_CELL_BRUSH_SELECTION]);return}this.isMouseOnTheTooltip(r)||this.isMouseOnTheCanvasContainer(r)||(a.reset(),this.spreadsheet.emit(S2Event.GLOBAL_RESET,r),this.spreadsheet.emit(S2Event.GLOBAL_SELECTED,a.getActiveCells()))}},t.prototype.isMouseEvent=function(r){return hasIn(r,"clientX")&&hasIn(r,"clientY")},t.prototype.isMatchElement=function(r){var e=this.spreadsheet.getCanvasElement(),n=r.target;return n===e||n instanceof DisplayObject||n instanceof Canvas},t.prototype.isMatchPoint=function(r){var e=this.spreadsheet.getCanvasElement(),n=this.getContainerRect(),a=n.width,o=n.height,s=e.getBoundingClientRect()||{},l=s.x,u=s.y,c=r.clientX,d=r.clientY;return c<=l+a&&c>=l&&d<=u+o&&d>=u},t.prototype.isMouseOnTheCanvasContainer=function(r){if(this.isMouseEvent(r)){var e=this.spreadsheet.getCanvasElement();return e?this.isMatchElement(r)&&this.isMatchPoint(r):!1}return!1},t.prototype.getContainerRect=function(){var r,e=this.spreadsheet,n=e.facet,a=e.options,o=(n==null?void 0:n.hRowScrollBar)||(n==null?void 0:n.hScrollBar),s=(n==null?void 0:n.panelBBox)||{},l=s.maxX,u=s.maxY,c=a.width,d=c===void 0?0:c,f=a.height,h=f===void 0?0:f,p=((r=o==null?void 0:o.theme)===null||r===void 0?void 0:r.size)||0;return{width:Math.min(d,l),height:Math.min(h,u+p)}},t.prototype.isMouseOnTheTooltip=function(r){var e,n,a,o,s=this.spreadsheet.tooltip;if(!(s!=null&&s.visible))return!1;var l=((a=(n=(e=this.spreadsheet.tooltip)===null||e===void 0?void 0:e.container)===null||n===void 0?void 0:n.getBoundingClientRect)===null||a===void 0?void 0:a.call(n))||{},u=l.x,c=l.y,d=l.width,f=l.height;return r.target instanceof Node?verifyTheElementInTooltip((o=this.spreadsheet.tooltip)===null||o===void 0?void 0:o.container,r.target):this.isMouseEvent(r)?r.clientX>=u&&r.clientX<=u+d&&r.clientY>=c&&r.clientY<=c+f:!1},t.prototype.isResizeArea=function(r){var e=getAppendInfo(r.target);return e==null?void 0:e.isResizeArea},t.prototype.activeResizeArea=function(r){var e,n,a,o=get(r.target,"attrs.appendInfo");if(!(o!=null&&o.isResizeMask)){this.resetResizeArea();var s=r.target;this.spreadsheet.store.set("activeResizeArea",s),s.attr(SHAPE_STYLE_MAP.backgroundOpacity,(a=(n=(e=this.spreadsheet.theme.resizeArea)===null||e===void 0?void 0:e.interactionState)===null||n===void 0?void 0:n.hover)===null||a===void 0?void 0:a.backgroundOpacity)}},t.prototype.resetResizeArea=function(){var r,e=this.spreadsheet.store.get("activeResizeArea");isEmpty(e)||e.attr(SHAPE_STYLE_MAP.backgroundOpacity,(r=this.spreadsheet.theme.resizeArea)===null||r===void 0?void 0:r.backgroundOpacity),this.spreadsheet.store.set("activeResizeArea",e)},t.prototype.hasBrushSelectionIntercepts=function(){return this.spreadsheet.interaction.hasIntercepts([InterceptType.HOVER,InterceptType.DATA_CELL_BRUSH_SELECTION,InterceptType.ROW_CELL_BRUSH_SELECTION,InterceptType.COL_CELL_BRUSH_SELECTION])},t.prototype.clear=function(){this.unbindEvents()},t.prototype.unbindEvents=function(){this.clearAllEvents()},t.prototype.addCanvasEvent=function(r,e){var n;(n=this.canvasContainer)===null||n===void 0||n.on(r,e),this.canvasEventHandlers.push({type:r,handler:e})},t.prototype.addS2Event=function(r,e){this.spreadsheet.on(r,e),this.s2EventHandlers.push({type:r,handler:e})},t.prototype.addDomEventListener=function(r,e,n){if(r.addEventListener){var a=this.spreadsheet.options.interaction.eventListenerOptions;r.addEventListener(e,n,a),this.domEventListeners.push({target:r,type:e,handler:n,options:a})}else console.error("Please make sure ".concat(r," has addEventListener function"))},t.prototype.clearAllEvents=function(){var r=this;forEach(this.canvasEventHandlers,function(e){var n,a=e.type,o=e.handler;(n=r.canvasContainer)===null||n===void 0||n.removeEventListener(a,o)}),forEach(this.s2EventHandlers,function(e){var n=e.type,a=e.handler;r.spreadsheet.off(n,a)}),forEach(this.domEventListeners,function(e){e.target.removeEventListener(e.type,e.handler,e.options)}),this.canvasEventHandlers=[],this.s2EventHandlers=[],this.domEventListeners=[]},t.prototype.getViewportPoint=function(r){var e=this.spreadsheet.getCanvasConfig();return e.supportsCSSTransform&&!isNil(r.offsetX)&&!isNil(r.offsetY)?{x:r.offsetX,y:r.offsetY}:this.spreadsheet.container.client2Viewport({x:r.clientX,y:r.clientY})},t}(),RangeSelection=function(t){__extends(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.isRangeSelection=!1,e.handleColClick=function(n){n.stopPropagation();var a=e.spreadsheet,o=a.interaction,s=a.facet,l=e.spreadsheet.getCell(n.target),u=l==null?void 0:l.getMeta();if(!isNil(u==null?void 0:u.x)){o.addIntercepts([InterceptType.HOVER]);var c=[getCellMeta(l)],d=e.spreadsheet.store.get("lastClickedCell");if(e.isRangeSelection&&d&&d.cellType===l.cellType&&d.getMeta().level===u.level){var f=s.getLayoutResult(),h=f.rowsHierarchy,p=f.colsHierarchy,v=__read([h.maxLevel,p.maxLevel],2),g=v[0],y=v[1],m=getRangeIndex(d.getMeta(),u),S=m.start,w=m.end;l instanceof DataCell?c=e.handleSeriesNumberRowSelected(S.rowIndex,w.rowIndex,l):(l==null?void 0:l.cellType)===CellType.ROW_CELL&&u.level===g?c=e.handleRowSelected(S.rowIndex,w.rowIndex,l):(l==null?void 0:l.cellType)===CellType.COL_CELL&&u.level===y&&(c=e.handleColSelected(S.colIndex,w.colIndex,l)),o.changeState({cells:c,stateName:InteractionStateName.SELECTED})}else isEmpty(o.getCells())&&o.removeIntercepts([InterceptType.HOVER]),e.spreadsheet.store.set("lastClickedCell",l);var R=c.map(function(T){var x=T.id;return x});o.updateCells(s.getHeaderCells(R)),e.spreadsheet.emit(S2Event.GLOBAL_SELECTED,o.getActiveCells())}},e}return r.prototype.bindEvents=function(){this.bindKeyboardDown(),this.bindDataCellClick(),this.bindColCellClick(),this.bindKeyboardUp(),this.bindMouseMove()},r.prototype.reset=function(){this.isRangeSelection=!1,this.spreadsheet.interaction.removeIntercepts([InterceptType.CLICK])},r.prototype.bindKeyboardDown=function(){var e=this;this.spreadsheet.on(S2Event.GLOBAL_KEYBOARD_DOWN,function(n){n.key===InteractionKeyboardKey.SHIFT&&(e.isRangeSelection=!0,e.spreadsheet.interaction.addIntercepts([InterceptType.CLICK]))})},r.prototype.bindKeyboardUp=function(){var e=this;this.spreadsheet.on(S2Event.GLOBAL_KEYBOARD_UP,function(n){n.key===InteractionKeyboardKey.SHIFT&&e.reset()})},r.prototype.bindMouseMove=function(){var e=this;this.spreadsheet.on(S2Event.GLOBAL_MOUSE_MOVE,function(n){e.isRangeSelection&&!n.shiftKey&&e.reset()})},r.prototype.bindColCellClick=function(){var e=this;this.spreadsheet.isTableMode()&&this.spreadsheet.on(S2Event.ROW_CELL_CLICK,function(n){e.handleColClick(n)}),this.spreadsheet.on(S2Event.COL_CELL_CLICK,function(n){e.handleColClick(n)})},r.prototype.bindDataCellClick=function(){var e=this;this.spreadsheet.on(S2Event.DATA_CELL_CLICK,function(n){n.stopPropagation();var a=e.spreadsheet.getCell(n.target),o=a.getMeta(),s=e.spreadsheet.interaction;if(o){var l=e.spreadsheet.store.get("lastClickedCell"),u=e.isRangeSelection&&(l==null?void 0:l.cellType)===a.cellType;if(!u){e.spreadsheet.store.set("lastClickedCell",a);return}var c=getRangeIndex(l.getMeta(),a.getMeta()),d=c.start,f=c.end,h=range(d.colIndex,f.colIndex+1).flatMap(function(p){var v=e.spreadsheet.facet.getColLeafNodes()[p].id;return range(d.rowIndex,f.rowIndex+1).map(function(g){var y=e.spreadsheet.facet.getSeriesNumberWidth()||e.spreadsheet.isTableMode()?String(g):e.spreadsheet.facet.getRowLeafNodes()[g].id;return{id:"".concat(y,"-").concat(v),colIndex:p,rowIndex:g,type:a.cellType}})});s.addIntercepts([InterceptType.CLICK,InterceptType.HOVER]),s.changeState({cells:h,stateName:InteractionStateName.SELECTED}),e.spreadsheet.showTooltipWithInfo(n,getCellsTooltipData(e.spreadsheet)),e.spreadsheet.emit(S2Event.GLOBAL_SELECTED,s.getActiveCells())}})},r.prototype.handleSeriesNumberRowSelected=function(e,n,a){var o=this.spreadsheet.facet.getColLeafNodes()[0].id;return range(e,n+1).map(function(s){var l=String(s);return{id:"".concat(l,"-").concat(o),colIndex:0,rowIndex:s,type:a.cellType}})},r.prototype.handleRowSelected=function(e,n,a){return this.spreadsheet.facet.getRowNodes().filter(function(o){var s=o.rowIndex;return inRange(s,e,n+1)}).map(function(o){return{id:o.id,colIndex:o.colIndex,rowIndex:o.rowIndex,type:a.cellType}})},r.prototype.handleColSelected=function(e,n,a){return this.spreadsheet.facet.getColLeafNodes().filter(function(o){var s=o.colIndex;return inRange(s,e,n+1)}).map(function(o){return{id:o.id,colIndex:o.colIndex,rowIndex:o.rowIndex,type:a.cellType}})},r}(BaseEvent),RowColumnResize=function(t){__extends(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.resizeStartPosition={},e}return r.prototype.bindEvents=function(){this.bindMouseDown(),this.bindMouseMove(),this.bindMouseUp()},r.prototype.initResizeGroup=function(){if(!this.resizeReferenceGroup){this.resizeReferenceGroup=this.spreadsheet.facet.foregroundGroup.appendChild(new Group);var e=this.spreadsheet.options,n=e.width,a=e.height,o=this.getResizeAreaTheme(),s=o.guideLineColor,l=o.guideLineDash,u=o.size,c={path:"",lineDash:l,stroke:s,lineWidth:u};this.resizeReferenceGroup.appendChild(new Path({id:RESIZE_START_GUIDE_LINE_ID,style:c})),this.resizeReferenceGroup.appendChild(new Path({id:RESIZE_END_GUIDE_LINE_ID,style:c})),this.resizeReferenceGroup.appendChild(new CustomRect({id:RESIZE_MASK_ID,style:{x:0,y:0,width:n,height:a,fill:"transparent"}},{isResizeArea:!0,isResizeMask:!0}))}},r.prototype.getResizeAreaTheme=function(){return this.spreadsheet.theme.resizeArea},r.prototype.setResizeTarget=function(e){this.resizeTarget=e},r.prototype.getGuideLineWidthAndHeight=function(){var e=this.spreadsheet.options,n=e.width,a=e.height,o=this.spreadsheet.facet.panelBBox,s=o.maxY,l=o.maxX,u=Math.min(l,n),c=Math.min(s,a);return{width:u,height:c}},r.prototype.getResizeShapes=function(){var e;return((e=this.resizeReferenceGroup)===null||e===void 0?void 0:e.children)||[]},r.prototype.setResizeMaskCursor=function(e){var n=__read(this.getResizeShapes(),3),a=n[2];a==null||a.attr("cursor",e)},r.prototype.updateResizeGuideLinePosition=function(e,n){var a=this.getResizeShapes();if(!isEmpty(a)){var o=__read(a,2),s=o[0],l=o[1],u=n.type,c=n.offsetX,d=n.offsetY,f=n.width,h=n.height,p=n.size,v=this.getGuideLineWidthAndHeight(),g=v.width,y=v.height;this.cursorType="".concat(u,"-resize"),this.setResizeMaskCursor(this.cursorType);var m=p/2;if(u===ResizeDirectionType.Horizontal){s.attr("path",[["M",c+m,d],["L",c+m,y]]),l.attr("path",[["M",c+f-m,d],["L",c+f-m,y]]),this.resizeStartPosition.offsetX=e.offsetX,this.resizeStartPosition.clientX=e.clientX;return}s.attr("path",[["M",c,d+m],["L",g,d+m]]),l.attr("path",[["M",c,d+h-m],["L",g,d+h-m]]),this.resizeStartPosition.offsetY=e.offsetY,this.resizeStartPosition.clientY=e.clientY}},r.prototype.bindMouseDown=function(){var e=this;this.spreadsheet.on(S2Event.LAYOUT_RESIZE_MOUSE_DOWN,function(n){var a=n.target,o=e.getCellAppendInfo(n.target);e.spreadsheet.store.set("resized",!1),o!=null&&o.isResizeArea&&(e.spreadsheet.hideTooltip(),e.spreadsheet.interaction.addIntercepts([InterceptType.RESIZE]),e.setResizeTarget(a),e.showResizeGroup(),e.updateResizeGuideLinePosition(n,o))})},r.prototype.bindMouseMove=function(){this.spreadsheet.on(S2Event.LAYOUT_RESIZE_MOUSE_MOVE,throttle(this.resizeMouseMove.bind(this),33))},r.prototype.getResizeGuideLinePosition=function(){var e,n=__read(((e=this.resizeReferenceGroup)===null||e===void 0?void 0:e.children)||[],2),a=n[0],o=n[1],s=(a==null?void 0:a.attr("path"))||[],l=(o==null?void 0:o.attr("path"))||[],u=__read(s[0]||[],3),c=u[1],d=c===void 0?0:c,f=u[2],h=f===void 0?0:f,p=__read(l[0]||[],3),v=p[1],g=v===void 0?0:v,y=p[2],m=y===void 0?0:y;return{start:{x:+d,y:+h},end:{x:+g,y:+m}}},r.prototype.getDisAllowResizeInfo=function(){var e,n=this.getResizeInfo(),a=this.spreadsheet.options.interaction.resize,o=n.width,s=n.height,l=n.resizedWidth,u=l===void 0?0:l,c=n.resizedHeight,d=c===void 0?0:c,f=(e=a==null?void 0:a.disable)===null||e===void 0?void 0:e.call(a,n),h=f?o:u,p=f?s:d;return{displayWidth:h,displayHeight:p,isDisabled:f}},r.prototype.getResizeCellField=function(e){var n,a,o,s,l,u=e.type===ResizeDirectionType.Vertical,c=u?!this.isEffectRowOf(ResizeType.ALL):!this.isEffectColOf(ResizeType.ALL);return this.spreadsheet.isTableMode()?u?((n=e==null?void 0:e.meta)===null||n===void 0?void 0:n.rowId)||String((a=e==null?void 0:e.meta)===null||a===void 0?void 0:a.rowIndex):(o=e==null?void 0:e.meta)===null||o===void 0?void 0:o.field:c?(s=e==null?void 0:e.meta)===null||s===void 0?void 0:s.id:(l=e==null?void 0:e.meta)===null||l===void 0?void 0:l.field},r.prototype.isEffectRowOf=function(e){var n,a;return((a=(n=this.spreadsheet.options.interaction)===null||n===void 0?void 0:n.resize)===null||a===void 0?void 0:a.rowResizeType)===e},r.prototype.isEffectColOf=function(e){var n,a;return((a=(n=this.spreadsheet.options.interaction)===null||n===void 0?void 0:n.resize)===null||a===void 0?void 0:a.colResizeType)===e},r.prototype.getCellStyleByField=function(e){var n,a=this,o=this.spreadsheet.interaction,s=this.getResizeInfo(),l=s.type===ResizeDirectionType.Vertical,u=l?o.getActiveRowCells():o.getActiveColCells(),c=o.isSelectedState()&&u.length>1;return!this.isEffectRowOf(ResizeType.SELECTED)||!this.isEffectColOf(ResizeType.SELECTED)||!c?(n={},n[this.getResizeCellField(s)]=e,n):u.reduce(function(d,f){return Node$1.getAllLeaveNodes(f.getMeta()).forEach(function(h){var p=__assign(__assign({},s),{meta:h});d[a.getResizeCellField(p)]=e}),d},{})},r.prototype.getResizeWidthDetail=function(){var e,n=this.getResizeInfo(),a=this.getDisAllowResizeInfo().displayWidth;switch(n.effect){case ResizeAreaEffect.Field:return{eventType:S2Event.LAYOUT_RESIZE_ROW_WIDTH,style:{rowCell:{widthByField:(e={},e[n.meta.field]=a,e)}}};case ResizeAreaEffect.Tree:return{eventType:S2Event.LAYOUT_RESIZE_TREE_WIDTH,style:{rowCell:{width:a}}};case ResizeAreaEffect.Cell:return{eventType:S2Event.LAYOUT_RESIZE_COL_WIDTH,style:{colCell:{width:this.isEffectColOf(ResizeType.ALL)?a:null,widthByField:this.getCellStyleByField(a)}}};case ResizeAreaEffect.Series:return{eventType:S2Event.LAYOUT_RESIZE_SERIES_WIDTH,seriesNumberWidth:a};default:return null}},r.prototype.getResizeHeightDetail=function(){var e=this.getResizeInfo(),n=this.getDisAllowResizeInfo().displayHeight;switch(e.effect){case ResizeAreaEffect.Field:return{eventType:S2Event.LAYOUT_RESIZE_COL_HEIGHT,style:{colCell:{heightByField:this.getHeightByField(e,n)}}};case ResizeAreaEffect.Cell:return{eventType:S2Event.LAYOUT_RESIZE_ROW_HEIGHT,style:{rowCell:{height:this.isEffectRowOf(ResizeType.ALL)?n:null,heightByField:this.getCellStyleByField(n)}}};default:return null}},r.prototype.getHeightByField=function(e,n){var a;return this.spreadsheet.isCustomColumnFields()||this.spreadsheet.isTableMode()?this.spreadsheet.facet.getColNodes().filter(function(o){var s,l;return o.level===((s=e.meta)===null||s===void 0?void 0:s.level)&&o.height===((l=e.meta)===null||l===void 0?void 0:l.height)}).reduce(function(o,s){return o[s.field]=n,o},{}):(a={},a[e.meta.field]=n,a)},r.prototype.getResizeDetail=function(){var e=this.getResizeInfo();return e.type===ResizeDirectionType.Horizontal?this.getResizeWidthDetail():this.getResizeHeightDetail()},r.prototype.showResizeGroup=function(){var e;this.initResizeGroup(),(e=this.resizeReferenceGroup)===null||e===void 0||e.setAttribute("visibility","visible")},r.prototype.hideResizeGroup=function(){var e;(e=this.resizeReferenceGroup)===null||e===void 0||e.setAttribute("visibility","hidden")},r.prototype.bindMouseUp=function(){var e=this;this.spreadsheet.on(S2Event.GLOBAL_MOUSE_UP,function(){var n;e.cursorType="default",e.setResizeMaskCursor(e.cursorType),!(!e.resizeReferenceGroup||isEmpty((n=e.resizeReferenceGroup)===null||n===void 0?void 0:n.children))&&(e.hideResizeGroup(),e.renderResizedResult())})},r.prototype.resizeMouseMove=function(e){var n,a;if(((n=this.resizeReferenceGroup)===null||n===void 0?void 0:n.parsedStyle.visibility)==="visible"){var o=this.getResizeInfo(),s=((a=this.resizeReferenceGroup)===null||a===void 0?void 0:a.children)||[];if(!isEmpty(s)){var l=__read(s,2),u=l[1],c=__read(clone$1(u.attr("path")),2),d=c[0],f=c[1];o.type===ResizeDirectionType.Horizontal?this.updateHorizontalResizingEndGuideLinePosition(e.offsetX,o,{start:d,end:f}):this.updateVerticalResizingEndGuideLinePosition(e.offsetY,o,{start:d,end:f}),this.updateResizeGuideLineTheme(u),u.attr("path",[d,f])}}},r.prototype.updateResizeGuideLineTheme=function(e){var n=this.getResizeAreaTheme(),a=n.guideLineColor,o=n.guideLineDisableColor,s=this.getDisAllowResizeInfo().isDisabled;e.attr("stroke",s?o:a),this.setResizeMaskCursor(s?"no-drop":this.cursorType)},r.prototype.updateHorizontalResizingEndGuideLinePosition=function(e,n,a){var o,s,l=(((o=this.spreadsheet.options.interaction)===null||o===void 0?void 0:o.resize)||{}).minCellWidth,u=l===void 0?RESIZE_MIN_CELL_WIDTH:l,c=e-this.resizeStartPosition.offsetX;n.width+c<u&&(c=-(n.width-u));var d=n.offsetX+n.width+c,f=n.size/2;a.start[1]=d-f,a.end[1]=d-f,(s=this.resizeTarget)===null||s===void 0||s.attr({x:d-n.size})},r.prototype.updateVerticalResizingEndGuideLinePosition=function(e,n,a){var o,s,l=(((o=this.spreadsheet.options.interaction)===null||o===void 0?void 0:o.resize)||{}).minCellHeight,u=l===void 0?RESIZE_MIN_CELL_HEIGHT:l,c=e-this.resizeStartPosition.offsetY;n.height+c<u&&(c=-(n.height-u));var d=n.offsetY+n.height+c,f=n.size/2;a.start[2]=d-f,a.end[2]=d-f,(s=this.resizeTarget)===null||s===void 0||s.attr({y:d-n.size})},r.prototype.renderResizedResult=function(){var e=this.getResizeInfo(),n=this.getResizeDetail()||{},a=n.style,o=n.seriesNumberWidth,s=n.eventType,l={info:e,style:a};this.spreadsheet.emit(S2Event.LAYOUT_RESIZE,l),this.spreadsheet.emit(s,l),a&&this.spreadsheet.setOptions({style:a}),o&&this.spreadsheet.setTheme({rowCell:{seriesNumberWidth:o}}),this.spreadsheet.store.set("resized",!0),this.render()},r.prototype.getResizeInfo=function(){var e=this.getCellAppendInfo(this.resizeTarget),n=this.getResizeGuideLinePosition(),a=n.start,o=n.end,s=floor(o.x-a.x+(e.type===ResizeDirectionType.Horizontal?e.size:0)),l=floor(o.y-a.y+(e.type===ResizeDirectionType.Vertical?e.size:0));return __assign(__assign({},e),{resizedWidth:s,resizedHeight:l})},r.prototype.render=function(){this.resizeStartPosition={},this.resizeTarget=null,this.resizeReferenceGroup=null,this.spreadsheet.render(!1)},r}(BaseEvent),SelectedCellMoveMap=[InteractionKeyboardKey.ARROW_LEFT,InteractionKeyboardKey.ARROW_RIGHT,InteractionKeyboardKey.ARROW_UP,InteractionKeyboardKey.ARROW_DOWN],SelectedCellMove=function(t){__extends(r,t);function r(e){return t.call(this,e)||this}return r.prototype.isCanvasEffect=function(){return this.spreadsheet.interaction.eventController.isCanvasEffect},r.prototype.bindEvents=function(){var e=this;this.spreadsheet.on(S2Event.GLOBAL_KEYBOARD_DOWN,function(n){if(e.isCanvasEffect()){var a=n.shiftKey,o=n.metaKey,s=SelectedCellMoveMap.includes(n.key),l=!1,u=!1,c=!1;s&&(o&&a?(l=!1,u=!0,c=!1):o?(l=!0,u=!0,c=!0):a?(l=!1,u=!1,c=!1):(l=!0,u=!1,c=!0),e.handleMove({event:n,changeStartCell:l,isJumpMode:u,isSingleSelection:c}))}}),this.spreadsheet.on(S2Event.DATA_CELL_CLICK,function(n){var a=e.spreadsheet.getCell(n.target),o=a==null?void 0:a.getMeta();o&&(e.startCell=e.getCellMetaByViewMeta(o),e.endCell=e.startCell)})},r.prototype.getCellMetaByViewMeta=function(e){return{rowIndex:e.rowIndex,colIndex:e.colIndex,id:e.id,type:CellType.DATA_CELL}},r.prototype.handleMove=function(e){var n=e.event,a=e.changeStartCell,o=e.isJumpMode,s=e.isSingleSelection,l=this,u=l.spreadsheet,c=l.startCell,d=l.endCell,f=a?c:d,h=this.getMoveInfo(n.key,f,o);if(h){var p=__read([h.row,h.col],2),v=p[0],g=p[1];this.scrollToActiveCell(u,v,g);var y=this.generateCellMeta(u,v,g),m=s?[y]:this.getRangeCells(u,c,y);selectCells(u,m),a&&(this.startCell=y),this.endCell=y,this.spreadsheet.emit(S2Event.DATA_CELL_SELECT_MOVE,m)}},r.prototype.generateCellMeta=function(e,n,a){var o=e.isTableMode,s=e.facet,l=s.getRowLeafNodes(),u=s.getColLeafNodes(),c=o()?String(n):l[n].id,d=u[a].id;return{rowIndex:n,colIndex:a,id:getDataCellId(c,d),type:CellType.DATA_CELL}},r.prototype.getRangeCells=function(e,n,a){for(var o=getRangeIndex(n,a),s=o.start,l=s.rowIndex,u=s.colIndex,c=o.end,d=c.rowIndex,f=c.colIndex,h=[],p=l;p<=d;p++)for(var v=u;v<=f;v++)h.push(this.generateCellMeta(e,p,v));return h},r.prototype.getMoveInfo=function(e,n,a){var o=this.spreadsheet,s=o.options.frozen,l=s.rowCount,u=l===void 0?0:l,c=s.trailingRowCount,d=c===void 0?0:c,f=s.colCount,h=f===void 0?0:f,p=s.trailingColCount,v=p===void 0?0:p,g=o.facet.getRowLeafNodes(),y=o.facet.getColLeafNodes(),m=__read([0+h,y.length-v-1],2),S=m[0],w=m[1],R=__read([0+u,(o.isTableMode()?o.dataSet.getDisplayDataSet().length:g.length)-d-1],2),T=R[0],x=R[1];if(n)switch(e){case InteractionKeyboardKey.ARROW_RIGHT:return n.colIndex+1>w?void 0:{row:n.rowIndex,col:a?w:n.colIndex+1};case InteractionKeyboardKey.ARROW_LEFT:return n.colIndex-1<S?void 0:{row:n.rowIndex,col:a?S:n.colIndex-1};case InteractionKeyboardKey.ARROW_UP:return n.rowIndex-1<T?void 0:{row:a?T:n.rowIndex-1,col:n.colIndex};case InteractionKeyboardKey.ARROW_DOWN:return n.rowIndex+1>x?void 0:{row:a?x:n.rowIndex+1,col:n.colIndex}}},r.prototype.calculateOffset=function(e,n,a){var o=e.options.frozen,s=o.rowCount,l=s===void 0?0:s,u=o.trailingRowCount,c=u===void 0?0:u,d=e.facet,f=d.frozenColGroup,h=d.frozenTrailingColGroup,p=d.frozenRowGroup,v=d.frozenTrailingRowGroup,g=d.getColLeafNodes(),y=d.getScrollOffset(),m=y.scrollX,S=y.scrollY,w=d.panelBBox,R=w.viewportHeight,T=w.viewportWidth,x=get(e,"theme.splitLine"),b=f?floor(f.getBBox().width-x.verticalBorderWidth/2):0,L=h?floor(h.getBBox().width):0,M=p?floor(p.getBBox().height-x.horizontalBorderWidth/2):0,D=v?floor(v.getBBox().height):0,N=calculateInViewIndexes({scrollX:m,scrollY:S,widths:d.viewCellWidths,heights:d.viewCellHeights,viewport:{width:T-b-L,height:R-M-D,x:b,y:M},rowRemainWidth:d.getRealScrollX(d.cornerBBox.width)}),F=-1,k=-1,H=g.find(function(z){return z.colIndex===a});if(a<=N[0]?F=(H==null?void 0:H.x)-b:a>=N[1]&&a<g.length-c&&(F=(H==null?void 0:H.x)+(H==null?void 0:H.width)-T+L),n<=N[2])k=d.viewCellHeights.getCellOffsetY(n-l);else if(n>=N[3]){var G=d.viewCellHeights.getCellOffsetY(n+1);k=G+D-R}return{offsetX:F,offsetY:k}},r.prototype.scrollToActiveCell=function(e,n,a){var o=this.calculateOffset(e,n,a),s=o.offsetX,l=o.offsetY,u=e.facet,c=e.facet.getScrollOffset(),d=c.scrollX,f=c.scrollY;u.scrollWithAnimation({offsetX:{value:s>-1?s:d},offsetY:{value:l>-1?l:f}})},r}(BaseEvent),RootInteraction=function(){function t(r){var e=this;this.interactions=new Map,this.intercepts=new Set,this.hoverTimer=null,this.defaultState={cells:[],force:!1},this.onTriggerInteractionsResetEffect=function(){e.interactions.forEach(function(n){n.reset()})},this.selectAll=function(){e.changeState({stateName:InteractionStateName.ALL_SELECTED})},this.selectHeaderCell=function(n){var a;n===void 0&&(n={});var o=n.cell;if(!isEmpty(o)){var s=(a=o==null?void 0:o.getMeta)===null||a===void 0?void 0:a.call(o);if(!(!s||isNil(s==null?void 0:s.x))){e.addIntercepts([InterceptType.HOVER]);var l=e.spreadsheet.isHierarchyTreeType(),u=(o==null?void 0:o.cellType)===CellType.COL_CELL,c=e.getState(),d=e.isSelectedCell(o),f=(n==null?void 0:n.isMultiSelection)&&e.isSelectedState(),h=d?[]:e.spreadsheet.facet.getCellChildrenNodes(o),p=d?[]:[getCellMeta(o)];if(f&&(p=concat((c==null?void 0:c.cells)||[],p),h=concat((c==null?void 0:c.nodes)||[],h),d&&(p=p.filter(function(y){var m=y.id;return m!==s.id}),h=h.filter(function(y){return!(y!=null&&y.id.includes(s.id))}))),isEmpty(p)){e.reset(),e.spreadsheet.emit(S2Event.GLOBAL_SELECTED,e.getActiveCells());return}if(!(unionBy(p,"type").length>1)){var v=isEmpty(h)?[o.getMeta()]:h;e.changeState({cells:p,nodes:v,stateName:InteractionStateName.SELECTED});var g=p.map(function(y){var m=y.id;return m});return e.updateCells(e.spreadsheet.facet.getHeaderCells(g)),(!l||u)&&e.highlightNodes(h),e.spreadsheet.emit(S2Event.GLOBAL_SELECTED,e.getActiveCells()),!0}}}},this.highlightNodes=function(n){n===void 0&&(n=[]),n.forEach(function(a){var o;(o=a==null?void 0:a.belongsCell)===null||o===void 0||o.updateByState(InteractionStateName.SELECTED,a.belongsCell)})},this.mergeCells=function(n,a){mergeCell(e.spreadsheet,n,a)},this.unmergeCell=function(n){unmergeCell(e.spreadsheet,n)},this.spreadsheet=r,this.registerEventController(),this.registerInteractions(),window.addEventListener("visibilitychange",this.onTriggerInteractionsResetEffect)}return t.prototype.destroy=function(){this.interactions.clear(),this.intercepts.clear(),this.eventController.clear(),this.clearHoverTimer(),this.resetState(),window.removeEventListener("visibilitychange",this.onTriggerInteractionsResetEffect)},t.prototype.reset=function(){this.clearState(),this.clearHoverTimer(),this.intercepts.clear(),this.spreadsheet.hideTooltip()},t.prototype.setState=function(r){setState(this.spreadsheet,r)},t.prototype.getState=function(){return this.spreadsheet.store.get(INTERACTION_STATE_INFO_KEY)||this.defaultState},t.prototype.setInteractedCells=function(r){var e=this.getInteractedCells().concat([r]),n=this.getState();n.interactedCells=e,this.setState(n)},t.prototype.getInteractedCells=function(){var r=this.getState();return(r==null?void 0:r.interactedCells)||[]},t.prototype.resetState=function(){this.spreadsheet.store.set(INTERACTION_STATE_INFO_KEY,this.defaultState)},t.prototype.getCurrentStateName=function(){return this.getState().stateName},t.prototype.isEqualStateName=function(r){return this.getCurrentStateName()===r},t.prototype.isStateOf=function(r){var e=this.getState();return(e==null?void 0:e.stateName)===r},t.prototype.isSelectedState=function(){var r=this;return[InteractionStateName.SELECTED,InteractionStateName.ROW_CELL_BRUSH_SELECTED,InteractionStateName.COL_CELL_BRUSH_SELECTED,InteractionStateName.DATA_CELL_BRUSH_SELECTED].some(function(e){return r.isStateOf(e)})},t.prototype.isAllSelectedState=function(){return this.isStateOf(InteractionStateName.ALL_SELECTED)},t.prototype.isHoverFocusState=function(){return this.isStateOf(InteractionStateName.HOVER_FOCUS)},t.prototype.isHoverState=function(){return this.isStateOf(InteractionStateName.HOVER)},t.prototype.isActiveCell=function(r){return!!this.getCells().find(function(e){return r.getMeta().id===e.id})},t.prototype.isSelectedCell=function(r){return this.isSelectedState()&&this.isActiveCell(r)},t.prototype.getCells=function(r){var e=this.getState(),n=(e==null?void 0:e.cells)||[];return isNil(r)?n:n.filter(function(a){return r.includes(a.type)})},t.prototype.getActiveCells=function(){var r,e=this.getCells().map(function(a){return a.id}),n=(r=this.spreadsheet.facet)===null||r===void 0?void 0:r.getCells();return map(e,function(a){return find(n,function(o){var s;return((s=o==null?void 0:o.getMeta())===null||s===void 0?void 0:s.id)===a})}).filter(Boolean)},t.prototype.getActiveDataCells=function(){return this.getActiveCells().filter(function(r){return r.cellType===CellType.DATA_CELL})},t.prototype.getActiveRowCells=function(){return this.getActiveCells().filter(function(r){return r.cellType===CellType.ROW_CELL})},t.prototype.getActiveColCells=function(){return this.getActiveCells().filter(function(r){return r.cellType===CellType.COL_CELL})},t.prototype.clearStyleIndependent=function(){!this.isSelectedState()&&!this.isHoverState()&&!this.isAllSelectedState()||this.spreadsheet.facet.getDataCells().forEach(function(r){r.hideInteractionShape()})},t.prototype.getUnSelectedDataCells=function(){var r=this;return this.spreadsheet.facet.getDataCells().filter(function(e){return!r.isActiveCell(e)})},t.prototype.hideColumns=function(r,e){return r===void 0&&(r=[]),e===void 0&&(e=!0),__awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return[4,hideColumnsByThunkGroup(this.spreadsheet,r,e)];case 1:return n.sent(),[2]}})})},t.prototype.getBrushSelectionInfo=function(r){var e,n,a;return isBoolean(r)?{dataCellBrushSelection:r,rowCellBrushSelection:r,colCellBrushSelection:r}:{dataCellBrushSelection:(e=r==null?void 0:r.dataCell)!==null&&e!==void 0?e:!1,rowCellBrushSelection:(n=r==null?void 0:r.rowCell)!==null&&n!==void 0?n:!1,colCellBrushSelection:(a=r==null?void 0:r.colCell)!==null&&a!==void 0?a:!1}},t.prototype.getDefaultInteractions=function(){var r=this.spreadsheet.options.interaction,e=r.resize,n=r.brushSelection,a=r.multiSelection,o=r.rangeSelection,s=r.selectedCellMove,l=this.getBrushSelectionInfo(n),u=l.dataCellBrushSelection,c=l.rowCellBrushSelection,d=l.colCellBrushSelection;return[{key:InteractionName.CORNER_CELL_CLICK,interaction:CornerCellClick},{key:InteractionName.DATA_CELL_CLICK,interaction:DataCellClick},{key:InteractionName.ROW_COLUMN_CLICK,interaction:RowColumnClick},{key:InteractionName.ROW_TEXT_CLICK,interaction:RowTextClick},{key:InteractionName.MERGED_CELLS_CLICK,interaction:MergedCellClick},{key:InteractionName.HOVER,interaction:HoverEvent,enable:!isMobile()},{key:InteractionName.DATA_CELL_BRUSH_SELECTION,interaction:DataCellBrushSelection,enable:!isMobile()&&u},{key:InteractionName.ROW_CELL_BRUSH_SELECTION,interaction:RowCellBrushSelection,enable:!isMobile()&&c},{key:InteractionName.COL_CELL_BRUSH_SELECTION,interaction:ColCellBrushSelection,enable:!isMobile()&&d},{key:InteractionName.COL_ROW_RESIZE,interaction:RowColumnResize,enable:!isMobile()&&e},{key:InteractionName.DATA_CELL_MULTI_SELECTION,interaction:DataCellMultiSelection,enable:!isMobile()&&a},{key:InteractionName.RANGE_SELECTION,interaction:RangeSelection,enable:!isMobile()&&o},{key:InteractionName.SELECTED_CELL_MOVE,interaction:SelectedCellMove,enable:!isMobile()&&s}]},t.prototype.registerInteractions=function(){var r=this,e=this.spreadsheet.options.interaction.customInteractions;this.interactions.clear();var n=this.getDefaultInteractions();n.forEach(function(a){var o=a.key,s=a.interaction,l=a.enable;l!==!1&&r.interactions.set(o,new s(r.spreadsheet))}),isEmpty(e)||forEach(e,function(a){var o=a.interaction;r.interactions.set(a.key,new o(r.spreadsheet))})},t.prototype.registerEventController=function(){this.eventController=new EventController(this.spreadsheet)},t.prototype.draw=function(){this.spreadsheet.container.render()},t.prototype.clearState=function(){clearState(this.spreadsheet)&&this.draw()},t.prototype.changeState=function(r){var e=this,n=this.spreadsheet.interaction,a=r.cells,o=a===void 0?[]:a,s=r.force,l=r.stateName,u=r.onUpdateCells;if(isEmpty(o)&&l===InteractionStateName.SELECTED){s&&n.changeState({cells:[],stateName:InteractionStateName.UNSELECTED});return}this.getCurrentStateName()===InteractionStateName.ALL_SELECTED&&this.clearStyleIndependent(),this.clearState(),this.setState(r);var c=function(){e.updatePanelGroupAllDataCells()};u?u(this,c):c(),this.draw()},t.prototype.updatePanelGroupAllDataCells=function(){this.updateCells(this.spreadsheet.facet.getDataCells())},t.prototype.updateCells=function(r){r===void 0&&(r=[]),r.forEach(function(e){e.update()})},t.prototype.addIntercepts=function(r){var e=this;r===void 0&&(r=[]),r.forEach(function(n){e.intercepts.add(n)})},t.prototype.hasIntercepts=function(r){var e=this;return r===void 0&&(r=[]),r.some(function(n){return e.intercepts.has(n)})},t.prototype.removeIntercepts=function(r){var e=this;r===void 0&&(r=[]),r.forEach(function(n){e.intercepts.delete(n)})},t.prototype.clearHoverTimer=function(){clearTimeout(this.hoverTimer)},t.prototype.setHoverTimer=function(r){this.hoverTimer=r},t.prototype.getHoverTimer=function(){return this.hoverTimer},t.prototype.getSelectedCellHighlight=function(){var r,e=this.spreadsheet.options.interaction.selectedCellHighlight;if(isBoolean(e))return{rowHeader:e,colHeader:e,currentRow:e,currentCol:e};var n=(r=e)!==null&&r!==void 0?r:{},a=n.rowHeader,o=a===void 0?!1:a,s=n.colHeader,l=s===void 0?!1:s,u=n.currentRow,c=u===void 0?!1:u,d=n.currentCol,f=d===void 0?!1:d;return{rowHeader:o,colHeader:l,currentRow:c,currentCol:f}},t.prototype.getHoverAfterScroll=function(){return this.spreadsheet.options.interaction.hoverAfterScroll},t.prototype.getHoverHighlight=function(){var r=this.spreadsheet.options.interaction.hoverHighlight;if(isBoolean(r))return{rowHeader:r,colHeader:r,currentRow:r,currentCol:r};var e=r??{},n=e.rowHeader,a=n===void 0?!1:n,o=e.colHeader,s=o===void 0?!1:o,l=e.currentRow,u=l===void 0?!1:l,c=e.currentCol,d=c===void 0?!1:c;return{rowHeader:a,colHeader:s,currentRow:u,currentCol:d}},t.prototype.getBrushSelection=function(){var r=this.spreadsheet.options.interaction.brushSelection;if(isBoolean(r))return{dataCell:r,rowCell:r,colCell:r};var e=r??{},n=e.dataCell,a=n===void 0?!1:n,o=e.rowCell,s=o===void 0?!1:o,l=e.colCell,u=l===void 0?!1:l;return{dataCell:a,rowCell:s,colCell:u}},t.prototype.updateDataCellRelevantHeaderCells=function(r,e){this.updateDataCellRelevantColCells(r,e),this.updateDataCellRelevantRowCells(r,e)},t.prototype.updateDataCellRelevantRowCells=function(r,e){var n=e.rowId,a=this.spreadsheet,o=a.facet,s=a.interaction,l=r===InteractionStateName.HOVER,u=(l?s.getHoverHighlight():s.getSelectedCellHighlight()).rowHeader;if(u&&n){var c=l?getActiveHoverHeaderCells(n,o.getRowCells(),this.spreadsheet.isHierarchyTreeType()):getRowCellForSelectedCell(e,this.spreadsheet),d=o.getSeriesNumberCells().filter(function(h){return c.find(function(p){return p.getMeta().y===h.getMeta().y})}),f=__spreadArray(__spreadArray([],__read(d),!1),__read(c),!1);forEach(f,function(h){h.updateByState(r)})}},t.prototype.updateDataCellRelevantColCells=function(r,e){var n=e.colId,a=this.spreadsheet,o=a.facet,s=a.interaction,l=(r===InteractionStateName.HOVER?s.getHoverHighlight():s.getSelectedCellHighlight()).colHeader;l&&n&&updateAllColHeaderCellState(n,o.getColCells(),r)},t}(),HdAdapter=function(){function t(r){var e=this;this.viewport=window,this.isDevicePixelRatioChange=!1,this.init=function(){e.initDevicePixelRatioListener(),e.initDeviceZoomListener()},this.destroy=function(){e.removeDevicePixelRatioListener(),e.removeDeviceZoomListener()},this.removeDevicePixelRatioListener=function(){var n;!((n=e.devicePixelRatioMedia)===null||n===void 0)&&n.removeEventListener?e.devicePixelRatioMedia.removeEventListener("change",e.renderByDevicePixelRatioChanged):e.devicePixelRatioMedia.removeListener(e.renderByDevicePixelRatioChanged)},this.initDeviceZoomListener=function(){var n,a;isMobile()||(a=(n=e.viewport)===null||n===void 0?void 0:n.visualViewport)===null||a===void 0||a.addEventListener("resize",e.renderByZoomScaleWithoutResizeEffect)},this.removeDeviceZoomListener=function(){var n,a;isMobile()||(a=(n=e.viewport)===null||n===void 0?void 0:n.visualViewport)===null||a===void 0||a.removeEventListener("resize",e.renderByZoomScaleWithoutResizeEffect)},this.renderByZoomScaleWithoutResizeEffect=function(n){e.isDevicePixelRatioChange=!1,e.renderByZoomScale(n)},this.renderByDevicePixelRatioChanged=function(){e.isDevicePixelRatioChange=!0,e.renderByDevicePixelRatio()},this.renderByDevicePixelRatio=function(n){n===void 0&&(n=window.devicePixelRatio);var a=e.spreadsheet,o=a.container,s=a.options,l=s.width,u=s.height,c=e.spreadsheet.getCanvasElement(),d=o.getConfig().devicePixelRatio;if(!(d===n||!c)){var f=Math.max(n,d,MIN_DEVICE_PIXEL_RATIO);o.getConfig().devicePixelRatio=f,o.resize(l,u),e.spreadsheet.render(!1)}},this.renderByZoomScale=debounce(function(n){var a,o=Math.ceil((a=n.target)===null||a===void 0?void 0:a.scale);o>=1&&!e.isDevicePixelRatioChange&&e.renderByDevicePixelRatio(o)},350),this.spreadsheet=r}return t.prototype.initDevicePixelRatioListener=function(){var r;this.devicePixelRatioMedia=window.matchMedia("(resolution: ".concat(window.devicePixelRatio,"dppx)")),!((r=this.devicePixelRatioMedia)===null||r===void 0)&&r.addEventListener?this.devicePixelRatioMedia.addEventListener("change",this.renderByDevicePixelRatioChanged):this.devicePixelRatioMedia.addListener(this.renderByDevicePixelRatioChanged)},t}(),BaseTooltip=function(){function t(r){this.visible=!1,this.position={x:0,y:0},this.spreadsheet=r}return t.prototype.show=function(r){var e,n,a,o=r.position,s=r.content,l=r.event,u=this.spreadsheet.options.tooltip||{},c=u.autoAdjustBoundary,d=u.adjustPosition;this.visible=!0,this.options=r;var f=this.getContainer();this.renderContent(s);var h=getAutoAdjustPosition({spreadsheet:this.spreadsheet,position:o,tooltipContainer:f,autoAdjustBoundary:c}),p=h.x,v=h.y;this.position=(e=d==null?void 0:d({position:{x:p,y:v},event:l}))!==null&&e!==void 0?e:{x:p,y:v},setTooltipContainerStyle(f,{style:{left:"".concat((n=this.position)===null||n===void 0?void 0:n.x,"px"),top:"".concat((a=this.position)===null||a===void 0?void 0:a.y,"px"),pointerEvents:"all"},visible:!0})},t.prototype.hide=function(){this.visible=!1,this.container&&(setTooltipContainerStyle(this.container,{style:{pointerEvents:"none"},visible:!1}),this.resetPosition())},t.prototype.destroy=function(){var r,e;this.visible=!1,this.container&&(this.resetPosition(),(e=(r=this.container).remove)===null||e===void 0||e.call(r),this.container=null)},t.prototype.renderContent=function(r){var e,n,a,o;if(this.container){this.clearContent();var s=(this.spreadsheet.options.tooltip||{}).content,l=r??s;if(!isNil(l)){if(typeof l=="string"){this.container.innerHTML=l,(n=(e=this.options).onMounted)===null||n===void 0||n.call(e);return}l instanceof Element&&(this.container.appendChild(l),(o=(a=this.options).onMounted)===null||o===void 0||o.call(a))}}},t.prototype.clearContent=function(){this.container&&(this.container.innerHTML="")},t.prototype.disablePointerEvent=function(){this.container&&this.container.style.pointerEvents!=="none"&&setTooltipContainerStyle(this.container,{style:{pointerEvents:"none"}})},t.prototype.resetPosition=function(){this.position={x:0,y:0}},t.prototype.getContainer=function(){var r;if(!this.container){var e=this.spreadsheet.options.tooltip,n=((r=e==null?void 0:e.getContainer)===null||r===void 0?void 0:r.call(e))||document.body,a=document.createElement("div");return setTooltipContainerStyle(a,{style:e==null?void 0:e.style,className:[TOOLTIP_CONTAINER_CLS].concat(e==null?void 0:e.className)}),n.appendChild(a),this.container=a,this.container}return this.container},t}(),OFFSCREEN_CANVAS_DOM_ID="s2-offscreen-canvas",removeOffscreenCanvas=function(){var t;(t=document.getElementById(OFFSCREEN_CANVAS_DOM_ID))===null||t===void 0||t.remove()};runtime.enableCSSParsing=!1;var SpreadSheet=function(t){__extends(r,t);function r(e,n,a){var o=t.call(this)||this;return o.store=new Store,o.destroyed=!1,o.measureText=memoize(function(s,l){var u;if(s===void 0&&(s=""),!l)return null;var c=(u=o.getCanvasElement())===null||u===void 0?void 0:u.getContext("2d"),d=l,f=d.fontSize,h=d.fontFamily,p=d.fontWeight,v=d.fontStyle,g=d.fontVariant;return c.font=[v,g,p,"".concat(f,"px"),h].join(" ").trim(),c.measureText(String(s))},function(s,l){return __spreadArray([s],__read(values(l)),!1).join("")}),o.measureTextWidth=function(s,l){s===void 0&&(s="");var u=o.measureText(s,l);return(u==null?void 0:u.width)||0},o.measureTextHeight=function(s,l){s===void 0&&(s="");var u=o.measureText(s,l);return u?u.actualBoundingBoxAscent+u.actualBoundingBoxDescent:0},o.measureTextWidthRoughly=function(s,l){var u,c;l===void 0&&(l={});var d=o.measureTextWidth("a",l),f=o.measureTextWidth("蚂",l),h=0;if(!s)return h;try{for(var p=__values(s),v=p.next();!v.done;v=p.next()){var g=v.value,y=g.charCodeAt(0);h+=y>=0&&y<=255?d:f}}catch(m){u={error:m}}finally{try{v&&!v.done&&(c=p.return)&&c.call(p)}finally{if(u)throw u.error}}return h},o.dataCfg=setupDataConfig(n),o.options=setupOptions(a),o.dataSet=o.getDataSet(),o.setDebug(),o.initTooltip(),o.initContainer(e),o.bindEvents(),o.initInteraction(),o.initTheme(),o.initHdAdapter(),o.registerIcons(),o.setOverscrollBehavior(),o}return r.prototype.isCustomHeaderFields=function(e){var n=this.dataCfg.fields;return e?some(n==null?void 0:n[e],function(a){return!isString(a)}):some(__spreadArray(__spreadArray([],__read(n==null?void 0:n.rows),!1),__read(n==null?void 0:n.columns),!1),function(a){return!isString(a)})},r.prototype.isCustomColumnFields=function(){return this.isCustomHeaderFields("columns")},r.prototype.setOverscrollBehavior=function(){var e=this.options.interaction.overscrollBehavior,n=window.getComputedStyle(document.body).getPropertyValue("overscroll-behavior"),a=n&&n!=="auto";a?this.store.set("initOverscrollBehavior",n):e&&(document.body.style.overscrollBehavior=e)},r.prototype.restoreOverscrollBehavior=function(){document.body.style.overscrollBehavior=this.store.get("initOverscrollBehavior")||""},r.prototype.setDebug=function(){DebuggerUtil.getInstance().setDebug(this.options.debug)},r.prototype.initTheme=function(){this.setThemeCfg({name:"default"})},r.prototype.getMountContainer=function(e){var n=isString(e)?document.querySelector(e):e;if(!n)throw new Error("Target mount container is not a DOM element");return n},r.prototype.initHdAdapter=function(){this.options.hd&&(this.hdAdapter=new HdAdapter(this),this.hdAdapter.init())},r.prototype.initInteraction=function(){var e,n;(n=(e=this.interaction)===null||e===void 0?void 0:e.destroy)===null||n===void 0||n.call(e),this.interaction=new RootInteraction(this)},r.prototype.initTooltip=function(){var e,n,a,o;(n=(e=this.tooltip)===null||e===void 0?void 0:e.destroy)===null||n===void 0||n.call(e),this.tooltip=this.renderTooltip(),this.tooltip instanceof BaseTooltip||console.warn("[Custom Tooltip]: ".concat((o=(a=this.tooltip)===null||a===void 0?void 0:a.constructor)===null||o===void 0?void 0:o.toString()," should be extends from BaseTooltip"))},r.prototype.renderTooltip=function(){var e,n;return((n=(e=this.options.tooltip)===null||e===void 0?void 0:e.render)===null||n===void 0?void 0:n.call(e,this))||new BaseTooltip(this)},r.prototype.showTooltip=function(e){var n=this,a=e.content,o=e.event,s=this.getCell(o==null?void 0:o.target),l=isFunction(a)?a(s,e):a;return new Promise(function(u){var c,d,f=__assign(__assign({},e),{content:l,onMounted:u});isMobile()?delay(function(){var h,p;(p=(h=n.tooltip).show)===null||p===void 0||p.call(h,f)},50):(d=(c=n.tooltip).show)===null||d===void 0||d.call(c,f)})},r.prototype.showTooltipWithInfo=function(e,n,a){var o,s=getTooltipOptions(this,e),l=s.enable,u=s.content;if(l){var c=this.getCell(e==null?void 0:e.target),d=(o=a==null?void 0:a.data)!==null&&o!==void 0?o:getTooltipData({spreadsheet:this,cellInfos:n,targetCell:c,options:__assign({enableFormat:!0},a)});return this.showTooltip({data:d,position:{x:e.clientX,y:e.clientY},options:a,event:e,content:u})}},r.prototype.hideTooltip=function(){var e,n;(n=(e=this.tooltip).hide)===null||n===void 0||n.call(e)},r.prototype.destroyTooltip=function(){var e,n;(n=(e=this.tooltip).destroy)===null||n===void 0||n.call(e)},r.prototype.registerIcons=function(){var e=this.options.customSVGIcons;isEmpty(e)||forEach(e,function(n){registerIcon(n.name,n.svg)})},r.prototype.setDataCfg=function(e,n){this.store.set("originalDataCfg",e),n?this.dataCfg=setupDataConfig(e):this.dataCfg=setupDataConfig(this.dataCfg,e),clearValueRangeState(this)},r.prototype.setOptions=function(e,n){var a;this.hideTooltip(),n?this.options=setupOptions(e):this.options=customMerge(this.options,e),(n||!((a=e==null?void 0:e.tooltip)===null||a===void 0)&&a.render)&&this.initTooltip(),this.resetHiddenColumnsDetailInfoIfNeeded(),this.registerIcons()},r.prototype.resetDataCfg=function(){this.setDataCfg(null,!0)},r.prototype.resetOptions=function(){this.setOptions(null,!0)},r.prototype.resetHiddenColumnsDetailInfoIfNeeded=function(){var e;isEmpty((e=this.options.interaction)===null||e===void 0?void 0:e.hiddenColumnFields)||this.store.set("hiddenColumnsDetail",[])},r.prototype.doRender=function(e){return __awaiter(this,void 0,void 0,function(){var n,a,o,s,l,u,c;return __generator(this,function(d){switch(d.label){case 0:return!this.getCanvasElement()||!window.document.body.contains(this.getCanvasElement())?[2]:(n=e||{},a=n.reloadData,o=a===void 0?!0:a,s=n.reBuildDataSet,l=s===void 0?!1:s,u=n.reBuildHiddenColumnsDetail,c=u===void 0?!0:u,this.emit(S2Event.LAYOUT_BEFORE_RENDER),l&&(this.dataSet=this.getDataSet()),o&&(this.clearDrillDownData("",!0),this.dataSet.setDataCfg(this.dataCfg)),this.buildFacet(),c?[4,this.initHiddenColumnsDetail()]:[3,2]);case 1:d.sent(),d.label=2;case 2:return this.emit(S2Event.LAYOUT_AFTER_RENDER),[2]}})})},r.prototype.render=function(e){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(a){switch(a.label){case 0:return this.destroyed?[2]:(n=typeof e=="boolean"?{reloadData:e}:e,[4,this.container.ready]);case 1:return a.sent(),[4,this.doRender(n)];case 2:return a.sent(),[2]}})})},r.prototype.destroy=function(){var e,n,a,o,s;this.destroyed||(this.destroyed=!0,this.restoreOverscrollBehavior(),this.emit(S2Event.LAYOUT_DESTROY),(e=this.facet)===null||e===void 0||e.destroy(),(n=this.hdAdapter)===null||n===void 0||n.destroy(),(a=this.interaction)===null||a===void 0||a.destroy(),(o=this.store)===null||o===void 0||o.clear(),this.destroyTooltip(),this.clearCanvasEvent(),(s=this.container)===null||s===void 0||s.destroy(),removeOffscreenCanvas())},r.prototype.setThemeName=function(e){this.themeName=e},r.prototype.setThemeCfg=function(e){e===void 0&&(e={});var n=(e==null?void 0:e.theme)||{},a=getTheme(__assign(__assign({},e),{spreadsheet:this}));this.theme=customMerge(a,n),this.setThemeName(e==null?void 0:e.name),injectThemeVars(e==null?void 0:e.name)},r.prototype.setTheme=function(e){this.theme=customMerge(this.theme,e)},r.prototype.getTheme=function(){return this.theme},r.prototype.getThemeName=function(){return this.themeName},r.prototype.updatePagination=function(e){this.options=customMerge(this.options,{pagination:e}),this.facet.resetScrollOffset()},r.prototype.getContentHeight=function(){return this.facet.getContentHeight()},r.prototype.changeSheetSize=function(e,n){e===void 0&&(e=this.options.width),n===void 0&&(n=this.options.height);var a=this.getCanvasElement(),o=this.container.getConfig(),s=o.width,l=o.height,u=e!==s||n!==l;!u||!a||(this.options=customMerge(this.options,{width:e,height:n}),this.container.resize(e,n))},r.prototype.on=function(e,n){return t.prototype.on.call(this,e,n)},r.prototype.emit=function(e){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];t.prototype.emit.apply(this,__spreadArray([e],__read(n),!1))},r.prototype.getCanvas=function(){return this.container},r.prototype.getCanvasConfig=function(){return this.getCanvas().getConfig()},r.prototype.getCanvasElement=function(){return this.getCanvas().getContextService().getDomElement()},r.prototype.getLayoutWidthType=function(){var e;return(e=this.options.style)===null||e===void 0?void 0:e.layoutWidthType},r.prototype.updateScrollOffset=function(e){var n={offsetX:{value:void 0,animate:!1},offsetY:{value:void 0,animate:!1},rowHeaderOffsetX:{value:void 0,animate:!1}};this.facet.updateScrollOffset(customMerge(n,e))},r.prototype.isCellType=function(e){return e instanceof BaseCell},r.prototype.getCell=function(e){for(var n=e;n&&!(n instanceof Canvas);){if(this.isCellType(n))return n;n=n==null?void 0:n.parentNode}return null},r.prototype.getCellType=function(e){var n=this.getCell(e);return n==null?void 0:n.cellType},r.prototype.getTotalsConfig=function(e){var n=this.options.totals,a=this.dataSet.fields.rows,o=get(n,includes(a,e)?"row":"col",{}),s=o.showSubTotals&&includes(o.subTotalsDimensions,e)?o.showSubTotals:!1;return __assign(__assign({grandTotalsLabel:i18n("总计"),subTotalsLabel:i18n("小计"),grandTotalsGroupDimensions:[],subTotalsGroupDimensions:[]},o),{showSubTotals:s})},r.prototype.initContainer=function(e){var n=this.options,a=n.width,o=n.height,s=n.transformCanvasConfig,l=new Renderer,u=s==null?void 0:s(l,this);this.container=new Canvas(__assign({container:this.getMountContainer(e),width:a,height:o,renderer:l},u)),this.updateContainerStyle()},r.prototype.updateContainerStyle=function(){var e=this.getCanvasElement();e&&(e.style.display="block")},r.prototype.initHiddenColumnsDetail=function(){return __awaiter(this,void 0,void 0,function(){var e,n;return __generator(this,function(a){switch(a.label){case 0:return e=this.options.interaction.hiddenColumnFields,n=this.store.get("hiddenColumnsDetail"),isEmpty(e)&&isEmpty(n)?[2]:[4,hideColumnsByThunkGroup(this,e,!0)];case 1:return a.sent(),[2]}})})},r.prototype.clearCanvasEvent=function(){var e=this,n=this.getEvents();forIn(n,function(a,o){e.off(o)})},r.prototype.updateSortMethodMap=function(e,n,a){var o;a===void 0&&(a=!1);var s=a?null:this.store.get("sortMethodMap");this.store.set("sortMethodMap",__assign(__assign({},s),(o={},o[e]=n,o)))},r.prototype.getMenuDefaultSelectedKeys=function(e){var n=this.store.get("sortMethodMap"),a=get(n,e);return a?[a]:[]},r.prototype.handleGroupSort=function(e,n){var a=this;e.stopPropagation(),this.interaction.addIntercepts([InterceptType.HOVER]);var o=this.getMenuDefaultSelectedKeys(n==null?void 0:n.id),s=this.isTableMode()?getTooltipOperatorTableSortMenus():getTooltipOperatorSortMenus(),l={menu:{defaultSelectedKeys:o,items:s,onClick:function(u){var c=u.key;a.groupSortByMethod(c,n),a.emit(S2Event.RANGE_SORTED,e)}}};this.showTooltipWithInfo(e,[],{operator:l,onlyShowOperator:!0,forceRender:!0})},r}(EventEmitter),PivotSheet=function(t){__extends(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.isCustomRowFields=function(){return this.isCustomHeaderFields("rows")},r.prototype.getDataSet=function(){var e=this.options.dataSet;return e?e(this):this.isCustomRowFields()?new CustomGridPivotDataSet(this):new PivotDataSet(this)},r.prototype.enableFrozenHeaders=function(){return!1},r.prototype.getContentHeight=function(){return this.facet.getContentHeight()},r.prototype.isPivotMode=function(){return!0},r.prototype.isTableMode=function(){return!1},r.prototype.isHierarchyTreeType=function(){return this.options.hierarchyType==="tree"},r.prototype.isFrozenRowHeader=function(){var e,n;return!!(!((n=(e=this.options)===null||e===void 0?void 0:e.frozen)===null||n===void 0)&&n.rowHeader)},r.prototype.isValueInCols=function(){return this.dataSet.fields.valueInCols},r.prototype.clearDrillDownData=function(e,n){if(this.dataSet instanceof PivotDataSet){var a=this.dataSet.clearDrillDownData(e);a&&!n&&(this.interaction.reset(),this.render(!1))}},r.prototype.buildFacet=function(){var e=this,n,a,o,s,l,u,c=function(d){return new DataCell(d,e)};(n=(u=this.options).dataCell)!==null&&n!==void 0||(u.dataCell=c),(a=this.facet)===null||a===void 0||a.destroy(),this.facet=(l=(s=(o=this.options).facet)===null||s===void 0?void 0:s.call(o,this))!==null&&l!==void 0?l:new PivotFacet(this),this.facet.render()},r.prototype.bindEvents=function(){this.off(S2Event.ROW_CELL_COLLAPSED__PRIVATE),this.off(S2Event.ROW_CELL_ALL_COLLAPSED__PRIVATE),this.on(S2Event.ROW_CELL_COLLAPSED__PRIVATE,this.handleRowCellCollapsed),this.on(S2Event.ROW_CELL_ALL_COLLAPSED__PRIVATE,this.handleRowCellToggleCollapseAll)},r.prototype.handleRowCellCollapsed=function(e){var n,a,o=e.isCollapsed,s=e.node,l=((a=this.options.style)===null||a===void 0?void 0:a.rowCell).collapseFields,u=__assign(__assign({},l),(n={},n[s.id]=o,n));this.setOptions({style:{rowCell:{collapseFields:u}}}),this.render(!1),this.emit(S2Event.ROW_CELL_COLLAPSED,{isCollapsed:o,collapseFields:u,node:s})},r.prototype.handleRowCellToggleCollapseAll=function(e){var n=!e;this.setOptions({style:{rowCell:{collapseAll:n,collapseFields:null,expandDepth:null}}}),this.render(!1),this.emit(S2Event.ROW_CELL_ALL_COLLAPSED,n)},r.prototype.groupSortByMethod=function(e,n){var a,o=this.dataCfg.fields,s=o.rows,l=o.columns,u=this.options.style.colCell.hideValue,c=this.isValueInCols()?last(s):last(l),d=n.query,f=n.value,h=clone$1(d),p=f;u&&this.isValueInCols()&&(p=this.dataSet.fields.values[0],h[EXTRA_FIELD]=p);var v=isString(c)?c:c.field,g={sortFieldId:v,sortMethod:e,sortByMeasure:p,query:h},y=(a=this.dataCfg.sortParams)===null||a===void 0?void 0:a.filter(function(S){return(S==null?void 0:S.sortFieldId)!==c});this.updateSortMethodMap(n.id,e,!0);var m=__spreadArray(__spreadArray([],__read(y),!1),[g],!1);this.emit(S2Event.RANGE_SORT,m),this.setDataCfg(__assign(__assign({},this.dataCfg),{sortParams:m})),this.render()},r}(SpreadSheet);(function(t){__extends(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.groupSortByMethod=function(n,a){var o=a.field,s={sortFieldId:o,sortMethod:n};e.updateSortMethodMap(a.id,n),e.emit(S2Event.RANGE_SORT,[s])},e}return r.prototype.isCustomRowFields=function(){return!1},r.prototype.getDataSet=function(){var e=this.options.dataSet;return e?e(this):new TableDataSet(this)},r.prototype.enableFrozenHeaders=function(){var e=this.options.frozen,n=e.rowCount,a=n===void 0?0:n,o=e.trailingRowCount,s=o===void 0?0:o,l=e.colCount,u=l===void 0?0:l,c=e.trailingColCount,d=c===void 0?0:c;return a>0||s>0||u>0||d>0},r.prototype.isPivotMode=function(){return!1},r.prototype.isTableMode=function(){return!0},r.prototype.isHierarchyTreeType=function(){return!1},r.prototype.isFrozenRowHeader=function(){return!1},r.prototype.clearDrillDownData=function(){},r.prototype.isValueInCols=function(){return!1},r.prototype.bindEvents=function(){},r.prototype.buildFacet=function(){var e=this,n,a,o,s,l,u,c=function(d){var f;return!((f=e.options.seriesNumber)===null||f===void 0)&&f.enable&&d.colIndex===0?new TableSeriesNumberCell(d,e):new TableDataCell(d,e)};(n=(u=this.options).dataCell)!==null&&n!==void 0||(u.dataCell=c),(a=this.facet)===null||a===void 0||a.destroy(),this.facet=(l=(s=(o=this.options).facet)===null||s===void 0?void 0:s.call(o,this))!==null&&l!==void 0?l:new TableFacet(this),this.facet.render()},r.prototype.destroy=function(){t.prototype.destroy.call(this),this.off(S2Event.RANGE_SORT),this.off(S2Event.RANGE_FILTER)},r})(SpreadSheet);const _sfc_main$1={name:"s2-view",data(){return{s2:null}},props:{dataSource:{type:Object,default:()=>{}},hierarchyType:{type:String,default:"grid"},meta:{type:Array,default:()=>[]},layoutWidthType:{type:String,default:"colAdaptive"}},mounted(){this.dataSource&&this.bootstrap(),setTimeout(()=>{this.s2.setThemeCfg({name:"colorful"})},1e3)},watch:{hierarchyType:{handler(t){this.s2.destroy(),this.bootstrap()}},dataSource:{handler(t){console.log(t,22),this.s2.destroy(),this.bootstrap()},deep:!0}},methods:{async bootstrap(){console.log(this.dataSource);const t={width:600,height:480,hierarchyType:this.hierarchyType,showDefaultHeaderActionIcon:!0,interaction:{copy:{enable:!0},withFormat:!0,withHeader:!0},style:{layoutWidthType:"colAdaptive",colCfg:{hideMeasureColumn:!0},cellCfg:{width:200}},totals:{row:{showSubTotals:!0,showGrandTotals:!0}},interaction:{selectedCellsSpotlight:!1,hoverHighlight:!1},frozen:{}},r={...this.dataSource,meta:this.meta},e=document.getElementById("container"),n=new PivotSheet(e,r,t);this.s2=n,await n.render()}}},_hoisted_1$1={id:"container"};function _sfc_render(t,r,e,n,a,o){return openBlock(),createElementBlock("div",_hoisted_1$1)}const S2View=_export_sfc(_sfc_main$1,[["render",_sfc_render]]),_hoisted_1=createStaticVNode('<h1 id="大数据表格" tabindex="-1">大数据表格 <a class="header-anchor" href="#大数据表格" aria-label="Permalink to &quot;大数据表格&quot;">​</a></h1><h2 id="构成" tabindex="-1">构成 <a class="header-anchor" href="#构成" aria-label="Permalink to &quot;构成&quot;">​</a></h2><p>透视表由五部分组成，分别是行头、列头、角头、数据单元格、框架 如下图所示：</p><p><img src="'+_imports_0+'" alt="alt text"></p><h2 id="基础用法" tabindex="-1">基础用法 <a class="header-anchor" href="#基础用法" aria-label="Permalink to &quot;基础用法&quot;">​</a></h2><p>This is a simple example</p>',6),_hoisted_7={class:"example"},__pageData=JSON.parse('{"title":"大数据表格","description":"","frontmatter":{},"headers":[],"relativePath":"examples/S2View/index.md","filePath":"examples/S2View/index.md"}'),__default__={name:"examples/S2View/index.md"},_sfc_main=Object.assign(__default__,{setup(t){const r=ref(data1),e=ref("grid"),n=ref([{field:"number",name:"数量"},{field:"province",name:"省份"},{field:"city",name:"城市"},{field:"type",name:"类别"},{field:"sub_type",name:"子类别"}]);return onMounted(()=>{axios.get("/data/list").then(o=>{r.value=o.data,console.log(r,22)}).catch(o=>{console.log(o)});const a=getCurrentInstance();console.log(a,"in")}),(a,o)=>{const s=resolveComponent("el-option"),l=resolveComponent("el-select");return openBlock(),createElementBlock("div",null,[_hoisted_1,createBaseVNode("div",_hoisted_7,[createVNode(l,{modelValue:e.value,"onUpdate:modelValue":o[0]||(o[0]=u=>e.value=u),style:{width:"100px"},placeholder:"请选择模式"},{default:withCtx(()=>[createVNode(s,{value:"tree",label:"树状模式"},{default:withCtx(()=>[createTextVNode("树状模式")]),_:1}),createVNode(s,{value:"grid",label:"平铺模式"},{default:withCtx(()=>[createTextVNode("平铺模式 ")]),_:1})]),_:1},8,["modelValue"]),createVNode(S2View,{ref:"s2",dataSource:r.value,hierarchyType:e.value,meta:n.value},null,8,["dataSource","hierarchyType","meta"])])])}}});export{__pageData,_sfc_main as default};
